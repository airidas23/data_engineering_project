2025-01-20 10:28:11,699 - [INFO] - Spark Session created.
2025-01-20 10:31:14,326 - [ERROR] - Error occurred during Task 1 processing.
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 35, in main
    process_files_for_user_agent(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 23, in process_files_for_user_agent
    df = spark.read.parquet(input_path + "/*.parquet")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 449, in connect_to_java_server
    self.close()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 542, in close
    def close(self, reset=False):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 449, in connect_to_java_server
    self.close()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 542, in close
    def close(self, reset=False):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 10:31:47,076 - [INFO] - Spark Session created.
2025-01-20 10:33:57,935 - [ERROR] - Error occurred during Task 1 processing.
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 35, in main
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 23, in process_files_for_user_agent
    df = spark.read.parquet(input_path + "/*.parquet")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 10:34:28,823 - [INFO] - Spark Session created.
2025-01-20 10:34:30,362 - [ERROR] - Error occurred during Task 1 processing.
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 39, in main
    process_files_for_user_agent(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 23, in process_files_for_user_agent
    df = spark.read.parquet(input_path + "/*.parquet")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\errors\exceptions\captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [PATH_NOT_FOUND] Path does not exist: file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/data/input/*.parquet.
2025-01-20 10:37:06,554 - [INFO] - Spark Session created.
2025-01-20 10:37:08,099 - [ERROR] - Error occurred during Task 1 processing.
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 35, in main
    process_files_for_user_agent(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 23, in process_files_for_user_agent
    df = spark.read.parquet(input_path + "/*.parquet")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\errors\exceptions\captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: [PATH_NOT_FOUND] Path does not exist: file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/data/input/*.parquet.
2025-01-20 10:50:21,876 - [INFO] - Spark Session created.
2025-01-20 10:50:21,876 - [ERROR] - Input path does not exist: ./data/input
2025-01-20 10:50:21,876 - [INFO] - Task 1 processing complete.
2025-01-20 10:53:01,796 - [INFO] - Spark Session created.
2025-01-20 10:59:53,714 - [ERROR] - Error occurred during Task 1 processing.
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 35, in main
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 38, in process_files_for_user_agent
    # We assume structure:
         ^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:00:29,140 - [INFO] - Spark Session created.
2025-01-20 11:01:12,245 - [ERROR] - Error occurred during Task 1 processing.
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 39, in main
    process_files_for_user_agent(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 36, in process_files_for_user_agent
    raise ValueError("Input data failed schema validation")
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:05:52,522 - [INFO] - Spark Session created.
2025-01-20 11:09:02,811 - [ERROR] - Error during processing: [WinError 10061] No connection could be made because the target machine actively refused it
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 52, in process_files_for_user_agent
    df, input_files = self.read_input_files(input_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 32, in read_input_files
    df = self.spark.read.parquet(os.path.join(input_path, "*.parquet"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:09:02,816 - [INFO] - Task 1 processing complete.
2025-01-20 11:09:04,844 - [ERROR] - Error occurred during Task 1 processing.
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 49, in main
    parsed_args = parser.parse_args(args)
        ^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\session.py", line 1796, in stop
    self._sc.stop()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 654, in stop
    self._jsc.stop()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:09:29,074 - [INFO] - Starting application...
2025-01-20 11:09:55,887 - [INFO] - Spark Session created successfully.
2025-01-20 11:09:55,887 - [INFO] - Using input path: ./raw_data
2025-01-20 11:09:55,887 - [INFO] - Using output path: ./output
2025-01-20 11:12:53,700 - [ERROR] - Error during processing: [WinError 10061] No connection could be made because the target machine actively refused it
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 52, in process_files_for_user_agent
    df, input_files = self.read_input_files(input_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 32, in read_input_files
    df = self.spark.read.parquet(os.path.join(input_path, "*.parquet"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:12:53,712 - [ERROR] - Task 1 processing failed.
2025-01-20 11:12:55,739 - [ERROR] - Error stopping Spark session: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:13:02,580 - [INFO] - Starting application...
2025-01-20 11:13:29,199 - [INFO] - Spark Session created successfully.
2025-01-20 11:13:29,199 - [INFO] - Using input path: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\raw_data
2025-01-20 11:13:29,199 - [INFO] - Using output path: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output
2025-01-20 11:14:06,462 - [ERROR] - Error during processing: [WinError 10061] No connection could be made because the target machine actively refused it
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 52, in process_files_for_user_agent
    df, input_files = self.read_input_files(input_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 32, in read_input_files
    df = self.spark.read.parquet(os.path.join(input_path, "*.parquet"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:14:06,462 - [ERROR] - Task 1 processing failed.
2025-01-20 11:14:08,486 - [ERROR] - Error stopping Spark session: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:14:16,352 - [INFO] - Starting application...
2025-01-20 11:14:43,051 - [INFO] - Spark Session created successfully.
2025-01-20 11:14:43,051 - [INFO] - Using input path: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\raw_data
2025-01-20 11:14:43,051 - [INFO] - Using output path: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output
2025-01-20 11:17:00,076 - [ERROR] - Error during processing: [WinError 10061] No connection could be made because the target machine actively refused it
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 52, in process_files_for_user_agent
    df, input_files = self.read_input_files(input_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 32, in read_input_files
    df = self.spark.read.parquet(os.path.join(input_path, "*.parquet"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 449, in connect_to_java_server
    self.close()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 542, in close
    def close(self, reset=False):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:17:00,081 - [ERROR] - Task 1 processing failed.
2025-01-20 11:17:02,112 - [ERROR] - Error stopping Spark session: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:17:15,707 - [INFO] - Starting application...
2025-01-20 11:17:42,350 - [INFO] - Spark Session created successfully.
2025-01-20 11:17:42,350 - [INFO] - Using input path: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\raw_data
2025-01-20 11:17:42,350 - [INFO] - Using output path: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output
2025-01-20 11:25:40,900 - [ERROR] - Error during processing: [WinError 10061] No connection could be made because the target machine actively refused it
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 52, in process_files_for_user_agent
    df, input_files = self.read_input_files(input_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 32, in read_input_files
    df = self.spark.read.parquet(os.path.join(input_path, "*.parquet"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:25:40,905 - [ERROR] - Task 1 processing failed.
2025-01-20 11:25:42,945 - [ERROR] - Error stopping Spark session: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:26:52,344 - [INFO] - Starting application...
2025-01-20 11:26:52,344 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 11:26:52,344 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 11:27:18,003 - [INFO] - Spark Session created successfully.
2025-01-20 11:30:20,925 - [ERROR] - Error during processing: [WinError 10061] No connection could be made because the target machine actively refused it
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 511, in send_command
    answer = smart_decode(self.stream.readline()[:-1])
                          ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\socket.py", line 706, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 503, in send_command
    self.socket.sendall(command.encode("utf-8"))
ConnectionResetError: [WinError 10054] An existing connection was forcibly closed by the remote host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 506, in send_command
    raise Py4JNetworkError(
py4j.protocol.Py4JNetworkError: Error while sending

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 52, in process_files_for_user_agent
    df, input_files = self.read_input_files(input_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 32, in read_input_files
    df = self.spark.read.parquet(os.path.join(input_path, "*.parquet"))
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 544, in parquet
    return self._df(self._jreader.parquet(_to_seq(self._spark._sc, paths)))
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1038, in send_command
    response = connection.send_command(command)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 538, in send_command
    logger.info("Error while receiving.", exc_info=True)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\logging\__init__.py", line 1479, in info
    def info(self, msg, *args, **kwargs):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1053, in send_command
    response = self.send_command(command, binary=binary)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 449, in connect_to_java_server
    self.close()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 542, in close
    def close(self, reset=False):
    
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 381, in signal_handler
    self.cancelAllJobs()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 2446, in cancelAllJobs
    self._jsc.sc().cancelAllJobs()
    ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1321, in __call__
    answer = self.gateway_client.send_command(command)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1036, in send_command
    connection = self._get_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 284, in _get_connection
    connection = self._create_new_connection()
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 291, in _create_new_connection
    connection.connect_to_java_server()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\clientserver.py", line 438, in connect_to_java_server
    self.socket.connect((self.java_address, self.java_port))
ConnectionRefusedError: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:30:20,930 - [ERROR] - Task 1 processing failed.
2025-01-20 11:30:22,973 - [ERROR] - Error stopping Spark session: [WinError 10061] No connection could be made because the target machine actively refused it
2025-01-20 11:30:43,439 - [INFO] - Starting application...
2025-01-20 11:30:43,439 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 11:30:43,439 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 11:31:10,016 - [INFO] - Spark Session created successfully.
2025-01-20 11:31:14,127 - [ERROR] - Missing required field: event_type
2025-01-20 11:31:14,127 - [ERROR] - Error during processing: Input data failed schema validation
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 52, in process_files_for_user_agent
    df, input_files = self.read_input_files(input_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 36, in read_input_files
    raise ValueError("Input data failed schema validation")
ValueError: Input data failed schema validation
2025-01-20 11:31:14,127 - [ERROR] - Task 1 processing failed.
2025-01-20 11:31:14,422 - [INFO] - Spark Session stopped successfully.
2025-01-20 11:46:27,793 - [INFO] - Starting application...
2025-01-20 11:46:27,793 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 11:46:27,793 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 11:46:54,910 - [INFO] - Spark Session created successfully.
2025-01-20 11:46:59,688 - [ERROR] - Missing required field: event_type
2025-01-20 11:46:59,688 - [ERROR] - Error during processing: Input data failed schema validation
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 52, in process_files_for_user_agent
    df, input_files = self.read_input_files(input_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 36, in read_input_files
    raise ValueError("Input data failed schema validation")
ValueError: Input data failed schema validation
2025-01-20 11:46:59,688 - [ERROR] - Task 1 processing failed.
2025-01-20 11:47:00,239 - [INFO] - Spark Session stopped successfully.
2025-01-20 11:49:17,135 - [INFO] - Starting application...
2025-01-20 11:49:17,135 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 11:49:17,135 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 11:49:43,842 - [INFO] - Spark Session created successfully.
2025-01-20 11:49:47,997 - [ERROR] - Missing required fields: event_type
2025-01-20 11:49:47,997 - [ERROR] - Task 1 processing failed.
2025-01-20 11:49:48,227 - [INFO] - Spark Session stopped successfully.
2025-01-20 11:52:48,901 - [INFO] - Starting application...
2025-01-20 11:52:48,901 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 11:52:48,901 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 11:53:15,673 - [INFO] - Spark Session created successfully.
2025-01-20 11:53:19,724 - [ERROR] - Missing required fields: event_type
2025-01-20 11:53:19,724 - [ERROR] - Task 1 processing failed.
2025-01-20 11:53:20,065 - [INFO] - Spark Session stopped successfully.
2025-01-20 12:03:46,085 - [INFO] - Starting application...
2025-01-20 12:03:46,085 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:03:46,085 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:04:13,149 - [INFO] - Spark Session created successfully.
2025-01-20 12:04:13,149 - [INFO] - Found 5 impression files and 6 click files
2025-01-20 12:04:17,946 - [ERROR] - Error during processing: Cannot resolve column name "shown_in_non_friendly_iframe" among (transaction_header, user_identity, fraud_detection, geo_location, device_settings, connection, banner, rotator, interaction_id, page_url, landing_url, publisher_domain, banner_click_url_id, keywords, rtb_vars, publisher_data, dco_vars, banner_vars, adx_vars, ext_vars, test_id, raw_request_url, server_impression_time_ms, is_p2c_enabled, membership_id, unload, cross_device, client_id, client_provider, creation_time_local, inventory_source_creation_time_local, cookie_policy, deprecated_processing_id, payload, payload_cross_device, publisher_domain_normalized, payload_external_identity, invalidation_reason, exclude_from_processing_output, event_type).
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 96, in process_files_for_user_agent
    df = impressions_df.unionByName(clicks_df)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\dataframe.py", line 4043, in unionByName
    return DataFrame(self._jdf.unionByName(other._jdf, allowMissingColumns), self.sparkSession)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\errors\exceptions\captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: Cannot resolve column name "shown_in_non_friendly_iframe" among (transaction_header, user_identity, fraud_detection, geo_location, device_settings, connection, banner, rotator, interaction_id, page_url, landing_url, publisher_domain, banner_click_url_id, keywords, rtb_vars, publisher_data, dco_vars, banner_vars, adx_vars, ext_vars, test_id, raw_request_url, server_impression_time_ms, is_p2c_enabled, membership_id, unload, cross_device, client_id, client_provider, creation_time_local, inventory_source_creation_time_local, cookie_policy, deprecated_processing_id, payload, payload_cross_device, publisher_domain_normalized, payload_external_identity, invalidation_reason, exclude_from_processing_output, event_type).
2025-01-20 12:04:17,953 - [ERROR] - Task 1 processing failed.
2025-01-20 12:04:18,064 - [INFO] - Spark Session stopped successfully.
2025-01-20 12:06:18,640 - [INFO] - Starting application...
2025-01-20 12:06:18,640 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:06:18,641 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:06:45,244 - [INFO] - Spark Session created successfully.
2025-01-20 12:06:45,244 - [INFO] - Found 5 impression files and 6 click files
2025-01-20 12:06:53,046 - [INFO] - Row count metrics at initial: {'total_rows': 54, 'impression_count': 24, 'click_count': 30}
2025-01-20 12:06:53,046 - [INFO] - Initial data metrics: {'total_rows': 54, 'impression_count': 24, 'click_count': 30}
2025-01-20 12:06:53,918 - [INFO] - Filtered to 54 rows for user agent: some user agent
2025-01-20 12:07:07,040 - [ERROR] - Error during processing: An error occurred while calling o131.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 18.0 failed 1 times, most recent failure: Lost task 0.0 in stage 18.0 (TID 25) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 38 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2458)

	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1049)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)

	at org.apache.spark.rdd.RDD.withScope(RDD.scala:410)

	at org.apache.spark.rdd.RDD.collect(RDD.scala:1048)

	at org.apache.spark.RangePartitioner$.sketch(Partitioner.scala:320)

	at org.apache.spark.RangePartitioner.<init>(Partitioner.scala:187)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$.prepareShuffleDependency(ShuffleExchangeExec.scala:296)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency$lzycompute(ShuffleExchangeExec.scala:179)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency(ShuffleExchangeExec.scala:173)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture$lzycompute(ShuffleExchangeExec.scala:149)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture(ShuffleExchangeExec.scala:145)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.$anonfun$submitShuffleJob$1(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:246)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:243)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob$(ShuffleExchangeExec.scala:72)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.submitShuffleJob(ShuffleExchangeExec.scala:120)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture$lzycompute(QueryStageExec.scala:194)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture(QueryStageExec.scala:194)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.doMaterialize(QueryStageExec.scala:196)

	at org.apache.spark.sql.execution.adaptive.QueryStageExec.materialize(QueryStageExec.scala:61)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5(AdaptiveSparkPlanExec.scala:302)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5$adapted(AdaptiveSparkPlanExec.scala:300)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)

	at scala.collection.IterableLike.foreach(IterableLike.scala:74)

	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)

	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$1(AdaptiveSparkPlanExec.scala:300)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.getFinalPhysicalPlan(AdaptiveSparkPlanExec.scala:272)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:419)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 38 more

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 132, in process_files_for_user_agent
    self._write_output(complete_df, output_path, date_part)
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 175, in _write_output
    .csv(output_file)
     ^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o131.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 18.0 failed 1 times, most recent failure: Lost task 0.0 in stage 18.0 (TID 25) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 38 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2458)

	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1049)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)

	at org.apache.spark.rdd.RDD.withScope(RDD.scala:410)

	at org.apache.spark.rdd.RDD.collect(RDD.scala:1048)

	at org.apache.spark.RangePartitioner$.sketch(Partitioner.scala:320)

	at org.apache.spark.RangePartitioner.<init>(Partitioner.scala:187)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$.prepareShuffleDependency(ShuffleExchangeExec.scala:296)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency$lzycompute(ShuffleExchangeExec.scala:179)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency(ShuffleExchangeExec.scala:173)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture$lzycompute(ShuffleExchangeExec.scala:149)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture(ShuffleExchangeExec.scala:145)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.$anonfun$submitShuffleJob$1(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:246)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:243)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob$(ShuffleExchangeExec.scala:72)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.submitShuffleJob(ShuffleExchangeExec.scala:120)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture$lzycompute(QueryStageExec.scala:194)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture(QueryStageExec.scala:194)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.doMaterialize(QueryStageExec.scala:196)

	at org.apache.spark.sql.execution.adaptive.QueryStageExec.materialize(QueryStageExec.scala:61)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5(AdaptiveSparkPlanExec.scala:302)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5$adapted(AdaptiveSparkPlanExec.scala:300)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)

	at scala.collection.IterableLike.foreach(IterableLike.scala:74)

	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)

	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$1(AdaptiveSparkPlanExec.scala:300)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.getFinalPhysicalPlan(AdaptiveSparkPlanExec.scala:272)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:419)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 38 more


2025-01-20 12:07:07,044 - [ERROR] - Task 1 processing failed.
2025-01-20 12:07:07,451 - [INFO] - Spark Session stopped successfully.
2025-01-20 12:15:19,099 - [INFO] - Starting application...
2025-01-20 12:15:19,099 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:15:19,099 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:15:24,810 - [INFO] - Spark Session created successfully.
2025-01-20 12:15:24,810 - [INFO] - Found 5 impression files and 6 click files
2025-01-20 12:15:30,008 - [ERROR] - Error during processing: Cannot resolve column name "shown_in_non_friendly_iframe" among (transaction_header, user_identity, fraud_detection, geo_location, device_settings, connection, banner, rotator, interaction_id, page_url, landing_url, publisher_domain, banner_click_url_id, keywords, rtb_vars, publisher_data, dco_vars, banner_vars, adx_vars, ext_vars, test_id, raw_request_url, server_impression_time_ms, is_p2c_enabled, membership_id, unload, cross_device, client_id, client_provider, creation_time_local, inventory_source_creation_time_local, cookie_policy, deprecated_processing_id, payload, payload_cross_device, publisher_domain_normalized, payload_external_identity, invalidation_reason, exclude_from_processing_output, event_type).
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 133, in process_files_for_user_agent
    df = impressions_df.unionByName(clicks_df)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\dataframe.py", line 4037, in unionByName
    return DataFrame(self._jdf.unionByName(other._jdf, allowMissingColumns), self.sparkSession)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\errors\exceptions\captured.py", line 185, in deco
    raise converted from None
pyspark.errors.exceptions.captured.AnalysisException: Cannot resolve column name "shown_in_non_friendly_iframe" among (transaction_header, user_identity, fraud_detection, geo_location, device_settings, connection, banner, rotator, interaction_id, page_url, landing_url, publisher_domain, banner_click_url_id, keywords, rtb_vars, publisher_data, dco_vars, banner_vars, adx_vars, ext_vars, test_id, raw_request_url, server_impression_time_ms, is_p2c_enabled, membership_id, unload, cross_device, client_id, client_provider, creation_time_local, inventory_source_creation_time_local, cookie_policy, deprecated_processing_id, payload, payload_cross_device, publisher_domain_normalized, payload_external_identity, invalidation_reason, exclude_from_processing_output, event_type).
2025-01-20 12:15:30,017 - [ERROR] - Task 1 processing failed.
2025-01-20 12:15:30,218 - [INFO] - Spark Session stopped successfully.
2025-01-20 12:17:57,441 - [INFO] - Starting application...
2025-01-20 12:17:57,442 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:17:57,442 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:18:24,811 - [INFO] - Spark Session created successfully.
2025-01-20 12:18:24,811 - [INFO] - Found 5 impression files and 6 click files
2025-01-20 12:18:33,697 - [INFO] - Filtered to 54 rows for user agent: some user agent
2025-01-20 12:18:46,786 - [ERROR] - Error writing output: An error occurred while calling o126.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 11.0 failed 1 times, most recent failure: Lost task 1.0 in stage 11.0 (TID 14) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.sql.execution.joins.UnsafeCartesianRDD.compute(CartesianProductExec.scala:46)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 47 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)

	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)

	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)

	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)

	at org.apache.spark.RangePartitioner$.sketch(Partitioner.scala:320)

	at org.apache.spark.RangePartitioner.<init>(Partitioner.scala:187)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$.prepareShuffleDependency(ShuffleExchangeExec.scala:296)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency$lzycompute(ShuffleExchangeExec.scala:179)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency(ShuffleExchangeExec.scala:173)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture$lzycompute(ShuffleExchangeExec.scala:149)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture(ShuffleExchangeExec.scala:145)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.$anonfun$submitShuffleJob$1(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:246)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:243)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob$(ShuffleExchangeExec.scala:72)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.submitShuffleJob(ShuffleExchangeExec.scala:120)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture$lzycompute(QueryStageExec.scala:187)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture(QueryStageExec.scala:187)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.doMaterialize(QueryStageExec.scala:189)

	at org.apache.spark.sql.execution.adaptive.QueryStageExec.materialize(QueryStageExec.scala:61)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5(AdaptiveSparkPlanExec.scala:286)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5$adapted(AdaptiveSparkPlanExec.scala:284)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)

	at scala.collection.IterableLike.foreach(IterableLike.scala:74)

	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)

	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$1(AdaptiveSparkPlanExec.scala:284)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.getFinalPhysicalPlan(AdaptiveSparkPlanExec.scala:256)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:401)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.sql.execution.joins.UnsafeCartesianRDD.compute(CartesianProductExec.scala:46)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 47 more


2025-01-20 12:18:46,787 - [ERROR] - Error during processing: An error occurred while calling o126.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 11.0 failed 1 times, most recent failure: Lost task 1.0 in stage 11.0 (TID 14) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.sql.execution.joins.UnsafeCartesianRDD.compute(CartesianProductExec.scala:46)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 47 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)

	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)

	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)

	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)

	at org.apache.spark.RangePartitioner$.sketch(Partitioner.scala:320)

	at org.apache.spark.RangePartitioner.<init>(Partitioner.scala:187)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$.prepareShuffleDependency(ShuffleExchangeExec.scala:296)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency$lzycompute(ShuffleExchangeExec.scala:179)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency(ShuffleExchangeExec.scala:173)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture$lzycompute(ShuffleExchangeExec.scala:149)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture(ShuffleExchangeExec.scala:145)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.$anonfun$submitShuffleJob$1(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:246)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:243)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob$(ShuffleExchangeExec.scala:72)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.submitShuffleJob(ShuffleExchangeExec.scala:120)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture$lzycompute(QueryStageExec.scala:187)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture(QueryStageExec.scala:187)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.doMaterialize(QueryStageExec.scala:189)

	at org.apache.spark.sql.execution.adaptive.QueryStageExec.materialize(QueryStageExec.scala:61)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5(AdaptiveSparkPlanExec.scala:286)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5$adapted(AdaptiveSparkPlanExec.scala:284)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)

	at scala.collection.IterableLike.foreach(IterableLike.scala:74)

	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)

	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$1(AdaptiveSparkPlanExec.scala:284)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.getFinalPhysicalPlan(AdaptiveSparkPlanExec.scala:256)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:401)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.sql.execution.joins.UnsafeCartesianRDD.compute(CartesianProductExec.scala:46)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 47 more

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 180, in process_files_for_user_agent
    self._write_output(complete_df, output_path, date_part)
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 200, in _write_output
    .csv(output_file)
     ^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\readwriter.py", line 1864, in csv
    self._jwrite.csv(path)
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1322, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\errors\exceptions\captured.py", line 179, in deco
    return f(*a, **kw)
           ^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling o126.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 11.0 failed 1 times, most recent failure: Lost task 1.0 in stage 11.0 (TID 14) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.sql.execution.joins.UnsafeCartesianRDD.compute(CartesianProductExec.scala:46)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 47 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2463)

	at org.apache.spark.rdd.RDD.$anonfun$collect$1(RDD.scala:1046)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)

	at org.apache.spark.rdd.RDD.withScope(RDD.scala:407)

	at org.apache.spark.rdd.RDD.collect(RDD.scala:1045)

	at org.apache.spark.RangePartitioner$.sketch(Partitioner.scala:320)

	at org.apache.spark.RangePartitioner.<init>(Partitioner.scala:187)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec$.prepareShuffleDependency(ShuffleExchangeExec.scala:296)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency$lzycompute(ShuffleExchangeExec.scala:179)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.shuffleDependency(ShuffleExchangeExec.scala:173)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture$lzycompute(ShuffleExchangeExec.scala:149)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.mapOutputStatisticsFuture(ShuffleExchangeExec.scala:145)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.$anonfun$submitShuffleJob$1(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.SparkPlan.$anonfun$executeQuery$1(SparkPlan.scala:246)

	at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)

	at org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:243)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob(ShuffleExchangeExec.scala:73)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeLike.submitShuffleJob$(ShuffleExchangeExec.scala:72)

	at org.apache.spark.sql.execution.exchange.ShuffleExchangeExec.submitShuffleJob(ShuffleExchangeExec.scala:120)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture$lzycompute(QueryStageExec.scala:187)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.shuffleFuture(QueryStageExec.scala:187)

	at org.apache.spark.sql.execution.adaptive.ShuffleQueryStageExec.doMaterialize(QueryStageExec.scala:189)

	at org.apache.spark.sql.execution.adaptive.QueryStageExec.materialize(QueryStageExec.scala:61)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5(AdaptiveSparkPlanExec.scala:286)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$5$adapted(AdaptiveSparkPlanExec.scala:284)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at scala.collection.AbstractIterator.foreach(Iterator.scala:1431)

	at scala.collection.IterableLike.foreach(IterableLike.scala:74)

	at scala.collection.IterableLike.foreach$(IterableLike.scala:73)

	at scala.collection.AbstractIterable.foreach(Iterable.scala:56)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$getFinalPhysicalPlan$1(AdaptiveSparkPlanExec.scala:284)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.getFinalPhysicalPlan(AdaptiveSparkPlanExec.scala:256)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:401)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.sql.execution.joins.UnsafeCartesianRDD.compute(CartesianProductExec.scala:46)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 47 more


2025-01-20 12:18:46,792 - [ERROR] - Task 1 processing failed.
2025-01-20 12:18:46,983 - [INFO] - Spark Session stopped successfully.
2025-01-20 12:23:36,711 - [INFO] - Starting application...
2025-01-20 12:23:36,711 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:23:36,711 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:24:03,717 - [INFO] - Spark Session created successfully.
2025-01-20 12:24:03,717 - [ERROR] - Error during processing: 'DataProcessor' object has no attribute 'process_files_for_user_agent'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 150, in main
    success = processor.process_files_for_user_agent(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataProcessor' object has no attribute 'process_files_for_user_agent'
2025-01-20 12:24:04,070 - [INFO] - Spark Session stopped successfully.
2025-01-20 12:27:01,335 - [INFO] - Starting application...
2025-01-20 12:27:01,336 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:27:01,336 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:27:34,447 - [INFO] - Spark Session created successfully.
2025-01-20 12:27:34,448 - [ERROR] - Error during processing: 'DataProcessor' object has no attribute 'process_files_for_user_agent'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 150, in main
    success = processor.process_files_for_user_agent(
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'DataProcessor' object has no attribute 'process_files_for_user_agent'
2025-01-20 12:27:34,784 - [INFO] - Spark Session stopped successfully.
2025-01-20 12:37:19,029 - [INFO] - Starting application...
2025-01-20 12:37:19,029 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:37:19,029 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:37:45,762 - [INFO] - Spark Session created successfully
2025-01-20 12:37:50,356 - [ERROR] - Error processing files for date 2022-05-27: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `event_type` cannot be resolved. Did you mean one of the following? [`test_id`, `client_id`, `ext_vars`, `rotator`, `banner`].;
'Pivot ArrayBuffer(hour#80), 'event_type, [impression, click], [count(1)]
+- Project [transaction_header#0, user_identity#1, fraud_detection#2, geo_location#3, device_settings#4, connection#5, banner#6, rotator#7, interaction_id#8L, page_url#9, landing_url#10, publisher_domain#11, banner_click_url_id#12, keywords#13, rtb_vars#14, publisher_data#15, dco_vars#16, banner_vars#17, adx_vars#18, ext_vars#19, test_id#20, raw_request_url#21, server_impression_time_ms#22L, is_p2c_enabled#23, ... 16 more fields]
   +- Filter (device_settings#4.user_agent = some user agent)
      +- Relation [transaction_header#0,user_identity#1,fraud_detection#2,geo_location#3,device_settings#4,connection#5,banner#6,rotator#7,interaction_id#8L,page_url#9,landing_url#10,publisher_domain#11,banner_click_url_id#12,keywords#13,rtb_vars#14,publisher_data#15,dco_vars#16,banner_vars#17,adx_vars#18,ext_vars#19,test_id#20,raw_request_url#21,server_impression_time_ms#22L,is_p2c_enabled#23,... 15 more fields] parquet

2025-01-20 12:37:50,360 - [ERROR] - Error during processing: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `event_type` cannot be resolved. Did you mean one of the following? [`test_id`, `client_id`, `ext_vars`, `rotator`, `banner`].;
'Pivot ArrayBuffer(hour#80), 'event_type, [impression, click], [count(1)]
+- Project [transaction_header#0, user_identity#1, fraud_detection#2, geo_location#3, device_settings#4, connection#5, banner#6, rotator#7, interaction_id#8L, page_url#9, landing_url#10, publisher_domain#11, banner_click_url_id#12, keywords#13, rtb_vars#14, publisher_data#15, dco_vars#16, banner_vars#17, adx_vars#18, ext_vars#19, test_id#20, raw_request_url#21, server_impression_time_ms#22L, is_p2c_enabled#23, ... 16 more fields]
   +- Filter (device_settings#4.user_agent = some user agent)
      +- Relation [transaction_header#0,user_identity#1,fraud_detection#2,geo_location#3,device_settings#4,connection#5,banner#6,rotator#7,interaction_id#8L,page_url#9,landing_url#10,publisher_domain#11,banner_click_url_id#12,keywords#13,rtb_vars#14,publisher_data#15,dco_vars#16,banner_vars#17,adx_vars#18,ext_vars#19,test_id#20,raw_request_url#21,server_impression_time_ms#22L,is_p2c_enabled#23,... 15 more fields] parquet

2025-01-20 12:37:50,360 - [ERROR] - Processing failed
2025-01-20 12:37:50,653 - [INFO] - Spark Session stopped
2025-01-20 12:38:47,330 - [INFO] - Starting application...
2025-01-20 12:38:47,330 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:38:47,330 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:39:14,847 - [INFO] - Spark Session created successfully
2025-01-20 12:39:20,138 - [ERROR] - Error processing files for date 2022-05-27: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `event_type` cannot be resolved. Did you mean one of the following? [`test_id`, `client_id`, `ext_vars`, `rotator`, `banner`].;
'Pivot ArrayBuffer(hour#80), 'event_type, [impression, click], [count(1)]
+- Project [transaction_header#0, user_identity#1, fraud_detection#2, geo_location#3, device_settings#4, connection#5, banner#6, rotator#7, interaction_id#8L, page_url#9, landing_url#10, publisher_domain#11, banner_click_url_id#12, keywords#13, rtb_vars#14, publisher_data#15, dco_vars#16, banner_vars#17, adx_vars#18, ext_vars#19, test_id#20, raw_request_url#21, server_impression_time_ms#22L, is_p2c_enabled#23, ... 16 more fields]
   +- Filter (device_settings#4.user_agent = some user agent)
      +- Relation [transaction_header#0,user_identity#1,fraud_detection#2,geo_location#3,device_settings#4,connection#5,banner#6,rotator#7,interaction_id#8L,page_url#9,landing_url#10,publisher_domain#11,banner_click_url_id#12,keywords#13,rtb_vars#14,publisher_data#15,dco_vars#16,banner_vars#17,adx_vars#18,ext_vars#19,test_id#20,raw_request_url#21,server_impression_time_ms#22L,is_p2c_enabled#23,... 15 more fields] parquet

2025-01-20 12:39:20,142 - [ERROR] - Error during processing: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `event_type` cannot be resolved. Did you mean one of the following? [`test_id`, `client_id`, `ext_vars`, `rotator`, `banner`].;
'Pivot ArrayBuffer(hour#80), 'event_type, [impression, click], [count(1)]
+- Project [transaction_header#0, user_identity#1, fraud_detection#2, geo_location#3, device_settings#4, connection#5, banner#6, rotator#7, interaction_id#8L, page_url#9, landing_url#10, publisher_domain#11, banner_click_url_id#12, keywords#13, rtb_vars#14, publisher_data#15, dco_vars#16, banner_vars#17, adx_vars#18, ext_vars#19, test_id#20, raw_request_url#21, server_impression_time_ms#22L, is_p2c_enabled#23, ... 16 more fields]
   +- Filter (device_settings#4.user_agent = some user agent)
      +- Relation [transaction_header#0,user_identity#1,fraud_detection#2,geo_location#3,device_settings#4,connection#5,banner#6,rotator#7,interaction_id#8L,page_url#9,landing_url#10,publisher_domain#11,banner_click_url_id#12,keywords#13,rtb_vars#14,publisher_data#15,dco_vars#16,banner_vars#17,adx_vars#18,ext_vars#19,test_id#20,raw_request_url#21,server_impression_time_ms#22L,is_p2c_enabled#23,... 15 more fields] parquet

2025-01-20 12:39:20,142 - [ERROR] - Processing failed
2025-01-20 12:39:20,277 - [INFO] - Spark Session stopped
2025-01-20 12:42:25,011 - [INFO] - Starting application...
2025-01-20 12:42:25,011 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:42:25,011 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:42:52,128 - [INFO] - Spark Session created successfully
2025-01-20 12:43:08,499 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 12:43:08,500 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 12:43:08,500 - [ERROR] - Processing failed
2025-01-20 12:43:08,668 - [INFO] - Spark Session stopped
2025-01-20 12:46:28,001 - [INFO] - Starting application...
2025-01-20 12:46:28,001 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:46:28,001 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:46:54,856 - [INFO] - Spark Session created successfully
2025-01-20 12:47:10,992 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 12:47:10,992 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 12:47:10,992 - [ERROR] - Processing failed
2025-01-20 12:47:11,364 - [INFO] - Spark Session stopped
2025-01-20 12:53:01,877 - [INFO] - Starting application...
2025-01-20 12:53:01,877 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:53:01,877 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:53:28,807 - [INFO] - Spark Session created successfully
2025-01-20 12:53:45,112 - [ERROR] - Error processing files for date 2022-05-27: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 12:53:45,113 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 12:53:45,113 - [ERROR] - Processing failed
2025-01-20 12:53:45,295 - [INFO] - Spark Session stopped
2025-01-20 12:55:53,779 - [INFO] - Starting application...
2025-01-20 12:55:53,779 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 12:55:53,779 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 12:56:20,722 - [INFO] - Spark Session created successfully
2025-01-20 12:56:36,634 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 12:56:36,635 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 12:56:36,635 - [ERROR] - Processing failed
2025-01-20 12:56:36,734 - [INFO] - Spark Session stopped
2025-01-20 13:00:29,528 - [INFO] - Starting application...
2025-01-20 13:00:29,528 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 13:00:29,528 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 13:00:56,295 - [INFO] - Spark Session created successfully
2025-01-20 13:01:12,461 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 13:01:12,462 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 13:01:12,462 - [ERROR] - Processing failed
2025-01-20 13:01:12,895 - [INFO] - Spark Session stopped
2025-01-20 13:03:22,047 - [INFO] - Starting application...
2025-01-20 13:03:22,047 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 13:03:22,047 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 13:03:27,642 - [INFO] - Spark Session created successfully
2025-01-20 13:03:43,611 - [ERROR] - Error processing files for date 2022-05-27: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 13:03:43,611 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 13:03:43,611 - [ERROR] - Processing failed
2025-01-20 13:03:44,118 - [INFO] - Spark Session stopped
2025-01-20 13:30:43,607 - [INFO] - Starting application...
2025-01-20 13:30:43,607 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 13:30:43,607 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 13:31:10,308 - [INFO] - Spark Session created successfully
2025-01-20 13:31:26,788 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 13:31:26,789 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 13:31:26,789 - [ERROR] - Processing failed
2025-01-20 13:31:27,168 - [INFO] - Spark Session stopped
2025-01-20 13:51:45,538 - [INFO] - Starting application...
2025-01-20 13:51:45,538 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 13:51:45,538 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 13:52:12,908 - [INFO] - Spark Session created successfully
2025-01-20 13:52:29,781 - [ERROR] - Error processing files for date 2022-05-27: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 13:52:29,783 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 13:52:29,783 - [ERROR] - Processing failed
2025-01-20 13:52:29,986 - [INFO] - Spark Session stopped
2025-01-20 14:13:16,986 - [INFO] - Starting application...
2025-01-20 14:13:16,986 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 14:13:16,986 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 14:13:35,411 - [INFO] - Spark Session created successfully
2025-01-20 14:13:51,768 - [ERROR] - Error processing files for date 2022-05-27: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:13:51,769 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:13:51,769 - [ERROR] - Processing failed
2025-01-20 14:13:51,923 - [INFO] - Spark Session stopped
2025-01-20 14:19:17,578 - [INFO] - Starting application...
2025-01-20 14:19:17,588 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 14:19:17,588 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 14:19:44,325 - [INFO] - Spark Session created successfully
2025-01-20 14:20:00,547 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:20:00,548 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:20:00,548 - [ERROR] - Processing failed
2025-01-20 14:20:00,885 - [INFO] - Spark Session stopped
2025-01-20 14:22:40,497 - [INFO] - Starting application...
2025-01-20 14:22:40,497 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 14:22:40,497 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 14:23:07,224 - [INFO] - Spark Session created successfully
2025-01-20 14:23:23,382 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:23:23,383 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:23:23,383 - [ERROR] - Processing failed
2025-01-20 14:23:23,710 - [INFO] - Spark Session stopped
2025-01-20 14:27:03,413 - [INFO] - Starting application...
2025-01-20 14:27:03,413 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 14:27:03,413 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 14:27:29,995 - [ERROR] - Error during processing: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.
: java.io.FileNotFoundException: File file:/C:/tmp/spark-events does not exist

	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:779)

	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:1100)

	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:769)

	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:462)

	at org.apache.spark.deploy.history.EventLogFileWriter.requireLogBaseDirAsDirectory(EventLogFileWriters.scala:77)

	at org.apache.spark.deploy.history.SingleEventLogFileWriter.start(EventLogFileWriters.scala:221)

	at org.apache.spark.scheduler.EventLoggingListener.start(EventLoggingListener.scala:81)

	at org.apache.spark.SparkContext.<init>(SparkContext.scala:637)

	at org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)

	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)

	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)

	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:238)

	at py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)

	at py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 162, in main
    spark = create_spark_session()
            ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 102, in create_spark_session
    .getOrCreate()
     ^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\session.py", line 497, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 515, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 203, in __init__
    self._do_init(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 296, in _do_init
    self._jsc = jsc or self._initialize_context(self._conf._jconf)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 421, in _initialize_context
    return self._jvm.JavaSparkContext(jconf)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\java_gateway.py", line 1587, in __call__
    return_value = get_return_value(
                   ^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\py4j\protocol.py", line 326, in get_return_value
    raise Py4JJavaError(
py4j.protocol.Py4JJavaError: An error occurred while calling None.org.apache.spark.api.java.JavaSparkContext.
: java.io.FileNotFoundException: File file:/C:/tmp/spark-events does not exist

	at org.apache.hadoop.fs.RawLocalFileSystem.deprecatedGetFileStatus(RawLocalFileSystem.java:779)

	at org.apache.hadoop.fs.RawLocalFileSystem.getFileLinkStatusInternal(RawLocalFileSystem.java:1100)

	at org.apache.hadoop.fs.RawLocalFileSystem.getFileStatus(RawLocalFileSystem.java:769)

	at org.apache.hadoop.fs.FilterFileSystem.getFileStatus(FilterFileSystem.java:462)

	at org.apache.spark.deploy.history.EventLogFileWriter.requireLogBaseDirAsDirectory(EventLogFileWriters.scala:77)

	at org.apache.spark.deploy.history.SingleEventLogFileWriter.start(EventLogFileWriters.scala:221)

	at org.apache.spark.scheduler.EventLoggingListener.start(EventLoggingListener.scala:81)

	at org.apache.spark.SparkContext.<init>(SparkContext.scala:637)

	at org.apache.spark.api.java.JavaSparkContext.<init>(JavaSparkContext.scala:58)

	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)

	at java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)

	at java.base/java.lang.reflect.Constructor.newInstance(Constructor.java:490)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:247)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:238)

	at py4j.commands.ConstructorCommand.invokeConstructor(ConstructorCommand.java:80)

	at py4j.commands.ConstructorCommand.execute(ConstructorCommand.java:69)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 14:30:57,955 - [INFO] - Starting application...
2025-01-20 14:30:57,955 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 14:30:57,955 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 14:31:24,726 - [INFO] - Spark Session created successfully
2025-01-20 14:31:41,222 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:31:41,222 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:31:41,222 - [ERROR] - Processing failed
2025-01-20 14:31:41,716 - [INFO] - Spark Session stopped
2025-01-20 14:34:31,050 - [INFO] - Starting application...
2025-01-20 14:34:31,050 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 14:34:31,050 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 14:35:30,761 - [INFO] - Spark Session created successfully
2025-01-20 14:35:53,890 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:35:53,891 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:35:53,891 - [ERROR] - Processing failed
2025-01-20 14:35:54,309 - [INFO] - Spark Session stopped
2025-01-20 14:58:32,615 - [INFO] - Starting application...
2025-01-20 14:58:32,615 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 14:58:32,615 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 14:59:00,570 - [INFO] - Spark Session created successfully
2025-01-20 14:59:17,909 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:59:17,910 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 14:59:17,910 - [ERROR] - Processing failed
2025-01-20 14:59:18,392 - [INFO] - Spark Session stopped
2025-01-20 15:17:33,710 - [INFO] - Starting application...
2025-01-20 15:17:33,710 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 15:17:33,710 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 15:18:02,602 - [INFO] - Spark Session created successfully
2025-01-20 15:18:20,775 - [ERROR] - Error processing files for date 2022-05-27: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 15:18:20,795 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 15:18:20,795 - [ERROR] - Processing failed
2025-01-20 15:18:20,946 - [INFO] - Spark Session stopped
2025-01-20 15:55:07,485 - [INFO] - Starting application...
2025-01-20 15:55:07,485 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 15:55:07,485 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 15:55:13,218 - [INFO] - Spark Session created successfully
2025-01-20 15:55:29,291 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 15:55:29,292 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 1.0 failed 1 times, most recent failure: Lost task 0.0 in stage 1.0 (TID 1) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: org.apache.spark.SparkException: Python worker failed to connect back.

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)

	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)

	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)

	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)

	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:364)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:328)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more

Caused by: java.net.SocketTimeoutException: Accept timed out

	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)

	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)

	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:474)

	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:565)

	at java.base/java.net.ServerSocket.accept(ServerSocket.java:533)

	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)

	... 17 more


2025-01-20 15:55:29,292 - [ERROR] - Processing failed
2025-01-20 15:55:29,810 - [INFO] - Spark Session stopped
2025-01-20 16:00:45,655 - [INFO] - Starting application...
2025-01-20 16:00:45,655 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:00:45,655 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:01:12,279 - [INFO] - Spark Session created successfully
2025-01-20 16:01:25,999 - [INFO] - Successfully wrote output for date 2022-05-26
2025-01-20 16:01:25,999 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-20 16:01:26,000 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-20 16:01:26,000 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-20 16:01:37,765 - [INFO] - Successfully wrote output for date 2022-05-27
2025-01-20 16:01:37,766 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-20 16:01:37,766 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-20 16:01:37,767 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-20 16:01:37,767 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-20 16:01:37,767 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-20 16:01:37,768 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-20 16:01:37,768 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-20 16:01:37,768 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-20 16:01:37,768 - [INFO] - Processing completed successfully
2025-01-20 16:01:38,633 - [INFO] - Spark Session stopped
2025-01-20 16:23:49,399 - [INFO] - Starting application...
2025-01-20 16:23:49,399 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:23:49,399 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:24:16,189 - [INFO] - Spark Session created successfully
2025-01-20 16:24:16,189 - [WARNING] - No parquet files found in input directory
2025-01-20 16:24:16,189 - [ERROR] - Processing failed
2025-01-20 16:24:16,522 - [INFO] - Spark Session stopped
2025-01-20 16:29:21,015 - [INFO] - Starting application...
2025-01-20 16:29:21,015 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:29:21,015 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:29:47,779 - [INFO] - Spark Session created successfully
2025-01-20 16:30:02,133 - [ERROR] - Error writing output for date 2022-05-26: An error occurred while calling o143.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:402)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:30:02,135 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling o143.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:402)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:30:02,135 - [ERROR] - Error during processing: An error occurred while calling o143.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:402)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:374)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:30:02,135 - [ERROR] - Processing failed
2025-01-20 16:30:02,375 - [INFO] - Spark Session stopped
2025-01-20 16:30:26,855 - [INFO] - Starting application...
2025-01-20 16:30:26,855 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:30:26,855 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:30:53,431 - [INFO] - Spark Session created successfully
2025-01-20 16:31:13,551 - [ERROR] - Error writing output for date 2022-05-27: An error occurred while calling o213.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:31:13,552 - [ERROR] - Error processing files for date 2022-05-27: An error occurred while calling o213.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:31:13,553 - [ERROR] - Error during processing: An error occurred while calling o213.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:31:13,553 - [ERROR] - Processing failed
2025-01-20 16:31:13,713 - [INFO] - Spark Session stopped
2025-01-20 16:32:15,927 - [INFO] - Starting application...
2025-01-20 16:32:15,927 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:32:15,927 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:32:42,901 - [INFO] - Spark Session created successfully
2025-01-20 16:33:03,554 - [ERROR] - Error writing output for date 2022-05-27: An error occurred while calling o213.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:33:03,555 - [ERROR] - Error processing files for date 2022-05-27: An error occurred while calling o213.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:33:03,556 - [ERROR] - Error during processing: An error occurred while calling o213.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:33:03,556 - [ERROR] - Processing failed
2025-01-20 16:33:04,661 - [INFO] - Spark Session stopped
2025-01-20 16:36:01,656 - [INFO] - Starting application...
2025-01-20 16:36:01,656 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:36:01,656 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:36:28,565 - [INFO] - Spark Session created successfully
2025-01-20 16:36:42,838 - [ERROR] - Error writing output for date 2022-05-26: An error occurred while calling o141.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:36:42,839 - [ERROR] - Error processing files for date 2022-05-26: An error occurred while calling o141.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:36:42,839 - [ERROR] - Error during processing: An error occurred while calling o141.csv.
: java.lang.UnsatisfiedLinkError: 'boolean org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(java.lang.String, int)'

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access0(Native Method)

	at org.apache.hadoop.io.nativeio.NativeIO$Windows.access(NativeIO.java:793)

	at org.apache.hadoop.fs.FileUtil.canRead(FileUtil.java:1249)

	at org.apache.hadoop.fs.FileUtil.list(FileUtil.java:1454)

	at org.apache.hadoop.fs.RawLocalFileSystem.listStatus(RawLocalFileSystem.java:601)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.fs.ChecksumFileSystem.listStatus(ChecksumFileSystem.java:761)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:1972)

	at org.apache.hadoop.fs.FileSystem.listStatus(FileSystem.java:2014)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.getAllCommittedTaskPaths(FileOutputCommitter.java:334)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJobInternal(FileOutputCommitter.java:404)

	at org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.commitJob(FileOutputCommitter.java:377)

	at org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.commitJob(HadoopMapReduceCommitProtocol.scala:192)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$writeAndCommit$3(FileFormatWriter.scala:275)

	at scala.runtime.java8.JFunction0$mcV$sp.apply(JFunction0$mcV$sp.java:23)

	at org.apache.spark.util.Utils$.timeTakenMs(Utils.scala:552)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:275)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:859)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:388)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:361)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:240)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:850)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)


2025-01-20 16:36:42,840 - [ERROR] - Processing failed
2025-01-20 16:36:43,861 - [INFO] - Spark Session stopped
2025-01-20 16:38:42,429 - [INFO] - Starting application...
2025-01-20 16:38:42,429 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:38:42,429 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:39:09,121 - [INFO] - Spark Session created successfully
2025-01-20 16:39:28,717 - [INFO] - Successfully wrote output for date 2022-05-27
2025-01-20 16:39:28,717 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-20 16:39:28,718 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-20 16:39:28,718 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-20 16:39:28,719 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-20 16:39:28,719 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-20 16:39:28,720 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-20 16:39:28,720 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-20 16:39:28,720 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-20 16:39:34,456 - [INFO] - Successfully wrote output for date 2022-05-26
2025-01-20 16:39:34,456 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-20 16:39:34,457 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-20 16:39:34,457 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-20 16:39:34,457 - [INFO] - Processing completed successfully
2025-01-20 16:39:35,327 - [INFO] - Spark Session stopped
2025-01-20 16:42:04,978 - [INFO] - Starting application...
2025-01-20 16:42:04,979 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:42:04,979 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:42:32,038 - [INFO] - Spark Session created successfully
2025-01-20 16:42:32,038 - [WARNING] - No parquet files found in input directory
2025-01-20 16:42:32,038 - [ERROR] - Processing failed
2025-01-20 16:42:32,362 - [INFO] - Spark Session stopped
2025-01-20 16:43:25,356 - [INFO] - Starting application...
2025-01-20 16:43:25,356 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:43:25,356 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:43:31,230 - [INFO] - Spark Session created successfully
2025-01-20 16:43:45,085 - [INFO] - Successfully wrote output for date 2022-05-26
2025-01-20 16:43:45,085 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-20 16:43:45,086 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-20 16:43:45,086 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-20 16:43:56,354 - [INFO] - Successfully wrote output for date 2022-05-27
2025-01-20 16:43:56,355 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-20 16:43:56,355 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-20 16:43:56,355 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-20 16:43:56,356 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-20 16:43:56,356 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-20 16:43:56,356 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-20 16:43:56,356 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-20 16:43:56,356 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-20 16:43:56,356 - [INFO] - Processing completed successfully
2025-01-20 16:43:57,220 - [INFO] - Spark Session stopped
2025-01-20 16:50:30,810 - [INFO] - Starting application...
2025-01-20 16:50:30,810 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 16:50:30,810 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 16:50:57,604 - [INFO] - Spark Session created successfully
2025-01-20 16:51:11,334 - [INFO] - Successfully wrote output for date 2022-05-26
2025-01-20 16:51:11,334 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-20 16:51:11,335 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-20 16:51:11,335 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-20 16:51:22,677 - [INFO] - Successfully wrote output for date 2022-05-27
2025-01-20 16:51:22,677 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-20 16:51:22,678 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-20 16:51:22,678 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-20 16:51:22,679 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-20 16:51:22,679 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-20 16:51:22,679 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-20 16:51:22,680 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-20 16:51:22,680 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-20 16:51:22,681 - [INFO] - Processing completed successfully
2025-01-20 16:51:23,547 - [INFO] - Spark Session stopped
2025-01-20 17:04:08,766 - [INFO] - Starting application...
2025-01-20 17:04:08,766 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 17:04:08,766 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 17:04:16,023 - [INFO] - Spark Session created successfully
2025-01-20 17:04:31,940 - [ERROR] - Error processing files for date ('2022-05-27', 12): [UNSUPPORTED_FEATURE.LITERAL_TYPE] The feature is not supported: Literal for '[2022-05-27, 12]' of class java.util.ArrayList.
2025-01-20 17:04:31,943 - [ERROR] - Error during processing: [UNSUPPORTED_FEATURE.LITERAL_TYPE] The feature is not supported: Literal for '[2022-05-27, 12]' of class java.util.ArrayList.
2025-01-20 17:04:31,943 - [ERROR] - Processing failed
2025-01-20 17:04:32,655 - [INFO] - Spark Session stopped
2025-01-20 17:07:35,733 - [INFO] - Starting application...
2025-01-20 17:07:35,734 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 17:07:35,734 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 17:08:02,463 - [INFO] - Spark Session created successfully
2025-01-20 17:08:22,748 - [INFO] - Successfully wrote output for date 2022-05-27 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-20 17:08:22,748 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-20 17:08:22,749 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-20 17:08:22,749 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-20 17:08:22,750 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-20 17:08:22,750 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-20 17:08:22,752 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-20 17:08:22,752 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-20 17:08:22,753 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-20 17:08:28,611 - [INFO] - Successfully wrote output for date 2022-05-26 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-20 17:08:28,611 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-20 17:08:28,612 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-20 17:08:28,612 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-20 17:08:28,612 - [INFO] - Processing completed successfully
2025-01-20 17:08:29,456 - [INFO] - Spark Session stopped
2025-01-20 17:26:59,734 - [INFO] - Starting application...
2025-01-20 17:26:59,734 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 17:26:59,735 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 17:27:07,649 - [INFO] - Spark Session created successfully
2025-01-20 17:27:15,738 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-20 17:27:16,301 - [INFO] - Found 0 impressions for user agent: your user agent string
2025-01-20 17:27:25,155 - [INFO] - Total impressions: 0, Total clicks: 0 for date 2022-05-26
2025-01-20 17:27:25,670 - [INFO] - Successfully wrote output for date 2022-05-26 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-20 17:27:25,671 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-20 17:27:25,671 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-20 17:27:25,672 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-20 17:27:26,082 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-20 17:27:26,294 - [INFO] - Found 0 impressions for user agent: your user agent string
2025-01-20 17:27:28,945 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-20 17:27:29,179 - [INFO] - Found 0 clicks for user agent: your user agent string
2025-01-20 17:27:39,120 - [INFO] - Total impressions: 0, Total clicks: 0 for date 2022-05-27
2025-01-20 17:27:39,254 - [INFO] - Successfully wrote output for date 2022-05-27 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-20 17:27:39,254 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-20 17:27:39,255 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-20 17:27:39,256 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-20 17:27:39,256 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-20 17:27:39,257 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-20 17:27:39,257 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-20 17:27:39,258 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-20 17:27:39,258 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-20 17:27:39,258 - [INFO] - Processing completed successfully
2025-01-20 17:27:39,885 - [INFO] - Spark Session stopped
2025-01-20 17:32:38,419 - [INFO] - Starting application...
2025-01-20 17:32:38,419 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 17:32:38,420 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 17:33:06,033 - [INFO] - Spark Session created successfully
2025-01-20 17:33:13,743 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-20 17:33:14,332 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-20 17:33:16,784 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-20 17:33:16,786 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:984)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2398)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2419)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2438)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:829)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-20 17:33:16,786 - [ERROR] - Processing failed
2025-01-20 17:33:17,334 - [INFO] - Spark Session stopped
2025-01-20 17:34:41,295 - [INFO] - Starting application...
2025-01-20 17:34:41,295 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-20 17:34:41,295 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-20 17:35:08,904 - [INFO] - Spark Session created successfully
2025-01-20 17:35:08,904 - [INFO] - Filtering for user agent: some user agent
2025-01-20 17:35:16,647 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-20 17:35:17,296 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-20 17:35:19,430 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-20 17:35:20,195 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-20 17:35:20,554 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-20 17:35:25,837 - [INFO] - Successfully wrote output for date 2022-05-26 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-20 17:35:26,234 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-20 17:35:26,480 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-20 17:35:28,123 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-20 17:35:28,548 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-20 17:35:28,836 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-20 17:35:29,187 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-20 17:35:29,567 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-20 17:35:31,308 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-20 17:35:31,756 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-20 17:35:32,185 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-20 17:35:37,673 - [INFO] - Successfully wrote output for date 2022-05-27 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-20 17:35:37,673 - [INFO] - Processing completed successfully
2025-01-20 17:35:38,836 - [INFO] - Spark Session stopped
2025-01-21 09:03:39,252 - [INFO] - Starting application...
2025-01-21 09:03:39,252 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 09:03:39,252 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 09:04:06,930 - [INFO] - Spark Session created successfully
2025-01-21 09:04:06,930 - [INFO] - Filtering for user agent: some user agent
2025-01-21 09:04:13,340 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:04:13,880 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 09:04:15,953 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:04:16,694 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:04:17,002 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:04:21,197 - [INFO] - Successfully wrote output for date 2022-05-26 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-21 09:04:21,505 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:04:21,681 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 09:04:22,954 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 09:04:23,287 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 09:04:23,472 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 09:04:23,722 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 09:04:23,915 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 09:04:25,300 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 09:04:25,657 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 09:04:25,884 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 09:04:29,608 - [INFO] - Successfully wrote output for date 2022-05-27 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-21 09:04:29,608 - [INFO] - Processing completed successfully
2025-01-21 09:04:30,041 - [INFO] - Spark Session stopped
2025-01-21 09:08:46,273 - [INFO] - Starting application...
2025-01-21 09:08:46,273 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 09:08:46,273 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 09:09:12,407 - [INFO] - Spark Session created successfully
2025-01-21 09:09:12,407 - [INFO] - Filtering for user agent: some user agent
2025-01-21 09:09:18,005 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:09:18,504 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 09:09:20,283 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:09:20,840 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:09:21,143 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:09:24,931 - [INFO] - Successfully wrote output for date 2022-05-26 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-21 09:09:25,212 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:09:25,374 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 09:09:26,691 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 09:09:27,074 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 09:09:27,251 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 09:09:27,512 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 09:09:27,706 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 09:09:29,052 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 09:09:29,352 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 09:09:29,669 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 09:09:32,982 - [INFO] - Successfully wrote output for date 2022-05-27 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-21 09:09:32,982 - [INFO] - Processing completed successfully
2025-01-21 09:09:33,391 - [INFO] - Spark Session stopped
2025-01-21 09:11:14,780 - [INFO] - Starting application...
2025-01-21 09:11:14,780 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 09:11:14,780 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 09:11:41,089 - [INFO] - Spark Session created successfully
2025-01-21 09:11:41,090 - [INFO] - Filtering for user agent: some user agent
2025-01-21 09:11:47,048 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:11:47,557 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 09:11:49,427 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 09:11:49,956 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 09:11:50,207 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 09:11:50,526 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 09:11:50,803 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 09:11:52,346 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 09:11:52,665 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 09:11:52,908 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 09:11:57,591 - [INFO] - Successfully wrote output for date 2022-05-27 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-21 09:11:57,873 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:11:58,084 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 09:11:59,224 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:11:59,491 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:11:59,647 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:12:01,881 - [INFO] - Successfully wrote output for date 2022-05-26 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-21 09:12:01,881 - [INFO] - Processing completed successfully
2025-01-21 09:12:02,503 - [INFO] - Spark Session stopped
2025-01-21 09:17:56,458 - [INFO] - Starting application...
2025-01-21 09:17:56,460 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 09:17:56,460 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 09:18:22,630 - [INFO] - Spark Session created successfully
2025-01-21 09:18:22,630 - [INFO] - Filtering for user agent: some user agent
2025-01-21 09:18:28,172 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:18:28,666 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 09:18:30,475 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:18:31,091 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:18:31,365 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:18:31,365 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 09:18:31,365 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:18:31,367 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 09:18:34,920 - [ERROR] - Error writing output for date 2022-05-26: An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 19.0 failed 1 times, most recent failure: Lost task 0.0 in stage 19.0 (TID 17) (host.docker.internal executor driver): org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

Caused by: org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


2025-01-21 09:18:34,920 - [ERROR] - Error processing files for date '2022-05-26': An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 19.0 failed 1 times, most recent failure: Lost task 0.0 in stage 19.0 (TID 17) (host.docker.internal executor driver): org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

Caused by: org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


2025-01-21 09:18:34,923 - [ERROR] - Error during processing: An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 19.0 failed 1 times, most recent failure: Lost task 0.0 in stage 19.0 (TID 17) (host.docker.internal executor driver): org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

Caused by: org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


2025-01-21 09:18:34,923 - [ERROR] - Processing failed
2025-01-21 09:18:35,250 - [INFO] - Spark Session stopped
2025-01-21 09:23:56,730 - [INFO] - Starting application...
2025-01-21 09:23:56,730 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 09:23:56,730 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 09:24:14,188 - [INFO] - Spark Session created successfully
2025-01-21 09:24:14,188 - [INFO] - Filtering for user agent: some user agent
2025-01-21 09:24:20,538 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:24:21,025 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 09:24:22,967 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:24:23,644 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:24:24,475 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:24:24,476 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 09:24:24,476 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:24:24,477 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 09:24:28,777 - [ERROR] - Error writing output for date 2022-05-26: An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 19.0 failed 1 times, most recent failure: Lost task 0.0 in stage 19.0 (TID 17) (host.docker.internal executor driver): org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

Caused by: org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


2025-01-21 09:24:28,777 - [ERROR] - Error processing files for date '2022-05-26': An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 19.0 failed 1 times, most recent failure: Lost task 0.0 in stage 19.0 (TID 17) (host.docker.internal executor driver): org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

Caused by: org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


2025-01-21 09:24:28,778 - [ERROR] - Error during processing: An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 19.0 failed 1 times, most recent failure: Lost task 0.0 in stage 19.0 (TID 17) (host.docker.internal executor driver): org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

Caused by: org.apache.spark.SparkFileNotFoundException: File file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.

	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:781)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:222)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:282)

	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:131)

	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)

	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)

	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)

	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)

	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)

	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)

	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)

	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


2025-01-21 09:24:28,778 - [ERROR] - Processing failed
2025-01-21 09:24:29,052 - [INFO] - Spark Session stopped
2025-01-21 09:28:10,741 - [INFO] - Starting application...
2025-01-21 09:28:10,741 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 09:28:10,741 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 09:28:16,338 - [INFO] - Spark Session created successfully
2025-01-21 09:28:16,338 - [INFO] - Filtering for user agent: some user agent
2025-01-21 09:28:23,268 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:28:24,595 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 09:28:26,803 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 09:28:26,804 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 09:28:26,804 - [ERROR] - Processing failed
2025-01-21 09:28:27,170 - [INFO] - Spark Session stopped
2025-01-21 09:28:54,501 - [INFO] - Starting application...
2025-01-21 09:28:54,501 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 09:28:54,501 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 09:29:20,840 - [INFO] - Spark Session created successfully
2025-01-21 09:29:20,840 - [INFO] - Filtering for user agent: some user agent
2025-01-21 09:29:26,431 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:29:26,990 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 09:29:29,635 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:29:30,188 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:29:30,467 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 09:29:34,475 - [INFO] - Successfully wrote output for date 2022-05-26 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-21 09:29:34,477 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 09:29:34,478 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 09:29:34,478 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 09:29:34,785 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 09:29:34,975 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 09:29:36,205 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 09:29:36,535 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 09:29:36,713 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 09:29:37,001 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 09:29:37,153 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 09:29:38,658 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 09:29:38,937 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 09:29:39,214 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 09:29:42,602 - [INFO] - Successfully wrote output for date 2022-05-27 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-21 09:29:42,602 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-21 09:29:42,603 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 09:29:42,603 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-21 09:29:42,604 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-21 09:29:42,604 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 09:29:42,605 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-21 09:29:42,606 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-21 09:29:42,606 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-21 09:29:42,606 - [INFO] - Processing completed successfully
2025-01-21 09:29:42,970 - [INFO] - Spark Session stopped
2025-01-21 10:19:27,559 - [INFO] - Starting application...
2025-01-21 10:19:27,560 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 10:19:27,560 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 10:19:40,986 - [INFO] - Spark Session created successfully
2025-01-21 10:19:40,986 - [INFO] - Spark version: 3.5.4
2025-01-21 10:19:40,987 - [INFO] - Spark master: local[*]
2025-01-21 10:19:40,987 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 10:19:40,987 - [INFO] - Filtering for user agent: some user agent
2025-01-21 10:19:46,305 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 10:19:46,819 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 10:19:48,722 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 10:19:49,348 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 10:19:49,630 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 10:19:53,555 - [INFO] - Successfully wrote output for date 2022-05-26 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-21 10:19:53,555 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 10:19:53,556 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 10:19:53,557 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 10:19:53,928 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 10:19:54,126 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 10:19:55,322 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 10:19:55,669 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 10:19:55,897 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 10:19:56,181 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 10:19:56,425 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 10:19:57,828 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 10:19:58,151 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 10:19:58,436 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 10:20:02,365 - [INFO] - Successfully wrote output for date 2022-05-27 to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-21 10:20:02,365 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-21 10:20:02,367 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 10:20:02,367 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-21 10:20:02,368 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-21 10:20:02,369 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 10:20:02,369 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-21 10:20:02,370 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-21 10:20:02,371 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-21 10:20:02,371 - [INFO] - Processing completed successfully
2025-01-21 10:20:02,824 - [INFO] - Spark Session stopped
2025-01-21 12:44:25,066 - [INFO] - Starting application...
2025-01-21 12:44:25,066 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 12:44:25,066 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 12:44:30,061 - [INFO] - Spark Session created successfully
2025-01-21 12:44:30,061 - [INFO] - Spark version: 3.5.4
2025-01-21 12:44:30,061 - [INFO] - Spark master: local[*]
2025-01-21 12:44:30,061 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:44:30,061 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:44:30,062 - [INFO] - Spark master: local[*]
2025-01-21 12:44:30,062 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:44:30,062 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:44:36,380 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 12:44:36,861 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 12:44:38,743 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 12:44:39,342 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10)]
2025-01-21 12:44:39,597 - [INFO] - Final hour distribution: [Row(hour=19, count=10)]
2025-01-21 12:44:43,592 - [ERROR] - Error writing output for date 2022-05-26 19:32: An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 22.0 failed 1 times, most recent failure: Lost task 0.0 in stage 22.0 (TID 20) (host.docker.internal executor driver): java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211244435836006096783739024_0022_m_000000_20 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:420)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211244435836006096783739024_0022_m_000000_20 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more


2025-01-21 12:44:43,592 - [ERROR] - Error processing files for date '2022-05-26 19:32': An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 22.0 failed 1 times, most recent failure: Lost task 0.0 in stage 22.0 (TID 20) (host.docker.internal executor driver): java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211244435836006096783739024_0022_m_000000_20 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:420)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211244435836006096783739024_0022_m_000000_20 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more


2025-01-21 12:44:43,593 - [ERROR] - Error during processing: An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 22.0 failed 1 times, most recent failure: Lost task 0.0 in stage 22.0 (TID 20) (host.docker.internal executor driver): java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211244435836006096783739024_0022_m_000000_20 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:420)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211244435836006096783739024_0022_m_000000_20 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more


2025-01-21 12:44:43,593 - [ERROR] - Processing failed
2025-01-21 12:44:44,495 - [INFO] - Spark Session stopped
2025-01-21 12:45:32,460 - [INFO] - Starting application...
2025-01-21 12:45:32,460 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 12:45:32,460 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 12:45:58,274 - [INFO] - Spark Session created successfully
2025-01-21 12:45:58,275 - [INFO] - Spark version: 3.5.4
2025-01-21 12:45:58,275 - [INFO] - Spark master: local[*]
2025-01-21 12:45:58,275 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:45:58,275 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:45:58,275 - [INFO] - Spark master: local[*]
2025-01-21 12:45:58,275 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:45:58,275 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:46:03,297 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 12:46:03,736 - [INFO] - Found 10 clicks for user agent: some user agent
2025-01-21 12:46:05,329 - [ERROR] - Error processing files for date '2022-05-27 11:31': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 12:46:05,330 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 12:46:05,330 - [ERROR] - Processing failed
2025-01-21 12:46:05,724 - [INFO] - Spark Session stopped
2025-01-21 12:48:57,361 - [INFO] - Starting application...
2025-01-21 12:48:57,361 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 12:48:57,361 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 12:49:23,576 - [INFO] - Spark Session created successfully
2025-01-21 12:49:23,576 - [INFO] - Spark version: 3.5.4
2025-01-21 12:49:23,576 - [INFO] - Spark master: local[*]
2025-01-21 12:49:23,576 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:49:23,576 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:49:23,576 - [INFO] - Spark master: local[*]
2025-01-21 12:49:23,576 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:49:23,576 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:49:29,612 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 12:49:30,030 - [INFO] - Found 10 clicks for user agent: some user agent
2025-01-21 12:49:31,637 - [ERROR] - Error processing files for date '2022-05-27 11:31': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 12:49:31,638 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 12:49:31,638 - [ERROR] - Processing failed
2025-01-21 12:49:32,039 - [INFO] - Spark Session stopped
2025-01-21 12:52:57,363 - [INFO] - Starting application...
2025-01-21 12:52:57,363 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 12:52:57,363 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 12:53:23,921 - [INFO] - Spark Session created successfully
2025-01-21 12:53:23,922 - [INFO] - Spark version: 3.5.4
2025-01-21 12:53:23,922 - [INFO] - Spark master: local[*]
2025-01-21 12:53:23,922 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:53:23,922 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:53:23,922 - [INFO] - Spark master: local[*]
2025-01-21 12:53:23,922 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:53:23,922 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:53:28,942 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 12:53:29,381 - [INFO] - Found 10 clicks for user agent: some user agent
2025-01-21 12:53:31,039 - [ERROR] - Error processing files for date '2022-05-27 11:31': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 12:53:31,040 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 12:53:31,040 - [ERROR] - Processing failed
2025-01-21 12:53:31,331 - [INFO] - Spark Session stopped
2025-01-21 12:55:27,477 - [INFO] - Starting application...
2025-01-21 12:55:27,477 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 12:55:27,477 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 12:55:53,570 - [INFO] - Spark Session created successfully
2025-01-21 12:55:53,571 - [INFO] - Spark version: 3.5.4
2025-01-21 12:55:53,571 - [INFO] - Spark master: local[*]
2025-01-21 12:55:53,571 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:55:53,571 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:55:53,571 - [INFO] - Spark master: local[*]
2025-01-21 12:55:53,571 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 12:55:53,571 - [INFO] - Filtering for user agent: some user agent
2025-01-21 12:55:58,598 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 12:55:59,035 - [INFO] - Found 10 clicks for user agent: some user agent
2025-01-21 12:56:00,654 - [ERROR] - Error processing files for date '2022-05-27 12:01': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 12:56:00,656 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 12:56:00,656 - [ERROR] - Processing failed
2025-01-21 12:56:01,022 - [INFO] - Spark Session stopped
2025-01-21 13:06:50,257 - [INFO] - Starting application...
2025-01-21 13:06:50,258 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:06:50,258 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:07:16,221 - [INFO] - Spark Session created successfully
2025-01-21 13:07:16,221 - [INFO] - Spark version: 3.5.4
2025-01-21 13:07:16,221 - [INFO] - Spark master: local[*]
2025-01-21 13:07:16,221 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:07:16,221 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:07:16,221 - [INFO] - Spark master: local[*]
2025-01-21 13:07:16,222 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:07:16,222 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:07:21,319 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 13:07:21,761 - [INFO] - Found 4 impressions for user agent: some user agent
2025-01-21 13:07:23,509 - [ERROR] - Error processing files for date '2022-05-26 11:32': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 5) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:07:23,510 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 5) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:07:23,510 - [ERROR] - Processing failed
2025-01-21 13:07:23,668 - [INFO] - Spark Session stopped
2025-01-21 13:08:09,064 - [INFO] - Starting application...
2025-01-21 13:08:09,064 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:08:09,064 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:08:34,950 - [INFO] - Spark Session created successfully
2025-01-21 13:08:34,951 - [INFO] - Spark version: 3.5.4
2025-01-21 13:08:34,951 - [INFO] - Spark master: local[*]
2025-01-21 13:08:34,951 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:08:34,951 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:08:34,951 - [INFO] - Spark master: local[*]
2025-01-21 13:08:34,951 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:08:34,951 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:08:40,109 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 13:08:40,568 - [INFO] - Found 10 clicks for user agent: some user agent
2025-01-21 13:08:42,292 - [ERROR] - Error processing files for date '2022-05-27 12:01': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.flush(BufferedOutputStream.java:142)

	at java.base/java.io.DataOutputStream.flush(DataOutputStream.java:123)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:454)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.flush(BufferedOutputStream.java:142)

	at java.base/java.io.DataOutputStream.flush(DataOutputStream.java:123)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:454)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:08:42,293 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.flush(BufferedOutputStream.java:142)

	at java.base/java.io.DataOutputStream.flush(DataOutputStream.java:123)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:454)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.flush(BufferedOutputStream.java:142)

	at java.base/java.io.DataOutputStream.flush(DataOutputStream.java:123)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:454)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:08:42,293 - [ERROR] - Processing failed
2025-01-21 13:08:42,398 - [INFO] - Spark Session stopped
2025-01-21 13:09:24,950 - [INFO] - Starting application...
2025-01-21 13:09:24,951 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:09:24,951 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:09:47,887 - [INFO] - Spark Session created successfully
2025-01-21 13:09:47,888 - [INFO] - Spark version: 3.5.4
2025-01-21 13:09:47,888 - [INFO] - Spark master: local[*]
2025-01-21 13:09:47,888 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:09:47,888 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:09:47,888 - [INFO] - Spark master: local[*]
2025-01-21 13:09:47,888 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:09:47,889 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:10:01,123 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 13:10:02,592 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 13:10:07,500 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 13:10:09,378 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 13:10:10,304 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 13:10:10,990 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 13:10:11,339 - [INFO] - Found 10 clicks for user agent: some user agent
2025-01-21 13:10:14,922 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-21 13:10:15,799 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 13:10:16,437 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 13:10:27,080 - [ERROR] - Error writing output for date 2022-05-27 12:31: [WinError 267] The directory name is invalid: 'C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\\temp_2022-05-27 12:31_131027'
2025-01-21 13:10:27,081 - [ERROR] - Stack trace: Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\data_processing.py", line 272, in _write_output
    os.makedirs(temp_dir, exist_ok=True)
  File "<frozen os>", line 225, in makedirs
NotADirectoryError: [WinError 267] The directory name is invalid: 'C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\\temp_2022-05-27 12:31_131027'

2025-01-21 13:10:27,081 - [ERROR] - Error processing files for date '2022-05-27 12:31': [WinError 267] The directory name is invalid: 'C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\\temp_2022-05-27 12:31_131027'
2025-01-21 13:10:27,081 - [ERROR] - Error during processing: [WinError 267] The directory name is invalid: 'C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\\temp_2022-05-27 12:31_131027'
2025-01-21 13:10:27,082 - [ERROR] - Processing failed
2025-01-21 13:10:27,942 - [INFO] - Spark Session stopped
2025-01-21 13:13:30,063 - [INFO] - Starting application...
2025-01-21 13:13:30,064 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:13:30,064 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:13:55,948 - [INFO] - Spark Session created successfully
2025-01-21 13:13:55,948 - [INFO] - Spark version: 3.5.4
2025-01-21 13:13:55,948 - [INFO] - Spark master: local[*]
2025-01-21 13:13:55,949 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:13:55,949 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:13:55,949 - [INFO] - Spark master: local[*]
2025-01-21 13:13:55,949 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:13:55,949 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:14:00,923 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 13:14:01,437 - [INFO] - Found 10 clicks for user agent: some user agent
2025-01-21 13:14:03,043 - [ERROR] - Error processing files for date '2022-05-27 11:31': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:14:03,044 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:14:03,044 - [ERROR] - Processing failed
2025-01-21 13:14:03,412 - [INFO] - Spark Session stopped
2025-01-21 13:19:25,249 - [INFO] - Starting application...
2025-01-21 13:19:25,249 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:19:25,249 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:19:51,503 - [INFO] - Spark Session created successfully
2025-01-21 13:19:51,504 - [INFO] - Spark version: 3.5.4
2025-01-21 13:19:51,504 - [INFO] - Spark master: local[*]
2025-01-21 13:19:51,504 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:19:51,504 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:19:51,504 - [INFO] - Spark master: local[*]
2025-01-21 13:19:51,504 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:19:51,504 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:19:56,477 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 13:19:56,903 - [INFO] - Found 4 impressions for user agent: some user agent
2025-01-21 13:19:58,581 - [ERROR] - Error processing files for date '2022-05-26 11:32': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 5) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:19:58,582 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 5) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:19:58,582 - [ERROR] - Processing failed
2025-01-21 13:19:58,995 - [INFO] - Spark Session stopped
2025-01-21 13:22:37,323 - [INFO] - Starting application...
2025-01-21 13:22:37,324 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:22:37,324 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:23:03,724 - [INFO] - Spark Session created successfully
2025-01-21 13:23:03,725 - [INFO] - Spark version: 3.5.4
2025-01-21 13:23:03,725 - [INFO] - Spark master: local[*]
2025-01-21 13:23:03,725 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:23:03,725 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:23:03,725 - [INFO] - Spark master: local[*]
2025-01-21 13:23:03,725 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:23:03,725 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:23:09,008 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 13:23:09,442 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 13:23:11,150 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 13:23:11,699 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10)]
2025-01-21 13:23:11,922 - [INFO] - Final hour distribution: [Row(hour=19, count=10)]
2025-01-21 13:23:15,648 - [ERROR] - Error writing output for date 2022-05-26 19:32: An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 3 in stage 24.0 failed 1 times, most recent failure: Lost task 3.0 in stage 24.0 (TID 25) (host.docker.internal executor driver): java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211323152800286551285545705_0024_m_000003_25 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:420)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211323152800286551285545705_0024_m_000003_25 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more


2025-01-21 13:23:15,649 - [ERROR] - Error processing files for date '2022-05-26 19:32': An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 3 in stage 24.0 failed 1 times, most recent failure: Lost task 3.0 in stage 24.0 (TID 25) (host.docker.internal executor driver): java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211323152800286551285545705_0024_m_000003_25 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:420)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211323152800286551285545705_0024_m_000003_25 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more


2025-01-21 13:23:15,650 - [ERROR] - Error during processing: An error occurred while calling o178.csv.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 3 in stage 24.0 failed 1 times, most recent failure: Lost task 3.0 in stage 24.0 (TID 25) (host.docker.internal executor driver): java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211323152800286551285545705_0024_m_000003_25 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	at java.base/java.lang.Thread.run(Thread.java:834)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.$anonfun$executeWrite$4(FileFormatWriter.scala:307)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.writeAndCommit(FileFormatWriter.scala:271)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeWrite(FileFormatWriter.scala:304)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:190)

	at org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:190)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:113)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:111)

	at org.apache.spark.sql.execution.command.DataWritingCommandExec.executeCollect(commands.scala:125)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.$anonfun$executeCollect$1(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.withFinalPlanUpdate(AdaptiveSparkPlanExec.scala:420)

	at org.apache.spark.sql.execution.adaptive.AdaptiveSparkPlanExec.executeCollect(AdaptiveSparkPlanExec.scala:392)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.$anonfun$applyOrElse$1(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$6(SQLExecution.scala:125)

	at org.apache.spark.sql.execution.SQLExecution$.withSQLConfPropagated(SQLExecution.scala:201)

	at org.apache.spark.sql.execution.SQLExecution$.$anonfun$withNewExecutionId$1(SQLExecution.scala:108)

	at org.apache.spark.sql.SparkSession.withActive(SparkSession.scala:900)

	at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:66)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:107)

	at org.apache.spark.sql.execution.QueryExecution$$anonfun$eagerlyExecuteCommands$1.applyOrElse(QueryExecution.scala:98)

	at org.apache.spark.sql.catalyst.trees.TreeNode.$anonfun$transformDownWithPruning$1(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(origin.scala:76)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDownWithPruning(TreeNode.scala:461)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.org$apache$spark$sql$catalyst$plans$logical$AnalysisHelper$$super$transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning(AnalysisHelper.scala:267)

	at org.apache.spark.sql.catalyst.plans.logical.AnalysisHelper.transformDownWithPruning$(AnalysisHelper.scala:263)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.plans.logical.LogicalPlan.transformDownWithPruning(LogicalPlan.scala:32)

	at org.apache.spark.sql.catalyst.trees.TreeNode.transformDown(TreeNode.scala:437)

	at org.apache.spark.sql.execution.QueryExecution.eagerlyExecuteCommands(QueryExecution.scala:98)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted$lzycompute(QueryExecution.scala:85)

	at org.apache.spark.sql.execution.QueryExecution.commandExecuted(QueryExecution.scala:83)

	at org.apache.spark.sql.execution.QueryExecution.assertCommandExecuted(QueryExecution.scala:142)

	at org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:869)

	at org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:391)

	at org.apache.spark.sql.DataFrameWriter.saveInternal(DataFrameWriter.scala:364)

	at org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:243)

	at org.apache.spark.sql.DataFrameWriter.csv(DataFrameWriter.scala:860)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.io.IOException: Mkdirs failed to create file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output/task1_output_2022-05-26 19:32.csv/_temporary/0/_temporary/attempt_202501211323152800286551285545705_0024_m_000003_25 (exists=false, cwd=file:/C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:515)

	at org.apache.hadoop.fs.ChecksumFileSystem.create(ChecksumFileSystem.java:500)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1195)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1175)

	at org.apache.hadoop.fs.FileSystem.create(FileSystem.java:1064)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStream(CodecStreams.scala:81)

	at org.apache.spark.sql.execution.datasources.CodecStreams$.createOutputStreamWriter(CodecStreams.scala:92)

	at org.apache.spark.sql.execution.datasources.csv.CsvOutputWriter.<init>(CsvOutputWriter.scala:38)

	at org.apache.spark.sql.execution.datasources.csv.CSVFileFormat$$anon$1.newInstance(CSVFileFormat.scala:84)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.newOutputWriter(FileFormatDataWriter.scala:161)

	at org.apache.spark.sql.execution.datasources.SingleDirectoryDataWriter.<init>(FileFormatDataWriter.scala:146)

	at org.apache.spark.sql.execution.datasources.FileFormatWriter$.executeTask(FileFormatWriter.scala:389)

	at org.apache.spark.sql.execution.datasources.WriteFilesExec.$anonfun$doExecuteWrite$1(WriteFiles.scala:100)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2(RDD.scala:893)

	at org.apache.spark.rdd.RDD.$anonfun$mapPartitionsInternal$2$adapted(RDD.scala:893)

	at org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:52)

	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)

	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)

	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)

	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)

	at org.apache.spark.scheduler.Task.run(Task.scala:141)

	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)

	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)

	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)

	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)

	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)

	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)

	... 1 more


2025-01-21 13:23:15,650 - [ERROR] - Processing failed
2025-01-21 13:23:16,588 - [INFO] - Spark Session stopped
2025-01-21 13:24:45,018 - [INFO] - Starting application...
2025-01-21 13:24:45,018 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:24:45,018 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:25:11,186 - [INFO] - Spark Session created successfully
2025-01-21 13:25:11,186 - [INFO] - Spark version: 3.5.4
2025-01-21 13:25:11,186 - [INFO] - Spark master: local[*]
2025-01-21 13:25:11,186 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:25:11,186 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:25:11,186 - [INFO] - Spark master: local[*]
2025-01-21 13:25:11,187 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:25:11,187 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:25:11,189 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet: unconverted data remains: 1131
2025-01-21 13:25:11,189 - [ERROR] - Error during processing: unconverted data remains: 1131
2025-01-21 13:25:11,189 - [ERROR] - Processing failed
2025-01-21 13:25:11,505 - [INFO] - Spark Session stopped
2025-01-21 13:28:44,155 - [INFO] - Starting application...
2025-01-21 13:28:44,155 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:28:44,155 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:29:10,337 - [INFO] - Spark Session created successfully
2025-01-21 13:29:10,337 - [INFO] - Spark version: 3.5.4
2025-01-21 13:29:10,337 - [INFO] - Spark master: local[*]
2025-01-21 13:29:10,337 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:29:10,337 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:29:10,338 - [INFO] - Spark master: local[*]
2025-01-21 13:29:10,338 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:29:10,338 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:29:15,306 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 13:29:15,709 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 13:29:17,359 - [ERROR] - Error processing files for date '2022-05-27 12:31': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:29:17,359 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 13:29:17,360 - [ERROR] - Processing failed
2025-01-21 13:29:17,759 - [INFO] - Spark Session stopped
2025-01-21 13:31:53,060 - [INFO] - Starting application...
2025-01-21 13:31:53,060 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 13:31:53,060 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 13:32:18,788 - [INFO] - Spark Session created successfully
2025-01-21 13:32:18,788 - [INFO] - Spark version: 3.5.4
2025-01-21 13:32:18,788 - [INFO] - Spark master: local[*]
2025-01-21 13:32:18,788 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:32:18,788 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:32:18,788 - [INFO] - Spark master: local[*]
2025-01-21 13:32:18,788 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 13:32:18,788 - [INFO] - Filtering for user agent: some user agent
2025-01-21 13:32:23,790 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 13:32:24,247 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 13:32:25,928 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 13:32:26,479 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 13:32:26,753 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 13:32:30,380 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-21 13:32:30,381 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 13:32:30,381 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 13:32:30,382 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 13:32:30,668 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 13:32:30,871 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 13:32:32,065 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 13:32:32,371 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 13:32:32,556 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 13:32:32,822 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 13:32:32,968 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 13:32:34,415 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 13:32:34,743 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 13:32:34,979 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 13:32:38,244 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-21 13:32:38,245 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-21 13:32:38,245 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 13:32:38,246 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-21 13:32:38,246 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-21 13:32:38,247 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 13:32:38,247 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-21 13:32:38,248 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-21 13:32:38,248 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-21 13:32:38,249 - [INFO] - Processing completed successfully
2025-01-21 13:32:38,692 - [INFO] - Spark Session stopped
2025-01-21 14:05:01,825 - [INFO] - Starting application...
2025-01-21 14:05:01,825 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 14:05:01,826 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 14:05:27,623 - [INFO] - Spark Session created successfully
2025-01-21 14:05:27,624 - [INFO] - Spark version: 3.5.4
2025-01-21 14:05:27,624 - [INFO] - Spark master: local[*]
2025-01-21 14:05:27,624 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 14:05:27,624 - [INFO] - Filtering for user agent: some user agent
2025-01-21 14:05:27,624 - [INFO] - Spark master: local[*]
2025-01-21 14:05:27,624 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 14:05:27,624 - [INFO] - Filtering for user agent: some user agent
2025-01-21 14:05:33,059 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 14:05:33,602 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 14:05:35,663 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 14:05:35,663 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-21 14:05:35,663 - [ERROR] - Processing failed
2025-01-21 14:05:36,162 - [INFO] - Spark Session stopped
2025-01-21 14:07:02,182 - [INFO] - Starting application...
2025-01-21 14:07:02,182 - [INFO] - Using input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-21 14:07:02,182 - [INFO] - Using output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-21 14:07:28,482 - [INFO] - Spark Session created successfully
2025-01-21 14:07:28,483 - [INFO] - Spark version: 3.5.4
2025-01-21 14:07:28,483 - [INFO] - Spark master: local[*]
2025-01-21 14:07:28,483 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 14:07:28,483 - [INFO] - Filtering for user agent: some user agent
2025-01-21 14:07:28,483 - [INFO] - Spark master: local[*]
2025-01-21 14:07:28,483 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 14:07:28,483 - [INFO] - Filtering for user agent: some user agent
2025-01-21 14:07:33,356 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 14:07:33,823 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 14:07:35,469 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 14:07:36,006 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 14:07:36,248 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 14:07:36,583 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 14:07:36,787 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 14:07:38,323 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 14:07:38,648 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 14:07:38,879 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 14:07:43,730 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-21 14:07:43,731 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-21 14:07:43,732 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 14:07:43,732 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-21 14:07:43,733 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-21 14:07:43,733 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 14:07:43,734 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-21 14:07:43,734 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-21 14:07:43,735 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-21 14:07:44,010 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 14:07:44,208 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 14:07:45,416 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 14:07:45,739 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 14:07:45,927 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 14:07:48,083 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-21 14:07:48,084 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 14:07:48,084 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 14:07:48,085 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 14:07:48,085 - [INFO] - Processing completed successfully
2025-01-21 14:07:48,745 - [INFO] - Spark Session stopped
2025-01-21 21:56:08,493 - [INFO] - Starting application...
2025-01-21 21:56:43,900 - [INFO] - Spark Session created successfully
2025-01-21 21:56:43,901 - [INFO] - Spark version: 3.5.4
2025-01-21 21:56:43,901 - [INFO] - Spark master: local[*]
2025-01-21 21:56:43,901 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 21:56:43,901 - [INFO] - Filtering for user agent: some user agent
2025-01-21 21:56:43,901 - [INFO] - Spark master: local[*]
2025-01-21 21:56:43,901 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 21:56:43,901 - [INFO] - Filtering for user agent: some user agent
2025-01-21 21:56:50,736 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 21:56:51,200 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 21:56:52,916 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 21:56:53,535 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 21:56:53,847 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 21:56:58,392 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-21 21:56:58,393 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 21:56:58,393 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 21:56:58,394 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 21:56:58,681 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 21:56:58,866 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 21:57:00,076 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 21:57:00,408 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 21:57:00,609 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 21:57:00,930 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 21:57:01,079 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 21:57:02,419 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 21:57:02,716 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 21:57:02,931 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 21:57:06,238 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-21 21:57:06,239 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-21 21:57:06,239 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 21:57:06,240 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-21 21:57:06,241 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-21 21:57:06,242 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 21:57:06,242 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-21 21:57:06,243 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-21 21:57:06,243 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-21 21:57:06,243 - [INFO] - Starting warehouse loading process...
2025-01-21 21:57:06,306 - [ERROR] - Error creating schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-01-21 21:57:06,306 - [ERROR] - Error in process_and_load_data: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/20/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 622, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 169, in process_and_load_data
    etl.create_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 49, in create_schema
    with self.engine.connect() as conn:
         ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3274, in connect
    return self._connection_cls(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 148, in __init__
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2439, in _handle_dbapi_exception_noconnection
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 146, in __init__
    self._dbapi_connection = engine.raw_connection()
                             ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3298, in raw_connection
    return self.pool.connect()
           ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 449, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 1263, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 712, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 179, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 177, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 390, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 674, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 900, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 146, in __exit__
    raise exc_value.with_traceback(exc_tb)
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 896, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 646, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 622, in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/20/e3q8)
2025-01-21 21:57:06,410 - [ERROR] - Processing or loading failed
2025-01-21 21:57:06,679 - [INFO] - Spark Session stopped
2025-01-21 22:42:25,303 - [INFO] - Starting application...
2025-01-21 22:42:44,394 - [INFO] - Spark Session created successfully
2025-01-21 22:42:44,395 - [INFO] - Spark version: 3.5.4
2025-01-21 22:42:44,395 - [INFO] - Spark master: local[*]
2025-01-21 22:42:44,395 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 22:42:44,395 - [INFO] - Filtering for user agent: some user agent
2025-01-21 22:42:44,395 - [INFO] - Spark master: local[*]
2025-01-21 22:42:44,395 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 22:42:44,395 - [INFO] - Filtering for user agent: some user agent
2025-01-21 22:42:50,789 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 22:42:51,366 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 22:42:53,372 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 22:42:54,219 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 22:42:54,565 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 22:42:59,589 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-21 22:42:59,589 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 22:42:59,590 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 22:42:59,591 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 22:42:59,978 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 22:43:00,200 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 22:43:01,784 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 22:43:02,197 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 22:43:02,440 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 22:43:02,777 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 22:43:03,065 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 22:43:04,831 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 22:43:05,289 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 22:43:05,596 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 22:43:09,330 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-21 22:43:09,331 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-21 22:43:09,331 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 22:43:09,332 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-21 22:43:09,333 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-21 22:43:09,334 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 22:43:09,334 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-21 22:43:09,335 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-21 22:43:09,336 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-21 22:43:09,336 - [INFO] - Starting warehouse loading process...
2025-01-21 22:43:09,397 - [ERROR] - Error creating schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-21 22:43:09,397 - [ERROR] - Error in process_and_load_data: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 173, in process_and_load_data
    etl.create_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 49, in create_schema
    with self.engine.connect() as conn:
         ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-21 22:43:09,409 - [ERROR] - Processing or loading failed
2025-01-21 22:43:10,598 - [INFO] - Spark Session stopped
2025-01-21 23:04:41,584 - [INFO] - Starting application...
2025-01-21 23:05:07,991 - [INFO] - Spark Session created successfully
2025-01-21 23:05:07,992 - [INFO] - Spark version: 3.5.4
2025-01-21 23:05:07,992 - [INFO] - Spark master: local[*]
2025-01-21 23:05:07,992 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 23:05:07,992 - [INFO] - Filtering for user agent: some user agent
2025-01-21 23:05:07,992 - [INFO] - Spark master: local[*]
2025-01-21 23:05:07,992 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 23:05:07,992 - [INFO] - Filtering for user agent: some user agent
2025-01-21 23:05:07,992 - [WARNING] - No parquet files found in input directory
2025-01-21 23:05:07,992 - [ERROR] - Spark processing failed
2025-01-21 23:05:07,992 - [ERROR] - Processing or loading failed
2025-01-21 23:05:08,320 - [INFO] - Spark Session stopped
2025-01-21 23:23:18,765 - [INFO] - Starting application...
2025-01-21 23:23:45,153 - [INFO] - Spark Session created successfully
2025-01-21 23:23:45,153 - [INFO] - Spark version: 3.5.4
2025-01-21 23:23:45,154 - [INFO] - Spark master: local[*]
2025-01-21 23:23:45,154 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 23:23:45,154 - [INFO] - Filtering for user agent: some user agent
2025-01-21 23:23:45,154 - [INFO] - Spark master: local[*]
2025-01-21 23:23:45,154 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 23:23:45,154 - [INFO] - Filtering for user agent: some user agent
2025-01-21 23:23:45,154 - [WARNING] - No parquet files found in input directory
2025-01-21 23:23:45,154 - [ERROR] - Spark processing failed
2025-01-21 23:23:45,154 - [ERROR] - Processing or loading failed
2025-01-21 23:23:45,490 - [INFO] - Spark Session stopped
2025-01-21 23:24:40,854 - [INFO] - Starting application...
2025-01-21 23:24:56,912 - [INFO] - Spark Session created successfully
2025-01-21 23:24:56,913 - [INFO] - Spark version: 3.5.4
2025-01-21 23:24:56,913 - [INFO] - Spark master: local[*]
2025-01-21 23:24:56,913 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 23:24:56,913 - [INFO] - Filtering for user agent: some user agent
2025-01-21 23:24:56,913 - [INFO] - Spark master: local[*]
2025-01-21 23:24:56,913 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-21 23:24:56,913 - [INFO] - Filtering for user agent: some user agent
2025-01-21 23:25:02,649 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 23:25:03,137 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-21 23:25:05,065 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 23:25:05,657 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-21 23:25:05,933 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-21 23:25:06,298 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-21 23:25:06,543 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-21 23:25:08,108 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 23:25:08,459 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 23:25:08,719 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-21 23:25:13,850 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-21 23:25:13,850 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-21 23:25:13,851 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-21 23:25:13,852 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-21 23:25:13,852 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-21 23:25:13,852 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-21 23:25:13,854 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-21 23:25:13,855 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-21 23:25:13,855 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-21 23:25:14,177 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-21 23:25:14,365 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-21 23:25:15,771 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 23:25:16,064 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 23:25:16,227 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-21 23:25:18,670 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-21 23:25:18,670 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-21 23:25:18,671 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-21 23:25:18,671 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-21 23:25:18,671 - [INFO] - Starting warehouse loading process...
2025-01-21 23:25:18,727 - [ERROR] - Error creating schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-21 23:25:18,727 - [ERROR] - Error in process_and_load_data: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 175, in process_and_load_data
    etl.create_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 51, in create_schema
    with self.engine.connect() as conn:
         ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-21 23:25:18,734 - [ERROR] - Processing or loading failed
2025-01-21 23:25:19,211 - [INFO] - Spark Session stopped
2025-01-22 01:19:54,924 - [INFO] - Starting application...
2025-01-22 01:20:21,267 - [INFO] - Spark Session created successfully
2025-01-22 01:20:21,267 - [INFO] - Reading input files from: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 01:20:22,801 - [ERROR] - Error in processing data: [UNABLE_TO_INFER_SCHEMA] Unable to infer schema for CSV. It must be specified manually.
2025-01-22 01:20:22,801 - [ERROR] - Processing or loading failed
2025-01-22 01:20:23,126 - [INFO] - Spark Session stopped
2025-01-22 01:20:50,731 - [INFO] - Starting application...
2025-01-22 01:21:16,982 - [INFO] - Spark Session created successfully
2025-01-22 01:21:16,982 - [INFO] - Reading input files from: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 01:21:18,454 - [ERROR] - Error in processing data: [UNABLE_TO_INFER_SCHEMA] Unable to infer schema for CSV. It must be specified manually.
2025-01-22 01:21:18,454 - [ERROR] - Processing or loading failed
2025-01-22 01:21:18,840 - [INFO] - Spark Session stopped
2025-01-22 01:21:38,766 - [INFO] - Starting application...
2025-01-22 01:21:44,213 - [INFO] - Spark Session created successfully
2025-01-22 01:21:44,213 - [INFO] - Reading input files from: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 01:21:45,742 - [ERROR] - Error in processing data: [UNABLE_TO_INFER_SCHEMA] Unable to infer schema for CSV. It must be specified manually.
2025-01-22 01:21:45,742 - [ERROR] - Processing or loading failed
2025-01-22 01:21:46,030 - [INFO] - Spark Session stopped
2025-01-22 01:21:47,562 - [INFO] - Starting application...
2025-01-22 01:22:14,802 - [INFO] - Spark Session created successfully
2025-01-22 01:22:14,803 - [INFO] - Reading input files from: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 01:22:16,457 - [ERROR] - Error in processing data: [UNABLE_TO_INFER_SCHEMA] Unable to infer schema for CSV. It must be specified manually.
2025-01-22 01:22:16,457 - [ERROR] - Processing or loading failed
2025-01-22 01:22:16,664 - [INFO] - Spark Session stopped
2025-01-22 01:23:23,121 - [INFO] - Starting application...
2025-01-22 01:23:50,047 - [INFO] - Spark Session created successfully
2025-01-22 01:23:50,047 - [INFO] - Reading input files from: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 01:23:51,683 - [ERROR] - Error in processing data: [UNABLE_TO_INFER_SCHEMA] Unable to infer schema for CSV. It must be specified manually.
2025-01-22 01:23:51,683 - [ERROR] - Processing or loading failed
2025-01-22 01:23:51,888 - [INFO] - Spark Session stopped
2025-01-22 01:27:38,805 - [INFO] - Starting application...
2025-01-22 01:27:54,978 - [INFO] - Spark Session created successfully
2025-01-22 01:27:54,978 - [INFO] - Reading input files from: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 01:27:56,530 - [ERROR] - Error in processing data: [UNABLE_TO_INFER_SCHEMA] Unable to infer schema for CSV. It must be specified manually.
2025-01-22 01:27:56,530 - [ERROR] - Processing or loading failed
2025-01-22 01:27:56,847 - [INFO] - Spark Session stopped
2025-01-22 01:28:16,560 - [INFO] - Starting application...
2025-01-22 01:28:21,948 - [INFO] - Spark Session created successfully
2025-01-22 01:28:21,948 - [INFO] - Reading input files from: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 01:28:23,531 - [ERROR] - Error in processing data: [UNABLE_TO_INFER_SCHEMA] Unable to infer schema for CSV. It must be specified manually.
2025-01-22 01:28:23,531 - [ERROR] - Processing or loading failed
2025-01-22 01:28:23,763 - [INFO] - Spark Session stopped
2025-01-22 01:31:19,504 - [INFO] - Starting application...
2025-01-22 01:31:45,938 - [INFO] - Spark Session created successfully
2025-01-22 01:31:45,940 - [INFO] - Spark version: 3.5.4
2025-01-22 01:31:45,940 - [INFO] - Spark master: local[*]
2025-01-22 01:31:45,940 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:31:45,940 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:31:45,940 - [INFO] - Spark master: local[*]
2025-01-22 01:31:45,940 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:31:45,940 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:31:45,940 - [WARNING] - No parquet files found in input directory
2025-01-22 01:31:45,941 - [ERROR] - Spark processing failed
2025-01-22 01:31:45,941 - [ERROR] - Processing or loading failed
2025-01-22 01:31:46,256 - [INFO] - Spark Session stopped
2025-01-22 01:35:23,045 - [INFO] - Starting application...
2025-01-22 01:35:50,064 - [INFO] - Spark Session created successfully
2025-01-22 01:35:50,065 - [INFO] - Spark version: 3.5.4
2025-01-22 01:35:50,065 - [INFO] - Spark master: local[*]
2025-01-22 01:35:50,065 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:35:50,065 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:35:50,065 - [INFO] - Spark master: local[*]
2025-01-22 01:35:50,065 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:35:50,065 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:35:50,065 - [WARNING] - No parquet files found in input directory
2025-01-22 01:35:50,065 - [ERROR] - Error in process_and_load_data: 'bool' object has no attribute 'coalesce'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 166, in process_and_load_data
    ).coalesce(1)  # Ensure single partition
      ^^^^^^^^
AttributeError: 'bool' object has no attribute 'coalesce'
2025-01-22 01:35:50,065 - [ERROR] - Processing or loading failed
2025-01-22 01:35:50,383 - [INFO] - Spark Session stopped
2025-01-22 01:37:18,733 - [INFO] - Starting application...
2025-01-22 01:37:45,534 - [INFO] - Spark Session created successfully
2025-01-22 01:37:45,535 - [INFO] - Spark version: 3.5.4
2025-01-22 01:37:45,535 - [INFO] - Spark master: local[*]
2025-01-22 01:37:45,535 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:37:45,535 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:37:45,535 - [INFO] - Spark master: local[*]
2025-01-22 01:37:45,535 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:37:45,535 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:37:45,535 - [WARNING] - No parquet files found in input directory
2025-01-22 01:37:45,535 - [ERROR] - Spark processing failed
2025-01-22 01:37:45,535 - [ERROR] - Processing or loading failed
2025-01-22 01:37:45,855 - [INFO] - Spark Session stopped
2025-01-22 01:44:09,927 - [INFO] - Starting application...
2025-01-22 01:44:15,318 - [INFO] - Spark Session created successfully
2025-01-22 01:44:15,318 - [INFO] - Spark version: 3.5.4
2025-01-22 01:44:15,318 - [INFO] - Spark master: local[*]
2025-01-22 01:44:15,318 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:44:15,318 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:44:15,318 - [INFO] - Spark master: local[*]
2025-01-22 01:44:15,318 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:44:15,318 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:44:15,318 - [WARNING] - No parquet files found in input directory
2025-01-22 01:44:15,318 - [ERROR] - Spark processing failed
2025-01-22 01:44:15,318 - [ERROR] - Processing or loading failed
2025-01-22 01:44:15,638 - [INFO] - Spark Session stopped
2025-01-22 01:45:06,206 - [INFO] - Starting application...
2025-01-22 01:45:21,537 - [INFO] - Spark Session created successfully
2025-01-22 01:45:21,538 - [INFO] - Spark version: 3.5.4
2025-01-22 01:45:21,538 - [INFO] - Spark master: local[*]
2025-01-22 01:45:21,538 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:45:21,538 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:45:21,538 - [INFO] - Spark master: local[*]
2025-01-22 01:45:21,538 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 01:45:21,538 - [INFO] - Filtering for user agent: some user agent
2025-01-22 01:45:28,632 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 01:45:29,217 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 01:45:31,385 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 01:45:31,962 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 01:45:32,253 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 01:45:36,280 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-22 01:45:36,281 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 01:45:36,282 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 01:45:36,282 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 01:45:36,612 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 01:45:36,799 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 01:45:38,209 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 01:45:38,570 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 01:45:38,762 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 01:45:39,051 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 01:45:39,313 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 01:45:40,917 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 01:45:41,229 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 01:45:41,495 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 01:45:45,096 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-22 01:45:45,097 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 01:45:45,098 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 01:45:45,099 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 01:45:45,099 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 01:45:45,100 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 01:45:45,101 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 01:45:45,101 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 01:45:45,102 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 01:45:45,102 - [INFO] - Starting warehouse loading process...
2025-01-22 01:45:45,161 - [ERROR] - Error creating schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 01:45:45,161 - [ERROR] - Error in process_and_load_data: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 176, in process_and_load_data
    etl.create_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 51, in create_schema
    with self.engine.connect() as conn:
         ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 01:45:45,173 - [ERROR] - Processing or loading failed
2025-01-22 01:45:45,503 - [INFO] - Spark Session stopped
2025-01-22 08:31:56,395 - [INFO] - Starting application...
2025-01-22 08:32:31,871 - [INFO] - Spark Session created successfully
2025-01-22 08:32:31,871 - [INFO] - Starting Task 1 - Spark Processing
2025-01-22 08:32:31,872 - [INFO] - Spark version: 3.5.4
2025-01-22 08:32:31,872 - [INFO] - Spark master: local[*]
2025-01-22 08:32:31,872 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:32:31,872 - [INFO] - Filtering for user agent: some user agent
2025-01-22 08:32:31,872 - [INFO] - Spark master: local[*]
2025-01-22 08:32:31,872 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:32:31,872 - [INFO] - Filtering for user agent: some user agent
2025-01-22 08:32:38,065 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 08:32:38,586 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 08:32:40,738 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-22 08:32:40,738 - [ERROR] - Error during processing: An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


Driver stacktrace:

	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)

	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)

	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)

	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)

	at scala.Option.foreach(Option.scala:407)

	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)

	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)

	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)

	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)

	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)

	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)

	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)

	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)

	at java.base/java.lang.reflect.Method.invoke(Method.java:566)

	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)

	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)

	at py4j.Gateway.invoke(Gateway.java:282)

	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)

	at py4j.commands.CallCommand.execute(CallCommand.java:79)

	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)

	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)

	at java.base/java.lang.Thread.run(Thread.java:834)

Caused by: java.net.SocketException: Connection reset by peer: socket write error

	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)

	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)

	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)

	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)

	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)

	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)

	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)

	at scala.collection.Iterator.foreach(Iterator.scala:943)

	at scala.collection.Iterator.foreach$(Iterator.scala:943)

	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)

	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)

	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)

	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)

	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)


2025-01-22 08:32:40,739 - [ERROR] - Task 1 - Spark processing failed
2025-01-22 08:32:40,739 - [ERROR] - Processing or loading failed
2025-01-22 08:32:40,826 - [INFO] - Spark Session stopped
2025-01-22 08:37:31,399 - [INFO] - Starting application...
2025-01-22 08:37:57,234 - [INFO] - Spark Session created successfully
2025-01-22 08:37:57,235 - [INFO] - Spark version: 3.5.4
2025-01-22 08:37:57,235 - [INFO] - Spark master: local[*]
2025-01-22 08:37:57,235 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:37:57,235 - [INFO] - Filtering for user agent: some user agent
2025-01-22 08:37:57,235 - [INFO] - Spark master: local[*]
2025-01-22 08:37:57,235 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:37:57,235 - [INFO] - Filtering for user agent: some user agent
2025-01-22 08:38:02,798 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 08:38:03,252 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 08:38:04,926 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 08:38:05,477 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 08:38:05,744 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 08:38:09,496 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-22 08:38:09,496 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 08:38:09,496 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 08:38:09,498 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 08:38:09,757 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 08:38:09,907 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 08:38:11,147 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 08:38:11,421 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 08:38:11,617 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 08:38:11,840 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 08:38:12,017 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 08:38:13,402 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 08:38:13,698 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 08:38:14,075 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 08:38:17,782 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-22 08:38:17,782 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 08:38:17,782 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 08:38:17,784 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 08:38:17,784 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 08:38:17,784 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 08:38:17,786 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 08:38:17,786 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 08:38:17,786 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 08:38:17,786 - [INFO] - Starting warehouse loading process...
2025-01-22 08:38:17,786 - [ERROR] - Error in process_and_load_data: 'ClientReportETL' object has no attribute 'create_schema'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 177, in process_and_load_data
    etl.create_schema()
    ^^^^^^^^^^^^^^^^^
AttributeError: 'ClientReportETL' object has no attribute 'create_schema'
2025-01-22 08:38:17,788 - [ERROR] - Processing or loading failed
2025-01-22 08:38:18,947 - [INFO] - Spark Session stopped
2025-01-22 08:43:37,909 - [INFO] - Starting application...
2025-01-22 08:43:46,723 - [INFO] - Spark Session created successfully
2025-01-22 08:43:46,724 - [INFO] - Spark version: 3.5.4
2025-01-22 08:43:46,724 - [INFO] - Spark master: local[*]
2025-01-22 08:43:46,724 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:43:46,724 - [INFO] - Spark version: 3.5.4
2025-01-22 08:43:46,724 - [INFO] - Spark master: local[*]
2025-01-22 08:43:46,724 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:43:46,724 - [INFO] - Filtering for user agent: some user agent
2025-01-22 08:43:46,724 - [INFO] - Spark master: local[*]
2025-01-22 08:43:46,724 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:43:46,725 - [INFO] - Filtering for user agent: some user agent
2025-01-22 08:43:51,786 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 08:43:52,256 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 08:43:54,006 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 08:43:54,562 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 08:43:54,825 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 08:43:55,201 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 08:43:55,422 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 08:43:56,788 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 08:43:57,102 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 08:43:57,340 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 08:44:01,849 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-22 08:44:01,849 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 08:44:01,850 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 08:44:01,850 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 08:44:01,851 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 08:44:01,851 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 08:44:01,851 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 08:44:01,852 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 08:44:01,852 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 08:44:02,180 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 08:44:02,351 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 08:44:03,454 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 08:44:03,736 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 08:44:03,937 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 08:44:06,065 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-22 08:44:06,065 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 08:44:06,066 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 08:44:06,066 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 08:44:06,067 - [INFO] - Starting client report loading process...
2025-01-22 08:44:06,067 - [INFO] - Client report loading completed successfully
2025-01-22 08:44:06,067 - [INFO] - Processing and loading completed successfully
2025-01-22 08:44:06,720 - [INFO] - Spark Session stopped
2025-01-22 08:55:47,681 - [INFO] - Starting application...
2025-01-22 08:55:52,366 - [INFO] - Spark Session created successfully
2025-01-22 08:55:52,366 - [INFO] - Spark version: 3.5.4
2025-01-22 08:55:52,366 - [INFO] - Spark master: local[*]
2025-01-22 08:55:52,366 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:55:52,366 - [INFO] - Spark version: 3.5.4
2025-01-22 08:55:52,366 - [INFO] - Spark master: local[*]
2025-01-22 08:55:52,366 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:55:52,366 - [INFO] - Filtering for user agent: some user agent
2025-01-22 08:55:52,366 - [INFO] - Spark master: local[*]
2025-01-22 08:55:52,366 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 08:55:52,366 - [INFO] - Filtering for user agent: some user agent
2025-01-22 08:55:57,391 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 08:55:57,795 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 08:55:59,605 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 08:56:00,238 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 08:56:00,470 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 08:56:00,835 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 08:56:01,122 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 08:56:02,913 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 08:56:03,458 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 08:56:03,749 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 08:56:08,496 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27
2025-01-22 08:56:08,497 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 08:56:08,497 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 08:56:08,498 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 08:56:08,498 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 08:56:08,499 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 08:56:08,499 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 08:56:08,500 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 08:56:08,500 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 08:56:08,834 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 08:56:08,994 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 08:56:10,146 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 08:56:10,426 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 08:56:10,594 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 08:56:12,746 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26
2025-01-22 08:56:12,747 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 08:56:12,748 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 08:56:12,748 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 08:56:12,748 - [INFO] - Starting client report loading process...
2025-01-22 08:56:12,749 - [ERROR] - No files were processed
2025-01-22 08:56:12,749 - [ERROR] - Processing or loading failed
2025-01-22 08:56:13,366 - [INFO] - Spark Session stopped
2025-01-22 09:07:01,097 - [INFO] - Starting application...
2025-01-22 09:07:27,303 - [INFO] - Spark Session created successfully
2025-01-22 09:07:27,303 - [INFO] - Spark version: 3.5.4
2025-01-22 09:07:27,303 - [INFO] - Spark master: local[*]
2025-01-22 09:07:27,303 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 09:07:27,304 - [INFO] - Starting file processing...
2025-01-22 09:07:27,304 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 09:07:27,304 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 09:07:27,304 - [INFO] - User agent filter: some user agent
2025-01-22 09:07:27,305 - [INFO] - Found 11 total parquet files
2025-01-22 09:07:27,305 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 09:07:27,305 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 09:07:32,334 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 09:07:32,787 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 09:07:34,389 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 09:07:34,964 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 09:07:35,215 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 09:07:38,769 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 09:07:38,770 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 09:07:38,770 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 09:07:38,771 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 09:07:38,771 - [WARNING] - Failed to process data for date: 2022-05-26
2025-01-22 09:07:39,028 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 09:07:39,186 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 09:07:40,279 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 09:07:40,547 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 09:07:40,747 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 09:07:41,010 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 09:07:41,182 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 09:07:42,495 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 09:07:42,777 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 09:07:43,022 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 09:07:46,106 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 09:07:46,107 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 09:07:46,108 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 09:07:46,108 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 09:07:46,109 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 09:07:46,110 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 09:07:46,110 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 09:07:46,111 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 09:07:46,112 - [INFO] - Removed pr2025-01-22 09:07:46,112 - [WARNING] - Failed to process data for date: 2022-05-27
2025-01-22 09:07:46,112 - [ERROR] - No dates were successfully processed
2025-01-22 09:07:46,112 - [ERROR] - Spark processing failed
2025-01-22 09:07:46,112 - [ERROR] - Processing or loading failed
2025-01-22 09:07:46,664 - [INFO] - Spark Session stoppedocessed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet

2025-01-22 09:09:58,934 - [INFO] - Starting application...
2025-01-22 09:10:10,848 - [INFO] - Spark Session created successfully
2025-01-22 09:10:10,848 - [INFO] - Spark version: 3.5.4
2025-01-22 09:10:10,849 - [INFO] - Spark master: local[*]
2025-01-22 09:10:10,849 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 09:10:10,849 - [INFO] - Starting file processing...
2025-01-22 09:10:10,849 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 09:10:10,849 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 09:10:10,849 - [INFO] - User agent filter: some user agent
2025-01-22 09:10:10,850 - [INFO] - Found 11 total parquet files
2025-01-22 09:10:10,850 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 09:10:10,850 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 09:10:15,780 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 09:10:16,194 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 09:10:17,851 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 09:10:18,438 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 09:10:18,674 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 09:10:22,132 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 09:10:22,132 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 09:10:22,133 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 09:10:22,133 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 09:10:22,134 - [WARNING] - Failed to process data for date: 2022-05-26
2025-01-22 09:10:22,439 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 09:10:22,612 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 09:10:23,707 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 09:10:24,024 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 09:10:24,255 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 09:10:24,494 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 09:10:24,665 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 09:10:26,006 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 09:10:26,278 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 09:10:26,553 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 09:10:29,693 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 09:10:29,694 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 09:10:29,694 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 09:10:29,695 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 09:10:29,695 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 09:10:29,695 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 09:10:29,696 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 09:10:29,696 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 09:10:29,696 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 09:10:29,696 - [WARNING] - Failed to process data for date: 2022-05-27
2025-01-22 09:10:29,697 - [ERROR] - No dates were successfully processed
2025-01-22 09:10:29,697 - [ERROR] - Spark processing failed
2025-01-22 09:10:29,697 - [ERROR] - Processing or loading failed
2025-01-22 09:10:30,159 - [INFO] - Spark Session stopped
2025-01-22 09:13:56,263 - [INFO] - Starting application...
2025-01-22 09:14:22,206 - [INFO] - Spark Session created successfully
2025-01-22 09:14:22,207 - [INFO] - Spark version: 3.5.4
2025-01-22 09:14:22,207 - [INFO] - Spark master: local[*]
2025-01-22 09:14:22,207 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 09:14:22,207 - [INFO] - Starting file processing...
2025-01-22 09:14:22,207 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 09:14:22,207 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 09:14:22,207 - [INFO] - User agent filter: some user agent
2025-01-22 09:14:22,207 - [WARNING] - No parquet files found in input directory
2025-01-22 09:14:22,207 - [ERROR] - Spark processing failed
2025-01-22 09:14:22,207 - [ERROR] - Processing or loading failed
2025-01-22 09:14:22,550 - [INFO] - Spark Session stopped
2025-01-22 09:15:01,586 - [INFO] - Starting application...
2025-01-22 09:15:16,355 - [INFO] - Spark Session created successfully
2025-01-22 09:15:16,355 - [INFO] - Spark version: 3.5.4
2025-01-22 09:15:16,355 - [INFO] - Spark master: local[*]
2025-01-22 09:15:16,355 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 09:15:16,355 - [INFO] - Starting file processing...
2025-01-22 09:15:16,355 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 09:15:16,355 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 09:15:16,355 - [INFO] - User agent filter: some user agent
2025-01-22 09:15:16,356 - [INFO] - Found 11 total parquet files
2025-01-22 09:15:16,356 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 09:15:16,356 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 09:15:21,321 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 09:15:21,750 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 09:15:23,379 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 09:15:23,918 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 09:15:24,198 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 09:15:27,639 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 09:15:27,640 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 09:15:27,640 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 09:15:27,641 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 09:15:27,641 - [WARNING] - Failed to process data for date: 2022-05-26
2025-01-22 09:15:27,901 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 09:15:28,072 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 09:15:29,167 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 09:15:29,432 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 09:15:29,648 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 09:15:29,907 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 09:15:30,055 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 09:15:31,362 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 09:15:31,633 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 09:15:31,946 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 09:15:35,064 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 09:15:35,065 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 09:15:35,065 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 09:15:35,065 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 09:15:35,065 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 09:15:35,066 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 09:15:35,066 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 09:15:35,067 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 09:15:35,067 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 09:15:35,067 - [WARNING] - Failed to process data for date: 2022-05-27
2025-01-22 09:15:35,067 - [ERROR] - No dates were successfully processed
2025-01-22 09:15:35,068 - [ERROR] - Spark processing failed
2025-01-22 09:15:35,068 - [ERROR] - Processing or loading failed
2025-01-22 09:15:35,620 - [INFO] - Spark Session stopped
2025-01-22 09:43:11,185 - [INFO] - Starting application...
2025-01-22 09:43:11,264 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 09:43:11,265 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 09:43:50,253 - [INFO] - Starting application...
2025-01-22 09:43:50,321 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 09:43:50,322 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 09:46:18,465 - [INFO] - Starting application...
2025-01-22 09:46:18,537 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 09:46:18,537 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:49:02,580 - [INFO] - Starting application...
2025-01-22 10:49:02,651 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:49:02,651 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:50:28,020 - [INFO] - Starting application...
2025-01-22 10:50:28,845 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:50:28,845 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:50:31,402 - [INFO] - Starting application...
2025-01-22 10:50:31,541 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:50:31,542 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:51:21,485 - [INFO] - Starting application...
2025-01-22 10:51:22,109 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:51:22,109 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:56:13,433 - [INFO] - Starting application...
2025-01-22 10:56:13,504 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 10:56:13,505 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 11:38:40,223 - [INFO] - Starting application...
2025-01-22 11:38:44,387 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 11:38:44,387 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 23, in __init__
    self._ensure_schema()  # Ensure schema exists on initialization
    ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 28, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 11:39:24,897 - [INFO] - Starting application...
2025-01-22 11:39:24,958 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 11:39:51,551 - [INFO] - Spark Session created successfully
2025-01-22 11:39:51,552 - [INFO] - Spark version: 3.5.4
2025-01-22 11:39:51,552 - [INFO] - Spark master: local[*]
2025-01-22 11:39:51,552 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 11:39:51,552 - [INFO] - Starting file processing...
2025-01-22 11:39:51,552 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 11:39:51,553 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 11:39:51,553 - [INFO] - User agent filter: some user agent
2025-01-22 11:39:51,554 - [INFO] - Found 11 total parquet files
2025-01-22 11:39:51,554 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 11:39:51,554 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 11:39:56,928 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 11:39:57,366 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 11:39:59,077 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 11:39:59,634 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 11:39:59,888 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 11:40:03,544 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 11:40:03,544 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 11:40:03,545 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 11:40:03,546 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 11:40:03,546 - [WARNING] - Failed to process data for date: 2022-05-26
2025-01-22 11:40:03,805 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 11:40:03,955 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 11:40:05,053 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 11:40:05,349 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 11:40:05,532 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 11:40:05,831 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 11:40:05,985 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 11:40:07,336 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 11:40:07,584 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 11:40:07,838 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 11:40:11,007 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 11:40:11,007 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 11:40:11,008 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 11:40:11,008 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 11:40:11,008 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 11:40:11,009 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 11:40:11,009 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 11:40:11,010 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 11:40:11,010 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 11:40:11,010 - [WARNING] - Failed to process data for date: 2022-05-27
2025-01-22 11:40:11,010 - [ERROR] - No dates were successfully processed
2025-01-22 11:40:11,010 - [ERROR] - Spark processing failed
2025-01-22 11:40:11,010 - [ERROR] - Processing or loading failed
2025-01-22 11:40:11,568 - [INFO] - Spark Session stopped
2025-01-22 11:58:37,318 - [INFO] - Starting application...
2025-01-22 11:58:37,405 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 11:58:44,743 - [INFO] - Spark Session created successfully
2025-01-22 11:58:44,743 - [INFO] - Spark version: 3.5.4
2025-01-22 11:58:44,743 - [INFO] - Spark master: local[*]
2025-01-22 11:58:44,743 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 11:58:44,743 - [INFO] - Starting file processing...
2025-01-22 11:58:44,743 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 11:58:44,743 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 11:58:44,743 - [INFO] - User agent filter: some user agent
2025-01-22 11:58:44,744 - [INFO] - Found 11 total parquet files
2025-01-22 11:58:44,744 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 11:58:44,745 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 11:58:50,024 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 11:58:50,468 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 11:58:52,226 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 11:58:52,800 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 11:58:53,065 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 11:58:56,662 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 11:58:56,662 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 11:58:56,663 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 11:58:56,663 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 11:58:56,663 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 11:58:56,948 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 11:58:57,101 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 11:58:58,288 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 11:58:58,577 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 11:58:58,787 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 11:58:59,085 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 11:58:59,276 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 11:59:00,660 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 11:59:00,926 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 11:59:01,253 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 11:59:04,440 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 11:59:04,441 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 11:59:04,441 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 11:59:04,442 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 11:59:04,442 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 11:59:04,443 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 11:59:04,443 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 11:59:04,444 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 11:59:04,444 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 11:59:04,444 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 11:59:04,445 - [INFO] - Successfully processed 2 dates
2025-01-22 11:59:04,445 - [INFO] - Starting client report loading process...
2025-01-22 11:59:04,445 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 11:59:04,449 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 11:59:04,452 - [ERROR] - Error loading data: 'ClientReportETL' object has no attribute 'validate_data'
2025-01-22 11:59:04,452 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'ClientReportETL' object has no attribute 'validate_data'
2025-01-22 11:59:04,452 - [ERROR] - Processing or loading failed
2025-01-22 11:59:04,952 - [INFO] - Spark Session stopped
2025-01-22 12:03:57,065 - [INFO] - Starting application...
2025-01-22 12:03:57,125 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 12:04:03,045 - [INFO] - Spark Session created successfully
2025-01-22 12:04:03,045 - [INFO] - Spark version: 3.5.4
2025-01-22 12:04:03,045 - [INFO] - Spark master: local[*]
2025-01-22 12:04:03,045 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 12:04:03,045 - [INFO] - Starting file processing...
2025-01-22 12:04:03,045 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 12:04:03,046 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 12:04:03,046 - [INFO] - User agent filter: some user agent
2025-01-22 12:04:03,047 - [INFO] - Found 11 total parquet files
2025-01-22 12:04:03,047 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 12:04:03,047 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 12:04:08,457 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:04:08,962 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 12:04:10,642 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:04:11,206 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:04:11,458 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:04:15,018 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 12:04:15,019 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 12:04:15,019 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:04:15,020 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 12:04:15,020 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 12:04:15,278 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:04:15,437 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 12:04:16,575 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:04:16,875 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 12:04:17,075 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 12:04:17,366 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 12:04:17,570 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 12:04:18,916 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:04:19,187 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:04:19,383 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:04:22,492 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 12:04:22,493 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 12:04:22,494 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:04:22,494 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 12:04:22,495 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 12:04:22,495 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:04:22,495 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 12:04:22,496 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 12:04:22,496 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 12:04:22,497 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 12:04:22,497 - [INFO] - Successfully processed 2 dates
2025-01-22 12:04:22,497 - [INFO] - Starting client report loading process...
2025-01-22 12:04:22,497 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 12:04:22,502 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:04:22,506 - [ERROR] - Error loading data: 'ClientReportETL' object has no attribute 'validate_data'
2025-01-22 12:04:22,506 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'ClientReportETL' object has no attribute 'validate_data'
2025-01-22 12:04:22,506 - [ERROR] - Processing or loading failed
2025-01-22 12:04:23,005 - [INFO] - Spark Session stopped
2025-01-22 12:17:45,083 - [INFO] - Starting application...
2025-01-22 12:17:45,146 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 12:17:52,201 - [INFO] - Spark Session created successfully
2025-01-22 12:17:52,201 - [INFO] - Spark version: 3.5.4
2025-01-22 12:17:52,201 - [INFO] - Spark master: local[*]
2025-01-22 12:17:52,202 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 12:17:52,202 - [INFO] - Starting file processing...
2025-01-22 12:17:52,202 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 12:17:52,202 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 12:17:52,202 - [INFO] - User agent filter: some user agent
2025-01-22 12:17:52,203 - [INFO] - Found 11 total parquet files
2025-01-22 12:17:52,203 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 12:17:52,203 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 12:17:57,460 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:17:57,916 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 12:17:59,702 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:18:00,279 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:18:00,556 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:18:04,174 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 12:18:04,174 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 12:18:04,175 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:18:04,176 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 12:18:04,176 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 12:18:04,441 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:18:04,611 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 12:18:05,783 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:18:06,096 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 12:18:06,328 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 12:18:06,609 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 12:18:06,787 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 12:18:08,189 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:18:08,533 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:18:08,817 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:18:12,045 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 12:18:12,046 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 12:18:12,046 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:18:12,047 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 12:18:12,047 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 12:18:12,048 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:18:12,048 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 12:18:12,049 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 12:18:12,049 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 12:18:12,049 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 12:18:12,049 - [INFO] - Successfully processed 2 dates
2025-01-22 12:18:12,049 - [INFO] - Starting client report loading process...
2025-01-22 12:18:12,050 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 12:18:12,054 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:18:12,058 - [INFO] - Data validation passed
2025-01-22 12:18:12,060 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 12:18:12,095 - [INFO] - Successfully loaded 24 rows
2025-01-22 12:18:12,100 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 12:18:12,100 - [INFO] - - Archived rows: 0
2025-01-22 12:18:12,100 - [INFO] - - Loaded rows: 24
2025-01-22 12:18:12,100 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 12:18:12,104 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:18:12,108 - [ERROR] - Data validation failed:
Found records where clicks exceed impressions
2025-01-22 12:18:12,108 - [ERROR] - Error loading data: Data validation failed: Found records where clicks exceed impressions
2025-01-22 12:18:12,108 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv: Data validation failed: Found records where clicks exceed impressions
2025-01-22 12:18:12,108 - [ERROR] - Processing or loading failed
2025-01-22 12:18:12,542 - [INFO] - Spark Session stopped
2025-01-22 12:22:52,184 - [INFO] - Starting application...
2025-01-22 12:22:52,260 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 12:23:01,386 - [INFO] - Spark Session created successfully
2025-01-22 12:23:01,386 - [INFO] - Spark version: 3.5.4
2025-01-22 12:23:01,386 - [INFO] - Spark master: local[*]
2025-01-22 12:23:01,386 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 12:23:01,387 - [INFO] - Starting file processing...
2025-01-22 12:23:01,387 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 12:23:01,387 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 12:23:01,387 - [INFO] - User agent filter: some user agent
2025-01-22 12:23:01,388 - [INFO] - Found 11 total parquet files
2025-01-22 12:23:01,388 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 12:23:01,388 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 12:23:06,939 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:23:07,412 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 12:23:09,290 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:23:09,845 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:23:10,142 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:23:13,775 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 12:23:13,776 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 12:23:13,776 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:23:13,777 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 12:23:13,777 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 12:23:14,035 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:23:14,207 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 12:23:15,412 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:23:15,779 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 12:23:15,967 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 12:23:16,247 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 12:23:16,452 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 12:23:17,919 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:23:18,323 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:23:18,571 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:23:21,824 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 12:23:21,825 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 12:23:21,825 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:23:21,826 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 12:23:21,826 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 12:23:21,827 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:23:21,827 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 12:23:21,828 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 12:23:21,828 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 12:23:21,828 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 12:23:21,828 - [INFO] - Successfully processed 2 dates
2025-01-22 12:23:21,828 - [INFO] - Starting client report loading process...
2025-01-22 12:23:21,829 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 12:23:21,833 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:23:21,839 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 12:23:21,878 - [INFO] - Successfully loaded 24 rows
2025-01-22 12:23:21,882 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 12:23:21,882 - [INFO] - - Archived rows: 24
2025-01-22 12:23:21,883 - [INFO] - - Loaded rows: 24
2025-01-22 12:23:21,883 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 12:23:21,887 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:23:21,891 - [WARNING] - Found 2 records where clicks exceed impressions
2025-01-22 12:23:21,902 - [INFO] - Stored 2 invalid records for later analysis
2025-01-22 12:23:21,902 - [ERROR] - Error loading data: Data validation failed: 
2025-01-22 12:23:21,903 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv: Data validation failed: 
2025-01-22 12:23:21,903 - [ERROR] - Processing or loading failed
2025-01-22 12:23:22,383 - [INFO] - Spark Session stopped
2025-01-22 12:36:52,172 - [INFO] - Starting application...
2025-01-22 12:36:52,240 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 12:36:57,049 - [INFO] - Spark Session created successfully
2025-01-22 12:36:57,049 - [INFO] - Spark version: 3.5.4
2025-01-22 12:36:57,049 - [INFO] - Spark master: local[*]
2025-01-22 12:36:57,049 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 12:36:57,049 - [INFO] - Starting file processing...
2025-01-22 12:36:57,049 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 12:36:57,049 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 12:36:57,049 - [INFO] - User agent filter: some user agent
2025-01-22 12:36:57,050 - [INFO] - Found 11 total parquet files
2025-01-22 12:36:57,050 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 12:36:57,050 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 12:37:02,989 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:37:03,952 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 12:37:06,363 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:37:07,274 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:37:07,671 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:37:11,842 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 12:37:11,843 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 12:37:11,843 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:37:11,844 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 12:37:11,844 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 12:37:12,111 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:37:12,289 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 12:37:13,412 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:37:13,909 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 12:37:14,130 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 12:37:14,382 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 12:37:14,575 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 12:37:15,920 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:37:16,454 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:37:16,676 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:37:19,781 - [WARNING] - Found rows where clicks exceed impressions:
2025-01-22 12:37:20,618 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 12:37:20,619 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 12:37:20,619 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:37:20,620 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 12:37:20,621 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 12:37:20,621 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:37:20,621 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 12:37:20,622 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 12:37:20,622 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 12:37:20,622 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 12:37:20,622 - [INFO] - Successfully processed 2 dates
2025-01-22 12:37:20,622 - [INFO] - Starting client report loading process...
2025-01-22 12:37:20,623 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 12:37:20,627 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:37:20,632 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 12:37:20,636 - [ERROR] - Error loading data: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_archive_pkey"
DETAIL:  Key (datetime)=(2022-05-26 00:00:00) already exists.

[SQL: 
                    INSERT INTO adform_dw.client_report_archive 
                    SELECT * FROM adform_dw.client_report;
                ]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-22 12:37:20,636 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_archive_pkey"
DETAIL:  Key (datetime)=(2022-05-26 00:00:00) already exists.

[SQL: 
                    INSERT INTO adform_dw.client_report_archive 
                    SELECT * FROM adform_dw.client_report;
                ]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-22 12:37:20,636 - [ERROR] - Processing or loading failed
2025-01-22 12:37:21,366 - [INFO] - Spark Session stopped
2025-01-22 12:46:09,187 - [INFO] - Starting application...
2025-01-22 12:46:09,252 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 12:46:34,933 - [INFO] - Spark Session created successfully
2025-01-22 12:46:34,934 - [INFO] - Spark version: 3.5.4
2025-01-22 12:46:34,934 - [INFO] - Spark master: local[*]
2025-01-22 12:46:34,934 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 12:46:34,934 - [INFO] - Starting file processing...
2025-01-22 12:46:34,934 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 12:46:34,934 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 12:46:34,934 - [INFO] - User agent filter: some user agent
2025-01-22 12:46:34,935 - [INFO] - Found 11 total parquet files
2025-01-22 12:46:34,935 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 12:46:34,935 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 12:46:39,962 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:46:40,440 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 12:46:42,244 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:46:43,198 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:46:43,619 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:46:48,628 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 12:46:48,629 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 12:46:48,629 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:46:48,630 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 12:46:48,630 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 12:46:48,876 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:46:49,049 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 12:46:50,193 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:46:50,636 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 12:46:50,820 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 12:46:51,104 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 12:46:51,270 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 12:46:52,584 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:46:53,019 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:46:53,223 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:46:57,187 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 12:46:57,923 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 12:46:57,923 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 12:46:57,924 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:46:57,924 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 12:46:57,925 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 12:46:57,925 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:46:57,926 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 12:46:57,927 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 12:46:57,927 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 12:46:57,927 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 12:46:57,927 - [INFO] - Successfully processed 2 dates
2025-01-22 12:46:57,927 - [INFO] - Starting client report loading process...
2025-01-22 12:46:57,928 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 12:46:57,930 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:46:57,930 - [ERROR] - Error loading data: 'datetime'
2025-01-22 12:46:57,930 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'datetime'
2025-01-22 12:46:57,930 - [ERROR] - Processing or loading failed
2025-01-22 12:46:58,170 - [INFO] - Spark Session stopped
2025-01-22 12:54:30,047 - [INFO] - Starting application...
2025-01-22 12:54:30,108 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 12:54:48,363 - [INFO] - Spark Session created successfully
2025-01-22 12:54:48,363 - [INFO] - Spark version: 3.5.4
2025-01-22 12:54:48,363 - [INFO] - Spark master: local[*]
2025-01-22 12:54:48,363 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 12:54:48,364 - [INFO] - Starting file processing...
2025-01-22 12:54:48,364 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 12:54:48,364 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 12:54:48,364 - [INFO] - User agent filter: some user agent
2025-01-22 12:54:48,365 - [INFO] - Found 11 total parquet files
2025-01-22 12:54:48,365 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 12:54:48,365 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 12:54:53,587 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:54:54,024 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 12:54:55,680 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:54:56,570 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:54:56,946 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 12:55:01,639 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 12:55:01,639 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 12:55:01,639 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 12:55:01,640 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 12:55:01,640 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 12:55:01,887 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 12:55:02,050 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 12:55:03,190 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:55:03,612 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 12:55:03,844 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 12:55:04,094 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 12:55:04,281 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 12:55:05,702 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:55:06,130 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:55:06,381 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 12:55:10,317 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 12:55:11,044 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 12:55:11,044 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 12:55:11,044 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 12:55:11,045 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 12:55:11,045 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 12:55:11,046 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 12:55:11,046 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 12:55:11,047 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 12:55:11,047 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 12:55:11,047 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 12:55:11,047 - [INFO] - Successfully processed 2 dates
2025-01-22 12:55:11,047 - [INFO] - Starting client report loading process...
2025-01-22 12:55:11,048 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 12:55:11,049 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:55:11,055 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 12:55:11,060 - [INFO] - Archived 0 unique rows
2025-01-22 12:55:11,096 - [INFO] - Successfully loaded 24 rows
2025-01-22 12:55:11,102 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 12:55:11,102 - [INFO] - - Archived rows: 0
2025-01-22 12:55:11,102 - [INFO] - - Loaded rows: 24
2025-01-22 12:55:11,102 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 12:55:11,104 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 12:55:11,107 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 12:55:11,110 - [INFO] - Archived 0 unique rows
2025-01-22 12:55:11,132 - [INFO] - Successfully loaded 24 rows
2025-01-22 12:55:11,137 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 12:55:11,137 - [INFO] - - Archived rows: 0
2025-01-22 12:55:11,137 - [INFO] - - Loaded rows: 24
2025-01-22 12:55:11,137 - [INFO] - 
Verifying data load...
2025-01-22 12:55:11,137 - [ERROR] - Error in process_and_load_data: 'ClientReportETL' object has no attribute 'verify_load'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 196, in process_and_load_data
    verification = etl.verify_load()
                   ^^^^^^^^^^^^^^^
AttributeError: 'ClientReportETL' object has no attribute 'verify_load'
2025-01-22 12:55:11,137 - [ERROR] - Processing or loading failed
2025-01-22 12:55:11,306 - [INFO] - Spark Session stopped
2025-01-22 13:04:00,278 - [INFO] - Starting application...
2025-01-22 13:04:00,344 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 13:04:10,979 - [INFO] - Spark Session created successfully
2025-01-22 13:04:10,979 - [INFO] - Spark version: 3.5.4
2025-01-22 13:04:10,979 - [INFO] - Spark master: local[*]
2025-01-22 13:04:10,979 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 13:04:10,979 - [INFO] - Starting file processing...
2025-01-22 13:04:10,979 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 13:04:10,979 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 13:04:10,980 - [INFO] - User agent filter: some user agent
2025-01-22 13:04:10,981 - [INFO] - Found 11 total parquet files
2025-01-22 13:04:10,981 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 13:04:10,981 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 13:04:16,029 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 13:04:16,488 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 13:04:18,215 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 13:04:19,084 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 13:04:19,505 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 13:04:24,373 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 13:04:24,374 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 13:04:24,374 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 13:04:24,375 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 13:04:24,375 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 13:04:24,676 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 13:04:24,822 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 13:04:25,965 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 13:04:26,415 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 13:04:26,629 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 13:04:26,902 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 13:04:27,094 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 13:04:28,434 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 13:04:28,853 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 13:04:29,063 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 13:04:32,934 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 13:04:33,672 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 13:04:33,673 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 13:04:33,673 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 13:04:33,674 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 13:04:33,674 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 13:04:33,675 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 13:04:33,675 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 13:04:33,676 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 13:04:33,677 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 13:04:33,677 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 13:04:33,677 - [INFO] - Successfully processed 2 dates
2025-01-22 13:04:33,677 - [INFO] - Starting client report loading process...
2025-01-22 13:04:33,678 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 13:04:33,680 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 13:04:33,685 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 13:04:33,691 - [INFO] - Archived 24 unique rows
2025-01-22 13:04:33,723 - [INFO] - Successfully loaded 24 rows
2025-01-22 13:04:33,728 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 13:04:33,728 - [INFO] - - Archived rows: 24
2025-01-22 13:04:33,728 - [INFO] - - Loaded rows: 24
2025-01-22 13:04:33,729 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 13:04:33,732 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 13:04:33,736 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 13:04:33,740 - [INFO] - Archived 0 unique rows
2025-01-22 13:04:33,765 - [INFO] - Successfully loaded 24 rows
2025-01-22 13:04:33,770 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 13:04:33,770 - [INFO] - - Archived rows: 0
2025-01-22 13:04:33,770 - [INFO] - - Loaded rows: 24
2025-01-22 13:04:33,771 - [INFO] - 
Verifying data load...
2025-01-22 13:04:33,776 - [INFO] - Verification results: {'total_rows': 24, 'date_range': {'start': datetime.datetime(2022, 5, 27, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('30'), 'clicks': Decimal('30')}}
2025-01-22 13:04:33,777 - [INFO] - 
Load Summary:
2025-01-22 13:04:33,777 - [INFO] - Total files processed: 2
2025-01-22 13:04:33,777 - [INFO] - Total rows loaded: 48
2025-01-22 13:04:33,777 - [INFO] - 
Date Range:
2025-01-22 13:04:33,777 - [INFO] -   Start: 2022-05-27 00:00:00
2025-01-22 13:04:33,777 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 13:04:33,777 - [INFO] - 
Total Counts:
2025-01-22 13:04:33,777 - [INFO] -   Impressions: 30
2025-01-22 13:04:33,777 - [INFO] -   Clicks: 30
2025-01-22 13:04:33,777 - [INFO] - 
Hourly Breakdown:
2025-01-22 13:04:33,777 - [ERROR] - Error in process_and_load_data: 'hourly_breakdown'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 209, in process_and_load_data
    logger.info(f"\n{verification['hourly_breakdown'].to_string()}")
                     ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
KeyError: 'hourly_breakdown'
2025-01-22 13:04:33,778 - [ERROR] - Processing or loading failed
2025-01-22 13:04:34,929 - [INFO] - Spark Session stopped
2025-01-22 13:07:00,848 - [INFO] - Starting application...
2025-01-22 13:07:00,907 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 13:07:05,863 - [INFO] - Spark Session created successfully
2025-01-22 13:07:05,863 - [INFO] - Spark version: 3.5.4
2025-01-22 13:07:05,863 - [INFO] - Spark master: local[*]
2025-01-22 13:07:05,864 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 13:07:05,864 - [INFO] - Starting file processing...
2025-01-22 13:07:05,864 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 13:07:05,864 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 13:07:05,864 - [INFO] - User agent filter: some user agent
2025-01-22 13:07:05,866 - [INFO] - Found 11 total parquet files
2025-01-22 13:07:05,866 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 13:07:05,866 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 13:07:11,985 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 13:07:12,564 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 13:07:14,679 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 13:07:15,540 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 13:07:15,933 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 13:07:20,605 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 13:07:20,605 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 13:07:20,606 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 13:07:20,606 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 13:07:20,607 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 13:07:20,867 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 13:07:21,040 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 13:07:22,126 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 13:07:22,589 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 13:07:22,787 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 13:07:23,055 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 13:07:23,249 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 13:07:24,568 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 13:07:25,006 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 13:07:25,209 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 13:07:29,151 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 13:07:29,925 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 13:07:29,925 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 13:07:29,926 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 13:07:29,926 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 13:07:29,927 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 13:07:29,928 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 13:07:29,928 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 13:07:29,929 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 13:07:29,929 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 13:07:29,930 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 13:07:29,930 - [INFO] - Successfully processed 2 dates
2025-01-22 13:07:29,930 - [INFO] - Starting client report loading process...
2025-01-22 13:07:29,930 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 13:07:29,932 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 13:07:29,939 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 13:07:29,945 - [INFO] - Archived 0 unique rows
2025-01-22 13:07:29,981 - [INFO] - Successfully loaded 24 rows
2025-01-22 13:07:29,987 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 13:07:29,987 - [INFO] - - Archived rows: 0
2025-01-22 13:07:29,987 - [INFO] - - Loaded rows: 24
2025-01-22 13:07:29,987 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 13:07:29,990 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 13:07:29,995 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 13:07:29,999 - [INFO] - Archived 0 unique rows
2025-01-22 13:07:30,024 - [INFO] - Successfully loaded 24 rows
2025-01-22 13:07:30,029 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 13:07:30,029 - [INFO] - - Archived rows: 0
2025-01-22 13:07:30,029 - [INFO] - - Loaded rows: 24
2025-01-22 13:07:30,029 - [INFO] - 
Verifying data load...
2025-01-22 13:07:30,034 - [INFO] - Verification results: {'total_rows': 24, 'date_range': {'start': datetime.datetime(2022, 5, 27, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('30'), 'clicks': Decimal('30')}}
2025-01-22 13:07:30,035 - [INFO] - 
Load Summary:
2025-01-22 13:07:30,035 - [INFO] - Total files processed: 2
2025-01-22 13:07:30,035 - [INFO] - Total rows loaded: 48
2025-01-22 13:07:30,035 - [INFO] - 
Date Range:
2025-01-22 13:07:30,035 - [INFO] -   Start: 2022-05-27 00:00:00
2025-01-22 13:07:30,035 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 13:07:30,035 - [INFO] - 
Total Counts:
2025-01-22 13:07:30,035 - [INFO] -   Impressions: 30
2025-01-22 13:07:30,035 - [INFO] -   Clicks: 30
2025-01-22 13:07:30,035 - [INFO] - 
Client report loading completed successfully
2025-01-22 13:07:30,035 - [INFO] - Processing and loading completed successfully
2025-01-22 13:07:31,147 - [INFO] - Spark Session stopped
2025-01-22 14:20:33,584 - [INFO] - Starting application...
2025-01-22 14:20:33,652 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 14:20:38,563 - [INFO] - Spark Session created successfully
2025-01-22 14:20:38,563 - [INFO] - Spark version: 3.5.4
2025-01-22 14:20:38,563 - [INFO] - Spark master: local[*]
2025-01-22 14:20:38,564 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 14:20:38,564 - [INFO] - Starting file processing...
2025-01-22 14:20:38,564 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 14:20:38,564 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 14:20:38,564 - [INFO] - User agent filter: some user agent
2025-01-22 14:20:38,565 - [INFO] - Found 11 total parquet files
2025-01-22 14:20:38,565 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 14:20:38,565 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 14:20:45,107 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 14:20:45,680 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 14:20:47,448 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 14:20:48,387 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 14:20:48,779 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 14:20:53,743 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 14:20:53,743 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 14:20:53,744 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 14:20:53,744 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 14:20:53,744 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 14:20:54,040 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 14:20:54,216 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 14:20:55,406 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 14:20:55,944 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 14:20:56,164 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 14:20:56,478 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 14:20:56,658 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 14:20:58,053 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 14:20:58,492 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 14:20:58,744 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 14:21:02,667 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 14:21:03,437 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 14:21:03,437 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 14:21:03,438 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 14:21:03,438 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 14:21:03,439 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 14:21:03,439 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 14:21:03,440 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 14:21:03,440 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 14:21:03,441 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 14:21:03,441 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 14:21:03,441 - [INFO] - Successfully processed 2 dates
2025-01-22 14:21:03,441 - [INFO] - Starting client report loading process...
2025-01-22 14:21:03,441 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 14:21:03,445 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 14:21:03,456 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 14:21:03,461 - [INFO] - Archived 0 unique rows
2025-01-22 14:21:03,492 - [INFO] - Successfully loaded 24 rows
2025-01-22 14:21:03,497 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 14:21:03,497 - [INFO] - - Archived rows: 0
2025-01-22 14:21:03,497 - [INFO] - - Loaded rows: 24
2025-01-22 14:21:03,497 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 14:21:03,506 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 14:21:03,511 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 14:21:03,514 - [INFO] - Archived 0 unique rows
2025-01-22 14:21:03,536 - [INFO] - Successfully loaded 24 rows
2025-01-22 14:21:03,541 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 14:21:03,541 - [INFO] - - Archived rows: 0
2025-01-22 14:21:03,541 - [INFO] - - Loaded rows: 24
2025-01-22 14:21:03,541 - [INFO] - 
Verifying data load...
2025-01-22 14:21:03,545 - [INFO] - Verification results: {'total_rows': 24, 'date_range': {'start': datetime.datetime(2022, 5, 27, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('30'), 'clicks': Decimal('30')}}
2025-01-22 14:21:03,546 - [INFO] - 
Load Summary:
2025-01-22 14:21:03,546 - [INFO] - Total files processed: 2
2025-01-22 14:21:03,546 - [INFO] - Total rows loaded: 48
2025-01-22 14:21:03,546 - [INFO] - 
Date Range:
2025-01-22 14:21:03,546 - [INFO] -   Start: 2022-05-27 00:00:00
2025-01-22 14:21:03,546 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 14:21:03,546 - [INFO] - 
Total Counts:
2025-01-22 14:21:03,546 - [INFO] -   Impressions: 30
2025-01-22 14:21:03,546 - [INFO] -   Clicks: 30
2025-01-22 14:21:03,546 - [INFO] - 
Client report loading completed successfully
2025-01-22 14:21:03,546 - [INFO] - Processing and loading completed successfully
2025-01-22 14:21:04,676 - [INFO] - Spark Session stopped
2025-01-22 14:55:09,001 - [INFO] - Starting application...
2025-01-22 14:55:09,069 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 14:55:13,864 - [INFO] - Spark Session created successfully
2025-01-22 14:55:13,864 - [INFO] - Spark version: 3.5.4
2025-01-22 14:55:13,865 - [INFO] - Spark master: local[*]
2025-01-22 14:55:13,865 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 14:55:13,865 - [INFO] - Starting file processing...
2025-01-22 14:55:13,865 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 14:55:13,865 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 14:55:13,865 - [INFO] - User agent filter: some user agent
2025-01-22 14:55:13,866 - [INFO] - Found 11 total parquet files
2025-01-22 14:55:13,866 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 14:55:13,866 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 14:55:21,188 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 14:55:21,822 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 14:55:23,935 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 14:55:24,777 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 14:55:25,215 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 14:55:30,157 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 14:55:30,159 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 14:55:30,159 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 14:55:30,160 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 14:55:30,160 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 14:55:30,464 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 14:55:30,640 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 14:55:31,836 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 37.0 failed 1 times, most recent failure: Lost task 0.0 in stage 37.0 (TID 36) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-22 14:55:31,836 - [WARNING] - Failed to process data for date: 2022-05-27 - An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 37.0 failed 1 times, most recent failure: Lost task 0.0 in stage 37.0 (TID 36) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-22 14:55:31,836 - [INFO] - Successfully processed 1 dates
2025-01-22 14:55:31,836 - [INFO] - Starting client report loading process...
2025-01-22 14:55:31,837 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 14:55:31,838 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 14:55:31,844 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 14:55:31,849 - [INFO] - Archived 0 unique rows
2025-01-22 14:55:31,864 - [INFO] - Successfully loaded 24 rows
2025-01-22 14:55:31,869 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 14:55:31,869 - [INFO] - - Archived rows: 0
2025-01-22 14:55:31,869 - [INFO] - - Loaded rows: 24
2025-01-22 14:55:31,870 - [INFO] - 
Verifying data load...
2025-01-22 14:55:31,874 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-22 14:55:31,875 - [INFO] - 
Load Summary:
2025-01-22 14:55:31,876 - [INFO] - Total files processed: 1
2025-01-22 14:55:31,876 - [INFO] - Total rows loaded: 24
2025-01-22 14:55:31,876 - [INFO] - 
Date Range:
2025-01-22 14:55:31,876 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-22 14:55:31,876 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 14:55:31,876 - [INFO] - 
Total Counts:
2025-01-22 14:55:31,876 - [INFO] -   Impressions: 44
2025-01-22 14:55:31,876 - [INFO] -   Clicks: 30
2025-01-22 14:55:31,876 - [INFO] - 
Client report loading completed successfully
2025-01-22 14:55:31,876 - [INFO] - Processing and loading completed successfully
2025-01-22 14:55:32,406 - [INFO] - Spark Session stopped
2025-01-22 15:00:34,278 - [INFO] - Starting application...
2025-01-22 15:00:34,340 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 15:01:00,433 - [INFO] - Spark Session created successfully
2025-01-22 15:01:00,434 - [INFO] - Spark version: 3.5.4
2025-01-22 15:01:00,434 - [INFO] - Spark master: local[*]
2025-01-22 15:01:00,434 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 15:01:00,434 - [INFO] - Starting file processing...
2025-01-22 15:01:00,434 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 15:01:00,434 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 15:01:00,434 - [INFO] - User agent filter: some user agent
2025-01-22 15:01:00,435 - [INFO] - Found 8 total parquet files
2025-01-22 15:01:00,435 - [INFO] - Impressions files by date: 2022-05-27
2025-01-22 15:01:00,435 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 15:01:07,647 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:01:08,150 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 15:01:10,153 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-22 15:01:10,154 - [WARNING] - Failed to process data for date: 2022-05-27 - An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-22 15:01:10,154 - [ERROR] - No dates were successfully processed
2025-01-22 15:01:10,154 - [ERROR] - Spark processing failed
2025-01-22 15:01:10,154 - [ERROR] - Processing or loading failed
2025-01-22 15:01:10,378 - [INFO] - Spark Session stopped
2025-01-22 15:02:54,521 - [INFO] - Starting application...
2025-01-22 15:02:54,583 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 15:03:01,311 - [INFO] - Spark Session created successfully
2025-01-22 15:03:01,312 - [INFO] - Spark version: 3.5.4
2025-01-22 15:03:01,312 - [INFO] - Spark master: local[*]
2025-01-22 15:03:01,312 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 15:03:01,312 - [INFO] - Starting file processing...
2025-01-22 15:03:01,313 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 15:03:01,313 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 15:03:01,313 - [INFO] - User agent filter: some user agent
2025-01-22 15:03:01,314 - [INFO] - Found 11 total parquet files
2025-01-22 15:03:01,314 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 15:03:01,314 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 15:03:07,537 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:03:08,009 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 15:03:09,949 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:03:10,872 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:03:11,278 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:03:16,129 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 15:03:16,129 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 15:03:16,130 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:03:16,130 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 15:03:16,131 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 15:03:16,406 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:03:16,567 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 15:03:17,681 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:03:18,113 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 15:03:18,346 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 15:03:18,611 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 15:03:18,802 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 15:03:20,157 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:03:20,687 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:03:20,911 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:03:24,943 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 15:03:25,664 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 15:03:25,664 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 15:03:25,665 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:03:25,665 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 15:03:25,666 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 15:03:25,666 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:03:25,667 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 15:03:25,667 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 15:03:25,668 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 15:03:25,668 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 15:03:25,668 - [INFO] - Successfully processed 2 dates
2025-01-22 15:03:25,668 - [INFO] - Starting client report loading process...
2025-01-22 15:03:25,668 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 15:03:25,670 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:03:25,676 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:03:25,681 - [INFO] - Archived 0 unique rows
2025-01-22 15:03:25,719 - [INFO] - Successfully loaded 24 rows
2025-01-22 15:03:25,726 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 15:03:25,726 - [INFO] - - Archived rows: 0
2025-01-22 15:03:25,726 - [INFO] - - Loaded rows: 24
2025-01-22 15:03:25,726 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 15:03:25,728 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:03:25,732 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:03:25,736 - [INFO] - Archived 0 unique rows
2025-01-22 15:03:25,761 - [INFO] - Successfully loaded 24 rows
2025-01-22 15:03:25,765 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 15:03:25,765 - [INFO] - - Archived rows: 0
2025-01-22 15:03:25,765 - [INFO] - - Loaded rows: 24
2025-01-22 15:03:25,765 - [INFO] - 
Verifying data load...
2025-01-22 15:03:25,770 - [INFO] - Verification results: {'total_rows': 24, 'date_range': {'start': datetime.datetime(2022, 5, 27, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('30'), 'clicks': Decimal('30')}}
2025-01-22 15:03:25,772 - [INFO] - 
Load Summary:
2025-01-22 15:03:25,772 - [INFO] - Total files processed: 2
2025-01-22 15:03:25,772 - [INFO] - Total rows loaded: 48
2025-01-22 15:03:25,772 - [INFO] - 
Date Range:
2025-01-22 15:03:25,772 - [INFO] -   Start: 2022-05-27 00:00:00
2025-01-22 15:03:25,772 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 15:03:25,772 - [INFO] - 
Total Counts:
2025-01-22 15:03:25,772 - [INFO] -   Impressions: 30
2025-01-22 15:03:25,772 - [INFO] -   Clicks: 30
2025-01-22 15:03:25,772 - [INFO] - 
Client report loading completed successfully
2025-01-22 15:03:25,772 - [INFO] - Processing and loading completed successfully
2025-01-22 15:03:26,938 - [INFO] - Spark Session stopped
2025-01-22 15:05:04,340 - [INFO] - Starting application...
2025-01-22 15:05:04,401 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 15:05:30,454 - [INFO] - Spark Session created successfully
2025-01-22 15:05:30,455 - [INFO] - Spark version: 3.5.4
2025-01-22 15:05:30,455 - [INFO] - Spark master: local[*]
2025-01-22 15:05:30,455 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 15:05:30,455 - [INFO] - Starting file processing...
2025-01-22 15:05:30,455 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 15:05:30,455 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 15:05:30,455 - [INFO] - User agent filter: some user agent
2025-01-22 15:05:30,455 - [INFO] - Found 11 total parquet files
2025-01-22 15:05:30,455 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 15:05:30,455 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 15:05:35,638 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:05:36,079 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 15:05:37,857 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:05:38,712 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:05:39,134 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:05:44,016 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 15:05:44,017 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 15:05:44,017 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:05:44,018 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 15:05:44,018 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 15:05:44,287 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:05:44,487 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 15:05:45,668 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 37.0 failed 1 times, most recent failure: Lost task 0.0 in stage 37.0 (TID 36) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-22 15:05:45,669 - [WARNING] - Failed to process data for date: 2022-05-27 - An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 37.0 failed 1 times, most recent failure: Lost task 0.0 in stage 37.0 (TID 36) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:123)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-22 15:05:45,669 - [INFO] - Successfully processed 1 dates
2025-01-22 15:05:45,669 - [INFO] - Starting client report loading process...
2025-01-22 15:05:45,669 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 15:05:45,671 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:05:45,677 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:05:45,681 - [INFO] - Archived 0 unique rows
2025-01-22 15:05:45,714 - [ERROR] - Error loading data: (sqlalchemy.exc.InvalidRequestError) A value is required for bind parameter 'min_date'
[SQL: SELECT COUNT(*) FROM adform_dw.client_report  WHERE datetime BETWEEN %(min_date)s AND %(max_date)s;]
(Background on this error at: https://sqlalche.me/e/14/cd3x)
2025-01-22 15:05:45,714 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: (sqlalchemy.exc.InvalidRequestError) A value is required for bind parameter 'min_date'
[SQL: SELECT COUNT(*) FROM adform_dw.client_report  WHERE datetime BETWEEN %(min_date)s AND %(max_date)s;]
(Background on this error at: https://sqlalche.me/e/14/cd3x)
2025-01-22 15:05:45,714 - [ERROR] - Processing or loading failed
2025-01-22 15:05:46,300 - [INFO] - Spark Session stopped
2025-01-22 15:11:29,430 - [INFO] - Starting application...
2025-01-22 15:11:29,490 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 15:11:45,148 - [INFO] - Spark Session created successfully
2025-01-22 15:11:45,148 - [INFO] - Spark version: 3.5.4
2025-01-22 15:11:45,148 - [INFO] - Spark master: local[*]
2025-01-22 15:11:45,148 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 15:11:45,148 - [INFO] - Starting file processing...
2025-01-22 15:11:45,149 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 15:11:45,149 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 15:11:45,149 - [INFO] - User agent filter: some user agent
2025-01-22 15:11:45,150 - [INFO] - Found 11 total parquet files
2025-01-22 15:11:45,150 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 15:11:45,150 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 15:11:50,747 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:11:51,251 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 15:11:53,188 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:11:54,075 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:11:54,510 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:11:59,669 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 15:11:59,670 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 15:11:59,670 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:11:59,671 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 15:11:59,671 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 15:11:59,945 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:12:00,121 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 15:12:01,309 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:12:01,727 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 15:12:01,946 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 15:12:02,229 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 15:12:02,387 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 15:12:03,851 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:12:04,288 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:12:04,535 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:12:08,646 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 15:12:09,427 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 15:12:09,428 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 15:12:09,429 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:12:09,429 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 15:12:09,430 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 15:12:09,430 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:12:09,431 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 15:12:09,431 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 15:12:09,432 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 15:12:09,432 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 15:12:09,432 - [INFO] - Successfully processed 2 dates
2025-01-22 15:12:09,432 - [INFO] - Starting client report loading process...
2025-01-22 15:12:09,433 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 15:12:09,435 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:12:09,441 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:12:09,445 - [INFO] - Archived 0 unique rows
2025-01-22 15:12:09,458 - [INFO] - Successfully loaded 48 rows
2025-01-22 15:12:09,464 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 15:12:09,464 - [INFO] - - Archived rows: 0
2025-01-22 15:12:09,464 - [INFO] - - Loaded rows: 48
2025-01-22 15:12:09,464 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 15:12:09,466 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:12:09,470 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:12:09,473 - [INFO] - Archived 0 unique rows
2025-01-22 15:12:09,483 - [INFO] - Successfully loaded 48 rows
2025-01-22 15:12:09,487 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 15:12:09,487 - [INFO] - - Archived rows: 0
2025-01-22 15:12:09,487 - [INFO] - - Loaded rows: 48
2025-01-22 15:12:09,487 - [INFO] - 
Verifying data load...
2025-01-22 15:12:09,493 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-22 15:12:09,494 - [INFO] - 
Load Summary:
2025-01-22 15:12:09,494 - [INFO] - Total files processed: 2
2025-01-22 15:12:09,494 - [INFO] - Total rows loaded: 96
2025-01-22 15:12:09,494 - [INFO] - 
Date Range:
2025-01-22 15:12:09,494 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-22 15:12:09,494 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 15:12:09,495 - [INFO] - 
Total Counts:
2025-01-22 15:12:09,495 - [INFO] -   Impressions: 44
2025-01-22 15:12:09,495 - [INFO] -   Clicks: 30
2025-01-22 15:12:09,495 - [INFO] - 
Client report loading completed successfully
2025-01-22 15:12:09,495 - [INFO] - Processing and loading completed successfully
2025-01-22 15:12:10,644 - [INFO] - Spark Session stopped
2025-01-22 15:26:18,525 - [INFO] - Starting application...
2025-01-22 15:26:18,586 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 15:26:45,118 - [INFO] - Spark Session created successfully
2025-01-22 15:26:45,119 - [INFO] - Spark version: 3.5.4
2025-01-22 15:26:45,119 - [INFO] - Spark master: local[*]
2025-01-22 15:26:45,119 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 15:26:45,119 - [INFO] - Starting file processing...
2025-01-22 15:26:45,119 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 15:26:45,119 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 15:26:45,119 - [INFO] - User agent filter: some user agent
2025-01-22 15:26:45,120 - [INFO] - Found 11 total parquet files
2025-01-22 15:26:45,120 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 15:26:45,120 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 15:26:50,345 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:26:50,848 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 15:26:52,815 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:26:53,683 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:26:54,087 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:26:59,174 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 15:26:59,175 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 15:26:59,176 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:26:59,176 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 15:26:59,176 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 15:26:59,523 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:26:59,767 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 15:27:01,024 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:27:01,489 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 15:27:01,744 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 15:27:02,072 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 15:27:02,242 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 15:27:03,647 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:27:04,101 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:27:04,356 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:27:08,313 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 15:27:09,058 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 15:27:09,059 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 15:27:09,060 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:27:09,060 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 15:27:09,061 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 15:27:09,061 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:27:09,062 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 15:27:09,062 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 15:27:09,063 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 15:27:09,063 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 15:27:09,063 - [INFO] - Successfully processed 2 dates
2025-01-22 15:27:09,063 - [INFO] - Starting client report loading process...
2025-01-22 15:27:09,064 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 15:27:09,066 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:27:09,078 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:27:09,082 - [INFO] - Archived 0 unique rows
2025-01-22 15:27:09,098 - [INFO] - Successfully loaded 48 rows
2025-01-22 15:27:09,104 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 15:27:09,104 - [INFO] - - Archived rows: 0
2025-01-22 15:27:09,104 - [INFO] - - Loaded rows: 48
2025-01-22 15:27:09,104 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 15:27:09,107 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:27:09,113 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:27:09,116 - [INFO] - Archived 0 unique rows
2025-01-22 15:27:09,123 - [INFO] - Successfully loaded 48 rows
2025-01-22 15:27:09,126 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 15:27:09,127 - [INFO] - - Archived rows: 0
2025-01-22 15:27:09,127 - [INFO] - - Loaded rows: 48
2025-01-22 15:27:09,127 - [INFO] - 
Verifying data load...
2025-01-22 15:27:09,131 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-22 15:27:09,132 - [INFO] - 
Load Summary:
2025-01-22 15:27:09,132 - [INFO] - Total files processed: 2
2025-01-22 15:27:09,132 - [INFO] - Total rows loaded: 96
2025-01-22 15:27:09,132 - [INFO] - 
Date Range:
2025-01-22 15:27:09,132 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-22 15:27:09,132 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 15:27:09,132 - [INFO] - 
Total Counts:
2025-01-22 15:27:09,132 - [INFO] -   Impressions: 44
2025-01-22 15:27:09,132 - [INFO] -   Clicks: 30
2025-01-22 15:27:09,132 - [INFO] - 
Client report loading completed successfully
2025-01-22 15:27:09,132 - [INFO] - Processing and loading completed successfully
2025-01-22 15:27:10,313 - [INFO] - Spark Session stopped
2025-01-22 15:31:29,801 - [INFO] - Starting application...
2025-01-22 15:31:29,866 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 15:31:34,801 - [INFO] - Spark Session created successfully
2025-01-22 15:31:34,801 - [INFO] - Spark version: 3.5.4
2025-01-22 15:31:34,801 - [INFO] - Spark master: local[*]
2025-01-22 15:31:34,801 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 15:31:34,801 - [INFO] - Starting file processing...
2025-01-22 15:31:34,801 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 15:31:34,801 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 15:31:34,802 - [INFO] - User agent filter: some user agent
2025-01-22 15:31:34,802 - [INFO] - Found 11 total parquet files
2025-01-22 15:31:34,803 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 15:31:34,803 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 15:31:41,142 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:31:41,604 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 15:31:43,344 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:31:44,259 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:31:44,713 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:31:49,927 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 15:31:49,928 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 15:31:49,928 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:31:49,929 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 15:31:49,929 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 15:31:50,211 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:31:50,439 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 15:31:51,566 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:31:52,320 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 15:31:52,703 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 15:31:53,120 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 15:31:53,290 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 15:31:55,386 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:31:56,031 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:31:56,355 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:32:00,703 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 15:32:01,472 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 15:32:01,473 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 15:32:01,473 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:32:01,474 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 15:32:01,474 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 15:32:01,474 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:32:01,475 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 15:32:01,475 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 15:32:01,476 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 15:32:01,476 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 15:32:01,476 - [INFO] - Successfully processed 2 dates
2025-01-22 15:32:01,476 - [INFO] - Starting client report loading process...
2025-01-22 15:32:01,476 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 15:32:01,478 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:32:01,487 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:32:01,490 - [INFO] - Archived 0 unique rows
2025-01-22 15:32:01,505 - [INFO] - Successfully loaded 48 rows
2025-01-22 15:32:01,512 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 15:32:01,512 - [INFO] - - Archived rows: 0
2025-01-22 15:32:01,512 - [INFO] - - Loaded rows: 48
2025-01-22 15:32:01,512 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 15:32:01,515 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:32:01,521 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:32:01,523 - [INFO] - Archived 0 unique rows
2025-01-22 15:32:01,533 - [INFO] - Successfully loaded 48 rows
2025-01-22 15:32:01,538 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 15:32:01,539 - [INFO] - - Archived rows: 0
2025-01-22 15:32:01,539 - [INFO] - - Loaded rows: 48
2025-01-22 15:32:01,539 - [INFO] - 
Verifying data load...
2025-01-22 15:32:01,544 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-22 15:32:01,545 - [INFO] - 
Load Summary:
2025-01-22 15:32:01,545 - [INFO] - Total files processed: 2
2025-01-22 15:32:01,545 - [INFO] - Total rows loaded: 96
2025-01-22 15:32:01,545 - [INFO] - 
Date Range:
2025-01-22 15:32:01,545 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-22 15:32:01,545 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 15:32:01,545 - [INFO] - 
Total Counts:
2025-01-22 15:32:01,545 - [INFO] -   Impressions: 44
2025-01-22 15:32:01,545 - [INFO] -   Clicks: 30
2025-01-22 15:32:01,545 - [INFO] - 
Client report loading completed successfully
2025-01-22 15:32:01,545 - [INFO] - Processing and loading completed successfully
2025-01-22 15:32:02,716 - [INFO] - Spark Session stopped
2025-01-22 15:38:06,778 - [INFO] - Starting application...
2025-01-22 15:38:06,842 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 15:38:32,943 - [INFO] - Spark Session created successfully
2025-01-22 15:38:32,943 - [INFO] - Spark version: 3.5.4
2025-01-22 15:38:32,943 - [INFO] - Spark master: local[*]
2025-01-22 15:38:32,943 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 15:38:32,943 - [INFO] - Starting file processing...
2025-01-22 15:38:32,944 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 15:38:32,944 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 15:38:32,944 - [INFO] - User agent filter: some user agent
2025-01-22 15:38:32,945 - [INFO] - Found 11 total parquet files
2025-01-22 15:38:32,945 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 15:38:32,945 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 15:38:38,542 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:38:39,019 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 15:38:40,963 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:38:41,927 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:38:42,377 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 15:38:47,369 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 15:38:47,370 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 15:38:47,371 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 15:38:47,371 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 15:38:47,371 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 15:38:47,629 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 15:38:47,795 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 15:38:48,941 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:38:49,395 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 15:38:49,589 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 15:38:49,835 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 15:38:50,046 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 15:38:51,479 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:38:51,917 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:38:52,150 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 15:38:56,162 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 15:38:56,947 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 15:38:56,948 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 15:38:56,948 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 15:38:56,949 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 15:38:56,949 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 15:38:56,950 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 15:38:56,950 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 15:38:56,951 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 15:38:56,951 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 15:38:56,951 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 15:38:56,951 - [INFO] - Successfully processed 2 dates
2025-01-22 15:38:56,951 - [INFO] - Starting client report loading process...
2025-01-22 15:38:56,952 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 15:38:56,954 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:38:56,960 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:38:56,965 - [INFO] - Archived 0 unique rows
2025-01-22 15:38:56,979 - [INFO] - Successfully loaded 48 rows
2025-01-22 15:38:56,985 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 15:38:56,985 - [INFO] - - Archived rows: 0
2025-01-22 15:38:56,985 - [INFO] - - Loaded rows: 48
2025-01-22 15:38:56,986 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 15:38:56,996 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 15:38:57,002 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 15:38:57,005 - [INFO] - Archived 0 unique rows
2025-01-22 15:38:57,012 - [INFO] - Successfully loaded 48 rows
2025-01-22 15:38:57,017 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 15:38:57,017 - [INFO] - - Archived rows: 0
2025-01-22 15:38:57,017 - [INFO] - - Loaded rows: 48
2025-01-22 15:38:57,017 - [INFO] - 
Verifying data load...
2025-01-22 15:38:57,021 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-22 15:38:57,022 - [INFO] - 
Load Summary:
2025-01-22 15:38:57,022 - [INFO] - Total files processed: 2
2025-01-22 15:38:57,022 - [INFO] - Total rows loaded: 96
2025-01-22 15:38:57,022 - [INFO] - 
Date Range:
2025-01-22 15:38:57,022 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-22 15:38:57,022 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 15:38:57,022 - [INFO] - 
Total Counts:
2025-01-22 15:38:57,023 - [INFO] -   Impressions: 44
2025-01-22 15:38:57,023 - [INFO] -   Clicks: 30
2025-01-22 15:38:57,023 - [INFO] - 
Client report loading completed successfully
2025-01-22 15:38:57,023 - [INFO] - Processing and loading completed successfully
2025-01-22 15:38:58,159 - [INFO] - Spark Session stopped
2025-01-22 16:03:48,119 - [INFO] - Starting application...
2025-01-22 16:03:52,247 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 16:03:52,247 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 253, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 50, in __init__
    self._ensure_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 55, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 16:05:31,834 - [INFO] - Starting application...
2025-01-22 16:05:31,927 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 16:06:07,607 - [INFO] - Spark Session created successfully
2025-01-22 16:06:07,607 - [INFO] - Spark version: 3.5.4
2025-01-22 16:06:07,607 - [INFO] - Spark master: local[*]
2025-01-22 16:06:07,608 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 16:06:07,608 - [INFO] - Starting file processing...
2025-01-22 16:06:07,608 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 16:06:07,608 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 16:06:07,608 - [INFO] - User agent filter: some user agent
2025-01-22 16:06:07,608 - [WARNING] - No parquet files found in input directory
2025-01-22 16:06:07,608 - [ERROR] - Spark processing failed
2025-01-22 16:06:07,608 - [ERROR] - Processing or loading failed
2025-01-22 16:06:07,933 - [INFO] - Spark Session stopped
2025-01-22 16:07:09,015 - [INFO] - Starting application...
2025-01-22 16:07:13,124 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 16:07:13,124 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 254, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 50, in __init__
    self._ensure_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 55, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "c:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-22 16:10:47,420 - [INFO] - Starting application...
2025-01-22 16:10:47,480 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 16:10:52,066 - [INFO] - Spark Session created successfully
2025-01-22 16:10:52,066 - [INFO] - Spark version: 3.5.4
2025-01-22 16:10:52,066 - [INFO] - Spark master: local[*]
2025-01-22 16:10:52,067 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 16:10:52,067 - [INFO] - Starting file processing...
2025-01-22 16:10:52,067 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 16:10:52,067 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 16:10:52,067 - [INFO] - User agent filter: some user agent
2025-01-22 16:10:52,068 - [INFO] - Found 11 total parquet files
2025-01-22 16:10:52,068 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 16:10:52,068 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 16:10:57,499 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 16:10:57,955 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 16:10:59,732 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 16:11:01,145 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 16:11:01,714 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 16:11:07,066 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 16:11:07,067 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 16:11:07,068 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 16:11:07,068 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 16:11:07,068 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 16:11:07,357 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 16:11:07,512 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 16:11:08,617 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 16:11:09,103 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 16:11:09,326 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 16:11:09,621 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 16:11:09,840 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 16:11:11,137 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 16:11:11,670 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 16:11:11,920 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 16:11:15,803 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 16:11:16,607 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 16:11:16,607 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 16:11:16,607 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 16:11:16,608 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 16:11:16,608 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 16:11:16,609 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 16:11:16,609 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 16:11:16,609 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 16:11:16,610 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 16:11:16,610 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 16:11:16,610 - [INFO] - Successfully processed 2 dates
2025-01-22 16:11:16,610 - [INFO] - Starting client report loading process...
2025-01-22 16:11:16,610 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 16:11:16,620 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 16:11:16,627 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 16:11:16,630 - [INFO] - Archived 0 unique rows
2025-01-22 16:11:16,646 - [INFO] - Successfully loaded 48 rows
2025-01-22 16:11:16,651 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 16:11:16,651 - [INFO] - - Archived rows: 0
2025-01-22 16:11:16,651 - [INFO] - - Loaded rows: 48
2025-01-22 16:11:16,651 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 16:11:16,662 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 16:11:16,669 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 16:11:16,673 - [INFO] - Archived 0 unique rows
2025-01-22 16:11:16,683 - [INFO] - Successfully loaded 48 rows
2025-01-22 16:11:16,688 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 16:11:16,688 - [INFO] - - Archived rows: 0
2025-01-22 16:11:16,688 - [INFO] - - Loaded rows: 48
2025-01-22 16:11:16,688 - [INFO] - 
Verifying data load...
2025-01-22 16:11:16,693 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-22 16:11:16,695 - [INFO] - 
Load Summary:
2025-01-22 16:11:16,695 - [INFO] - Total files processed: 2
2025-01-22 16:11:16,695 - [INFO] - Total rows loaded: 96
2025-01-22 16:11:16,695 - [INFO] - 
Date Range:
2025-01-22 16:11:16,695 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-22 16:11:16,695 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 16:11:16,695 - [INFO] - 
Total Counts:
2025-01-22 16:11:16,695 - [INFO] -   Impressions: 44
2025-01-22 16:11:16,695 - [INFO] -   Clicks: 30
2025-01-22 16:11:16,695 - [INFO] - 
Client report loading completed successfully
2025-01-22 16:11:16,695 - [INFO] - Processing and loading completed successfully
2025-01-22 16:11:17,805 - [INFO] - Spark Session stopped
2025-01-22 21:01:17,200 - [INFO] - Starting application...
2025-01-22 21:01:17,264 - [ERROR] - Critical error during execution: 'ClientReportETL' object has no attribute 'logger'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 254, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 46, in __init__
    self._ensure_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 92, in _ensure_schema
    self.logger.info(
    ^^^^^^^^^^^
AttributeError: 'ClientReportETL' object has no attribute 'logger'
2025-01-22 21:06:43,194 - [INFO] - Starting application...
2025-01-22 21:06:43,285 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 21:07:19,410 - [INFO] - Spark Session created successfully
2025-01-22 21:07:19,411 - [INFO] - Spark version: 3.5.4
2025-01-22 21:07:19,411 - [INFO] - Spark master: local[*]
2025-01-22 21:07:19,411 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 21:07:19,411 - [INFO] - Starting file processing...
2025-01-22 21:07:19,411 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 21:07:19,411 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 21:07:19,411 - [INFO] - User agent filter: some user agent
2025-01-22 21:07:19,412 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet: unconverted data remains: 80
2025-01-22 21:07:19,412 - [ERROR] - Error processing filename clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet: unconverted data remains: 80
2025-01-22 21:07:19,412 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet: unconverted data remains: 23
2025-01-22 21:07:19,412 - [ERROR] - Error processing filename clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet: unconverted data remains: 23
2025-01-22 21:07:19,412 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet: unconverted data remains: 24
2025-01-22 21:07:19,412 - [ERROR] - Error processing filename clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet: unconverted data remains: 24
2025-01-22 21:07:19,412 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet: unconverted data remains: 81
2025-01-22 21:07:19,412 - [ERROR] - Error processing filename clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet: unconverted data remains: 81
2025-01-22 21:07:19,412 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet: unconverted data remains: 81
2025-01-22 21:07:19,412 - [ERROR] - Error processing filename clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet: unconverted data remains: 81
2025-01-22 21:07:19,413 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet: unconverted data remains: 24
2025-01-22 21:07:19,413 - [ERROR] - Error processing filename clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet: unconverted data remains: 24
2025-01-22 21:07:19,413 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet: unconverted data remains: 63
2025-01-22 21:07:19,413 - [ERROR] - Error processing filename impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet: unconverted data remains: 63
2025-01-22 21:07:19,413 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet: unconverted data remains: 39
2025-01-22 21:07:19,413 - [ERROR] - Error processing filename impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet: unconverted data remains: 39
2025-01-22 21:07:19,413 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet: unconverted data remains: 70
2025-01-22 21:07:19,413 - [ERROR] - Error processing filename impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet: unconverted data remains: 70
2025-01-22 21:07:19,413 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet: unconverted data remains: 55
2025-01-22 21:07:19,413 - [ERROR] - Error processing filename impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet: unconverted data remains: 55
2025-01-22 21:07:19,413 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet: unconverted data remains: 88
2025-01-22 21:07:19,413 - [ERROR] - Error processing filename impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet: unconverted data remains: 88
2025-01-22 21:07:19,413 - [INFO] - Found 11 total parquet files
2025-01-22 21:07:19,413 - [INFO] - Impressions files by date: 
2025-01-22 21:07:19,413 - [INFO] - Clicks files by date: 
2025-01-22 21:07:19,413 - [ERROR] - No dates were successfully processed
2025-01-22 21:07:19,413 - [ERROR] - Spark processing failed
2025-01-22 21:07:19,413 - [ERROR] - Processing or loading failed
2025-01-22 21:07:19,761 - [INFO] - Spark Session stopped
2025-01-22 21:10:04,812 - [INFO] - Starting application...
2025-01-22 21:10:04,871 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 21:10:09,802 - [INFO] - Spark Session created successfully
2025-01-22 21:10:09,802 - [INFO] - Spark version: 3.5.4
2025-01-22 21:10:09,802 - [INFO] - Spark master: local[*]
2025-01-22 21:10:09,802 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 21:10:09,802 - [INFO] - Starting file processing...
2025-01-22 21:10:09,802 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 21:10:09,802 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 21:10:09,802 - [INFO] - User agent filter: some user agent
2025-01-22 21:10:09,803 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet: unconverted data remains: 80
2025-01-22 21:10:09,803 - [ERROR] - Error processing filename clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet: unconverted data remains: 80
2025-01-22 21:10:09,803 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet: unconverted data remains: 23
2025-01-22 21:10:09,803 - [ERROR] - Error processing filename clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet: unconverted data remains: 23
2025-01-22 21:10:09,803 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet: unconverted data remains: 24
2025-01-22 21:10:09,803 - [ERROR] - Error processing filename clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet: unconverted data remains: 24
2025-01-22 21:10:09,803 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet: unconverted data remains: 81
2025-01-22 21:10:09,803 - [ERROR] - Error processing filename clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet: unconverted data remains: 81
2025-01-22 21:10:09,804 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet: unconverted data remains: 81
2025-01-22 21:10:09,804 - [ERROR] - Error processing filename clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet: unconverted data remains: 81
2025-01-22 21:10:09,804 - [ERROR] - Error extracting date from filename clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet: unconverted data remains: 24
2025-01-22 21:10:09,804 - [ERROR] - Error processing filename clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet: unconverted data remains: 24
2025-01-22 21:10:09,804 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet: unconverted data remains: 63
2025-01-22 21:10:09,804 - [ERROR] - Error processing filename impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet: unconverted data remains: 63
2025-01-22 21:10:09,804 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet: unconverted data remains: 39
2025-01-22 21:10:09,804 - [ERROR] - Error processing filename impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet: unconverted data remains: 39
2025-01-22 21:10:09,804 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet: unconverted data remains: 70
2025-01-22 21:10:09,804 - [ERROR] - Error processing filename impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet: unconverted data remains: 70
2025-01-22 21:10:09,804 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet: unconverted data remains: 55
2025-01-22 21:10:09,804 - [ERROR] - Error processing filename impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet: unconverted data remains: 55
2025-01-22 21:10:09,804 - [ERROR] - Error extracting date from filename impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet: unconverted data remains: 88
2025-01-22 21:10:09,804 - [ERROR] - Error processing filename impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet: unconverted data remains: 88
2025-01-22 21:10:09,804 - [INFO] - Found 11 total parquet files
2025-01-22 21:10:09,804 - [INFO] - Impressions files by date: 
2025-01-22 21:10:09,804 - [INFO] - Clicks files by date: 
2025-01-22 21:10:09,804 - [ERROR] - No dates were successfully processed
2025-01-22 21:10:09,804 - [ERROR] - Spark processing failed
2025-01-22 21:10:09,804 - [ERROR] - Processing or loading failed
2025-01-22 21:10:10,154 - [INFO] - Spark Session stopped
2025-01-22 21:11:37,207 - [INFO] - Starting application...
2025-01-22 21:11:37,279 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 21:12:03,831 - [INFO] - Spark Session created successfully
2025-01-22 21:12:03,832 - [INFO] - Spark version: 3.5.4
2025-01-22 21:12:03,832 - [INFO] - Spark master: local[*]
2025-01-22 21:12:03,832 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 21:12:03,832 - [INFO] - Starting file processing...
2025-01-22 21:12:03,832 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 21:12:03,832 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 21:12:03,832 - [INFO] - User agent filter: some user agent
2025-01-22 21:12:03,833 - [INFO] - Found 11 total parquet files
2025-01-22 21:12:03,833 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 21:12:03,833 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 21:12:09,107 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 21:12:09,578 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 21:12:10,182 - [ERROR] - Error processing files for date '2022-05-26': 'list' object has no attribute 'isEmpty'
2025-01-22 21:12:10,182 - [WARNING] - Failed to process data for date: 2022-05-26 - 'list' object has no attribute 'isEmpty'
2025-01-22 21:12:10,490 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 21:12:10,684 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 21:12:10,945 - [ERROR] - Error processing files for date '2022-05-27': 'list' object has no attribute 'isEmpty'
2025-01-22 21:12:10,945 - [WARNING] - Failed to process data for date: 2022-05-27 - 'list' object has no attribute 'isEmpty'
2025-01-22 21:12:10,945 - [ERROR] - No dates were successfully processed
2025-01-22 21:12:10,945 - [ERROR] - Spark processing failed
2025-01-22 21:12:10,945 - [ERROR] - Processing or loading failed
2025-01-22 21:12:11,286 - [INFO] - Spark Session stopped
2025-01-22 21:16:47,691 - [INFO] - Starting application...
2025-01-22 21:16:47,773 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 21:17:14,928 - [INFO] - Spark Session created successfully
2025-01-22 21:17:14,929 - [INFO] - Spark version: 3.5.4
2025-01-22 21:17:14,929 - [INFO] - Spark master: local[*]
2025-01-22 21:17:14,929 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 21:17:14,929 - [INFO] - Starting file processing...
2025-01-22 21:17:14,929 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 21:17:14,929 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 21:17:14,929 - [INFO] - User agent filter: some user agent
2025-01-22 21:17:14,930 - [INFO] - Found 11 total parquet files
2025-01-22 21:17:14,930 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 21:17:14,930 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 21:17:21,754 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 21:17:22,359 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 21:17:24,105 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 21:17:24,572 - [INFO] - Found 0 records with invalid hours
2025-01-22 21:17:25,007 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 21:17:25,381 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-22 21:17:25,597 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 21:17:30,331 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 21:17:30,332 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 21:17:30,332 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 21:17:30,332 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 21:17:30,332 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 21:17:30,606 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 21:17:30,738 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 21:17:31,829 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 21:17:32,083 - [INFO] - Found 0 records with invalid hours
2025-01-22 21:17:32,276 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 21:17:32,464 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-22 21:17:32,654 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 21:17:33,088 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 21:17:33,235 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 21:17:34,599 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 21:17:34,813 - [INFO] - Found 0 records with invalid hours
2025-01-22 21:17:34,991 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 21:17:35,303 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-22 21:17:35,474 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 21:17:39,394 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 21:17:40,103 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 21:17:40,104 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 21:17:40,104 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 21:17:40,105 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 21:17:40,105 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 21:17:40,106 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 21:17:40,107 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 21:17:40,107 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 21:17:40,108 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 21:17:40,108 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 21:17:40,108 - [INFO] - Successfully processed 2 dates
2025-01-22 21:17:40,108 - [INFO] - Starting client report loading process...
2025-01-22 21:17:40,109 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 21:17:40,110 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 21:17:40,118 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 21:17:40,123 - [INFO] - Archived 0 unique rows
2025-01-22 21:17:40,136 - [INFO] - Successfully loaded 48 rows
2025-01-22 21:17:40,142 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 21:17:40,142 - [INFO] - - Archived rows: 0
2025-01-22 21:17:40,142 - [INFO] - - Loaded rows: 48
2025-01-22 21:17:40,142 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 21:17:40,150 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 21:17:40,155 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 21:17:40,158 - [INFO] - Archived 0 unique rows
2025-01-22 21:17:40,166 - [INFO] - Successfully loaded 48 rows
2025-01-22 21:17:40,170 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 21:17:40,170 - [INFO] - - Archived rows: 0
2025-01-22 21:17:40,170 - [INFO] - - Loaded rows: 48
2025-01-22 21:17:40,170 - [INFO] - 
Verifying data load...
2025-01-22 21:17:40,175 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-22 21:17:40,176 - [INFO] - 
Load Summary:
2025-01-22 21:17:40,176 - [INFO] - Total files processed: 2
2025-01-22 21:17:40,176 - [INFO] - Total rows loaded: 96
2025-01-22 21:17:40,176 - [INFO] - 
Date Range:
2025-01-22 21:17:40,176 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-22 21:17:40,176 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 21:17:40,176 - [INFO] - 
Total Counts:
2025-01-22 21:17:40,176 - [INFO] -   Impressions: 44
2025-01-22 21:17:40,176 - [INFO] -   Clicks: 30
2025-01-22 21:17:40,176 - [INFO] - 
Client report loading completed successfully
2025-01-22 21:17:40,176 - [INFO] - Processing and loading completed successfully
2025-01-22 21:17:40,395 - [INFO] - Spark Session stopped
2025-01-22 23:08:48,096 - AdformETLLogger - INFO - Starting application...
2025-01-22 23:08:48,163 - AdformETLLogger - INFO - Database schema and tables verified/created successfully
2025-01-22 23:10:05,816 - AdformETLLogger - ERROR - Critical error during execution: [WinError 3] The system cannot find the path specified: 'C:\\Users\\Rokas\\AppData\\Local\\Temp\\tmphrtnorhg'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\java_gateway.py", line 104, in launch_gateway
    time.sleep(0.1)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 259, in main
    spark = create_spark_session()
            ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 115, in create_spark_session
    .getOrCreate()
     ^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\sql\session.py", line 497, in getOrCreate
    sc = SparkContext.getOrCreate(sparkConf)
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 515, in getOrCreate
    SparkContext(conf=conf or SparkConf())
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 201, in __init__
    SparkContext._ensure_initialized(self, gateway=gateway, conf=conf)
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\context.py", line 436, in _ensure_initialized
    SparkContext._gateway = gateway or launch_gateway(conf)
                                       ^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\pyspark\java_gateway.py", line 116, in launch_gateway
    shutil.rmtree(conn_info_dir)
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 787, in rmtree
    return _rmtree_unsafe(path, onerror)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 615, in _rmtree_unsafe
    onerror(os.scandir, path, sys.exc_info())
  File "C:\Users\Rokas\AppData\Local\Programs\Python\Python311\Lib\shutil.py", line 612, in _rmtree_unsafe
    with os.scandir(path) as scandir_it:
         ^^^^^^^^^^^^^^^^
FileNotFoundError: [WinError 3] The system cannot find the path specified: 'C:\\Users\\Rokas\\AppData\\Local\\Temp\\tmphrtnorhg'
2025-01-22 23:10:11,824 - [INFO] - Starting application...
2025-01-22 23:10:11,903 - [INFO] - Database schema and tables verified/created successfully
2025-01-22 23:10:38,829 - [INFO] - Spark Session created successfully
2025-01-22 23:10:38,830 - [INFO] - Spark version: 3.5.4
2025-01-22 23:10:38,830 - [INFO] - Spark master: local[*]
2025-01-22 23:10:38,830 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-22 23:10:38,830 - [INFO] - Starting file processing...
2025-01-22 23:10:38,830 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-22 23:10:38,830 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-22 23:10:38,830 - [INFO] - User agent filter: some user agent
2025-01-22 23:10:38,831 - [INFO] - Found 11 total parquet files
2025-01-22 23:10:38,831 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-22 23:10:38,831 - [INFO] - Clicks files by date: 2022-05-27
2025-01-22 23:10:44,565 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 23:10:44,991 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-22 23:10:46,715 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 23:10:47,190 - [INFO] - Found 0 records with invalid hours
2025-01-22 23:10:47,623 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 23:10:47,999 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-22 23:10:48,242 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-22 23:10:53,153 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-22 23:10:53,153 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-22 23:10:53,154 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-22 23:10:53,154 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-22 23:10:53,155 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-22 23:10:53,456 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-22 23:10:53,591 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-22 23:10:54,770 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 23:10:55,010 - [INFO] - Found 0 records with invalid hours
2025-01-22 23:10:55,204 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-22 23:10:55,405 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-22 23:10:55,592 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-22 23:10:55,860 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-22 23:10:56,002 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-22 23:10:57,317 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 23:10:57,649 - [INFO] - Found 0 records with invalid hours
2025-01-22 23:10:57,825 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 23:10:58,028 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-22 23:10:58,186 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-22 23:11:02,016 - [WARNING] - Found records where clicks exceed impressions:
2025-01-22 23:11:02,788 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-22 23:11:02,790 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-22 23:11:02,792 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-22 23:11:02,794 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-22 23:11:02,796 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-22 23:11:02,798 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-22 23:11:02,799 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-22 23:11:02,800 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-22 23:11:02,801 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-22 23:11:02,802 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-22 23:11:02,802 - [INFO] - Successfully processed 2 dates
2025-01-22 23:11:02,802 - [INFO] - Starting client report loading process...
2025-01-22 23:11:02,804 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-22 23:11:02,807 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 23:11:02,823 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 23:11:02,830 - [INFO] - Archived 0 unique rows
2025-01-22 23:11:02,855 - [INFO] - Successfully loaded 48 rows
2025-01-22 23:11:02,862 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-22 23:11:02,862 - [INFO] - - Archived rows: 0
2025-01-22 23:11:02,862 - [INFO] - - Loaded rows: 48
2025-01-22 23:11:02,862 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-22 23:11:02,865 - [INFO] - Read CSV with shape: (24, 4)
2025-01-22 23:11:02,873 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-22 23:11:02,877 - [INFO] - Archived 0 unique rows
2025-01-22 23:11:02,889 - [INFO] - Successfully loaded 48 rows
2025-01-22 23:11:02,894 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-22 23:11:02,894 - [INFO] - - Archived rows: 0
2025-01-22 23:11:02,894 - [INFO] - - Loaded rows: 48
2025-01-22 23:11:02,894 - [INFO] - 
Verifying data load...
2025-01-22 23:11:02,901 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-22 23:11:02,903 - [INFO] - 
Load Summary:
2025-01-22 23:11:02,903 - [INFO] - Total files processed: 2
2025-01-22 23:11:02,903 - [INFO] - Total rows loaded: 96
2025-01-22 23:11:02,903 - [INFO] - 
Date Range:
2025-01-22 23:11:02,903 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-22 23:11:02,903 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-22 23:11:02,903 - [INFO] - 
Total Counts:
2025-01-22 23:11:02,903 - [INFO] -   Impressions: 44
2025-01-22 23:11:02,903 - [INFO] -   Clicks: 30
2025-01-22 23:11:02,903 - [INFO] - 
Client report loading completed successfully
2025-01-22 23:11:02,903 - [INFO] - Processing and loading completed successfully
2025-01-22 23:11:04,045 - [INFO] - Spark Session stopped
2025-01-23 12:04:43,836 - [INFO] - Starting application...
2025-01-23 12:04:43,886 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:04:43,886 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 254, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 48, in __init__
    self._ensure_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 53, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:40:08,992 - [INFO] - Starting application...
2025-01-23 12:40:09,037 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:40:09,038 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 254, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 48, in __init__
    self._ensure_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 53, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:41:00,001 - [INFO] - Starting application...
2025-01-23 12:41:00,047 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:41:00,047 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 254, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 48, in __init__
    self._ensure_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 53, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:42:51,061 - [INFO] - Starting application...
2025-01-23 12:42:51,107 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:42:51,107 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 254, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 48, in __init__
    self._ensure_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 53, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:46:04,309 - [INFO] - Starting application...
2025-01-23 12:46:04,358 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:46:04,358 - [ERROR] - Critical error during execution: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
psycopg2.OperationalError: connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 254, in main
    etl = ClientReportETL(warehouse_connection, logger)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 48, in __init__
    self._ensure_schema()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\src\etl\warehouse.py", line 53, in _ensure_schema
    with self.engine.begin() as conn:
         ^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3143, in begin
    conn = self.connect(close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3315, in connect
    return self._connection_cls(self, close_with_result=close_with_result)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 96, in __init__
    else engine.raw_connection()
         ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3394, in raw_connection
    return self._wrap_pool_connect(self.pool.connect, _connection)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3364, in _wrap_pool_connect
    Connection._handle_dbapi_exception_noconnection(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 2198, in _handle_dbapi_exception_noconnection
    util.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\base.py", line 3361, in _wrap_pool_connect
    return fn()
           ^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 327, in connect
    return _ConnectionFairy._checkout(self)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 894, in _checkout
    fairy = _ConnectionRecord.checkout(pool)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 493, in checkout
    rec = pool._do_get()
          ^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 145, in _do_get
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\impl.py", line 143, in _do_get
    return self._create_connection()
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 273, in _create_connection
    return _ConnectionRecord(self)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 388, in __init__
    self.__connect()
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 690, in __connect
    with util.safe_reraise():
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\langhelpers.py", line 70, in __exit__
    compat.raise_(
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\pool\base.py", line 686, in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
                                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\create.py", line 578, in connect
    return dialect.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\sqlalchemy\engine\default.py", line 598, in connect
    return self.dbapi.connect(*cargs, **cparams)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\.venv\Lib\site-packages\psycopg2\__init__.py", line 122, in connect
    conn = _connect(dsn, connection_factory=connection_factory, **kwasync)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
sqlalchemy.exc.OperationalError: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_db"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-23 12:48:16,346 - [INFO] - Starting application...
2025-01-23 12:48:16,430 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 12:48:42,558 - [INFO] - Spark Session created successfully
2025-01-23 12:48:42,559 - [INFO] - Spark version: 3.5.4
2025-01-23 12:48:42,559 - [INFO] - Spark master: local[*]
2025-01-23 12:48:42,559 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 12:48:42,559 - [INFO] - Starting file processing...
2025-01-23 12:48:42,559 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 12:48:42,559 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 12:48:42,559 - [INFO] - User agent filter: some user agent
2025-01-23 12:48:42,560 - [INFO] - Found 11 total parquet files
2025-01-23 12:48:42,560 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 12:48:42,560 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 12:48:47,718 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 12:48:48,156 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 12:48:49,845 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 12:48:50,284 - [INFO] - Found 0 records with invalid hours
2025-01-23 12:48:50,688 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 12:48:51,062 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 12:48:51,313 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 12:48:56,214 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-23 12:48:56,215 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 12:48:56,216 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 12:48:56,216 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 12:48:56,217 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-23 12:48:56,490 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 12:48:56,647 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 12:48:57,837 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 12:48:58,079 - [INFO] - Found 0 records with invalid hours
2025-01-23 12:48:58,290 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 12:48:58,538 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 12:48:58,721 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 12:48:58,962 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 12:48:59,226 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 12:49:00,560 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 12:49:00,850 - [INFO] - Found 0 records with invalid hours
2025-01-23 12:49:01,041 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 12:49:01,267 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 12:49:01,431 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 12:49:05,277 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 12:49:06,065 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-23 12:49:06,066 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 12:49:06,066 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 12:49:06,067 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 12:49:06,067 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 12:49:06,068 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 12:49:06,068 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 12:49:06,068 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 12:49:06,069 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 12:49:06,069 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-23 12:49:06,069 - [INFO] - Successfully processed 2 dates
2025-01-23 12:49:06,069 - [INFO] - Starting client report loading process...
2025-01-23 12:49:06,070 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-23 12:49:06,071 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 12:49:06,078 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 12:49:06,083 - [INFO] - Archived 0 unique rows
2025-01-23 12:49:06,099 - [INFO] - Successfully loaded 24 rows
2025-01-23 12:49:06,105 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-23 12:49:06,105 - [INFO] - - Archived rows: 0
2025-01-23 12:49:06,105 - [INFO] - - Loaded rows: 24
2025-01-23 12:49:06,106 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-23 12:49:06,115 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 12:49:06,120 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 12:49:06,123 - [INFO] - Archived 0 unique rows
2025-01-23 12:49:06,131 - [INFO] - Successfully loaded 48 rows
2025-01-23 12:49:06,135 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-23 12:49:06,135 - [INFO] - - Archived rows: 0
2025-01-23 12:49:06,135 - [INFO] - - Loaded rows: 48
2025-01-23 12:49:06,135 - [INFO] - 
Verifying data load...
2025-01-23 12:49:06,140 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-23 12:49:06,141 - [INFO] - 
Load Summary:
2025-01-23 12:49:06,141 - [INFO] - Total files processed: 2
2025-01-23 12:49:06,141 - [INFO] - Total rows loaded: 72
2025-01-23 12:49:06,141 - [INFO] - 
Date Range:
2025-01-23 12:49:06,141 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-23 12:49:06,141 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 12:49:06,141 - [INFO] - 
Total Counts:
2025-01-23 12:49:06,141 - [INFO] -   Impressions: 44
2025-01-23 12:49:06,141 - [INFO] -   Clicks: 30
2025-01-23 12:49:06,141 - [INFO] - 
Client report loading completed successfully
2025-01-23 12:49:06,141 - [INFO] - Processing and loading completed successfully
2025-01-23 12:49:07,316 - [INFO] - Spark Session stopped
2025-01-23 13:55:53,448 - [INFO] - Starting application...
2025-01-23 13:55:53,532 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 13:56:19,331 - [INFO] - Spark Session created successfully
2025-01-23 13:56:19,331 - [INFO] - Spark version: 3.5.4
2025-01-23 13:56:19,332 - [INFO] - Spark master: local[*]
2025-01-23 13:56:19,332 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 13:56:19,332 - [INFO] - Starting file processing...
2025-01-23 13:56:19,332 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 13:56:19,332 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 13:56:19,332 - [INFO] - User agent filter: some user agent
2025-01-23 13:56:19,333 - [INFO] - Found 11 total parquet files
2025-01-23 13:56:19,333 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 13:56:19,333 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 13:56:24,884 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 13:56:25,327 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 13:56:27,069 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 13:56:27,525 - [INFO] - Found 0 records with invalid hours
2025-01-23 13:56:27,942 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 13:56:28,304 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 13:56:28,536 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 13:56:33,841 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-23 13:56:33,841 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 13:56:33,841 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 13:56:33,842 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 13:56:33,842 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-23 13:56:34,111 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 13:56:34,277 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 13:56:35,378 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 13:56:35,629 - [INFO] - Found 0 records with invalid hours
2025-01-23 13:56:35,820 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 13:56:36,050 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 13:56:36,236 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 13:56:36,501 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 13:56:36,661 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 13:56:38,138 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 13:56:38,426 - [INFO] - Found 0 records with invalid hours
2025-01-23 13:56:38,621 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 13:56:38,827 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 13:56:39,026 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 13:56:42,941 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 13:56:43,710 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-23 13:56:43,711 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 13:56:43,711 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 13:56:43,712 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 13:56:43,712 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 13:56:43,713 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 13:56:43,713 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 13:56:43,713 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 13:56:43,714 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 13:56:43,714 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-23 13:56:43,714 - [INFO] - Successfully processed 2 dates
2025-01-23 13:56:43,714 - [INFO] - Starting client report loading process...
2025-01-23 13:56:43,715 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-23 13:56:43,717 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 13:56:43,731 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 13:56:43,736 - [INFO] - Archived 24 unique rows
2025-01-23 13:56:43,760 - [INFO] - Successfully loaded 48 rows
2025-01-23 13:56:43,767 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-23 13:56:43,767 - [INFO] - - Archived rows: 24
2025-01-23 13:56:43,767 - [INFO] - - Loaded rows: 48
2025-01-23 13:56:43,767 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-23 13:56:43,776 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 13:56:43,782 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 13:56:43,785 - [INFO] - Archived 24 unique rows
2025-01-23 13:56:43,793 - [INFO] - Successfully loaded 48 rows
2025-01-23 13:56:43,798 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-23 13:56:43,798 - [INFO] - - Archived rows: 24
2025-01-23 13:56:43,798 - [INFO] - - Loaded rows: 48
2025-01-23 13:56:43,798 - [INFO] - 
Verifying data load...
2025-01-23 13:56:43,803 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-23 13:56:43,805 - [INFO] - 
Load Summary:
2025-01-23 13:56:43,805 - [INFO] - Total files processed: 2
2025-01-23 13:56:43,805 - [INFO] - Total rows loaded: 96
2025-01-23 13:56:43,805 - [INFO] - 
Date Range:
2025-01-23 13:56:43,805 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-23 13:56:43,805 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 13:56:43,805 - [INFO] - 
Total Counts:
2025-01-23 13:56:43,805 - [INFO] -   Impressions: 44
2025-01-23 13:56:43,805 - [INFO] -   Clicks: 30
2025-01-23 13:56:43,805 - [INFO] - 
Client report loading completed successfully
2025-01-23 13:56:43,805 - [INFO] - Processing and loading completed successfully
2025-01-23 13:56:44,935 - [INFO] - Spark Session stopped
2025-01-23 14:00:05,104 - [INFO] - Starting application...
2025-01-23 14:00:05,166 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 14:00:09,935 - [INFO] - Spark Session created successfully
2025-01-23 14:00:09,936 - [INFO] - Spark version: 3.5.4
2025-01-23 14:00:09,936 - [INFO] - Spark master: local[*]
2025-01-23 14:00:09,936 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 14:00:09,936 - [INFO] - Starting file processing...
2025-01-23 14:00:09,936 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 14:00:09,936 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 14:00:09,936 - [INFO] - User agent filter: some user agent
2025-01-23 14:00:09,936 - [WARNING] - No parquet files found in input directory
2025-01-23 14:00:09,936 - [ERROR] - Spark processing failed
2025-01-23 14:00:09,936 - [ERROR] - Processing or loading failed
2025-01-23 14:00:10,270 - [INFO] - Spark Session stopped
2025-01-23 14:49:31,845 - [INFO] - Starting application...
2025-01-23 14:49:31,908 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 14:49:57,790 - [INFO] - Spark Session created successfully
2025-01-23 14:49:57,790 - [INFO] - Spark version: 3.5.4
2025-01-23 14:49:57,790 - [INFO] - Spark master: local[*]
2025-01-23 14:49:57,790 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 14:49:57,790 - [INFO] - Starting file processing...
2025-01-23 14:49:57,790 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 14:49:57,790 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 14:49:57,790 - [INFO] - User agent filter: some user agent
2025-01-23 14:49:57,791 - [INFO] - Found 11 total parquet files
2025-01-23 14:49:57,791 - [INFO] - Impressions files by date: 20220526, 20220527
2025-01-23 14:49:57,791 - [INFO] - Clicks files by date: 20220527
2025-01-23 14:50:03,086 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 14:50:03,555 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 14:50:05,301 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 14:50:05,751 - [INFO] - Found 0 records with invalid hours
2025-01-23 14:50:06,148 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 14:50:06,567 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 14:50:06,803 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 14:50:11,655 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220526.csv
2025-01-23 14:50:11,655 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 14:50:11,656 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 14:50:11,656 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 14:50:11,656 - [INFO] - Successfully processed data for date: 20220526
2025-01-23 14:50:11,948 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 14:50:12,086 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 14:50:13,209 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 14:50:13,451 - [INFO] - Found 0 records with invalid hours
2025-01-23 14:50:13,635 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 14:50:13,839 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 14:50:14,028 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 14:50:14,279 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 14:50:14,424 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 14:50:15,805 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 14:50:16,061 - [INFO] - Found 0 records with invalid hours
2025-01-23 14:50:16,243 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 14:50:16,446 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 14:50:16,603 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 14:50:20,560 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 14:50:21,320 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220527.csv
2025-01-23 14:50:21,320 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 14:50:21,321 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 14:50:21,321 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 14:50:21,321 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 14:50:21,322 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 14:50:21,322 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 14:50:21,323 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 14:50:21,323 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 14:50:21,323 - [INFO] - Successfully processed data for date: 20220527
2025-01-23 14:50:21,323 - [INFO] - Successfully processed 2 dates
2025-01-23 14:50:21,323 - [INFO] - Starting client report loading process...
2025-01-23 14:50:21,324 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv
2025-01-23 14:50:21,325 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 14:50:21,334 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 14:50:21,338 - [INFO] - Archived 0 unique rows
2025-01-23 14:50:21,355 - [INFO] - Successfully loaded 72 rows
2025-01-23 14:50:21,359 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv:
2025-01-23 14:50:21,360 - [INFO] - - Archived rows: 0
2025-01-23 14:50:21,360 - [INFO] - - Loaded rows: 72
2025-01-23 14:50:21,360 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv
2025-01-23 14:50:21,371 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 14:50:21,379 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 14:50:21,382 - [INFO] - Archived 24 unique rows
2025-01-23 14:50:21,392 - [INFO] - Successfully loaded 72 rows
2025-01-23 14:50:21,396 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv:
2025-01-23 14:50:21,396 - [INFO] - - Archived rows: 24
2025-01-23 14:50:21,396 - [INFO] - - Loaded rows: 72
2025-01-23 14:50:21,396 - [INFO] - 
Verifying data load...
2025-01-23 14:50:21,400 - [INFO] - Verification results: {'total_rows': 72, 'date_range': {'start': datetime.datetime(1970, 1, 1, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('74'), 'clicks': Decimal('60')}}
2025-01-23 14:50:21,401 - [INFO] - 
Load Summary:
2025-01-23 14:50:21,402 - [INFO] - Total files processed: 2
2025-01-23 14:50:21,402 - [INFO] - Total rows loaded: 144
2025-01-23 14:50:21,402 - [INFO] - 
Date Range:
2025-01-23 14:50:21,402 - [INFO] -   Start: 1970-01-01 00:00:00
2025-01-23 14:50:21,402 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 14:50:21,402 - [INFO] - 
Total Counts:
2025-01-23 14:50:21,402 - [INFO] -   Impressions: 74
2025-01-23 14:50:21,402 - [INFO] -   Clicks: 60
2025-01-23 14:50:21,402 - [INFO] - 
Client report loading completed successfully
2025-01-23 14:50:21,402 - [INFO] - Processing and loading completed successfully
2025-01-23 14:50:22,561 - [INFO] - Spark Session stopped
2025-01-23 16:25:38,796 - [INFO] - Starting application...
2025-01-23 16:25:38,867 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 16:25:45,256 - [INFO] - Spark Session created successfully
2025-01-23 16:25:45,257 - [INFO] - Spark version: 3.5.4
2025-01-23 16:25:45,257 - [INFO] - Spark master: local[*]
2025-01-23 16:25:45,257 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 16:25:45,257 - [INFO] - Starting file processing...
2025-01-23 16:25:45,257 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 16:25:45,257 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 16:25:45,257 - [INFO] - User agent filter: some user agent
2025-01-23 16:25:45,258 - [INFO] - Found 11 total parquet files
2025-01-23 16:25:45,258 - [INFO] - Impressions files by date: 20220526, 20220527
2025-01-23 16:25:45,258 - [INFO] - Clicks files by date: 20220527
2025-01-23 16:25:50,540 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 16:25:51,039 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 16:25:52,939 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 16:25:53,395 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:25:53,798 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 16:25:54,165 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 16:25:54,402 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 16:25:59,489 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220526.csv
2025-01-23 16:25:59,490 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 16:25:59,490 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 16:25:59,491 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 16:25:59,491 - [INFO] - Successfully processed data for date: 20220526
2025-01-23 16:25:59,785 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 16:25:59,935 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 16:26:01,099 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 16:26:01,357 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:26:01,542 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 16:26:01,730 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 16:26:01,952 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 16:26:02,186 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 16:26:02,354 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 16:26:03,849 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 16:26:04,107 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:26:04,297 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 16:26:04,535 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 16:26:04,707 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 16:26:08,859 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 16:26:09,648 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220527.csv
2025-01-23 16:26:09,649 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 16:26:09,649 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 16:26:09,650 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 16:26:09,650 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 16:26:09,651 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 16:26:09,651 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 16:26:09,652 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 16:26:09,652 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 16:26:09,653 - [INFO] - Successfully processed data for date: 20220527
2025-01-23 16:26:09,653 - [INFO] - Successfully processed 2 dates
2025-01-23 16:26:09,653 - [INFO] - Starting client report loading process...
2025-01-23 16:26:09,653 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv
2025-01-23 16:26:09,655 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 16:26:09,662 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 16:26:09,666 - [INFO] - Archived 0 unique rows
2025-01-23 16:26:09,680 - [INFO] - Successfully loaded 72 rows
2025-01-23 16:26:09,685 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv:
2025-01-23 16:26:09,685 - [INFO] - - Archived rows: 0
2025-01-23 16:26:09,685 - [INFO] - - Loaded rows: 72
2025-01-23 16:26:09,685 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv
2025-01-23 16:26:09,688 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 16:26:09,692 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 16:26:09,695 - [INFO] - Archived 0 unique rows
2025-01-23 16:26:09,702 - [INFO] - Successfully loaded 72 rows
2025-01-23 16:26:09,706 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv:
2025-01-23 16:26:09,706 - [INFO] - - Archived rows: 0
2025-01-23 16:26:09,706 - [INFO] - - Loaded rows: 72
2025-01-23 16:26:09,706 - [INFO] - 
Verifying data load...
2025-01-23 16:26:09,710 - [INFO] - Verification results: {'total_rows': 72, 'date_range': {'start': datetime.datetime(1970, 1, 1, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('74'), 'clicks': Decimal('60')}}
2025-01-23 16:26:09,711 - [INFO] - 
Load Summary:
2025-01-23 16:26:09,711 - [INFO] - Total files processed: 2
2025-01-23 16:26:09,711 - [INFO] - Total rows loaded: 144
2025-01-23 16:26:09,711 - [INFO] - 
Date Range:
2025-01-23 16:26:09,711 - [INFO] -   Start: 1970-01-01 00:00:00
2025-01-23 16:26:09,711 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 16:26:09,711 - [INFO] - 
Total Counts:
2025-01-23 16:26:09,711 - [INFO] -   Impressions: 74
2025-01-23 16:26:09,711 - [INFO] -   Clicks: 60
2025-01-23 16:26:09,711 - [INFO] - 
Client report loading completed successfully
2025-01-23 16:26:09,711 - [INFO] - Processing and loading completed successfully
2025-01-23 16:26:10,857 - [INFO] - Spark Session stopped
2025-01-23 16:41:17,734 - [INFO] - Starting application...
2025-01-23 16:41:17,808 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 16:41:34,090 - [INFO] - Spark Session created successfully
2025-01-23 16:41:34,091 - [INFO] - Spark version: 3.5.4
2025-01-23 16:41:34,091 - [INFO] - Spark master: local[*]
2025-01-23 16:41:34,091 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 16:41:34,091 - [INFO] - Starting file processing...
2025-01-23 16:41:34,091 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 16:41:34,091 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 16:41:34,091 - [INFO] - User agent filter: some user agent
2025-01-23 16:41:34,092 - [INFO] - Found 11 total parquet files
2025-01-23 16:41:34,092 - [INFO] - Impressions files by date: 20220526, 20220527
2025-01-23 16:41:34,092 - [INFO] - Clicks files by date: 20220527
2025-01-23 16:41:39,164 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 16:41:39,595 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 16:41:41,322 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 16:41:41,816 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:41:42,252 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 16:41:42,665 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 16:41:42,948 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 16:41:47,675 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220526.csv
2025-01-23 16:41:47,675 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 16:41:47,676 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 16:41:47,676 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 16:41:47,676 - [INFO] - Successfully processed data for date: 20220526
2025-01-23 16:41:47,935 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 16:41:48,083 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 16:41:49,235 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 16:41:49,464 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:41:49,627 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 16:41:49,812 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 16:41:49,962 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 16:41:50,292 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 16:41:50,440 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 16:41:51,717 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 16:41:51,957 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:41:52,154 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 16:41:52,356 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 16:41:52,523 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 16:41:56,371 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 16:41:57,079 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220527.csv
2025-01-23 16:41:57,080 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 16:41:57,080 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 16:41:57,080 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 16:41:57,081 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 16:41:57,081 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 16:41:57,082 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 16:41:57,082 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 16:41:57,083 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 16:41:57,083 - [INFO] - Successfully processed data for date: 20220527
2025-01-23 16:41:57,083 - [INFO] - Successfully processed 2 dates
2025-01-23 16:41:57,083 - [INFO] - Starting client report loading process...
2025-01-23 16:41:57,083 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv
2025-01-23 16:41:57,085 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 16:41:57,091 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 16:41:57,094 - [INFO] - Archived 0 unique rows
2025-01-23 16:41:57,106 - [INFO] - Successfully loaded 72 rows
2025-01-23 16:41:57,111 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv:
2025-01-23 16:41:57,111 - [INFO] - - Archived rows: 0
2025-01-23 16:41:57,111 - [INFO] - - Loaded rows: 72
2025-01-23 16:41:57,111 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv
2025-01-23 16:41:57,113 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 16:41:57,117 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 16:41:57,120 - [INFO] - Archived 0 unique rows
2025-01-23 16:41:57,126 - [INFO] - Successfully loaded 72 rows
2025-01-23 16:41:57,130 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv:
2025-01-23 16:41:57,130 - [INFO] - - Archived rows: 0
2025-01-23 16:41:57,130 - [INFO] - - Loaded rows: 72
2025-01-23 16:41:57,130 - [INFO] - 
Verifying data load...
2025-01-23 16:41:57,133 - [INFO] - Verification results: {'total_rows': 72, 'date_range': {'start': datetime.datetime(1970, 1, 1, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}}
2025-01-23 16:41:57,134 - [INFO] - 
Load Summary:
2025-01-23 16:41:57,134 - [INFO] - Total files processed: 2
2025-01-23 16:41:57,134 - [INFO] - Total rows loaded: 144
2025-01-23 16:41:57,134 - [INFO] - 
Date Range:
2025-01-23 16:41:57,134 - [INFO] -   Start: 1970-01-01 00:00:00
2025-01-23 16:41:57,134 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 16:41:57,135 - [INFO] - 
Total Counts:
2025-01-23 16:41:57,135 - [ERROR] - Error in process_and_load_data: 'totals'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 206, in process_and_load_data
    f"  Impressions: {verification['totals']['impressions']:,}")
                      ~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'totals'
2025-01-23 16:41:57,135 - [ERROR] - Processing or loading failed
2025-01-23 16:41:57,357 - [INFO] - Spark Session stopped
2025-01-23 16:48:42,700 - [INFO] - Starting application...
2025-01-23 16:48:42,793 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 16:48:49,062 - [INFO] - Spark Session created successfully
2025-01-23 16:48:49,062 - [INFO] - Spark version: 3.5.4
2025-01-23 16:48:49,062 - [INFO] - Spark master: local[*]
2025-01-23 16:48:49,062 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 16:48:49,062 - [INFO] - Starting file processing...
2025-01-23 16:48:49,062 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 16:48:49,062 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 16:48:49,062 - [INFO] - User agent filter: some user agent
2025-01-23 16:48:49,063 - [INFO] - Found 11 total parquet files
2025-01-23 16:48:49,064 - [INFO] - Impressions files by date: 20220526, 20220527
2025-01-23 16:48:49,064 - [INFO] - Clicks files by date: 20220527
2025-01-23 16:48:56,466 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 16:48:57,284 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 16:48:59,762 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 16:49:00,395 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:49:00,902 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 16:49:01,406 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 16:49:01,696 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 16:49:07,368 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220526.csv
2025-01-23 16:49:07,369 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 16:49:07,369 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 16:49:07,370 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 16:49:07,370 - [INFO] - Successfully processed data for date: 20220526
2025-01-23 16:49:07,703 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 16:49:07,873 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 16:49:09,282 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 16:49:09,563 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:49:09,759 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 16:49:09,954 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 16:49:10,171 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 16:49:10,530 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 16:49:10,720 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 16:49:12,246 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 16:49:12,516 - [INFO] - Found 0 records with invalid hours
2025-01-23 16:49:12,717 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 16:49:12,948 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 16:49:13,140 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 16:49:17,481 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 16:49:18,391 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220527.csv
2025-01-23 16:49:18,391 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 16:49:18,392 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 16:49:18,392 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 16:49:18,393 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 16:49:18,394 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 16:49:18,394 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 16:49:18,394 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 16:49:18,395 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 16:49:18,396 - [INFO] - Successfully processed data for date: 20220527
2025-01-23 16:49:18,396 - [INFO] - Successfully processed 2 dates
2025-01-23 16:49:18,396 - [INFO] - Starting client report loading process...
2025-01-23 16:49:18,397 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv
2025-01-23 16:49:18,399 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 16:49:18,408 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 16:49:18,413 - [INFO] - Archived 0 unique rows
2025-01-23 16:49:18,430 - [INFO] - Successfully loaded 72 rows
2025-01-23 16:49:18,436 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv:
2025-01-23 16:49:18,436 - [INFO] - - Archived rows: 0
2025-01-23 16:49:18,436 - [INFO] - - Loaded rows: 72
2025-01-23 16:49:18,436 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv
2025-01-23 16:49:18,445 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 16:49:18,450 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 16:49:18,454 - [INFO] - Archived 0 unique rows
2025-01-23 16:49:18,463 - [INFO] - Successfully loaded 72 rows
2025-01-23 16:49:18,468 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv:
2025-01-23 16:49:18,468 - [INFO] - - Archived rows: 0
2025-01-23 16:49:18,468 - [INFO] - - Loaded rows: 72
2025-01-23 16:49:18,468 - [INFO] - 
Verifying data load...
2025-01-23 16:49:18,474 - [INFO] - Verification results: {'total_rows': 72, 'date_range': {'start': datetime.datetime(1970, 1, 1, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}}
2025-01-23 16:49:18,475 - [INFO] - 
Load Summary:
2025-01-23 16:49:18,475 - [INFO] - Total files processed: 2
2025-01-23 16:49:18,475 - [INFO] - Total rows loaded: 144
2025-01-23 16:49:18,475 - [INFO] - 
Date Range:
2025-01-23 16:49:18,475 - [INFO] -   Start: 1970-01-01 00:00:00
2025-01-23 16:49:18,475 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 16:49:18,475 - [ERROR] - Error in process_and_load_data: 'totals'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 207, in process_and_load_data
    f"  Impressions: {verification['totals']['impressions']:,}")
                      ~~~~~~~~~~~~^^^^^^^^^^
KeyError: 'totals'
2025-01-23 16:49:18,476 - [ERROR] - Processing or loading failed
2025-01-23 16:49:19,481 - [INFO] - Spark Session stopped
2025-01-23 19:09:14,545 - [INFO] - Starting application...
2025-01-23 19:09:14,608 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 19:09:40,570 - [INFO] - Spark Session created successfully
2025-01-23 19:09:40,570 - [INFO] - Spark version: 3.5.4
2025-01-23 19:09:40,570 - [INFO] - Spark master: local[*]
2025-01-23 19:09:40,570 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 19:09:40,570 - [INFO] - Starting file processing...
2025-01-23 19:09:40,570 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 19:09:40,571 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 19:09:40,571 - [INFO] - User agent filter: some user agent
2025-01-23 19:09:40,571 - [INFO] - Found 11 total parquet files
2025-01-23 19:09:40,572 - [INFO] - Impressions files by date: 20220526, 20220527
2025-01-23 19:09:40,572 - [INFO] - Clicks files by date: 20220527
2025-01-23 19:09:45,596 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 19:09:46,010 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 19:09:47,685 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 19:09:48,125 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:09:48,517 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 19:09:48,888 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 19:09:49,127 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 19:09:53,778 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220526.csv
2025-01-23 19:09:53,778 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 19:09:53,779 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 19:09:53,779 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 19:09:53,779 - [INFO] - Successfully processed data for date: 20220526
2025-01-23 19:09:54,023 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 19:09:54,171 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 19:09:55,278 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 19:09:55,533 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:09:55,710 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 19:09:55,898 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 19:09:56,071 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 19:09:56,389 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 19:09:56,612 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 19:09:57,948 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 19:09:58,298 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:09:58,491 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 19:09:58,680 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 19:09:58,955 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 19:10:02,720 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 19:10:03,455 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_20220527.csv
2025-01-23 19:10:03,455 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 19:10:03,455 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 19:10:03,456 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 19:10:03,456 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 19:10:03,457 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 19:10:03,457 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 19:10:03,457 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 19:10:03,458 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 19:10:03,458 - [INFO] - Successfully processed data for date: 20220527
2025-01-23 19:10:03,458 - [INFO] - Successfully processed 2 dates
2025-01-23 19:10:03,458 - [INFO] - Starting client report loading process...
2025-01-23 19:10:03,459 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv
2025-01-23 19:10:03,460 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 19:10:03,465 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 19:10:03,469 - [INFO] - Archived 0 unique rows
2025-01-23 19:10:03,483 - [INFO] - Successfully loaded 24 rows
2025-01-23 19:10:03,486 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220526.csv:
2025-01-23 19:10:03,486 - [INFO] - - Archived rows: 0
2025-01-23 19:10:03,486 - [INFO] - - Loaded rows: 24
2025-01-23 19:10:03,486 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv
2025-01-23 19:10:03,495 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 19:10:03,500 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 19:10:03,502 - [INFO] - Archived 24 unique rows
2025-01-23 19:10:03,510 - [INFO] - Successfully loaded 24 rows
2025-01-23 19:10:03,512 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_20220527.csv:
2025-01-23 19:10:03,512 - [INFO] - - Archived rows: 24
2025-01-23 19:10:03,513 - [INFO] - - Loaded rows: 24
2025-01-23 19:10:03,513 - [INFO] - 
Verifying data load...
2025-01-23 19:10:03,516 - [INFO] - Verification results: {'total_rows': 24, 'date_range': {'start': datetime.datetime(1970, 1, 1, 0, 0), 'end': datetime.datetime(1970, 1, 1, 23, 0)}, 'totals': {'impressions': Decimal('30'), 'clicks': Decimal('30')}}
2025-01-23 19:10:03,517 - [INFO] - 
Load Summary:
2025-01-23 19:10:03,517 - [INFO] - Total files processed: 2
2025-01-23 19:10:03,517 - [INFO] - Total rows loaded: 48
2025-01-23 19:10:03,517 - [INFO] - 
Date Range:
2025-01-23 19:10:03,517 - [INFO] -   Start: 1970-01-01 00:00:00
2025-01-23 19:10:03,517 - [INFO] -   End: 1970-01-01 23:00:00
2025-01-23 19:10:03,517 - [INFO] - 
Total Counts:
2025-01-23 19:10:03,518 - [INFO] -   Impressions: 30
2025-01-23 19:10:03,518 - [INFO] -   Clicks: 30
2025-01-23 19:10:03,518 - [INFO] - 
Client report loading completed successfully
2025-01-23 19:10:03,518 - [INFO] - Processing and loading completed successfully
2025-01-23 19:10:04,716 - [INFO] - Spark Session stopped
2025-01-23 19:16:38,101 - [INFO] - Starting application...
2025-01-23 19:16:38,160 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 19:16:43,059 - [INFO] - Spark Session created successfully
2025-01-23 19:16:43,060 - [INFO] - Spark version: 3.5.4
2025-01-23 19:16:43,060 - [INFO] - Spark master: local[*]
2025-01-23 19:16:43,060 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 19:16:43,060 - [INFO] - Starting file processing...
2025-01-23 19:16:43,060 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 19:16:43,060 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 19:16:43,060 - [INFO] - User agent filter: some user agent
2025-01-23 19:16:43,061 - [INFO] - Found 11 total parquet files
2025-01-23 19:16:43,061 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 19:16:43,061 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 19:16:48,649 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 19:16:49,120 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 19:16:51,566 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 19:16:52,117 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:16:52,483 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 19:16:52,851 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 19:16:53,183 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 19:16:57,875 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-23 19:16:57,876 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 19:16:57,876 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 19:16:57,877 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 19:16:57,877 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-23 19:16:58,229 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 19:16:58,396 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 19:16:59,540 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 19:16:59,766 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:16:59,947 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 19:17:00,177 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 19:17:00,379 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 19:17:00,618 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 19:17:00,825 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 19:17:02,082 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 19:17:02,322 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:17:02,509 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 19:17:02,730 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 19:17:03,058 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 19:17:06,884 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 19:17:07,622 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-23 19:17:07,623 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 19:17:07,623 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 19:17:07,624 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 19:17:07,624 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 19:17:07,625 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 19:17:07,625 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 19:17:07,626 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 19:17:07,626 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 19:17:07,626 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-23 19:17:07,627 - [INFO] - Successfully processed 2 dates
2025-01-23 19:17:07,627 - [INFO] - Starting client report loading process...
2025-01-23 19:17:07,627 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-23 19:17:07,629 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 19:17:07,636 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 19:17:07,641 - [INFO] - Archived 0 unique rows
2025-01-23 19:17:07,657 - [INFO] - Successfully loaded 24 rows
2025-01-23 19:17:07,660 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-23 19:17:07,660 - [INFO] - - Archived rows: 0
2025-01-23 19:17:07,660 - [INFO] - - Loaded rows: 24
2025-01-23 19:17:07,660 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-23 19:17:07,670 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 19:17:07,675 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 19:17:07,678 - [INFO] - Archived 0 unique rows
2025-01-23 19:17:07,686 - [INFO] - Successfully loaded 48 rows
2025-01-23 19:17:07,688 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-23 19:17:07,688 - [INFO] - - Archived rows: 0
2025-01-23 19:17:07,689 - [INFO] - - Loaded rows: 48
2025-01-23 19:17:07,689 - [INFO] - 
Verifying data load...
2025-01-23 19:17:07,693 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-23 19:17:07,693 - [INFO] - 
Load Summary:
2025-01-23 19:17:07,694 - [INFO] - Total files processed: 2
2025-01-23 19:17:07,694 - [INFO] - Total rows loaded: 72
2025-01-23 19:17:07,694 - [INFO] - 
Date Range:
2025-01-23 19:17:07,694 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-23 19:17:07,694 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 19:17:07,694 - [INFO] - 
Total Counts:
2025-01-23 19:17:07,694 - [INFO] -   Impressions: 44
2025-01-23 19:17:07,694 - [INFO] -   Clicks: 30
2025-01-23 19:17:07,695 - [INFO] - 
Client report loading completed successfully
2025-01-23 19:17:07,695 - [INFO] - Processing and loading completed successfully
2025-01-23 19:17:07,871 - [INFO] - Spark Session stopped
2025-01-23 19:23:10,462 - [INFO] - Starting application...
2025-01-23 19:23:10,528 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 19:23:28,741 - [INFO] - Spark Session created successfully
2025-01-23 19:23:28,741 - [INFO] - Spark version: 3.5.4
2025-01-23 19:23:28,741 - [INFO] - Spark master: local[*]
2025-01-23 19:23:28,742 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 19:23:28,742 - [INFO] - Starting file processing...
2025-01-23 19:23:28,742 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 19:23:28,742 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 19:23:28,742 - [INFO] - User agent filter: some user agent
2025-01-23 19:23:28,743 - [INFO] - Found 11 total parquet files
2025-01-23 19:23:28,743 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 19:23:28,743 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 19:23:34,209 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 19:23:34,650 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 19:23:36,339 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 19:23:36,840 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:23:37,288 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 19:23:37,648 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 19:23:37,859 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 19:23:42,748 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-23 19:23:42,748 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 19:23:42,749 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 19:23:42,749 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 19:23:42,749 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-23 19:23:43,039 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 19:23:43,183 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 19:23:44,321 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 19:23:44,580 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:23:44,759 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 19:23:44,951 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 19:23:45,104 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 19:23:45,446 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 19:23:45,617 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 19:23:46,962 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 19:23:47,190 - [INFO] - Found 0 records with invalid hours
2025-01-23 19:23:47,380 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 19:23:47,572 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 19:23:47,777 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 19:23:51,646 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 19:23:52,382 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-23 19:23:52,383 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 19:23:52,385 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 19:23:52,386 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 19:23:52,388 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 19:23:52,389 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 19:23:52,391 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 19:23:52,393 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 19:23:52,395 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 19:23:52,395 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-23 19:23:52,395 - [INFO] - Successfully processed 2 dates
2025-01-23 19:23:52,395 - [INFO] - Starting client report loading process...
2025-01-23 19:23:52,398 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-23 19:23:52,404 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 19:23:52,428 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 19:23:52,436 - [INFO] - Archived 24 unique rows
2025-01-23 19:23:52,466 - [INFO] - Successfully loaded 48 rows
2025-01-23 19:23:52,472 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-23 19:23:52,472 - [INFO] - - Archived rows: 24
2025-01-23 19:23:52,472 - [INFO] - - Loaded rows: 48
2025-01-23 19:23:52,473 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-23 19:23:52,475 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 19:23:52,485 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 19:23:52,493 - [INFO] - Archived 24 unique rows
2025-01-23 19:23:52,511 - [INFO] - Successfully loaded 48 rows
2025-01-23 19:23:52,515 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-23 19:23:52,516 - [INFO] - - Archived rows: 24
2025-01-23 19:23:52,516 - [INFO] - - Loaded rows: 48
2025-01-23 19:23:52,516 - [INFO] - 
Verifying data load...
2025-01-23 19:23:52,527 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-23 19:23:52,530 - [INFO] - 
Load Summary:
2025-01-23 19:23:52,530 - [INFO] - Total files processed: 2
2025-01-23 19:23:52,530 - [INFO] - Total rows loaded: 96
2025-01-23 19:23:52,530 - [INFO] - 
Date Range:
2025-01-23 19:23:52,530 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-23 19:23:52,530 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 19:23:52,530 - [INFO] - 
Total Counts:
2025-01-23 19:23:52,530 - [INFO] -   Impressions: 44
2025-01-23 19:23:52,531 - [INFO] -   Clicks: 30
2025-01-23 19:23:52,531 - [INFO] - 
Client report loading completed successfully
2025-01-23 19:23:52,531 - [INFO] - Processing and loading completed successfully
2025-01-23 19:23:53,642 - [INFO] - Spark Session stopped
2025-01-23 20:06:21,449 - [INFO] - Starting application...
2025-01-23 20:06:21,519 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 20:06:37,954 - [INFO] - Spark Session created successfully
2025-01-23 20:06:37,954 - [INFO] - Spark version: 3.5.4
2025-01-23 20:06:37,954 - [INFO] - Spark master: local[*]
2025-01-23 20:06:37,954 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 20:06:37,955 - [INFO] - Starting file processing...
2025-01-23 20:06:37,955 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 20:06:37,955 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 20:06:37,955 - [INFO] - User agent filter: some user agent
2025-01-23 20:06:37,956 - [INFO] - Found 11 total parquet files
2025-01-23 20:06:37,956 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 20:06:37,956 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 20:06:43,128 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 20:06:43,545 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 20:06:45,264 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 20:06:45,730 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:06:46,120 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 20:06:46,490 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 20:06:46,714 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 20:06:51,423 - [ERROR] - Error processing files for date '2022-05-26': 'DataProcessor' object has no attribute '_handle_click_impression_mismatch'
2025-01-23 20:06:51,424 - [WARNING] - Failed to process data for date: 2022-05-26 - 'DataProcessor' object has no attribute '_handle_click_impression_mismatch'
2025-01-23 20:06:51,701 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 20:06:51,847 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 20:06:52,968 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 20:06:53,237 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:06:53,485 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 20:06:53,710 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 20:06:53,932 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 20:06:54,282 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 20:06:54,451 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 20:06:55,782 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 20:06:56,023 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:06:56,243 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 20:06:56,440 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 20:06:56,676 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 20:07:00,468 - [WARNING] - Found records where clicks exceed impressions:
2025-01-23 20:07:01,142 - [ERROR] - Error processing files for date '2022-05-27': 'DataProcessor' object has no attribute '_handle_click_impression_mismatch'
2025-01-23 20:07:01,142 - [WARNING] - Failed to process data for date: 2022-05-27 - 'DataProcessor' object has no attribute '_handle_click_impression_mismatch'
2025-01-23 20:07:01,142 - [ERROR] - No dates were successfully processed
2025-01-23 20:07:01,142 - [ERROR] - Spark processing failed
2025-01-23 20:07:01,142 - [ERROR] - Processing or loading failed
2025-01-23 20:07:01,452 - [INFO] - Spark Session stopped
2025-01-23 20:13:44,226 - [INFO] - Starting application...
2025-01-23 20:13:44,288 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 20:14:10,221 - [INFO] - Spark Session created successfully
2025-01-23 20:14:10,221 - [INFO] - Spark version: 3.5.4
2025-01-23 20:14:10,221 - [INFO] - Spark master: local[*]
2025-01-23 20:14:10,221 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 20:14:10,221 - [INFO] - Starting file processing...
2025-01-23 20:14:10,221 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 20:14:10,221 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 20:14:10,221 - [INFO] - User agent filter: some user agent
2025-01-23 20:14:10,222 - [INFO] - Found 11 total parquet files
2025-01-23 20:14:10,223 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 20:14:10,223 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 20:14:15,236 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 20:14:15,667 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 20:14:17,319 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 20:14:17,755 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:14:18,132 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 20:14:18,479 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 20:14:18,707 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 20:14:23,464 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-23 20:14:23,465 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 20:14:23,466 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 20:14:23,466 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 20:14:23,466 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-23 20:14:23,764 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 20:14:23,898 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 20:14:24,957 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 20:14:25,187 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:14:25,378 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 20:14:25,580 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 20:14:25,752 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 20:14:26,036 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 20:14:26,187 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 20:14:27,445 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 20:14:27,686 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:14:27,933 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 20:14:28,285 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 20:14:28,461 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 20:14:32,324 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-23 20:14:32,987 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-23 20:14:32,988 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 20:14:32,988 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 20:14:32,989 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 20:14:32,989 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 20:14:32,990 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 20:14:32,990 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 20:14:32,991 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 20:14:32,991 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 20:14:32,991 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-23 20:14:32,991 - [INFO] - Successfully processed 2 dates
2025-01-23 20:14:32,992 - [INFO] - Starting client report loading process...
2025-01-23 20:14:32,992 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-23 20:14:32,994 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 20:14:33,001 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 20:14:33,005 - [INFO] - Archived 0 unique rows
2025-01-23 20:14:33,021 - [INFO] - Successfully loaded 48 rows
2025-01-23 20:14:33,030 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-23 20:14:33,030 - [INFO] - - Archived rows: 0
2025-01-23 20:14:33,030 - [INFO] - - Loaded rows: 48
2025-01-23 20:14:33,030 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-23 20:14:33,032 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 20:14:33,037 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 20:14:33,041 - [INFO] - Archived 0 unique rows
2025-01-23 20:14:33,050 - [INFO] - Successfully loaded 48 rows
2025-01-23 20:14:33,055 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-23 20:14:33,055 - [INFO] - - Archived rows: 0
2025-01-23 20:14:33,055 - [INFO] - - Loaded rows: 48
2025-01-23 20:14:33,055 - [INFO] - 
Verifying data load...
2025-01-23 20:14:33,060 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-23 20:14:33,061 - [INFO] - 
Load Summary:
2025-01-23 20:14:33,061 - [INFO] - Total files processed: 2
2025-01-23 20:14:33,061 - [INFO] - Total rows loaded: 96
2025-01-23 20:14:33,061 - [INFO] - 
Date Range:
2025-01-23 20:14:33,061 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-23 20:14:33,061 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 20:14:33,062 - [INFO] - 
Total Counts:
2025-01-23 20:14:33,062 - [INFO] -   Impressions: 44
2025-01-23 20:14:33,062 - [INFO] -   Clicks: 30
2025-01-23 20:14:33,062 - [INFO] - 
Client report loading completed successfully
2025-01-23 20:14:33,062 - [INFO] - Processing and loading completed successfully
2025-01-23 20:14:33,322 - [INFO] - Spark Session stopped
2025-01-23 20:38:06,989 - [INFO] - Starting application...
2025-01-23 20:38:07,055 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 20:38:32,906 - [INFO] - Spark Session created successfully
2025-01-23 20:38:32,906 - [INFO] - Spark version: 3.5.4
2025-01-23 20:38:32,906 - [INFO] - Spark master: local[*]
2025-01-23 20:38:32,906 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 20:38:32,906 - [INFO] - Starting file processing...
2025-01-23 20:38:32,906 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 20:38:32,907 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 20:38:32,907 - [INFO] - User agent filter: some user agent
2025-01-23 20:38:32,908 - [INFO] - Found 11 total parquet files
2025-01-23 20:38:32,908 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 20:38:32,908 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 20:38:37,935 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 20:38:38,380 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 20:38:40,050 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 20:38:40,504 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:38:40,861 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 20:38:41,209 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 20:38:41,455 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 20:38:46,172 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-23 20:38:46,173 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 20:38:46,173 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 20:38:46,173 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 20:38:46,174 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-23 20:38:46,423 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 20:38:46,590 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 20:38:47,724 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 20:38:47,989 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:38:48,180 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 20:38:48,348 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 20:38:48,525 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 20:38:48,832 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 20:38:49,075 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 20:38:50,446 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 20:38:50,692 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:38:50,859 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 20:38:51,090 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 20:38:51,380 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 20:38:55,232 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-23 20:38:55,955 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-23 20:38:55,956 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 20:38:55,956 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 20:38:55,957 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 20:38:55,958 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 20:38:55,958 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 20:38:55,958 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 20:38:55,959 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 20:38:55,959 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 20:38:55,960 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-23 20:38:55,960 - [INFO] - Successfully processed 2 dates
2025-01-23 20:38:55,960 - [INFO] - Starting client report loading process...
2025-01-23 20:38:55,960 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-23 20:38:55,962 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 20:38:55,973 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 20:38:55,977 - [INFO] - Archived 0 unique rows
2025-01-23 20:38:55,995 - [INFO] - Successfully loaded 48 rows
2025-01-23 20:38:56,000 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-23 20:38:56,000 - [INFO] - - Archived rows: 0
2025-01-23 20:38:56,000 - [INFO] - - Loaded rows: 48
2025-01-23 20:38:56,000 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-23 20:38:56,003 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 20:38:56,009 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 20:38:56,013 - [INFO] - Archived 0 unique rows
2025-01-23 20:38:56,023 - [INFO] - Successfully loaded 48 rows
2025-01-23 20:38:56,027 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-23 20:38:56,027 - [INFO] - - Archived rows: 0
2025-01-23 20:38:56,027 - [INFO] - - Loaded rows: 48
2025-01-23 20:38:56,027 - [INFO] - 
Verifying data load...
2025-01-23 20:38:56,032 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-23 20:38:56,032 - [INFO] - 
Load Summary:
2025-01-23 20:38:56,033 - [INFO] - Total files processed: 2
2025-01-23 20:38:56,033 - [INFO] - Total rows loaded: 96
2025-01-23 20:38:56,033 - [INFO] - 
Date Range:
2025-01-23 20:38:56,033 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-23 20:38:56,033 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 20:38:56,033 - [INFO] - 
Total Counts:
2025-01-23 20:38:56,033 - [INFO] -   Impressions: 44
2025-01-23 20:38:56,033 - [INFO] -   Clicks: 30
2025-01-23 20:38:56,033 - [INFO] - 
Client report loading completed successfully
2025-01-23 20:38:56,033 - [INFO] - Processing and loading completed successfully
2025-01-23 20:38:56,231 - [INFO] - Spark Session stopped
2025-01-23 20:50:35,491 - [INFO] - Starting application...
2025-01-23 20:50:35,551 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 20:50:44,897 - [INFO] - Spark Session created successfully
2025-01-23 20:50:44,897 - [INFO] - Spark version: 3.5.4
2025-01-23 20:50:44,897 - [INFO] - Spark master: local[*]
2025-01-23 20:50:44,897 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 20:50:44,897 - [INFO] - Starting file processing...
2025-01-23 20:50:44,897 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 20:50:44,897 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 20:50:44,897 - [INFO] - User agent filter: some user agent
2025-01-23 20:50:44,898 - [INFO] - Found 11 total parquet files
2025-01-23 20:50:44,898 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 20:50:44,898 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 20:50:51,011 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 20:50:51,733 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 20:50:53,525 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 20:50:53,989 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:50:54,510 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 20:50:54,907 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 20:50:55,117 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 20:50:59,831 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-23 20:50:59,831 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 20:50:59,832 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 20:50:59,832 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 20:50:59,832 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-23 20:51:00,086 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 20:51:00,273 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 20:51:01,380 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 20:51:01,651 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:51:01,811 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 20:51:02,004 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 20:51:02,190 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 20:51:02,470 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 20:51:02,625 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 20:51:03,998 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 20:51:04,242 - [INFO] - Found 0 records with invalid hours
2025-01-23 20:51:04,420 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 20:51:04,627 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 20:51:04,972 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 20:51:08,916 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-23 20:51:09,615 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-23 20:51:09,616 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 20:51:09,616 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 20:51:09,617 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 20:51:09,617 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 20:51:09,618 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 20:51:09,618 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 20:51:09,619 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 20:51:09,620 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 20:51:09,620 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-23 20:51:09,620 - [INFO] - Successfully processed 2 dates
2025-01-23 20:51:09,620 - [INFO] - Starting client report loading process...
2025-01-23 20:51:09,621 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-23 20:51:09,622 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 20:51:09,630 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 20:51:09,633 - [INFO] - Archived 0 unique rows
2025-01-23 20:51:09,646 - [INFO] - Successfully loaded 48 rows
2025-01-23 20:51:09,653 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-23 20:51:09,654 - [INFO] - - Archived rows: 0
2025-01-23 20:51:09,654 - [INFO] - - Loaded rows: 48
2025-01-23 20:51:09,654 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-23 20:51:09,664 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 20:51:09,670 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 20:51:09,672 - [INFO] - Archived 0 unique rows
2025-01-23 20:51:09,680 - [INFO] - Successfully loaded 48 rows
2025-01-23 20:51:09,685 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-23 20:51:09,685 - [INFO] - - Archived rows: 0
2025-01-23 20:51:09,685 - [INFO] - - Loaded rows: 48
2025-01-23 20:51:09,685 - [INFO] - 
Verifying data load...
2025-01-23 20:51:09,689 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-23 20:51:09,690 - [INFO] - 
Load Summary:
2025-01-23 20:51:09,690 - [INFO] - Total files processed: 2
2025-01-23 20:51:09,690 - [INFO] - Total rows loaded: 96
2025-01-23 20:51:09,690 - [INFO] - 
Date Range:
2025-01-23 20:51:09,690 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-23 20:51:09,690 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 20:51:09,690 - [INFO] - 
Total Counts:
2025-01-23 20:51:09,690 - [INFO] -   Impressions: 44
2025-01-23 20:51:09,690 - [INFO] -   Clicks: 30
2025-01-23 20:51:09,690 - [INFO] - 
Client report loading completed successfully
2025-01-23 20:51:09,690 - [INFO] - Processing and loading completed successfully
2025-01-23 20:51:09,901 - [INFO] - Spark Session stopped
2025-01-23 21:03:57,363 - [INFO] - Starting application...
2025-01-23 21:03:57,427 - [INFO] - Database schema and tables verified/created successfully
2025-01-23 21:04:23,380 - [INFO] - Spark Session created successfully
2025-01-23 21:04:23,380 - [INFO] - Spark version: 3.5.4
2025-01-23 21:04:23,380 - [INFO] - Spark master: local[*]
2025-01-23 21:04:23,381 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-23 21:04:23,381 - [INFO] - Starting file processing...
2025-01-23 21:04:23,381 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-23 21:04:23,381 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-23 21:04:23,381 - [INFO] - User agent filter: some user agent
2025-01-23 21:04:23,382 - [INFO] - Found 11 total parquet files
2025-01-23 21:04:23,382 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-23 21:04:23,382 - [INFO] - Clicks files by date: 2022-05-27
2025-01-23 21:04:28,458 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 21:04:28,881 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-23 21:04:30,613 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 21:04:31,049 - [INFO] - Found 0 records with invalid hours
2025-01-23 21:04:31,416 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 21:04:31,790 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-23 21:04:32,072 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-23 21:04:37,171 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-23 21:04:37,171 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-23 21:04:37,172 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-23 21:04:37,172 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-23 21:04:37,172 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-23 21:04:37,459 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-23 21:04:37,603 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-23 21:04:38,715 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 21:04:38,957 - [INFO] - Found 0 records with invalid hours
2025-01-23 21:04:39,153 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-23 21:04:39,427 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-23 21:04:39,645 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-23 21:04:39,911 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-23 21:04:40,096 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-23 21:04:41,492 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 21:04:41,784 - [INFO] - Found 0 records with invalid hours
2025-01-23 21:04:42,041 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 21:04:42,415 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-23 21:04:42,912 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-23 21:04:47,530 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-23 21:04:48,226 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-23 21:04:48,226 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-23 21:04:48,227 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-23 21:04:48,228 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-23 21:04:48,228 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-23 21:04:48,229 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-23 21:04:48,229 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-23 21:04:48,230 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-23 21:04:48,230 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-23 21:04:48,230 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-23 21:04:48,231 - [INFO] - Successfully processed 2 dates
2025-01-23 21:04:48,231 - [INFO] - Starting client report loading process...
2025-01-23 21:04:48,231 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-23 21:04:48,233 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 21:04:48,242 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 21:04:48,246 - [INFO] - Archived 0 unique rows
2025-01-23 21:04:48,262 - [INFO] - Successfully loaded 48 rows
2025-01-23 21:04:48,267 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-23 21:04:48,267 - [INFO] - - Archived rows: 0
2025-01-23 21:04:48,267 - [INFO] - - Loaded rows: 48
2025-01-23 21:04:48,267 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-23 21:04:48,277 - [INFO] - Read CSV with shape: (24, 4)
2025-01-23 21:04:48,283 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-23 21:04:48,287 - [INFO] - Archived 0 unique rows
2025-01-23 21:04:48,295 - [INFO] - Successfully loaded 48 rows
2025-01-23 21:04:48,300 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-23 21:04:48,300 - [INFO] - - Archived rows: 0
2025-01-23 21:04:48,300 - [INFO] - - Loaded rows: 48
2025-01-23 21:04:48,300 - [INFO] - 
Verifying data load...
2025-01-23 21:04:48,305 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-23 21:04:48,307 - [INFO] - 
Load Summary:
2025-01-23 21:04:48,307 - [INFO] - Total files processed: 2
2025-01-23 21:04:48,307 - [INFO] - Total rows loaded: 96
2025-01-23 21:04:48,307 - [INFO] - 
Date Range:
2025-01-23 21:04:48,307 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-23 21:04:48,307 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-23 21:04:48,307 - [INFO] - 
Total Counts:
2025-01-23 21:04:48,307 - [INFO] -   Impressions: 44
2025-01-23 21:04:48,307 - [INFO] -   Clicks: 30
2025-01-23 21:04:48,307 - [INFO] - 
Client report loading completed successfully
2025-01-23 21:04:48,307 - [INFO] - Processing and loading completed successfully
2025-01-23 21:04:48,530 - [INFO] - Spark Session stopped
2025-01-24 07:50:10,183 - [INFO] - Starting application...
2025-01-24 07:50:10,298 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-24 07:51:09,104 - [INFO] - Starting application...
2025-01-24 07:51:09,290 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-24 07:53:11,766 - [INFO] - Starting application...
2025-01-24 07:53:11,847 - [INFO] - Database schema and tables verified/created successfully
2025-01-24 07:53:44,970 - [INFO] - Spark Session created successfully
2025-01-24 07:53:44,971 - [INFO] - Spark version: 3.5.4
2025-01-24 07:53:44,971 - [INFO] - Spark master: local[*]
2025-01-24 07:53:44,971 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-24 07:53:44,971 - [INFO] - Starting file processing...
2025-01-24 07:53:44,971 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-24 07:53:44,971 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-24 07:53:44,971 - [INFO] - User agent filter: some user agent
2025-01-24 07:53:44,972 - [INFO] - Found 11 total parquet files
2025-01-24 07:53:44,972 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-24 07:53:44,972 - [INFO] - Clicks files by date: 2022-05-27
2025-01-24 07:53:50,420 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-24 07:53:50,860 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-24 07:53:52,565 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-24 07:53:53,000 - [INFO] - Found 0 records with invalid hours
2025-01-24 07:53:53,350 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-24 07:53:53,690 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-24 07:53:53,913 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-24 07:53:58,738 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-24 07:53:58,739 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-24 07:53:58,739 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-24 07:53:58,740 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-24 07:53:58,740 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-24 07:53:59,035 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-24 07:53:59,194 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-24 07:54:00,291 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-24 07:54:00,550 - [INFO] - Found 0 records with invalid hours
2025-01-24 07:54:00,743 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-24 07:54:00,932 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-24 07:54:01,071 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-24 07:54:01,342 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-24 07:54:01,480 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-24 07:54:02,807 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-24 07:54:03,068 - [INFO] - Found 0 records with invalid hours
2025-01-24 07:54:03,338 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-24 07:54:03,544 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-24 07:54:03,818 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-24 07:54:07,899 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-24 07:54:08,587 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-24 07:54:08,588 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-24 07:54:08,588 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-24 07:54:08,589 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-24 07:54:08,589 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-24 07:54:08,590 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-24 07:54:08,590 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-24 07:54:08,591 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-24 07:54:08,591 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-24 07:54:08,591 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-24 07:54:08,591 - [INFO] - Successfully processed 2 dates
2025-01-24 07:54:08,591 - [INFO] - Starting client report loading process...
2025-01-24 07:54:08,592 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-24 07:54:08,594 - [INFO] - Read CSV with shape: (24, 4)
2025-01-24 07:54:08,609 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-24 07:54:08,625 - [INFO] - Archived 0 unique rows
2025-01-24 07:54:08,641 - [INFO] - Successfully loaded 48 rows
2025-01-24 07:54:08,647 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-24 07:54:08,647 - [INFO] - - Archived rows: 0
2025-01-24 07:54:08,647 - [INFO] - - Loaded rows: 48
2025-01-24 07:54:08,648 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-24 07:54:08,657 - [INFO] - Read CSV with shape: (24, 4)
2025-01-24 07:54:08,662 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-24 07:54:08,666 - [INFO] - Archived 0 unique rows
2025-01-24 07:54:08,674 - [INFO] - Successfully loaded 48 rows
2025-01-24 07:54:08,681 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-24 07:54:08,681 - [INFO] - - Archived rows: 0
2025-01-24 07:54:08,682 - [INFO] - - Loaded rows: 48
2025-01-24 07:54:08,682 - [INFO] - 
Verifying data load...
2025-01-24 07:54:08,690 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-24 07:54:08,691 - [INFO] - 
Load Summary:
2025-01-24 07:54:08,691 - [INFO] - Total files processed: 2
2025-01-24 07:54:08,691 - [INFO] - Total rows loaded: 96
2025-01-24 07:54:08,691 - [INFO] - 
Date Range:
2025-01-24 07:54:08,691 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-24 07:54:08,691 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-24 07:54:08,691 - [INFO] - 
Total Counts:
2025-01-24 07:54:08,692 - [INFO] -   Impressions: 44
2025-01-24 07:54:08,692 - [INFO] -   Clicks: 30
2025-01-24 07:54:08,692 - [INFO] - 
Client report loading completed successfully
2025-01-24 07:54:08,692 - [INFO] - Processing and loading completed successfully
2025-01-24 07:54:08,896 - [INFO] - Spark Session stopped
2025-01-24 07:59:14,472 - [INFO] - Starting application...
2025-01-24 07:59:14,539 - [INFO] - Database schema and tables verified/created successfully
2025-01-24 07:59:40,449 - [INFO] - Spark Session created successfully
2025-01-24 07:59:40,450 - [INFO] - Spark version: 3.5.4
2025-01-24 07:59:40,450 - [INFO] - Spark master: local[*]
2025-01-24 07:59:40,450 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-24 07:59:40,450 - [INFO] - Starting file processing...
2025-01-24 07:59:40,450 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-24 07:59:40,450 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-24 07:59:40,450 - [INFO] - User agent filter: some user agent
2025-01-24 07:59:40,451 - [INFO] - Found 11 total parquet files
2025-01-24 07:59:40,451 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-24 07:59:40,451 - [INFO] - Clicks files by date: 2022-05-27
2025-01-24 07:59:45,535 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-24 07:59:46,003 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-24 07:59:47,711 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-24 07:59:48,172 - [INFO] - Found 0 records with invalid hours
2025-01-24 07:59:48,566 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-24 07:59:48,941 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-24 07:59:49,220 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-24 07:59:53,896 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-24 07:59:53,897 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-24 07:59:53,897 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-24 07:59:53,898 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-24 07:59:53,898 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-24 07:59:54,176 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-24 07:59:54,310 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-24 07:59:55,383 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-24 07:59:55,641 - [INFO] - Found 0 records with invalid hours
2025-01-24 07:59:55,823 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-24 07:59:56,088 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-24 07:59:56,293 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-24 07:59:56,584 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-24 07:59:56,733 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-24 07:59:58,098 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-24 07:59:58,395 - [INFO] - Found 0 records with invalid hours
2025-01-24 07:59:58,625 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-24 07:59:58,794 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-24 07:59:59,002 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-24 08:00:03,347 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-24 08:00:04,127 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-24 08:00:04,127 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-24 08:00:04,128 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-24 08:00:04,128 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-24 08:00:04,129 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-24 08:00:04,129 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-24 08:00:04,130 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-24 08:00:04,130 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-24 08:00:04,131 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-24 08:00:04,131 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-24 08:00:04,131 - [INFO] - Successfully processed 2 dates
2025-01-24 08:00:04,131 - [INFO] - Starting client report loading process...
2025-01-24 08:00:04,132 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-24 08:00:04,134 - [INFO] - Read CSV with shape: (24, 4)
2025-01-24 08:00:04,145 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-24 08:00:04,151 - [INFO] - Archived 0 unique rows
2025-01-24 08:00:04,166 - [INFO] - Successfully loaded 48 rows
2025-01-24 08:00:04,172 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-24 08:00:04,172 - [INFO] - - Archived rows: 0
2025-01-24 08:00:04,173 - [INFO] - - Loaded rows: 48
2025-01-24 08:00:04,173 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-24 08:00:04,176 - [INFO] - Read CSV with shape: (24, 4)
2025-01-24 08:00:04,182 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-24 08:00:04,184 - [INFO] - Archived 0 unique rows
2025-01-24 08:00:04,193 - [INFO] - Successfully loaded 48 rows
2025-01-24 08:00:04,199 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-24 08:00:04,199 - [INFO] - - Archived rows: 0
2025-01-24 08:00:04,199 - [INFO] - - Loaded rows: 48
2025-01-24 08:00:04,199 - [INFO] - 
Verifying data load...
2025-01-24 08:00:04,204 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-24 08:00:04,205 - [INFO] - 
Load Summary:
2025-01-24 08:00:04,205 - [INFO] - Total files processed: 2
2025-01-24 08:00:04,205 - [INFO] - Total rows loaded: 96
2025-01-24 08:00:04,205 - [INFO] - 
Date Range:
2025-01-24 08:00:04,205 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-24 08:00:04,205 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-24 08:00:04,205 - [INFO] - 
Total Counts:
2025-01-24 08:00:04,206 - [INFO] -   Impressions: 44
2025-01-24 08:00:04,206 - [INFO] -   Clicks: 30
2025-01-24 08:00:04,206 - [INFO] - 
Client report loading completed successfully
2025-01-24 08:00:04,206 - [INFO] - Processing and loading completed successfully
2025-01-24 08:00:05,348 - [INFO] - Spark Session stopped
2025-01-25 21:41:28,786 - [INFO] - Starting application...
2025-01-25 21:43:27,016 - [INFO] - Starting application...
2025-01-25 21:43:31,144 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-25 21:44:21,889 - [INFO] - Starting application...
2025-01-25 21:44:22,044 - [INFO] - Database schema and tables verified/created successfully
2025-01-25 21:44:55,850 - [INFO] - Spark Session created successfully
2025-01-25 21:44:55,851 - [INFO] - Spark version: 3.5.4
2025-01-25 21:44:55,851 - [INFO] - Spark master: local[*]
2025-01-25 21:44:55,851 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-25 21:44:55,851 - [ERROR] - Error in process_and_load_data: DataProcessor.__init__() missing 2 required positional arguments: 'writer' and 'logger'
Traceback (most recent call last):
  File "C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\main.py", line 148, in process_and_load_data
    processor = DataProcessor(spark, logger)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: DataProcessor.__init__() missing 2 required positional arguments: 'writer' and 'logger'
2025-01-25 21:44:55,851 - [ERROR] - Processing or loading failed
2025-01-25 21:44:56,168 - [INFO] - Spark Session stopped
2025-01-25 21:47:29,180 - [INFO] - Starting application...
2025-01-25 21:47:29,268 - [INFO] - Database schema and tables verified/created successfully
2025-01-25 21:47:55,710 - [INFO] - Spark Session created successfully
2025-01-25 21:47:55,711 - [INFO] - Spark version: 3.5.4
2025-01-25 21:47:55,711 - [INFO] - Spark master: local[*]
2025-01-25 21:47:55,711 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-25 21:47:55,711 - [INFO] - Starting file processing...
2025-01-25 21:47:55,711 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-25 21:47:55,711 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-25 21:47:55,711 - [INFO] - User agent filter: some user agent
2025-01-25 21:47:55,712 - [INFO] - Found 11 total parquet files
2025-01-25 21:47:55,712 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-25 21:47:55,712 - [INFO] - Clicks files by date: 2022-05-27
2025-01-25 21:48:01,189 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 21:48:01,595 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-25 21:48:03,261 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-25 21:48:03,692 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:48:04,064 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-25 21:48:04,455 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-25 21:48:04,703 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-25 21:48:09,578 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-25 21:48:09,578 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-25 21:48:09,579 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-25 21:48:09,579 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-25 21:48:09,579 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-25 21:48:09,848 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 21:48:09,995 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-25 21:48:11,092 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-25 21:48:11,314 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:48:11,472 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-25 21:48:11,674 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-25 21:48:11,846 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-25 21:48:12,094 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-25 21:48:12,254 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-25 21:48:13,615 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-25 21:48:13,865 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:48:14,063 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-25 21:48:14,265 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-25 21:48:14,459 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-25 21:48:18,230 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-25 21:48:18,912 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-25 21:48:18,912 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-25 21:48:18,913 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-25 21:48:18,913 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-25 21:48:18,914 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-25 21:48:18,914 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-25 21:48:18,915 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-25 21:48:18,915 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-25 21:48:18,916 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-25 21:48:18,916 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-25 21:48:18,916 - [INFO] - Successfully processed 2 dates
2025-01-25 21:48:18,916 - [INFO] - Starting client report loading process...
2025-01-25 21:48:18,917 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'ClientReportETL' object has no attribute 'load_data'
2025-01-25 21:48:18,917 - [ERROR] - Processing or loading failed
2025-01-25 21:48:19,219 - [INFO] - Spark Session stopped
2025-01-25 21:51:08,767 - [INFO] - Starting application...
2025-01-25 21:51:08,842 - [INFO] - Database schema and tables verified/created successfully
2025-01-25 21:51:25,047 - [INFO] - Spark Session created successfully
2025-01-25 21:51:25,047 - [INFO] - Spark version: 3.5.4
2025-01-25 21:51:25,047 - [INFO] - Spark master: local[*]
2025-01-25 21:51:25,047 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-25 21:51:25,047 - [INFO] - Starting file processing...
2025-01-25 21:51:25,047 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-25 21:51:25,047 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-25 21:51:25,047 - [INFO] - User agent filter: some user agent
2025-01-25 21:51:25,048 - [INFO] - Found 11 total parquet files
2025-01-25 21:51:25,049 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-25 21:51:25,049 - [INFO] - Clicks files by date: 2022-05-27
2025-01-25 21:51:32,279 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 21:51:32,904 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-25 21:51:35,163 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-25 21:51:35,587 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:51:36,009 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-25 21:51:36,372 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-25 21:51:36,653 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-25 21:51:41,452 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-25 21:51:41,453 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-25 21:51:41,453 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-25 21:51:41,454 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-25 21:51:41,454 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-25 21:51:41,757 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 21:51:41,930 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-25 21:51:43,050 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-25 21:51:43,312 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:51:43,482 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-25 21:51:43,675 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-25 21:51:43,894 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-25 21:51:44,194 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-25 21:51:44,342 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-25 21:51:45,676 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-25 21:51:45,913 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:51:46,087 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-25 21:51:46,326 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-25 21:51:46,497 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-25 21:51:50,273 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-25 21:51:51,014 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-25 21:51:51,014 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-25 21:51:51,015 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-25 21:51:51,015 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-25 21:51:51,015 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-25 21:51:51,016 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-25 21:51:51,016 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-25 21:51:51,017 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-25 21:51:51,017 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-25 21:51:51,017 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-25 21:51:51,017 - [INFO] - Successfully processed 2 dates
2025-01-25 21:51:51,017 - [INFO] - Starting client report loading process...
2025-01-25 21:51:51,018 - [ERROR] - Error loading data: 'WindowsPath' object is not subscriptable
2025-01-25 21:51:51,018 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'WindowsPath' object is not subscriptable
2025-01-25 21:51:51,018 - [ERROR] - Processing or loading failed
2025-01-25 21:51:51,278 - [INFO] - Spark Session stopped
2025-01-25 21:58:00,285 - [INFO] - Starting application...
2025-01-25 21:58:00,360 - [INFO] - Database schema and tables verified/created successfully
2025-01-25 21:58:16,826 - [INFO] - Spark Session created successfully
2025-01-25 21:58:16,827 - [INFO] - Spark version: 3.5.4
2025-01-25 21:58:16,827 - [INFO] - Spark master: local[*]
2025-01-25 21:58:16,827 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-25 21:58:16,827 - [INFO] - Starting file processing...
2025-01-25 21:58:16,827 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-25 21:58:16,827 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-25 21:58:16,827 - [INFO] - User agent filter: some user agent
2025-01-25 21:58:16,828 - [INFO] - Found 11 total parquet files
2025-01-25 21:58:16,828 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-25 21:58:16,828 - [INFO] - Clicks files by date: 2022-05-27
2025-01-25 21:58:21,788 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 21:58:22,198 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-25 21:58:23,793 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-25 21:58:24,209 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:58:24,593 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-25 21:58:24,954 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-25 21:58:25,167 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-25 21:58:29,747 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-25 21:58:29,748 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-25 21:58:29,748 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-25 21:58:29,749 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-25 21:58:29,749 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-25 21:58:30,089 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 21:58:30,232 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-25 21:58:31,321 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-25 21:58:31,552 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:58:31,708 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-25 21:58:31,881 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-25 21:58:32,073 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-25 21:58:32,321 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-25 21:58:32,454 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-25 21:58:33,691 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-25 21:58:33,913 - [INFO] - Found 0 records with invalid hours
2025-01-25 21:58:34,084 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-25 21:58:34,287 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-25 21:58:34,458 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-25 21:58:38,670 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-25 21:58:39,809 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-25 21:58:39,810 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-25 21:58:39,810 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-25 21:58:39,811 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-25 21:58:39,812 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-25 21:58:39,812 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-25 21:58:39,813 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-25 21:58:39,813 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-25 21:58:39,814 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-25 21:58:39,814 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-25 21:58:39,814 - [INFO] - Successfully processed 2 dates
2025-01-25 21:58:39,814 - [INFO] - Starting client report loading process...
2025-01-25 21:58:39,819 - [ERROR] - Error loading data: 'datetime'
2025-01-25 21:58:39,819 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'datetime'
2025-01-25 21:58:39,819 - [ERROR] - Processing or loading failed
2025-01-25 21:58:40,673 - [INFO] - Spark Session stopped
2025-01-25 21:59:57,596 - [INFO] - Starting application...
2025-01-25 21:59:57,673 - [INFO] - Database schema and tables verified/created successfully
2025-01-25 22:00:03,434 - [INFO] - Spark Session created successfully
2025-01-25 22:00:03,434 - [INFO] - Spark version: 3.5.4
2025-01-25 22:00:03,434 - [INFO] - Spark master: local[*]
2025-01-25 22:00:03,434 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-25 22:00:03,434 - [INFO] - Starting file processing...
2025-01-25 22:00:03,434 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-25 22:00:03,435 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-25 22:00:03,435 - [INFO] - User agent filter: some user agent
2025-01-25 22:00:03,435 - [INFO] - Found 11 total parquet files
2025-01-25 22:00:03,435 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-25 22:00:03,436 - [INFO] - Clicks files by date: 2022-05-27
2025-01-25 22:00:08,415 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 22:00:08,855 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-25 22:00:10,543 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-25 22:00:10,984 - [INFO] - Found 0 records with invalid hours
2025-01-25 22:00:11,389 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-25 22:00:11,780 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-25 22:00:12,016 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-25 22:00:16,697 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-25 22:00:16,697 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-25 22:00:16,698 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-25 22:00:16,698 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-25 22:00:16,698 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-25 22:00:16,965 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 22:00:17,094 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-25 22:00:18,151 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-25 22:00:18,369 - [INFO] - Found 0 records with invalid hours
2025-01-25 22:00:18,543 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-25 22:00:18,733 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-25 22:00:18,932 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-25 22:00:19,167 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-25 22:00:19,304 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-25 22:00:20,606 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-25 22:00:20,824 - [INFO] - Found 0 records with invalid hours
2025-01-25 22:00:21,001 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-25 22:00:21,230 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-25 22:00:21,402 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-25 22:00:25,182 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-25 22:00:25,861 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-25 22:00:25,862 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-25 22:00:25,862 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-25 22:00:25,863 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-25 22:00:25,863 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-25 22:00:25,864 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-25 22:00:25,864 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-25 22:00:25,865 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-25 22:00:25,865 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-25 22:00:25,865 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-25 22:00:25,865 - [INFO] - Successfully processed 2 dates
2025-01-25 22:00:25,865 - [INFO] - Starting client report loading process...
2025-01-25 22:00:25,866 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-25 22:00:25,868 - [INFO] - Read CSV with shape: (24, 4)
2025-01-25 22:00:25,881 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-25 22:00:25,889 - [INFO] - Archived 0 unique rows
2025-01-25 22:00:25,908 - [INFO] - Successfully loaded 48 rows
2025-01-25 22:00:25,915 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-25 22:00:25,915 - [INFO] - - Archived rows: 0
2025-01-25 22:00:25,915 - [INFO] - - Loaded rows: 48
2025-01-25 22:00:25,915 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-25 22:00:25,925 - [INFO] - Read CSV with shape: (24, 4)
2025-01-25 22:00:25,930 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-25 22:00:25,933 - [INFO] - Archived 0 unique rows
2025-01-25 22:00:25,939 - [INFO] - Successfully loaded 48 rows
2025-01-25 22:00:25,943 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-25 22:00:25,943 - [INFO] - - Archived rows: 0
2025-01-25 22:00:25,943 - [INFO] - - Loaded rows: 48
2025-01-25 22:00:25,943 - [INFO] - 
Verifying data load...
2025-01-25 22:00:25,949 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-25 22:00:25,950 - [INFO] - 
Load Summary:
2025-01-25 22:00:25,950 - [INFO] - Total files processed: 2
2025-01-25 22:00:25,950 - [INFO] - Total rows loaded: 96
2025-01-25 22:00:25,950 - [INFO] - 
Date Range:
2025-01-25 22:00:25,950 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-25 22:00:25,950 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-25 22:00:25,950 - [INFO] - 
Total Counts:
2025-01-25 22:00:25,951 - [INFO] -   Impressions: 44
2025-01-25 22:00:25,951 - [INFO] -   Clicks: 30
2025-01-25 22:00:25,951 - [INFO] - 
Client report loading completed successfully
2025-01-25 22:00:25,951 - [INFO] - Processing and loading completed successfully
2025-01-25 22:00:26,171 - [INFO] - Spark Session stopped
2025-01-25 22:26:36,634 - [INFO] - Database schema and tables verified/created successfully
2025-01-25 22:26:36,636 - [INFO] - Starting file processing...
2025-01-25 22:26:36,636 - [INFO] - Input path: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\raw_data
2025-01-25 22:26:36,636 - [INFO] - Output path: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output
2025-01-25 22:26:36,636 - [INFO] - User agent filter: some user agent
2025-01-25 22:26:36,637 - [INFO] - Found 11 total parquet files
2025-01-25 22:26:36,637 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-25 22:26:36,637 - [INFO] - Clicks files by date: 2022-05-27
2025-01-25 22:26:41,732 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 22:26:42,215 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-25 22:26:52,957 - [ERROR] - Error processing files for date '2022-05-26': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)
	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)
	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)
	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketTimeoutException: Accept timed out
	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)
	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:551)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:519)
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.apache.spark.SparkException: Python worker failed to connect back.
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)
	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)
	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)
	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: java.net.SocketTimeoutException: Accept timed out
	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)
	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:551)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:519)
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)
	... 17 more

2025-01-25 22:26:52,958 - [WARNING] - Failed to process data for date: 2022-05-26 - An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)
	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)
	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)
	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketTimeoutException: Accept timed out
	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)
	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:551)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:519)
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.apache.spark.SparkException: Python worker failed to connect back.
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)
	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)
	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)
	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: java.net.SocketTimeoutException: Accept timed out
	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)
	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:551)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:519)
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)
	... 17 more

2025-01-25 22:26:53,349 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-25 22:26:53,535 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-25 22:27:03,862 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 15.0 failed 1 times, most recent failure: Lost task 0.0 in stage 15.0 (TID 15) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)
	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)
	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)
	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketTimeoutException: Accept timed out
	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)
	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:551)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:519)
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.apache.spark.SparkException: Python worker failed to connect back.
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)
	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)
	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)
	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: java.net.SocketTimeoutException: Accept timed out
	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)
	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:551)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:519)
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)
	... 17 more

2025-01-25 22:27:03,863 - [WARNING] - Failed to process data for date: 2022-05-27 - An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 15.0 failed 1 times, most recent failure: Lost task 0.0 in stage 15.0 (TID 15) (host.docker.internal executor driver): org.apache.spark.SparkException: Python worker failed to connect back.
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)
	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)
	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)
	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketTimeoutException: Accept timed out
	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)
	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:551)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:519)
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)
	... 17 more

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: org.apache.spark.SparkException: Python worker failed to connect back.
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:203)
	at org.apache.spark.api.python.PythonWorkerFactory.create(PythonWorkerFactory.scala:109)
	at org.apache.spark.SparkEnv.createPythonWorker(SparkEnv.scala:124)
	at org.apache.spark.api.python.BasePythonRunner.compute(PythonRunner.scala:174)
	at org.apache.spark.api.python.PythonRDD.compute(PythonRDD.scala:67)
	at org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:367)
	at org.apache.spark.rdd.RDD.iterator(RDD.scala:331)
	at org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:93)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:166)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	... 1 more
Caused by: java.net.SocketTimeoutException: Accept timed out
	at java.base/java.net.PlainSocketImpl.waitForNewConnection(Native Method)
	at java.base/java.net.PlainSocketImpl.socketAccept(PlainSocketImpl.java:163)
	at java.base/java.net.AbstractPlainSocketImpl.accept(AbstractPlainSocketImpl.java:458)
	at java.base/java.net.ServerSocket.implAccept(ServerSocket.java:551)
	at java.base/java.net.ServerSocket.accept(ServerSocket.java:519)
	at org.apache.spark.api.python.PythonWorkerFactory.createSimpleWorker(PythonWorkerFactory.scala:190)
	... 17 more

2025-01-25 22:27:03,863 - [ERROR] - No dates were successfully processed
2025-01-25 22:27:03,863 - [ERROR] - Pipeline error: Spark processing failed
2025-01-26 17:33:50,851 - [INFO] - Starting application...
2025-01-26 17:33:50,947 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 17:33:55,137 - [INFO] - Spark Session created successfully
2025-01-26 17:33:55,139 - [INFO] - Spark version: 3.5.0
2025-01-26 17:33:55,139 - [INFO] - Spark master: local[*]
2025-01-26 17:33:55,140 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 17:33:55,140 - [INFO] - Starting file processing...
2025-01-26 17:33:55,141 - [INFO] - Input path: /app/raw_data
2025-01-26 17:33:55,141 - [INFO] - Output path: /app/output
2025-01-26 17:33:55,142 - [INFO] - User agent filter: some user agent
2025-01-26 17:33:55,171 - [INFO] - Found 11 total parquet files
2025-01-26 17:33:55,171 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-26 17:33:55,172 - [INFO] - Clicks files by date: 2022-05-27
2025-01-26 17:34:01,004 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 17:34:01,585 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-26 17:34:03,746 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 17:34:04,661 - [INFO] - Found 0 records with invalid hours
2025-01-26 17:34:05,397 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 17:34:06,047 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-26 17:34:06,474 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 17:34:10,339 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-26 17:34:10,343 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-26 17:34:10,347 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 17:34:10,350 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-26 17:34:10,351 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-26 17:34:10,679 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 17:34:10,868 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-26 17:34:11,380 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 17:34:11,814 - [INFO] - Found 0 records with invalid hours
2025-01-26 17:34:12,110 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-26 17:34:12,436 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-26 17:34:12,717 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-26 17:34:13,090 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-26 17:34:13,346 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-26 17:34:14,025 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 17:34:14,479 - [INFO] - Found 0 records with invalid hours
2025-01-26 17:34:14,706 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 17:34:15,098 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-26 17:34:15,379 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 17:34:16,370 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-26 17:34:17,426 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-26 17:34:17,430 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-26 17:34:17,434 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 17:34:17,438 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-26 17:34:17,442 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-26 17:34:17,445 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 17:34:17,449 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-26 17:34:17,454 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-26 17:34:17,457 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-26 17:34:17,458 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-26 17:34:17,458 - [INFO] - Successfully processed 2 dates
2025-01-26 17:34:17,459 - [INFO] - Starting client report loading process...
2025-01-26 17:34:17,470 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-26 17:34:17,506 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 17:34:17,677 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 17:34:17,826 - [INFO] - Archived 0 unique rows
2025-01-26 17:34:18,211 - [INFO] - Successfully loaded 48 rows
2025-01-26 17:34:18,223 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-26 17:34:18,224 - [INFO] - - Archived rows: 0
2025-01-26 17:34:18,224 - [INFO] - - Loaded rows: 48
2025-01-26 17:34:18,225 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-26 17:34:18,232 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 17:34:18,239 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 17:34:18,241 - [INFO] - Archived 0 unique rows
2025-01-26 17:34:18,247 - [INFO] - Successfully loaded 48 rows
2025-01-26 17:34:18,251 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-26 17:34:18,252 - [INFO] - - Archived rows: 0
2025-01-26 17:34:18,252 - [INFO] - - Loaded rows: 48
2025-01-26 17:34:18,253 - [INFO] - 
Verifying data load...
2025-01-26 17:34:18,262 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-26 17:34:18,263 - [INFO] - 
Load Summary:
2025-01-26 17:34:18,264 - [INFO] - Total files processed: 2
2025-01-26 17:34:18,264 - [INFO] - Total rows loaded: 96
2025-01-26 17:34:18,265 - [INFO] - 
Date Range:
2025-01-26 17:34:18,265 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-26 17:34:18,266 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-26 17:34:18,266 - [INFO] - 
Total Counts:
2025-01-26 17:34:18,267 - [INFO] -   Impressions: 44
2025-01-26 17:34:18,267 - [INFO] -   Clicks: 30
2025-01-26 17:34:18,268 - [INFO] - 
Client report loading completed successfully
2025-01-26 17:34:18,268 - [INFO] - Processing and loading completed successfully
2025-01-26 17:34:19,412 - [INFO] - Spark Session stopped
2025-01-26 17:41:44,208 - [INFO] - Starting application...
2025-01-26 17:41:45,135 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 17:41:52,234 - [INFO] - Spark Session created successfully
2025-01-26 17:41:52,235 - [INFO] - Spark version: 3.5.0
2025-01-26 17:41:52,236 - [INFO] - Spark master: local[*]
2025-01-26 17:41:52,236 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 17:41:52,237 - [INFO] - Starting file processing...
2025-01-26 17:41:52,238 - [INFO] - Input path: /app/raw_data
2025-01-26 17:41:52,239 - [INFO] - Output path: /app/output
2025-01-26 17:41:52,239 - [INFO] - User agent filter: some user agent
2025-01-26 17:41:52,243 - [WARNING] - No parquet files found in input directory
2025-01-26 17:41:52,244 - [ERROR] - Spark processing failed
2025-01-26 17:41:52,244 - [ERROR] - Processing or loading failed
2025-01-26 17:41:52,811 - [INFO] - Spark Session stopped
2025-01-26 18:09:03,838 - [INFO] - Starting application...
2025-01-26 18:09:03,894 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 18:09:06,846 - [INFO] - Spark Session created successfully
2025-01-26 18:09:06,847 - [INFO] - Spark version: 3.5.0
2025-01-26 18:09:06,848 - [INFO] - Spark master: local[*]
2025-01-26 18:09:06,849 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 18:09:06,849 - [INFO] - Starting file processing...
2025-01-26 18:09:06,850 - [INFO] - Input path: /app/raw_data
2025-01-26 18:09:06,850 - [INFO] - Output path: /app/output
2025-01-26 18:09:06,852 - [INFO] - User agent filter: some user agent
2025-01-26 18:09:06,874 - [INFO] - Found 11 total parquet files
2025-01-26 18:09:06,874 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-26 18:09:06,875 - [INFO] - Clicks files by date: 2022-05-27
2025-01-26 18:09:11,245 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 18:09:11,768 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-26 18:09:13,321 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 18:09:13,955 - [INFO] - Found 0 records with invalid hours
2025-01-26 18:09:14,507 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 18:09:15,093 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-26 18:09:15,422 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 18:09:18,130 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-26 18:09:18,134 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-26 18:09:18,138 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 18:09:18,141 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-26 18:09:18,142 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-26 18:09:18,382 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 18:09:18,526 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-26 18:09:18,824 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 18:09:19,171 - [INFO] - Found 0 records with invalid hours
2025-01-26 18:09:19,331 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-26 18:09:19,578 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-26 18:09:19,809 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-26 18:09:20,092 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-26 18:09:20,285 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-26 18:09:20,697 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 18:09:21,170 - [INFO] - Found 0 records with invalid hours
2025-01-26 18:09:21,377 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 18:09:21,649 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-26 18:09:21,929 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 18:09:22,812 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-26 18:09:23,655 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-26 18:09:23,660 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-26 18:09:23,664 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 18:09:23,668 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-26 18:09:23,672 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-26 18:09:23,675 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 18:09:23,679 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-26 18:09:23,683 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-26 18:09:23,687 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-26 18:09:23,687 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-26 18:09:23,688 - [INFO] - Successfully processed 2 dates
2025-01-26 18:09:23,689 - [INFO] - Starting client report loading process...
2025-01-26 18:09:23,696 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-26 18:09:23,706 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 18:09:23,727 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 18:09:23,741 - [INFO] - Archived 0 unique rows
2025-01-26 18:09:23,766 - [INFO] - Successfully loaded 48 rows
2025-01-26 18:09:23,770 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-26 18:09:23,771 - [INFO] - - Archived rows: 0
2025-01-26 18:09:23,772 - [INFO] - - Loaded rows: 48
2025-01-26 18:09:23,772 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-26 18:09:23,778 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 18:09:23,783 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 18:09:23,785 - [INFO] - Archived 0 unique rows
2025-01-26 18:09:23,790 - [INFO] - Successfully loaded 48 rows
2025-01-26 18:09:23,794 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-26 18:09:23,795 - [INFO] - - Archived rows: 0
2025-01-26 18:09:23,796 - [INFO] - - Loaded rows: 48
2025-01-26 18:09:23,796 - [INFO] - 
Verifying data load...
2025-01-26 18:09:23,801 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-26 18:09:23,802 - [INFO] - 
Load Summary:
2025-01-26 18:09:23,803 - [INFO] - Total files processed: 2
2025-01-26 18:09:23,804 - [INFO] - Total rows loaded: 96
2025-01-26 18:09:23,804 - [INFO] - 
Date Range:
2025-01-26 18:09:23,805 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-26 18:09:23,806 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-26 18:09:23,806 - [INFO] - 
Total Counts:
2025-01-26 18:09:23,807 - [INFO] -   Impressions: 44
2025-01-26 18:09:23,807 - [INFO] -   Clicks: 30
2025-01-26 18:09:23,807 - [INFO] - 
Client report loading completed successfully
2025-01-26 18:09:23,808 - [INFO] - Processing and loading completed successfully
2025-01-26 18:09:24,841 - [INFO] - Spark Session stopped
2025-01-26 20:19:24,422 - [INFO] - Starting application...
2025-01-26 20:19:28,556 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 20:19:51,128 - [INFO] - Starting application...
2025-01-26 20:19:51,236 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 20:20:24,731 - [INFO] - Spark Session created successfully
2025-01-26 20:20:24,731 - [INFO] - Spark version: 3.5.4
2025-01-26 20:20:24,731 - [INFO] - Spark master: local[*]
2025-01-26 20:20:24,731 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 20:20:24,732 - [INFO] - Starting file processing...
2025-01-26 20:20:24,732 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-26 20:20:24,732 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-26 20:20:24,732 - [INFO] - User agent filter: some user agent
2025-01-26 20:20:24,733 - [INFO] - Found 11 total parquet files
2025-01-26 20:20:24,733 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-26 20:20:24,733 - [INFO] - Clicks files by date: 2022-05-27
2025-01-26 20:20:30,302 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 20:20:30,727 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-26 20:20:32,410 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 20:20:32,850 - [INFO] - Found 0 records with invalid hours
2025-01-26 20:20:33,237 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 20:20:33,581 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-26 20:20:33,787 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 20:20:38,459 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-26 20:20:38,459 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-26 20:20:38,460 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 20:20:38,460 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-26 20:20:38,460 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-26 20:20:38,687 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 20:20:38,840 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-26 20:20:39,914 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 20:20:40,155 - [INFO] - Found 0 records with invalid hours
2025-01-26 20:20:40,342 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-26 20:20:40,499 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-26 20:20:40,686 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-26 20:20:41,000 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-26 20:20:41,145 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-26 20:20:42,483 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 20:20:42,818 - [INFO] - Found 0 records with invalid hours
2025-01-26 20:20:42,994 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 20:20:43,189 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-26 20:20:43,468 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 20:20:47,246 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-26 20:20:47,917 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-26 20:20:47,918 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-26 20:20:47,918 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 20:20:47,919 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-26 20:20:47,919 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-26 20:20:47,920 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 20:20:47,920 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-26 20:20:47,921 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-26 20:20:47,921 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-26 20:20:47,921 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-26 20:20:47,921 - [INFO] - Successfully processed 2 dates
2025-01-26 20:20:47,921 - [INFO] - Starting client report loading process...
2025-01-26 20:20:47,922 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-26 20:20:47,923 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 20:20:47,932 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 20:20:47,936 - [INFO] - Archived 0 unique rows
2025-01-26 20:20:47,952 - [INFO] - Successfully loaded 48 rows
2025-01-26 20:20:47,959 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-26 20:20:47,959 - [INFO] - - Archived rows: 0
2025-01-26 20:20:47,959 - [INFO] - - Loaded rows: 48
2025-01-26 20:20:47,959 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-26 20:20:47,968 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 20:20:47,974 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 20:20:47,977 - [INFO] - Archived 0 unique rows
2025-01-26 20:20:47,987 - [INFO] - Successfully loaded 48 rows
2025-01-26 20:20:47,991 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-26 20:20:47,991 - [INFO] - - Archived rows: 0
2025-01-26 20:20:47,991 - [INFO] - - Loaded rows: 48
2025-01-26 20:20:47,991 - [INFO] - 
Verifying data load...
2025-01-26 20:20:47,996 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-26 20:20:47,997 - [INFO] - 
Load Summary:
2025-01-26 20:20:47,997 - [INFO] - Total files processed: 2
2025-01-26 20:20:47,997 - [INFO] - Total rows loaded: 96
2025-01-26 20:20:47,997 - [INFO] - 
Date Range:
2025-01-26 20:20:47,998 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-26 20:20:47,998 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-26 20:20:47,998 - [INFO] - 
Total Counts:
2025-01-26 20:20:47,998 - [INFO] -   Impressions: 44
2025-01-26 20:20:47,998 - [INFO] -   Clicks: 30
2025-01-26 20:20:47,998 - [INFO] - 
Client report loading completed successfully
2025-01-26 20:20:47,998 - [INFO] - Processing and loading completed successfully
2025-01-26 20:20:48,234 - [INFO] - Spark Session stopped
2025-01-26 19:23:52,800 - [INFO] - Starting application...
2025-01-26 19:23:52,852 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 19:23:56,320 - [INFO] - Spark Session created successfully
2025-01-26 19:23:56,322 - [INFO] - Spark version: 3.5.0
2025-01-26 19:23:56,322 - [INFO] - Spark master: local[*]
2025-01-26 19:23:56,323 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 19:23:56,323 - [INFO] - Starting file processing...
2025-01-26 19:23:56,324 - [INFO] - Input path: /app/raw_data
2025-01-26 19:23:56,324 - [INFO] - Output path: /app/output
2025-01-26 19:23:56,325 - [INFO] - User agent filter: some user agent
2025-01-26 19:23:56,328 - [WARNING] - No parquet files found in input directory
2025-01-26 19:23:56,328 - [ERROR] - Spark processing failed
2025-01-26 19:23:56,329 - [ERROR] - Processing or loading failed
2025-01-26 19:23:56,527 - [INFO] - Spark Session stopped
2025-01-26 19:44:38,190 - [INFO] - Starting application...
2025-01-26 19:44:38,273 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 19:44:43,094 - [INFO] - Spark Session created successfully
2025-01-26 19:44:43,096 - [INFO] - Spark version: 3.5.0
2025-01-26 19:44:43,096 - [INFO] - Spark master: local[*]
2025-01-26 19:44:43,097 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 19:44:43,097 - [INFO] - Starting file processing...
2025-01-26 19:44:43,098 - [INFO] - Input path: /app/raw_data
2025-01-26 19:44:43,099 - [INFO] - Output path: /app/output
2025-01-26 19:44:43,099 - [INFO] - User agent filter: some user agent
2025-01-26 19:44:43,103 - [WARNING] - No parquet files found in input directory
2025-01-26 19:44:43,103 - [ERROR] - Spark processing failed
2025-01-26 19:44:43,104 - [ERROR] - Processing or loading failed
2025-01-26 19:44:43,197 - [INFO] - Spark Session stopped
2025-01-26 19:51:35,978 - [INFO] - Starting application...
2025-01-26 19:51:36,070 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 19:51:40,742 - [INFO] - Spark Session created successfully
2025-01-26 19:51:40,744 - [INFO] - Spark version: 3.5.0
2025-01-26 19:51:40,744 - [INFO] - Spark master: local[*]
2025-01-26 19:51:40,745 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 19:51:40,746 - [INFO] - Starting file processing...
2025-01-26 19:51:40,746 - [INFO] - Input path: /app/raw_data
2025-01-26 19:51:40,747 - [INFO] - Output path: /app/output
2025-01-26 19:51:40,748 - [INFO] - User agent filter: some user agent
2025-01-26 19:51:40,871 - [INFO] - Found 11 total parquet files
2025-01-26 19:51:40,872 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-26 19:51:40,872 - [INFO] - Clicks files by date: 2022-05-27
2025-01-26 19:51:47,946 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 19:51:48,636 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-26 19:51:50,519 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 19:51:51,463 - [INFO] - Found 0 records with invalid hours
2025-01-26 19:51:52,467 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 19:51:53,394 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-26 19:51:53,871 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 19:51:57,177 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-26 19:51:57,181 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-26 19:51:57,185 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 19:51:57,190 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-26 19:51:57,190 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-26 19:51:57,546 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 19:51:57,729 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-26 19:51:58,076 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 19:51:58,489 - [INFO] - Found 0 records with invalid hours
2025-01-26 19:51:58,722 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-26 19:51:59,068 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-26 19:51:59,355 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-26 19:52:00,077 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-26 19:52:00,422 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-26 19:52:01,469 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 19:52:02,075 - [INFO] - Found 0 records with invalid hours
2025-01-26 19:52:02,376 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 19:52:02,821 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-26 19:52:03,163 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 19:52:04,300 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-26 19:52:05,529 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-26 19:52:05,534 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-26 19:52:05,539 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 19:52:05,544 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-26 19:52:05,548 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-26 19:52:05,552 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 19:52:05,556 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-26 19:52:05,560 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-26 19:52:05,564 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-26 19:52:05,565 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-26 19:52:05,565 - [INFO] - Successfully processed 2 dates
2025-01-26 19:52:05,566 - [INFO] - Starting client report loading process...
2025-01-26 19:52:05,580 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-26 19:52:05,594 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 19:52:05,665 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 19:52:05,690 - [INFO] - Archived 0 unique rows
2025-01-26 19:52:05,765 - [INFO] - Successfully loaded 48 rows
2025-01-26 19:52:05,769 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-26 19:52:05,770 - [INFO] - - Archived rows: 0
2025-01-26 19:52:05,771 - [INFO] - - Loaded rows: 48
2025-01-26 19:52:05,772 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-26 19:52:05,779 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 19:52:05,792 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 19:52:05,794 - [INFO] - Archived 0 unique rows
2025-01-26 19:52:05,803 - [INFO] - Successfully loaded 48 rows
2025-01-26 19:52:05,806 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-26 19:52:05,807 - [INFO] - - Archived rows: 0
2025-01-26 19:52:05,808 - [INFO] - - Loaded rows: 48
2025-01-26 19:52:05,809 - [INFO] - 
Verifying data load...
2025-01-26 19:52:05,817 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-26 19:52:05,818 - [INFO] - 
Load Summary:
2025-01-26 19:52:05,819 - [INFO] - Total files processed: 2
2025-01-26 19:52:05,820 - [INFO] - Total rows loaded: 96
2025-01-26 19:52:05,821 - [INFO] - 
Date Range:
2025-01-26 19:52:05,822 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-26 19:52:05,822 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-26 19:52:05,823 - [INFO] - 
Total Counts:
2025-01-26 19:52:05,824 - [INFO] -   Impressions: 44
2025-01-26 19:52:05,825 - [INFO] -   Clicks: 30
2025-01-26 19:52:05,826 - [INFO] - 
Client report loading completed successfully
2025-01-26 19:52:05,826 - [INFO] - Processing and loading completed successfully
2025-01-26 19:52:06,340 - [INFO] - Spark Session stopped
2025-01-26 19:58:35,670 - [INFO] - Starting application...
2025-01-26 19:58:35,719 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 19:58:39,544 - [INFO] - Spark Session created successfully
2025-01-26 19:58:39,546 - [INFO] - Spark version: 3.5.0
2025-01-26 19:58:39,546 - [INFO] - Spark master: local[*]
2025-01-26 19:58:39,547 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 19:58:39,548 - [INFO] - Starting file processing...
2025-01-26 19:58:39,548 - [INFO] - Input path: /app/raw_data
2025-01-26 19:58:39,549 - [INFO] - Output path: /app/output
2025-01-26 19:58:39,549 - [INFO] - User agent filter: some user agent
2025-01-26 19:58:39,573 - [INFO] - Found 11 total parquet files
2025-01-26 19:58:39,573 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-26 19:58:39,574 - [INFO] - Clicks files by date: 2022-05-27
2025-01-26 19:58:43,951 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 19:58:44,457 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-26 19:58:46,129 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 19:58:46,788 - [INFO] - Found 0 records with invalid hours
2025-01-26 19:58:47,460 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 19:58:48,091 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-26 19:58:48,427 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-26 19:58:51,354 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-26 19:58:51,358 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-26 19:58:51,362 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-26 19:58:51,366 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-26 19:58:51,367 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-26 19:58:51,613 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-26 19:58:51,818 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-26 19:58:52,137 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 19:58:52,494 - [INFO] - Found 0 records with invalid hours
2025-01-26 19:58:52,653 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-26 19:58:52,922 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-26 19:58:53,167 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-26 19:58:53,446 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-26 19:58:53,643 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-26 19:58:54,038 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 19:58:54,393 - [INFO] - Found 0 records with invalid hours
2025-01-26 19:58:54,614 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 19:58:54,943 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-26 19:58:55,189 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-26 19:58:55,994 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-26 19:58:56,955 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-26 19:58:56,960 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-26 19:58:56,964 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-26 19:58:56,968 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-26 19:58:56,973 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-26 19:58:56,977 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-26 19:58:56,981 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-26 19:58:56,984 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-26 19:58:56,988 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-26 19:58:56,988 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-26 19:58:56,989 - [INFO] - Successfully processed 2 dates
2025-01-26 19:58:56,990 - [INFO] - Starting client report loading process...
2025-01-26 19:58:57,005 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-26 19:58:57,049 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 19:58:57,243 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 19:58:57,327 - [INFO] - Archived 0 unique rows
2025-01-26 19:58:57,476 - [INFO] - Successfully loaded 48 rows
2025-01-26 19:58:57,480 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-26 19:58:57,481 - [INFO] - - Archived rows: 0
2025-01-26 19:58:57,482 - [INFO] - - Loaded rows: 48
2025-01-26 19:58:57,482 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-26 19:58:57,487 - [INFO] - Read CSV with shape: (24, 4)
2025-01-26 19:58:57,494 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-26 19:58:57,496 - [INFO] - Archived 0 unique rows
2025-01-26 19:58:57,500 - [INFO] - Successfully loaded 48 rows
2025-01-26 19:58:57,503 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-26 19:58:57,503 - [INFO] - - Archived rows: 0
2025-01-26 19:58:57,504 - [INFO] - - Loaded rows: 48
2025-01-26 19:58:57,505 - [INFO] - 
Verifying data load...
2025-01-26 19:58:57,511 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-26 19:58:57,512 - [INFO] - 
Load Summary:
2025-01-26 19:58:57,512 - [INFO] - Total files processed: 2
2025-01-26 19:58:57,513 - [INFO] - Total rows loaded: 96
2025-01-26 19:58:57,513 - [INFO] - 
Date Range:
2025-01-26 19:58:57,514 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-26 19:58:57,515 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-26 19:58:57,515 - [INFO] - 
Total Counts:
2025-01-26 19:58:57,516 - [INFO] -   Impressions: 44
2025-01-26 19:58:57,516 - [INFO] -   Clicks: 30
2025-01-26 19:58:57,516 - [INFO] - 
Client report loading completed successfully
2025-01-26 19:58:57,517 - [INFO] - Processing and loading completed successfully
2025-01-26 19:58:58,036 - [INFO] - Spark Session stopped
2025-01-26 22:05:16,060 - [INFO] - Starting application...
2025-01-26 22:05:16,127 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: fe_sendauth: no password supplied

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:06:20,850 - [INFO] - Starting application...
2025-01-26 22:06:20,886 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: fe_sendauth: no password supplied

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:06:39,531 - [INFO] - Starting application...
2025-01-26 22:06:39,571 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: fe_sendauth: no password supplied

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:07:01,262 - [INFO] - Starting application...
2025-01-26 22:07:01,302 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: fe_sendauth: no password supplied

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:08:28,067 - [INFO] - Starting application...
2025-01-26 22:08:28,118 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: fe_sendauth: no password supplied

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:09:07,349 - [INFO] - Starting application...
2025-01-26 22:09:07,388 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: fe_sendauth: no password supplied

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:11:11,413 - [INFO] - Starting application...
2025-01-26 22:11:11,451 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: fe_sendauth: no password supplied

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 20:12:43,436 - [INFO] - Starting application...
2025-01-26 20:12:43,470 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 20:13:07,262 - [INFO] - Starting application...
2025-01-26 20:13:07,283 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:16:40,879 - [INFO] - Starting application...
2025-01-26 22:16:40,925 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: fe_sendauth: no password supplied

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:20:13,553 - [INFO] - Starting application...
2025-01-26 22:20:17,679 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:20:34,395 - [INFO] - Starting application...
2025-01-26 22:20:38,563 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (::1), port 5433 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused (0x0000274D/10061)
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 22:21:11,520 - [INFO] - Starting application...
2025-01-26 22:21:11,585 - [INFO] - Database schema and tables verified/created successfully
2025-01-26 22:21:45,071 - [INFO] - Spark Session created successfully
2025-01-26 22:21:45,071 - [INFO] - Spark version: 3.5.4
2025-01-26 22:21:45,071 - [INFO] - Spark master: local[*]
2025-01-26 22:21:45,071 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-26 22:21:45,071 - [INFO] - Starting file processing...
2025-01-26 22:21:45,071 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-26 22:21:45,072 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-26 22:21:45,072 - [INFO] - User agent filter: some user agent
2025-01-26 22:21:45,072 - [WARNING] - No parquet files found in input directory
2025-01-26 22:21:45,072 - [ERROR] - Spark processing failed
2025-01-26 22:21:45,072 - [ERROR] - Processing or loading failed
2025-01-26 22:21:45,379 - [INFO] - Spark Session stopped
2025-01-26 20:22:23,856 - [INFO] - Starting application...
2025-01-26 20:22:23,878 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 20:22:45,986 - [INFO] - Starting application...
2025-01-26 20:22:46,011 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 20:23:12,856 - [INFO] - Starting application...
2025-01-26 20:23:12,880 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 20:24:25,428 - [INFO] - Starting application...
2025-01-26 20:24:25,448 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 20:31:57,234 - [INFO] - Starting application...
2025-01-26 20:31:57,281 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-26 20:33:06,032 - [INFO] - Starting application...
2025-01-26 20:33:06,091 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 06:33:55,068 - [INFO] - Starting application...
2025-01-27 06:33:55,122 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:03:00,247 - [INFO] - Starting application...
2025-01-27 07:03:00,273 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:12:14,953 - [INFO] - Starting application...
2025-01-27 07:12:15,043 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 07:12:19,618 - [INFO] - Spark Session created successfully
2025-01-27 07:12:19,618 - [INFO] - Spark version: 3.5.0
2025-01-27 07:12:19,619 - [INFO] - Spark master: local[*]
2025-01-27 07:12:19,620 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 07:12:19,620 - [INFO] - Starting file processing...
2025-01-27 07:12:19,621 - [INFO] - Input path: /app/raw_data
2025-01-27 07:12:19,621 - [INFO] - Output path: /app/output
2025-01-27 07:12:19,622 - [INFO] - User agent filter: some user agent
2025-01-27 07:12:19,748 - [WARNING] - No parquet files found in input directory
2025-01-27 07:12:19,749 - [ERROR] - Spark processing failed
2025-01-27 07:12:19,750 - [ERROR] - Processing or loading failed
2025-01-27 07:12:20,262 - [INFO] - Spark Session stopped
2025-01-27 07:21:48,016 - [INFO] - Starting application...
2025-01-27 07:21:48,139 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 07:21:52,609 - [INFO] - Spark Session created successfully
2025-01-27 07:21:52,610 - [INFO] - Spark version: 3.5.0
2025-01-27 07:21:52,611 - [INFO] - Spark master: local[*]
2025-01-27 07:21:52,611 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 07:21:52,612 - [INFO] - Starting file processing...
2025-01-27 07:21:52,612 - [INFO] - Input path: /app/raw_data
2025-01-27 07:21:52,613 - [INFO] - Output path: /app/output
2025-01-27 07:21:52,613 - [INFO] - User agent filter: some user agent
2025-01-27 07:21:52,617 - [WARNING] - No parquet files found in input directory
2025-01-27 07:21:52,617 - [ERROR] - Spark processing failed
2025-01-27 07:21:52,618 - [ERROR] - Processing or loading failed
2025-01-27 07:21:52,782 - [INFO] - Spark Session stopped
2025-01-27 07:23:04,036 - [INFO] - Starting application...
2025-01-27 07:23:04,073 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 07:23:07,578 - [INFO] - Spark Session created successfully
2025-01-27 07:23:07,579 - [INFO] - Spark version: 3.5.0
2025-01-27 07:23:07,580 - [INFO] - Spark master: local[*]
2025-01-27 07:23:07,580 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 07:23:07,581 - [INFO] - Starting file processing...
2025-01-27 07:23:07,582 - [INFO] - Input path: /app/raw_data
2025-01-27 07:23:07,582 - [INFO] - Output path: /app/output
2025-01-27 07:23:07,583 - [INFO] - User agent filter: some user agent
2025-01-27 07:23:07,586 - [WARNING] - No parquet files found in input directory
2025-01-27 07:23:07,586 - [ERROR] - Spark processing failed
2025-01-27 07:23:07,587 - [ERROR] - Processing or loading failed
2025-01-27 07:23:07,776 - [INFO] - Spark Session stopped
2025-01-27 07:44:33,455 - [INFO] - Starting application...
2025-01-27 07:44:33,501 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.2), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:45:02,159 - [INFO] - Starting application...
2025-01-27 07:45:02,231 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:46:02,394 - [INFO] - Starting application...
2025-01-27 07:46:02,439 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:47:02,036 - [INFO] - Starting application...
2025-01-27 07:47:02,057 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:48:01,597 - [INFO] - Starting application...
2025-01-27 07:48:01,618 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:49:02,174 - [INFO] - Starting application...
2025-01-27 07:49:02,196 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:49:49,572 - [INFO] - Starting application...
2025-01-27 07:49:49,594 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.2), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:50:02,328 - [INFO] - Starting application...
2025-01-27 07:50:02,349 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:51:01,931 - [INFO] - Starting application...
2025-01-27 07:51:01,960 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:52:01,560 - [INFO] - Starting application...
2025-01-27 07:52:01,587 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:52:52,767 - [INFO] - Starting application...
2025-01-27 07:52:52,788 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.2), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:53:02,488 - [INFO] - Starting application...
2025-01-27 07:53:02,510 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:53:19,622 - [INFO] - Starting application...
2025-01-27 07:53:19,644 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.2), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:56:21,043 - [INFO] - Starting application...
2025-01-27 07:56:21,082 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.2), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:57:01,908 - [INFO] - Starting application...
2025-01-27 07:57:01,929 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:58:01,479 - [INFO] - Starting application...
2025-01-27 07:58:01,502 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 07:59:02,081 - [INFO] - Starting application...
2025-01-27 07:59:02,104 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:00:01,705 - [INFO] - Starting application...
2025-01-27 08:00:01,727 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:01:02,249 - [INFO] - Starting application...
2025-01-27 08:01:02,270 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:01:58,534 - [INFO] - Starting application...
2025-01-27 08:01:58,566 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.2), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:02:02,251 - [INFO] - Starting application...
2025-01-27 08:02:02,273 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:02:20,911 - [INFO] - Starting application...
2025-01-27 08:02:20,959 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.2), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:03:01,538 - [INFO] - Starting application...
2025-01-27 08:03:01,559 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:08:23,481 - [INFO] - Starting application...
2025-01-27 08:08:31,528 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:09:03,752 - [INFO] - Starting application...
2025-01-27 08:09:03,815 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:10:01,648 - [INFO] - Starting application...
2025-01-27 08:10:01,669 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:11:02,285 - [INFO] - Starting application...
2025-01-27 08:11:02,308 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:12:01,913 - [INFO] - Starting application...
2025-01-27 08:12:01,943 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 f2025-01-27 08:17:44,603 - [INFO] - Starting application...
2025-01-27 08:17:44,801 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "postgres" (172.18.0.2), port 5432 failed: FATAL:  password authentication failed for user "adform_user"

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:18:02,784 - [INFO] - Starting application...
2025-01-27 08:18:02,811 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:19:02,751 - [INFO] - Starting application...
2025-01-27 08:19:02,784 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:20:02,568 - [INFO] - Starting application...
2025-01-27 08:20:02,592 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:21:02,146 - [INFO] - Starting application...
2025-01-27 08:21:02,168 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:22:01,698 - [INFO] - Starting application...
2025-01-27 08:22:01,722 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:23:02,249 - [INFO] - Starting application...
2025-01-27 08:23:02,270 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5433 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5433 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:34:26,084 - [INFO] - Starting application...
2025-01-27 08:34:26,154 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 08:34:30,667 - [INFO] - Spark Session created successfully
2025-01-27 08:34:30,668 - [INFO] - Spark version: 3.5.0
2025-01-27 08:34:30,668 - [INFO] - Spark master: local[*]
2025-01-27 08:34:30,669 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 08:34:30,670 - [INFO] - Starting file processing...
2025-01-27 08:34:30,670 - [INFO] - Input path: /app/raw_data
2025-01-27 08:34:30,671 - [INFO] - Output path: /app/output
2025-01-27 08:34:30,672 - [INFO] - User agent filter: some user agent
2025-01-27 08:34:30,680 - [WARNING] - No parquet files found in input directory
2025-01-27 08:34:30,681 - [ERROR] - Spark processing failed
2025-01-27 08:34:30,682 - [ERROR] - Processing or loading failed
2025-01-27 08:34:30,809 - [INFO] - Spark Session stopped
2025-01-27 08:35:02,888 - [INFO] - Starting application...
2025-01-27 08:35:02,998 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:36:02,165 - [INFO] - Starting application...
2025-01-27 08:36:02,194 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:37:01,774 - [INFO] - Starting application...
2025-01-27 08:37:01,796 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:38:02,311 - [INFO] - Starting application...
2025-01-27 08:38:02,332 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:38:24,492 - [INFO] - Starting application...
2025-01-27 08:38:24,539 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 08:38:28,151 - [INFO] - Spark Session created successfully
2025-01-27 08:38:28,152 - [INFO] - Spark version: 3.5.0
2025-01-27 08:38:28,153 - [INFO] - Spark master: local[*]
2025-01-27 08:38:28,153 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 08:38:28,154 - [INFO] - Starting file processing...
2025-01-27 08:38:28,154 - [INFO] - Input path: /app/raw_data
2025-01-27 08:38:28,155 - [INFO] - Output path: /app/output
2025-01-27 08:38:28,155 - [INFO] - User agent filter: some user agent
2025-01-27 08:38:28,158 - [WARNING] - No parquet files found in input directory
2025-01-27 08:38:28,158 - [ERROR] - Spark processing failed
2025-01-27 08:38:28,159 - [ERROR] - Processing or loading failed
2025-01-27 08:38:28,349 - [INFO] - Spark Session stopped
2025-01-27 08:39:02,374 - [INFO] - Starting application...
2025-01-27 08:39:02,400 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:39:15,795 - [INFO] - Starting application...
2025-01-27 08:39:15,828 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 08:39:19,005 - [INFO] - Spark Session created successfully
2025-01-27 08:39:19,006 - [INFO] - Spark version: 3.5.0
2025-01-27 08:39:19,006 - [INFO] - Spark master: local[*]
2025-01-27 08:39:19,007 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 08:39:19,007 - [INFO] - Starting file processing...
2025-01-27 08:39:19,008 - [INFO] - Input path: /app/raw_data
2025-01-27 08:39:19,008 - [INFO] - Output path: /app/output
2025-01-27 08:39:19,009 - [INFO] - User agent filter: some user agent
2025-01-27 08:39:19,012 - [WARNING] - No parquet files found in input directory
2025-01-27 08:39:19,012 - [ERROR] - Spark processing failed
2025-01-27 08:39:19,012 - [ERROR] - Processing or loading failed
2025-01-27 08:39:19,211 - [INFO] - Spark Session stopped
2025-01-27 08:40:01,659 - [INFO] - Starting application...
2025-01-27 08:40:01,680 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:41:02,163 - [INFO] - Starting application...
2025-01-27 08:41:02,185 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:41:38,463 - [INFO] - Starting application...
2025-01-27 08:41:38,557 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 08:41:41,659 - [INFO] - Spark Session created successfully
2025-01-27 08:41:41,660 - [INFO] - Spark version: 3.5.0
2025-01-27 08:41:41,661 - [INFO] - Spark master: local[*]
2025-01-27 08:41:41,661 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 08:41:41,662 - [INFO] - Starting file processing...
2025-01-27 08:41:41,663 - [INFO] - Input path: /app/raw_data
2025-01-27 08:41:41,663 - [INFO] - Output path: /app/output
2025-01-27 08:41:41,664 - [INFO] - User agent filter: some user agent
2025-01-27 08:41:41,666 - [WARNING] - No parquet files found in input directory
2025-01-27 08:41:41,667 - [ERROR] - Spark processing failed
2025-01-27 08:41:41,667 - [ERROR] - Processing or loading failed
2025-01-27 08:41:41,870 - [INFO] - Spark Session stopped
2025-01-27 08:42:02,385 - [INFO] - Starting application...
2025-01-27 08:42:02,407 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:46:45,242 - [INFO] - Starting application...
2025-01-27 08:46:45,276 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 08:46:48,380 - [INFO] - Spark Session created successfully
2025-01-27 08:46:48,382 - [INFO] - Spark version: 3.5.0
2025-01-27 08:46:48,382 - [INFO] - Spark master: local[*]
2025-01-27 08:46:48,383 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 08:46:48,383 - [INFO] - Starting file processing...
2025-01-27 08:46:48,384 - [INFO] - Input path: /app/raw_data
2025-01-27 08:46:48,384 - [INFO] - Output path: /app/output
2025-01-27 08:46:48,385 - [INFO] - User agent filter: some user agent
2025-01-27 08:46:48,388 - [WARNING] - No parquet files found in input directory
2025-01-27 08:46:48,388 - [ERROR] - Spark processing failed
2025-01-27 08:46:48,389 - [ERROR] - Processing or loading failed
2025-01-27 08:46:48,589 - [INFO] - Spark Session stopped
2025-01-27 08:47:02,175 - [INFO] - Starting application...
2025-01-27 08:47:02,197 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:47:10,894 - [INFO] - Starting application...
2025-01-27 08:47:10,927 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 08:47:14,165 - [INFO] - Spark Session created successfully
2025-01-27 08:47:14,166 - [INFO] - Spark version: 3.5.0
2025-01-27 08:47:14,167 - [INFO] - Spark master: local[*]
2025-01-27 08:47:14,167 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 08:47:14,168 - [INFO] - Starting file processing...
2025-01-27 08:47:14,168 - [INFO] - Input path: /app/raw_data
2025-01-27 08:47:14,169 - [INFO] - Output path: /app/output
2025-01-27 08:47:14,169 - [INFO] - User agent filter: some user agent
2025-01-27 08:47:14,172 - [WARNING] - No parquet files found in input directory
2025-01-27 08:47:14,173 - [ERROR] - Spark processing failed
2025-01-27 08:47:14,173 - [ERROR] - Processing or loading failed
2025-01-27 08:47:14,348 - [INFO] - Spark Session stopped
2025-01-27 08:47:47,517 - [INFO] - Starting application...
2025-01-27 08:47:47,563 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:48:02,037 - [INFO] - Starting application...
2025-01-27 08:48:02,068 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:49:01,651 - [INFO] - Starting application...
2025-01-27 08:49:01,673 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:50:02,237 - [INFO] - Starting application...
2025-01-27 08:50:02,259 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:51:01,819 - [INFO] - Starting application...
2025-01-27 08:51:01,842 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:52:02,439 - [INFO] - Starting application...
2025-01-27 08:52:02,463 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:53:02,004 - [INFO] - Starting application...
2025-01-27 08:53:02,025 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:54:01,564 - [INFO] - Starting application...
2025-01-27 08:54:01,587 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:55:02,117 - [INFO] - Starting application...
2025-01-27 08:55:02,140 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:56:01,721 - [INFO] - Starting application...
2025-01-27 08:56:01,742 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:57:02,340 - [INFO] - Starting application...
2025-01-27 08:57:02,363 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:58:01,900 - [INFO] - Starting application...
2025-01-27 08:58:01,921 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:58:04,709 - [INFO] - Starting application...
2025-01-27 08:58:04,735 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 08:58:36,179 - [INFO] - Starting application...
2025-01-27 08:58:36,213 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 08:58:39,308 - [INFO] - Spark Session created successfully
2025-01-27 08:58:39,309 - [INFO] - Spark version: 3.5.0
2025-01-27 08:58:39,310 - [INFO] - Spark master: local[*]
2025-01-27 08:58:39,310 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 08:58:39,311 - [INFO] - Starting file processing...
2025-01-27 08:58:39,311 - [INFO] - Input path: /app/raw_data
2025-01-27 08:58:39,312 - [INFO] - Output path: /app/output
2025-01-27 08:58:39,312 - [INFO] - User agent filter: some user agent
2025-01-27 08:58:39,315 - [WARNING] - No parquet files found in input directory
2025-01-27 08:58:39,316 - [ERROR] - Spark processing failed
2025-01-27 08:58:39,316 - [ERROR] - Processing or loading failed
2025-01-27 08:58:39,529 - [INFO] - Spark Session stopped
2025-01-27 08:59:02,090 - [INFO] - Starting application...
2025-01-27 08:59:02,113 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 09:11:10,300 - [INFO] - Starting application...
2025-01-27 09:11:10,369 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 09:11:14,472 - [INFO] - Spark Session created successfully
2025-01-27 09:11:14,473 - [INFO] - Spark version: 3.5.0
2025-01-27 09:11:14,474 - [INFO] - Spark master: local[*]
2025-01-27 09:11:14,474 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 09:11:14,475 - [INFO] - Starting file processing...
2025-01-27 09:11:14,475 - [INFO] - Input path: /app/raw_data
2025-01-27 09:11:14,476 - [INFO] - Output path: /app/output
2025-01-27 09:11:14,476 - [INFO] - User agent filter: some user agent
2025-01-27 09:11:14,479 - [WARNING] - No parquet files found in input directory
2025-01-27 09:11:14,480 - [ERROR] - Spark processing failed
2025-01-27 09:11:14,480 - [ERROR] - Processing or loading failed
2025-01-27 09:11:14,631 - [INFO] - Spark Session stopped
2025-01-27 09:12:01,937 - [INFO] - Starting application...
2025-01-27 09:12:01,972 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 09:12:05,159 - [INFO] - Spark Session created successfully
2025-01-27 09:12:05,161 - [INFO] - Spark version: 3.5.0
2025-01-27 09:12:05,162 - [INFO] - Spark master: local[*]
2025-01-27 09:12:05,163 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 09:12:05,164 - [INFO] - Starting file processing...
2025-01-27 09:12:05,165 - [INFO] - Input path: /app/raw_data
2025-01-27 09:12:05,166 - [INFO] - Output path: /app/output
2025-01-27 09:12:05,166 - [INFO] - User agent filter: some user agent
2025-01-27 09:12:05,167 - [WARNING] - No parquet files found in input directory
2025-01-27 09:12:05,168 - [ERROR] - Spark processing failed
2025-01-27 09:12:05,168 - [ERROR] - Processing or loading failed
2025-01-27 09:12:05,336 - [INFO] - Spark Session stopped
2025-01-27 09:13:01,886 - [INFO] - Starting application...
2025-01-27 09:13:01,922 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 09:13:05,082 - [INFO] - Spark Session created successfully
2025-01-27 09:13:05,083 - [INFO] - Spark version: 3.5.0
2025-01-27 09:13:05,084 - [INFO] - Spark master: local[*]
2025-01-27 09:13:05,085 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 09:13:05,086 - [INFO] - Starting file processing...
2025-01-27 09:13:05,087 - [INFO] - Input path: /app/raw_data
2025-01-27 09:13:05,088 - [INFO] - Output path: /app/output
2025-01-27 09:13:05,089 - [INFO] - User agent filter: some user agent
2025-01-27 09:13:05,090 - [WARNING] - No parquet files found in input directory
2025-01-27 09:13:05,091 - [ERROR] - Spark processing failed
2025-01-27 09:13:05,092 - [ERROR] - Processing or loading failed
2025-01-27 09:13:05,273 - [INFO] - Spark Session stopped
2025-01-27 09:14:02,285 - [INFO] - Starting application...
2025-01-27 09:14:02,330 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 09:14:05,958 - [INFO] - Spark Session created successfully
2025-01-27 09:14:05,960 - [INFO] - Spark version: 3.5.0
2025-01-27 09:14:05,961 - [INFO] - Spark master: local[*]
2025-01-27 09:14:05,962 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 09:14:05,963 - [INFO] - Starting file processing...
2025-01-27 09:14:05,964 - [INFO] - Input path: /app/raw_data
2025-01-27 09:14:05,964 - [INFO] - Output path: /app/output
2025-01-27 09:14:05,965 - [INFO] - User agent filter: some user agent
2025-01-27 09:14:05,966 - [WARNING] - No parquet files found in input directory
2025-01-27 09:14:05,967 - [ERROR] - Spark processing failed
2025-01-27 09:14:05,967 - [ERROR] - Processing or loading failed
2025-01-27 09:14:06,122 - [INFO] - Spark Session stopped
2025-01-27 09:15:01,718 - [INFO] - Starting application...
2025-01-27 09:15:01,752 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 09:15:04,850 - [INFO] - Spark Session created successfully
2025-01-27 09:15:04,851 - [INFO] - Spark version: 3.5.0
2025-01-27 09:15:04,852 - [INFO] - Spark master: local[*]
2025-01-27 09:15:04,854 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 09:15:04,854 - [INFO] - Starting file processing...
2025-01-27 09:15:04,855 - [INFO] - Input path: /app/raw_data
2025-01-27 09:15:04,856 - [INFO] - Output path: /app/output
2025-01-27 09:15:04,857 - [INFO] - User agent filter: some user agent
2025-01-27 09:15:04,857 - [WARNING] - No parquet files found in input directory
2025-01-27 09:15:04,858 - [ERROR] - Spark processing failed
2025-01-27 09:15:04,859 - [ERROR] - Processing or loading failed
2025-01-27 09:15:05,052 - [INFO] - Spark Session stopped
2025-01-27 09:16:01,667 - [INFO] - Starting application...
2025-01-27 09:16:01,701 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 09:16:04,924 - [INFO] - Spark Session created successfully
2025-01-27 09:16:04,925 - [INFO] - Spark version: 3.5.0
2025-01-27 09:16:04,926 - [INFO] - Spark master: local[*]
2025-01-27 09:16:04,927 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 09:16:04,928 - [INFO] - Starting file processing...
2025-01-27 09:16:04,929 - [INFO] - Input path: /app/raw_data
2025-01-27 09:16:04,929 - [INFO] - Output path: /app/output
2025-01-27 09:16:04,930 - [INFO] - User agent filter: some user agent
2025-01-27 09:16:04,953 - [INFO] - Found 11 total parquet files
2025-01-27 09:16:04,954 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 09:16:04,955 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 09:16:09,566 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 09:16:10,099 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 09:16:11,723 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 09:16:12,438 - [INFO] - Found 0 records with invalid hours
2025-01-27 09:16:13,009 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 09:16:13,617 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 09:16:13,930 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 09:16:16,619 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-27 09:16:16,623 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 09:16:16,628 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 09:16:16,633 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 09:16:16,634 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 09:16:16,901 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 09:16:17,085 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 09:16:17,466 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 09:16:17,816 - [INFO] - Found 0 records with invalid hours
2025-01-27 09:16:18,025 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 09:16:18,310 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 09:16:18,553 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 09:16:18,871 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 09:16:19,069 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 09:16:19,531 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 09:16:19,901 - [INFO] - Found 0 records with invalid hours
2025-01-27 09:16:20,117 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 09:16:20,440 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 09:16:20,700 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 09:16:21,796 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 09:16:22,774 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-27 09:16:22,778 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 09:16:22,782 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 09:16:22,786 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 09:16:22,790 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 09:16:22,793 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 09:16:22,798 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 09:16:22,801 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 09:16:22,805 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 09:16:22,806 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 09:16:22,807 - [INFO] - Successfully processed 2 dates
2025-01-27 09:16:22,808 - [INFO] - Starting client report loading process...
2025-01-27 09:16:22,821 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-27 09:16:22,836 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 09:16:22,889 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 09:16:22,900 - [INFO] - Archived 0 unique rows
2025-01-27 09:16:22,961 - [INFO] - Successfully loaded 48 rows
2025-01-27 09:16:22,968 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-27 09:16:22,970 - [INFO] - - Archived rows: 0
2025-01-27 09:16:22,971 - [INFO] - - Loaded rows: 48
2025-01-27 09:16:22,972 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-27 09:16:22,978 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 09:16:22,984 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 09:16:22,986 - [INFO] - Archived 0 unique rows
2025-01-27 09:16:22,992 - [INFO] - Successfully loaded 48 rows
2025-01-27 09:16:22,996 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-27 09:16:22,997 - [INFO] - - Archived rows: 0
2025-01-27 09:16:23,000 - [INFO] - - Loaded rows: 48
2025-01-27 09:16:23,002 - [INFO] - 
Verifying data load...
2025-01-27 09:16:23,007 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 09:16:23,008 - [INFO] - 
Load Summary:
2025-01-27 09:16:23,010 - [INFO] - Total files processed: 2
2025-01-27 09:16:23,010 - [INFO] - Total rows loaded: 96
2025-01-27 09:16:23,011 - [INFO] - 
Date Range:
2025-01-27 09:16:23,012 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 09:16:23,013 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 09:16:23,014 - [INFO] - 
Total Counts:
2025-01-27 09:16:23,014 - [INFO] -   Impressions: 44
2025-01-27 09:16:23,015 - [INFO] -   Clicks: 30
2025-01-27 09:16:23,016 - [INFO] - 
Client report loading completed successfully
2025-01-27 09:16:23,017 - [INFO] - Processing and loading completed successfully
2025-01-27 09:16:23,836 - [INFO] - Spark Session stopped
2025-01-27 09:17:02,222 - [INFO] - Starting application...
2025-01-27 09:17:02,274 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 09:17:06,446 - [INFO] - Spark Session created successfully
2025-01-27 09:17:06,448 - [INFO] - Spark version: 3.5.0
2025-01-27 09:17:06,449 - [INFO] - Spark master: local[*]
2025-01-27 09:17:06,450 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 09:17:06,451 - [INFO] - Starting file processing...
2025-01-27 09:17:06,452 - [INFO] - Input path: /app/raw_data
2025-01-27 09:17:06,453 - [INFO] - Output path: /app/output
2025-01-27 09:17:06,454 - [INFO] - User agent filter: some user agent
2025-01-27 09:17:06,458 - [WARNING] - No parquet files found in input directory
2025-01-27 09:17:06,459 - [ERROR] - Spark processing failed
2025-01-27 09:17:06,459 - [ERROR] - Processing or loading failed
2025-01-27 09:17:06,605 - [INFO] - Spark Session stopped
2025-01-27 09:18:02,153 - [INFO] - Starting application...
2025-01-27 09:18:02,188 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 09:18:05,181 - [INFO] - Spark Session created successfully
2025-01-27 09:18:05,183 - [INFO] - Spark version: 3.5.0
2025-01-27 09:18:05,184 - [INFO] - Spark master: local[*]
2025-01-27 09:18:05,185 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 09:18:05,186 - [INFO] - Starting file processing...
2025-01-27 09:18:05,187 - [INFO] - Input path: /app/raw_data
2025-01-27 09:18:05,188 - [INFO] - Output path: /app/output
2025-01-27 09:18:05,189 - [INFO] - User agent filter: some user agent
2025-01-27 09:18:05,190 - [WARNING] - No parquet files found in input directory
2025-01-27 09:18:05,190 - [ERROR] - Spark processing failed
2025-01-27 09:18:05,191 - [ERROR] - Processing or loading failed
2025-01-27 09:18:05,397 - [INFO] - Spark Session stopped
2025-01-27 11:18:25,828 - [INFO] - Starting application...
2025-01-27 11:18:28,766 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Unknown host

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-27 11:19:13,397 - [INFO] - Starting application...
2025-01-27 11:19:13,461 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 11:19:47,136 - [INFO] - Spark Session created successfully
2025-01-27 11:19:47,136 - [INFO] - Spark version: 3.5.4
2025-01-27 11:19:47,136 - [INFO] - Spark master: local[*]
2025-01-27 11:19:47,136 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 11:19:47,137 - [INFO] - Starting file processing...
2025-01-27 11:19:47,137 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 11:19:47,137 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 11:19:47,137 - [INFO] - User agent filter: some user agent
2025-01-27 11:19:47,138 - [WARNING] - No parquet files found in input directory
2025-01-27 11:19:47,138 - [ERROR] - Spark processing failed
2025-01-27 11:19:47,138 - [ERROR] - Processing or loading failed
2025-01-27 11:19:47,427 - [INFO] - Spark Session stopped
2025-01-27 14:06:45,461 - [INFO] - Starting application...
2025-01-27 14:06:45,523 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 14:07:11,544 - [INFO] - Spark Session created successfully
2025-01-27 14:07:11,544 - [INFO] - Spark version: 3.5.4
2025-01-27 14:07:11,544 - [INFO] - Spark master: local[*]
2025-01-27 14:07:11,544 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 14:07:11,544 - [INFO] - Starting file processing...
2025-01-27 14:07:11,544 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 14:07:11,545 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 14:07:11,545 - [INFO] - User agent filter: some user agent
2025-01-27 14:07:11,546 - [INFO] - Found 11 total parquet files
2025-01-27 14:07:11,546 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 14:07:11,546 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 14:07:16,714 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 14:07:17,216 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 14:07:18,918 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:07:19,424 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:07:19,818 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:07:20,183 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 14:07:20,425 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:07:25,308 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 14:07:25,308 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 14:07:25,309 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:07:25,309 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 14:07:25,309 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 14:07:25,582 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 14:07:25,726 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 14:07:26,939 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 14:07:27,236 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:07:27,448 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 14:07:27,621 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 14:07:27,792 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 14:07:28,107 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 14:07:28,266 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 14:07:29,698 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 14:07:29,935 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:07:30,136 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 14:07:30,309 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 14:07:30,496 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 14:07:34,293 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 14:07:35,014 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 14:07:35,014 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 14:07:35,015 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 14:07:35,015 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 14:07:35,016 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 14:07:35,016 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 14:07:35,017 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 14:07:35,017 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 14:07:35,018 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 14:07:35,018 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 14:07:35,018 - [INFO] - Successfully processed 2 dates
2025-01-27 14:07:35,018 - [INFO] - Starting client report loading process...
2025-01-27 14:07:35,019 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 14:07:35,021 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:07:35,028 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:07:35,032 - [INFO] - Archived 0 unique rows
2025-01-27 14:07:35,045 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:07:35,051 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 14:07:35,051 - [INFO] - - Archived rows: 0
2025-01-27 14:07:35,052 - [INFO] - - Loaded rows: 48
2025-01-27 14:07:35,052 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 14:07:35,061 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:07:35,066 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:07:35,069 - [INFO] - Archived 0 unique rows
2025-01-27 14:07:35,077 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:07:35,082 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 14:07:35,082 - [INFO] - - Archived rows: 0
2025-01-27 14:07:35,083 - [INFO] - - Loaded rows: 48
2025-01-27 14:07:35,083 - [INFO] - 
Verifying data load...
2025-01-27 14:07:35,088 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 14:07:35,089 - [INFO] - 
Load Summary:
2025-01-27 14:07:35,090 - [INFO] - Total files processed: 2
2025-01-27 14:07:35,090 - [INFO] - Total rows loaded: 96
2025-01-27 14:07:35,090 - [INFO] - 
Date Range:
2025-01-27 14:07:35,091 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 14:07:35,091 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 14:07:35,091 - [INFO] - 
Total Counts:
2025-01-27 14:07:35,091 - [INFO] -   Impressions: 44
2025-01-27 14:07:35,091 - [INFO] -   Clicks: 30
2025-01-27 14:07:35,091 - [INFO] - 
Client report loading completed successfully
2025-01-27 14:07:35,091 - [INFO] - Processing and loading completed successfully
2025-01-27 14:07:35,290 - [INFO] - Spark Session stopped
2025-01-27 14:12:00,940 - [INFO] - Starting application...
2025-01-27 14:12:01,000 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 14:12:05,752 - [INFO] - Spark Session created successfully
2025-01-27 14:12:05,753 - [INFO] - Spark version: 3.5.4
2025-01-27 14:12:05,753 - [INFO] - Spark master: local[*]
2025-01-27 14:12:05,753 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 14:12:05,753 - [INFO] - Starting file processing...
2025-01-27 14:12:05,753 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 14:12:05,754 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 14:12:05,754 - [INFO] - User agent filter: some user agent
2025-01-27 14:12:05,755 - [INFO] - Found 25 total parquet files
2025-01-27 14:12:05,755 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 14:12:05,755 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 14:12:11,100 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 14:12:11,609 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 14:12:13,316 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:12:13,798 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:12:14,223 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:12:14,566 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 14:12:14,780 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:12:19,495 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 14:12:19,495 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 14:12:19,496 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:12:19,496 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 14:12:19,497 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 14:12:19,779 - [ERROR] - Error processing files for date '2022-05-27': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#857L,page_url#858,transaction_header_transaction_id_lo#859L,transaction_header_transaction_id_hi#860L,transaction_header_creation_time#861L,transaction_header_producer_time#862L,transaction_header_original_producer#863,transaction_header_recent_producer#864,user_identity_cookie_id#865,user_identity_is_opted_out#866,user_identity_cookie_id_origin_id#867L,user_identity_browser_cookie_id#868,user_identity_browser_cookie_status#869,user_identity_device_advertising_id#870,banner_banner_id#871L,banner_campaign_id#872L,banner_media_id#873L,banner_tag_id#874L,banner_banner_placement_id#875L,rtb_vars_winning_price_in_dkk_lo#876L,rtb_vars_winning_price_in_dkk_hi#877L,rtb_vars_winning_price_in_dkk_signScale#878L] parquet

2025-01-27 14:12:19,788 - [WARNING] - Failed to process data for date: 2022-05-27 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#857L,page_url#858,transaction_header_transaction_id_lo#859L,transaction_header_transaction_id_hi#860L,transaction_header_creation_time#861L,transaction_header_producer_time#862L,transaction_header_original_producer#863,transaction_header_recent_producer#864,user_identity_cookie_id#865,user_identity_is_opted_out#866,user_identity_cookie_id_origin_id#867L,user_identity_browser_cookie_id#868,user_identity_browser_cookie_status#869,user_identity_device_advertising_id#870,banner_banner_id#871L,banner_campaign_id#872L,banner_media_id#873L,banner_tag_id#874L,banner_banner_placement_id#875L,rtb_vars_winning_price_in_dkk_lo#876L,rtb_vars_winning_price_in_dkk_hi#877L,rtb_vars_winning_price_in_dkk_signScale#878L] parquet

2025-01-27 14:12:19,788 - [INFO] - Successfully processed 1 dates
2025-01-27 14:12:19,789 - [INFO] - Starting client report loading process...
2025-01-27 14:12:19,789 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 14:12:19,792 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:12:19,805 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:12:19,810 - [INFO] - Archived 0 unique rows
2025-01-27 14:12:19,827 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:12:19,834 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 14:12:19,834 - [INFO] - - Archived rows: 0
2025-01-27 14:12:19,834 - [INFO] - - Loaded rows: 48
2025-01-27 14:12:19,834 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 14:12:19,836 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:12:19,842 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:12:19,847 - [INFO] - Archived 0 unique rows
2025-01-27 14:12:19,857 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:12:19,861 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 14:12:19,861 - [INFO] - - Archived rows: 0
2025-01-27 14:12:19,862 - [INFO] - - Loaded rows: 48
2025-01-27 14:12:19,862 - [INFO] - 
Verifying data load...
2025-01-27 14:12:19,867 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 14:12:19,869 - [INFO] - 
Load Summary:
2025-01-27 14:12:19,869 - [INFO] - Total files processed: 2
2025-01-27 14:12:19,869 - [INFO] - Total rows loaded: 96
2025-01-27 14:12:19,869 - [INFO] - 
Date Range:
2025-01-27 14:12:19,869 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 14:12:19,870 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 14:12:19,870 - [INFO] - 
Total Counts:
2025-01-27 14:12:19,870 - [INFO] -   Impressions: 44
2025-01-27 14:12:19,870 - [INFO] -   Clicks: 30
2025-01-27 14:12:19,870 - [INFO] - 
Client report loading completed successfully
2025-01-27 14:12:19,870 - [INFO] - Processing and loading completed successfully
2025-01-27 14:12:20,830 - [INFO] - Spark Session stopped
2025-01-27 14:21:24,913 - [INFO] - Starting application...
2025-01-27 14:21:24,986 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 14:21:31,784 - [INFO] - Spark Session created successfully
2025-01-27 14:21:31,784 - [INFO] - Spark version: 3.5.4
2025-01-27 14:21:31,785 - [INFO] - Spark master: local[*]
2025-01-27 14:21:31,785 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 14:21:31,785 - [INFO] - Starting file processing...
2025-01-27 14:21:31,785 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 14:21:31,785 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 14:21:31,786 - [INFO] - User agent filter: some user agent
2025-01-27 14:21:31,788 - [INFO] - Found 25 total parquet files
2025-01-27 14:21:31,788 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 14:21:31,788 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 14:21:38,994 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 14:21:39,866 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 14:21:41,790 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:21:42,322 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:21:42,769 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:21:43,145 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 14:21:43,413 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:21:48,256 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 14:21:48,256 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 14:21:48,257 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:21:48,258 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 14:21:48,258 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 14:21:48,510 - [ERROR] - Error processing files for date '2022-05-27': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#857L,page_url#858,transaction_header_transaction_id_lo#859L,transaction_header_transaction_id_hi#860L,transaction_header_creation_time#861L,transaction_header_producer_time#862L,transaction_header_original_producer#863,transaction_header_recent_producer#864,user_identity_cookie_id#865,user_identity_is_opted_out#866,user_identity_cookie_id_origin_id#867L,user_identity_browser_cookie_id#868,user_identity_browser_cookie_status#869,user_identity_device_advertising_id#870,banner_banner_id#871L,banner_campaign_id#872L,banner_media_id#873L,banner_tag_id#874L,banner_banner_placement_id#875L,rtb_vars_winning_price_in_dkk_lo#876L,rtb_vars_winning_price_in_dkk_hi#877L,rtb_vars_winning_price_in_dkk_signScale#878L] parquet

2025-01-27 14:21:48,515 - [WARNING] - Failed to process data for date: 2022-05-27 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#857L,page_url#858,transaction_header_transaction_id_lo#859L,transaction_header_transaction_id_hi#860L,transaction_header_creation_time#861L,transaction_header_producer_time#862L,transaction_header_original_producer#863,transaction_header_recent_producer#864,user_identity_cookie_id#865,user_identity_is_opted_out#866,user_identity_cookie_id_origin_id#867L,user_identity_browser_cookie_id#868,user_identity_browser_cookie_status#869,user_identity_device_advertising_id#870,banner_banner_id#871L,banner_campaign_id#872L,banner_media_id#873L,banner_tag_id#874L,banner_banner_placement_id#875L,rtb_vars_winning_price_in_dkk_lo#876L,rtb_vars_winning_price_in_dkk_hi#877L,rtb_vars_winning_price_in_dkk_signScale#878L] parquet

2025-01-27 14:21:48,516 - [INFO] - Successfully processed 1 dates
2025-01-27 14:21:48,516 - [INFO] - Starting client report loading process...
2025-01-27 14:21:48,516 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 14:21:48,518 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:21:48,528 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:21:48,533 - [INFO] - Archived 0 unique rows
2025-01-27 14:21:48,549 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:21:48,554 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 14:21:48,554 - [INFO] - - Archived rows: 0
2025-01-27 14:21:48,555 - [INFO] - - Loaded rows: 48
2025-01-27 14:21:48,555 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 14:21:48,556 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:21:48,564 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:21:48,567 - [INFO] - Archived 0 unique rows
2025-01-27 14:21:48,576 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:21:48,580 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 14:21:48,581 - [INFO] - - Archived rows: 0
2025-01-27 14:21:48,581 - [INFO] - - Loaded rows: 48
2025-01-27 14:21:48,582 - [INFO] - 
Verifying data load...
2025-01-27 14:21:48,587 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 14:21:48,589 - [INFO] - 
Load Summary:
2025-01-27 14:21:48,589 - [INFO] - Total files processed: 2
2025-01-27 14:21:48,589 - [INFO] - Total rows loaded: 96
2025-01-27 14:21:48,589 - [INFO] - 
Date Range:
2025-01-27 14:21:48,589 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 14:21:48,590 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 14:21:48,590 - [INFO] - 
Total Counts:
2025-01-27 14:21:48,590 - [INFO] -   Impressions: 44
2025-01-27 14:21:48,590 - [INFO] -   Clicks: 30
2025-01-27 14:21:48,590 - [INFO] - 
Client report loading completed successfully
2025-01-27 14:21:48,590 - [INFO] - Processing and loading completed successfully
2025-01-27 14:21:49,568 - [INFO] - Spark Session stopped
2025-01-27 14:27:11,478 - [INFO] - Starting application...
2025-01-27 14:27:11,540 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 14:27:16,392 - [INFO] - Spark Session created successfully
2025-01-27 14:27:16,393 - [INFO] - Spark version: 3.5.4
2025-01-27 14:27:16,393 - [INFO] - Spark master: local[*]
2025-01-27 14:27:16,393 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 14:27:16,394 - [INFO] - Starting file processing...
2025-01-27 14:27:16,394 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 14:27:16,394 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 14:27:16,394 - [INFO] - User agent filter: some user agent
2025-01-27 14:27:16,395 - [INFO] - Found 28 total parquet files
2025-01-27 14:27:16,396 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 14:27:16,396 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 14:27:21,165 - [ERROR] - Error processing files for date '2022-05-26': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`device_settings_user_agent`, `device_settings_os_id`, `device_settings_browser_id`, `device_settings_device_type_id`, `banner_banner_id`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L,device_settings_user_agent#22,device_settings_browser_id#23L,... 2 more fields] parquet

2025-01-27 14:27:21,173 - [WARNING] - Failed to process data for date: 2022-05-26 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`device_settings_user_agent`, `device_settings_os_id`, `device_settings_browser_id`, `device_settings_device_type_id`, `banner_banner_id`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L,device_settings_user_agent#22,device_settings_browser_id#23L,... 2 more fields] parquet

2025-01-27 14:27:21,379 - [ERROR] - Error processing files for date '2022-05-27': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#53L,page_url#54,transaction_header_transaction_id_lo#55L,transaction_header_transaction_id_hi#56L,transaction_header_creation_time#57L,transaction_header_producer_time#58L,transaction_header_original_producer#59,transaction_header_recent_producer#60,user_identity_cookie_id#61,user_identity_is_opted_out#62,user_identity_cookie_id_origin_id#63L,user_identity_browser_cookie_id#64,user_identity_browser_cookie_status#65,user_identity_device_advertising_id#66,banner_banner_id#67L,banner_campaign_id#68L,banner_media_id#69L,banner_tag_id#70L,banner_banner_placement_id#71L,rtb_vars_winning_price_in_dkk_lo#72L,rtb_vars_winning_price_in_dkk_hi#73L,rtb_vars_winning_price_in_dkk_signScale#74L] parquet

2025-01-27 14:27:21,396 - [WARNING] - Failed to process data for date: 2022-05-27 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#53L,page_url#54,transaction_header_transaction_id_lo#55L,transaction_header_transaction_id_hi#56L,transaction_header_creation_time#57L,transaction_header_producer_time#58L,transaction_header_original_producer#59,transaction_header_recent_producer#60,user_identity_cookie_id#61,user_identity_is_opted_out#62,user_identity_cookie_id_origin_id#63L,user_identity_browser_cookie_id#64,user_identity_browser_cookie_status#65,user_identity_device_advertising_id#66,banner_banner_id#67L,banner_campaign_id#68L,banner_media_id#69L,banner_tag_id#70L,banner_banner_placement_id#71L,rtb_vars_winning_price_in_dkk_lo#72L,rtb_vars_winning_price_in_dkk_hi#73L,rtb_vars_winning_price_in_dkk_signScale#74L] parquet

2025-01-27 14:27:21,397 - [ERROR] - No dates were successfully processed
2025-01-27 14:27:21,397 - [ERROR] - Spark processing failed
2025-01-27 14:27:21,397 - [ERROR] - Processing or loading failed
2025-01-27 14:27:21,819 - [INFO] - Spark Session stopped
2025-01-27 14:32:03,618 - [INFO] - Starting application...
2025-01-27 14:32:03,692 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 14:32:19,781 - [INFO] - Spark Session created successfully
2025-01-27 14:32:19,782 - [INFO] - Spark version: 3.5.4
2025-01-27 14:32:19,782 - [INFO] - Spark master: local[*]
2025-01-27 14:32:19,783 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 14:32:19,783 - [INFO] - Starting file processing...
2025-01-27 14:32:19,783 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 14:32:19,783 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 14:32:19,783 - [INFO] - User agent filter: some user agent
2025-01-27 14:32:19,785 - [INFO] - Found 35 total parquet files
2025-01-27 14:32:19,786 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 14:32:19,786 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 14:32:24,484 - [ERROR] - Error processing files for date '2022-05-26': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L] parquet

2025-01-27 14:32:24,496 - [WARNING] - Failed to process data for date: 2022-05-26 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L] parquet

2025-01-27 14:32:24,767 - [ERROR] - Error processing files for date '2022-05-27': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#45L,page_url#46,transaction_header_transaction_id_lo#47L,transaction_header_transaction_id_hi#48L,transaction_header_creation_time#49L,transaction_header_producer_time#50L,transaction_header_original_producer#51,transaction_header_recent_producer#52,user_identity_cookie_id#53,user_identity_is_opted_out#54,user_identity_cookie_id_origin_id#55L,user_identity_browser_cookie_id#56,user_identity_browser_cookie_status#57,user_identity_device_advertising_id#58,banner_banner_id#59L,banner_campaign_id#60L,banner_media_id#61L,banner_tag_id#62L,banner_banner_placement_id#63L,rtb_vars_winning_price_in_dkk_lo#64L,rtb_vars_winning_price_in_dkk_hi#65L,rtb_vars_winning_price_in_dkk_signScale#66L] parquet

2025-01-27 14:32:24,775 - [WARNING] - Failed to process data for date: 2022-05-27 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#45L,page_url#46,transaction_header_transaction_id_lo#47L,transaction_header_transaction_id_hi#48L,transaction_header_creation_time#49L,transaction_header_producer_time#50L,transaction_header_original_producer#51,transaction_header_recent_producer#52,user_identity_cookie_id#53,user_identity_is_opted_out#54,user_identity_cookie_id_origin_id#55L,user_identity_browser_cookie_id#56,user_identity_browser_cookie_status#57,user_identity_device_advertising_id#58,banner_banner_id#59L,banner_campaign_id#60L,banner_media_id#61L,banner_tag_id#62L,banner_banner_placement_id#63L,rtb_vars_winning_price_in_dkk_lo#64L,rtb_vars_winning_price_in_dkk_hi#65L,rtb_vars_winning_price_in_dkk_signScale#66L] parquet

2025-01-27 14:32:24,776 - [ERROR] - No dates were successfully processed
2025-01-27 14:32:24,776 - [ERROR] - Spark processing failed
2025-01-27 14:32:24,776 - [ERROR] - Processing or loading failed
2025-01-27 14:32:25,059 - [INFO] - Spark Session stopped
2025-01-27 14:33:20,421 - [INFO] - Starting application...
2025-01-27 14:33:20,498 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 14:33:32,998 - [INFO] - Spark Session created successfully
2025-01-27 14:33:32,998 - [INFO] - Spark version: 3.5.4
2025-01-27 14:33:32,999 - [INFO] - Spark master: local[*]
2025-01-27 14:33:32,999 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 14:33:32,999 - [INFO] - Starting file processing...
2025-01-27 14:33:32,999 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 14:33:32,999 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 14:33:33,000 - [INFO] - User agent filter: some user agent
2025-01-27 14:33:33,001 - [INFO] - Found 37 total parquet files
2025-01-27 14:33:33,002 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 14:33:33,002 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 14:33:36,095 - [ERROR] - Error processing files for date '2022-05-26': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L] parquet

2025-01-27 14:33:36,101 - [WARNING] - Failed to process data for date: 2022-05-26 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L] parquet

2025-01-27 14:33:36,260 - [ERROR] - Error processing files for date '2022-05-27': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#45L,page_url#46,transaction_header_transaction_id_lo#47L,transaction_header_transaction_id_hi#48L,transaction_header_creation_time#49L,transaction_header_producer_time#50L,transaction_header_original_producer#51,transaction_header_recent_producer#52,user_identity_cookie_id#53,user_identity_is_opted_out#54,user_identity_cookie_id_origin_id#55L,user_identity_browser_cookie_id#56,user_identity_browser_cookie_status#57,user_identity_device_advertising_id#58,banner_banner_id#59L,banner_campaign_id#60L,banner_media_id#61L,banner_tag_id#62L,banner_banner_placement_id#63L,rtb_vars_winning_price_in_dkk_lo#64L,rtb_vars_winning_price_in_dkk_hi#65L,rtb_vars_winning_price_in_dkk_signScale#66L] parquet

2025-01-27 14:33:36,266 - [WARNING] - Failed to process data for date: 2022-05-27 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#45L,page_url#46,transaction_header_transaction_id_lo#47L,transaction_header_transaction_id_hi#48L,transaction_header_creation_time#49L,transaction_header_producer_time#50L,transaction_header_original_producer#51,transaction_header_recent_producer#52,user_identity_cookie_id#53,user_identity_is_opted_out#54,user_identity_cookie_id_origin_id#55L,user_identity_browser_cookie_id#56,user_identity_browser_cookie_status#57,user_identity_device_advertising_id#58,banner_banner_id#59L,banner_campaign_id#60L,banner_media_id#61L,banner_tag_id#62L,banner_banner_placement_id#63L,rtb_vars_winning_price_in_dkk_lo#64L,rtb_vars_winning_price_in_dkk_hi#65L,rtb_vars_winning_price_in_dkk_signScale#66L] parquet

2025-01-27 14:33:36,266 - [ERROR] - No dates were successfully processed
2025-01-27 14:33:36,267 - [ERROR] - Spark processing failed
2025-01-27 14:33:36,267 - [ERROR] - Processing or loading failed
2025-01-27 14:33:36,383 - [INFO] - Spark Session stopped
2025-01-27 14:34:29,806 - [INFO] - Starting application...
2025-01-27 14:34:29,864 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 14:34:34,700 - [INFO] - Spark Session created successfully
2025-01-27 14:34:34,700 - [INFO] - Spark version: 3.5.4
2025-01-27 14:34:34,700 - [INFO] - Spark master: local[*]
2025-01-27 14:34:34,701 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 14:34:34,701 - [INFO] - Starting file processing...
2025-01-27 14:34:34,701 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 14:34:34,701 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 14:34:34,701 - [INFO] - User agent filter: some user agent
2025-01-27 14:34:34,702 - [INFO] - Found 11 total parquet files
2025-01-27 14:34:34,703 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 14:34:34,703 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 14:34:39,907 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 14:34:40,394 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 14:34:42,188 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:34:42,648 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:34:43,067 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:34:43,478 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 14:34:43,710 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:34:48,627 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 14:34:48,627 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 14:34:48,628 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:34:48,629 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 14:34:48,629 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 14:34:48,898 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 14:34:49,059 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 14:34:50,231 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 14:34:50,538 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:34:50,754 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 14:34:50,958 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 14:34:51,131 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 14:34:51,443 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 14:34:51,604 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 14:34:52,916 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 14:34:53,163 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:34:53,367 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 14:34:53,572 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 14:34:53,745 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 14:34:57,608 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 14:34:58,352 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 14:34:58,353 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 14:34:58,354 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 14:34:58,354 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 14:34:58,355 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 14:34:58,355 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 14:34:58,356 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 14:34:58,357 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 14:34:58,358 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 14:34:58,358 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 14:34:58,358 - [INFO] - Successfully processed 2 dates
2025-01-27 14:34:58,358 - [INFO] - Starting client report loading process...
2025-01-27 14:34:58,359 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 14:34:58,361 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:34:58,370 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:34:58,375 - [INFO] - Archived 0 unique rows
2025-01-27 14:34:58,391 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:34:58,397 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 14:34:58,397 - [INFO] - - Archived rows: 0
2025-01-27 14:34:58,398 - [INFO] - - Loaded rows: 48
2025-01-27 14:34:58,398 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 14:34:58,401 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:34:58,407 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:34:58,411 - [INFO] - Archived 0 unique rows
2025-01-27 14:34:58,420 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:34:58,425 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 14:34:58,425 - [INFO] - - Archived rows: 0
2025-01-27 14:34:58,425 - [INFO] - - Loaded rows: 48
2025-01-27 14:34:58,425 - [INFO] - 
Verifying data load...
2025-01-27 14:34:58,431 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 14:34:58,432 - [INFO] - 
Load Summary:
2025-01-27 14:34:58,433 - [INFO] - Total files processed: 2
2025-01-27 14:34:58,433 - [INFO] - Total rows loaded: 96
2025-01-27 14:34:58,433 - [INFO] - 
Date Range:
2025-01-27 14:34:58,433 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 14:34:58,433 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 14:34:58,434 - [INFO] - 
Total Counts:
2025-01-27 14:34:58,434 - [INFO] -   Impressions: 44
2025-01-27 14:34:58,434 - [INFO] -   Clicks: 30
2025-01-27 14:34:58,434 - [INFO] - 
Client report loading completed successfully
2025-01-27 14:34:58,434 - [INFO] - Processing and loading completed successfully
2025-01-27 14:34:59,627 - [INFO] - Spark Session stopped
2025-01-27 14:55:22,629 - [INFO] - Starting application...
2025-01-27 14:55:22,725 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 14:55:37,226 - [INFO] - Spark Session created successfully
2025-01-27 14:55:37,227 - [INFO] - Spark version: 3.5.4
2025-01-27 14:55:37,227 - [INFO] - Spark master: local[*]
2025-01-27 14:55:37,227 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 14:55:37,227 - [INFO] - Starting file processing...
2025-01-27 14:55:37,227 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 14:55:37,228 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 14:55:37,228 - [INFO] - User agent filter: some user agent
2025-01-27 14:55:37,229 - [INFO] - Found 11 total parquet files
2025-01-27 14:55:37,229 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 14:55:37,229 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 14:55:42,401 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 14:55:42,844 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 14:55:44,567 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:55:45,034 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:55:45,441 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:55:45,848 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 14:55:46,099 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 14:55:51,912 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 14:55:51,913 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 14:55:51,913 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 14:55:51,914 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 14:55:51,914 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 14:55:52,139 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 14:55:52,284 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 14:55:53,532 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 14:55:53,807 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:55:54,019 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 14:55:54,188 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 14:55:54,349 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 14:55:54,607 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 14:55:54,760 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 14:55:56,079 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 14:55:56,341 - [INFO] - Found 0 records with invalid hours
2025-01-27 14:55:56,518 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 14:55:56,707 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 14:55:56,857 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 14:56:02,122 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 14:56:02,549 - [ERROR] - Error in _combine_and_fill_hours: [CANNOT_INFER_TYPE_FOR_FIELD] Unable to infer the type of the field `source_file`.
2025-01-27 14:56:02,550 - [ERROR] - Error processing files for date '2022-05-27': [CANNOT_INFER_TYPE_FOR_FIELD] Unable to infer the type of the field `source_file`.
2025-01-27 14:56:02,550 - [WARNING] - Failed to process data for date: 2022-05-27 - [CANNOT_INFER_TYPE_FOR_FIELD] Unable to infer the type of the field `source_file`.
2025-01-27 14:56:02,550 - [INFO] - Successfully processed 1 dates
2025-01-27 14:56:02,550 - [INFO] - Starting client report loading process...
2025-01-27 14:56:02,551 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 14:56:02,553 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:56:02,560 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:56:02,564 - [INFO] - Archived 0 unique rows
2025-01-27 14:56:02,578 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:56:02,584 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 14:56:02,585 - [INFO] - - Archived rows: 0
2025-01-27 14:56:02,585 - [INFO] - - Loaded rows: 48
2025-01-27 14:56:02,585 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 14:56:02,586 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 14:56:02,593 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 14:56:02,596 - [INFO] - Archived 0 unique rows
2025-01-27 14:56:02,605 - [INFO] - Successfully loaded 48 rows
2025-01-27 14:56:02,610 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 14:56:02,610 - [INFO] - - Archived rows: 0
2025-01-27 14:56:02,610 - [INFO] - - Loaded rows: 48
2025-01-27 14:56:02,610 - [INFO] - 
Verifying data load...
2025-01-27 14:56:02,616 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 14:56:02,617 - [INFO] - 
Load Summary:
2025-01-27 14:56:02,617 - [INFO] - Total files processed: 2
2025-01-27 14:56:02,618 - [INFO] - Total rows loaded: 96
2025-01-27 14:56:02,618 - [INFO] - 
Date Range:
2025-01-27 14:56:02,618 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 14:56:02,618 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 14:56:02,618 - [INFO] - 
Total Counts:
2025-01-27 14:56:02,618 - [INFO] -   Impressions: 44
2025-01-27 14:56:02,619 - [INFO] -   Clicks: 30
2025-01-27 14:56:02,619 - [INFO] - 
Client report loading completed successfully
2025-01-27 14:56:02,619 - [INFO] - Processing and loading completed successfully
2025-01-27 14:56:03,108 - [INFO] - Spark Session stopped
2025-01-27 15:03:49,953 - [INFO] - Starting application...
2025-01-27 15:03:50,012 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 15:04:16,029 - [INFO] - Spark Session created successfully
2025-01-27 15:04:16,030 - [INFO] - Spark version: 3.5.4
2025-01-27 15:04:16,030 - [INFO] - Spark master: local[*]
2025-01-27 15:04:16,030 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 15:04:16,030 - [INFO] - Starting file processing...
2025-01-27 15:04:16,030 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 15:04:16,030 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 15:04:16,031 - [INFO] - User agent filter: some user agent
2025-01-27 15:04:16,032 - [INFO] - Found 8 total parquet files
2025-01-27 15:04:16,032 - [INFO] - Impressions files by date: 2022-05-27
2025-01-27 15:04:16,032 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 15:04:21,136 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:04:21,583 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 15:04:23,220 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-27 15:04:23,222 - [WARNING] - Failed to process data for date: 2022-05-27 - An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-27 15:04:23,223 - [ERROR] - No dates were successfully processed
2025-01-27 15:04:23,223 - [ERROR] - Spark processing failed
2025-01-27 15:04:23,223 - [ERROR] - Processing or loading failed
2025-01-27 15:04:23,407 - [INFO] - Spark Session stopped
2025-01-27 15:12:57,062 - [INFO] - Starting application...
2025-01-27 15:12:57,122 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 15:13:05,721 - [INFO] - Spark Session created successfully
2025-01-27 15:13:05,722 - [INFO] - Spark version: 3.5.4
2025-01-27 15:13:05,722 - [INFO] - Spark master: local[*]
2025-01-27 15:13:05,722 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 15:13:05,722 - [INFO] - Starting file processing...
2025-01-27 15:13:05,722 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 15:13:05,722 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 15:13:05,723 - [INFO] - User agent filter: some user agent
2025-01-27 15:13:05,724 - [INFO] - Found 8 total parquet files
2025-01-27 15:13:05,724 - [INFO] - Impressions files by date: 2022-05-27
2025-01-27 15:13:05,724 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 15:13:11,056 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:13:11,515 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 15:13:13,316 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:13:13,821 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:13:14,206 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 15:13:14,597 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 15:13:14,847 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 15:13:15,139 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 15:13:15,367 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 15:13:16,724 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:13:17,038 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:13:17,306 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:13:17,527 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 15:13:17,757 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:13:22,326 - [ERROR] - Error in _combine_and_fill_hours: ClientReportETL._handle_click_impression_mismatch() missing 2 required positional arguments: 'self' and 'df'
2025-01-27 15:13:22,327 - [ERROR] - Error processing files for date '2022-05-27': ClientReportETL._handle_click_impression_mismatch() missing 2 required positional arguments: 'self' and 'df'
2025-01-27 15:13:22,327 - [WARNING] - Failed to process data for date: 2022-05-27 - ClientReportETL._handle_click_impression_mismatch() missing 2 required positional arguments: 'self' and 'df'
2025-01-27 15:13:22,327 - [ERROR] - No dates were successfully processed
2025-01-27 15:13:22,327 - [ERROR] - Spark processing failed
2025-01-27 15:13:22,328 - [ERROR] - Processing or loading failed
2025-01-27 15:13:23,377 - [INFO] - Spark Session stopped
2025-01-27 15:15:51,597 - [INFO] - Starting application...
2025-01-27 15:15:51,665 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 15:16:18,116 - [INFO] - Spark Session created successfully
2025-01-27 15:16:18,117 - [INFO] - Spark version: 3.5.4
2025-01-27 15:16:18,117 - [INFO] - Spark master: local[*]
2025-01-27 15:16:18,117 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 15:16:18,117 - [INFO] - Starting file processing...
2025-01-27 15:16:18,117 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 15:16:18,118 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 15:16:18,118 - [INFO] - User agent filter: some user agent
2025-01-27 15:16:18,119 - [INFO] - Found 8 total parquet files
2025-01-27 15:16:18,119 - [INFO] - Impressions files by date: 2022-05-27
2025-01-27 15:16:18,119 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 15:16:23,348 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:16:23,760 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 15:16:25,414 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-27 15:16:25,415 - [WARNING] - Failed to process data for date: 2022-05-27 - An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-27 15:16:25,417 - [ERROR] - No dates were successfully processed
2025-01-27 15:16:25,417 - [ERROR] - Spark processing failed
2025-01-27 15:16:25,418 - [ERROR] - Processing or loading failed
2025-01-27 15:16:25,536 - [INFO] - Spark Session stopped
2025-01-27 15:31:42,889 - [INFO] - Starting application...
2025-01-27 15:31:42,947 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 15:32:08,776 - [INFO] - Spark Session created successfully
2025-01-27 15:32:08,776 - [INFO] - Spark version: 3.5.4
2025-01-27 15:32:08,777 - [INFO] - Spark master: local[*]
2025-01-27 15:32:08,777 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 15:32:08,777 - [INFO] - Starting file processing...
2025-01-27 15:32:08,777 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 15:32:08,777 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 15:32:08,777 - [INFO] - User agent filter: some user agent
2025-01-27 15:32:08,778 - [INFO] - Found 8 total parquet files
2025-01-27 15:32:08,778 - [INFO] - Impressions files by date: 2022-05-27
2025-01-27 15:32:08,779 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 15:32:13,940 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:32:14,404 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 15:32:16,063 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:32:16,528 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:32:16,899 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 15:32:17,245 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 15:32:17,482 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 15:32:17,788 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 15:32:18,113 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 15:32:19,418 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:32:19,700 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:32:19,951 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:32:20,178 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 15:32:20,400 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:32:25,364 - [WARNING] - Found records where clicks exceed impressions:
2025-01-27 15:32:26,644 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 15:32:26,645 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 15:32:26,646 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:32:26,647 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 15:32:26,647 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 15:32:26,648 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:32:26,648 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 15:32:26,649 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 15:32:26,650 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 15:32:26,650 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 15:32:26,651 - [INFO] - Successfully processed 1 dates
2025-01-27 15:32:26,651 - [INFO] - Starting client report loading process...
2025-01-27 15:32:26,652 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 15:32:26,654 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 15:32:26,663 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 15:32:26,668 - [INFO] - Archived 0 unique rows
2025-01-27 15:32:26,684 - [INFO] - Successfully loaded 48 rows
2025-01-27 15:32:26,690 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 15:32:26,691 - [INFO] - - Archived rows: 0
2025-01-27 15:32:26,691 - [INFO] - - Loaded rows: 48
2025-01-27 15:32:26,691 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 15:32:26,695 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 15:32:26,705 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 15:32:26,709 - [INFO] - Archived 0 unique rows
2025-01-27 15:32:26,718 - [INFO] - Successfully loaded 48 rows
2025-01-27 15:32:26,722 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 15:32:26,723 - [INFO] - - Archived rows: 0
2025-01-27 15:32:26,723 - [INFO] - - Loaded rows: 48
2025-01-27 15:32:26,723 - [INFO] - 
Verifying data load...
2025-01-27 15:32:26,728 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 15:32:26,729 - [INFO] - 
Load Summary:
2025-01-27 15:32:26,729 - [INFO] - Total files processed: 2
2025-01-27 15:32:26,730 - [INFO] - Total rows loaded: 96
2025-01-27 15:32:26,730 - [INFO] - 
Date Range:
2025-01-27 15:32:26,730 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 15:32:26,730 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 15:32:26,730 - [INFO] - 
Total Counts:
2025-01-27 15:32:26,731 - [INFO] -   Impressions: 44
2025-01-27 15:32:26,731 - [INFO] -   Clicks: 30
2025-01-27 15:32:26,731 - [INFO] - 
Client report loading completed successfully
2025-01-27 15:32:26,731 - [INFO] - Processing and loading completed successfully
2025-01-27 15:32:27,367 - [INFO] - Spark Session stopped
2025-01-27 15:40:23,390 - [INFO] - Starting application...
2025-01-27 15:40:23,500 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 15:40:49,280 - [INFO] - Spark Session created successfully
2025-01-27 15:40:49,280 - [INFO] - Spark version: 3.5.4
2025-01-27 15:40:49,280 - [INFO] - Spark master: local[*]
2025-01-27 15:40:49,280 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 15:40:49,281 - [INFO] - Starting file processing...
2025-01-27 15:40:49,281 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 15:40:49,281 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 15:40:49,281 - [INFO] - User agent filter: some user agent
2025-01-27 15:40:49,282 - [INFO] - Found 11 total parquet files
2025-01-27 15:40:49,283 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 15:40:49,283 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 15:40:54,403 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:40:54,856 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 15:40:56,546 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 15:40:57,025 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:40:57,407 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 15:40:57,765 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 15:40:57,996 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 15:41:03,019 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 15:41:03,019 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 15:41:03,020 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 15:41:03,021 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 15:41:03,022 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 15:41:03,357 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:41:03,547 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 15:41:04,778 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:41:05,058 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:41:05,256 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 15:41:05,438 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 15:41:05,632 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 15:41:06,045 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 15:41:06,214 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 15:41:07,605 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:41:07,864 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:41:08,114 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:41:08,337 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 15:41:08,541 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:41:12,478 - [WARNING] - Found records where clicks exceed impressions:
2025-01-27 15:41:13,325 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 15:41:13,326 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 15:41:13,327 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:41:13,328 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 15:41:13,328 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 15:41:13,329 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:41:13,330 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 15:41:13,330 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 15:41:13,331 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 15:41:13,331 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 15:41:13,332 - [INFO] - Successfully processed 2 dates
2025-01-27 15:41:13,332 - [INFO] - Starting client report loading process...
2025-01-27 15:41:13,333 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 15:41:13,335 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 15:41:13,336 - [ERROR] - Error loading data: Data validation failed: Missing required columns: {'datetime'}
2025-01-27 15:41:13,336 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: Data validation failed: Missing required columns: {'datetime'}
2025-01-27 15:41:13,336 - [ERROR] - Processing or loading failed
2025-01-27 15:41:14,496 - [INFO] - Spark Session stopped
2025-01-27 15:47:26,384 - [INFO] - Starting application...
2025-01-27 15:47:26,448 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 15:47:35,170 - [INFO] - Spark Session created successfully
2025-01-27 15:47:35,170 - [INFO] - Spark version: 3.5.4
2025-01-27 15:47:35,170 - [INFO] - Spark master: local[*]
2025-01-27 15:47:35,171 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 15:47:35,171 - [INFO] - Starting file processing...
2025-01-27 15:47:35,171 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 15:47:35,171 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 15:47:35,171 - [INFO] - User agent filter: some user agent
2025-01-27 15:47:35,172 - [INFO] - Found 11 total parquet files
2025-01-27 15:47:35,173 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 15:47:35,173 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 15:47:40,621 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:47:41,377 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 15:47:43,957 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 15:47:44,471 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:47:44,878 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 15:47:45,269 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 15:47:45,531 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 15:47:50,391 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 15:47:50,392 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 15:47:50,393 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 15:47:50,393 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 15:47:50,393 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 15:47:50,617 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:47:50,773 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 15:47:51,954 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:47:52,278 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:47:52,472 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 15:47:52,665 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 15:47:52,830 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 15:47:53,150 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 15:47:53,305 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 15:47:54,728 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:47:54,976 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:47:55,182 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:47:55,384 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 15:47:55,572 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:47:59,465 - [WARNING] - Found records where clicks exceed impressions:
2025-01-27 15:48:00,203 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 15:48:00,204 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 15:48:00,204 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:48:00,205 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 15:48:00,206 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 15:48:00,206 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:48:00,207 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 15:48:00,207 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 15:48:00,208 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 15:48:00,208 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 15:48:00,208 - [INFO] - Successfully processed 2 dates
2025-01-27 15:48:00,208 - [INFO] - Starting client report loading process...
2025-01-27 15:48:00,209 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 15:48:00,211 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 15:48:00,211 - [ERROR] - Error loading data: Data validation failed: Missing required columns: {'datetime'}
2025-01-27 15:48:00,211 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: Data validation failed: Missing required columns: {'datetime'}
2025-01-27 15:48:00,211 - [ERROR] - Processing or loading failed
2025-01-27 15:48:00,451 - [INFO] - Spark Session stopped
2025-01-27 15:50:25,123 - [INFO] - Starting application...
2025-01-27 15:50:25,189 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 15:50:34,101 - [INFO] - Spark Session created successfully
2025-01-27 15:50:34,102 - [INFO] - Spark version: 3.5.4
2025-01-27 15:50:34,102 - [INFO] - Spark master: local[*]
2025-01-27 15:50:34,102 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 15:50:34,102 - [INFO] - Starting file processing...
2025-01-27 15:50:34,102 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 15:50:34,103 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 15:50:34,103 - [INFO] - User agent filter: some user agent
2025-01-27 15:50:34,104 - [INFO] - Found 11 total parquet files
2025-01-27 15:50:34,104 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 15:50:34,104 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 15:50:40,002 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:50:40,623 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 15:50:43,343 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 15:50:43,877 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:50:44,329 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 15:50:44,718 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 15:50:44,957 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 15:50:49,761 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 15:50:49,762 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 15:50:49,763 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 15:50:49,764 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 15:50:49,764 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 15:50:50,031 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:50:50,195 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 15:50:51,420 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:50:51,739 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:50:51,932 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 15:50:52,152 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 15:50:52,326 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 15:50:52,653 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 15:50:52,813 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 15:50:54,200 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:50:54,446 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:50:54,635 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:50:54,857 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 15:50:55,075 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:50:59,045 - [WARNING] - Found records where clicks exceed impressions:
2025-01-27 15:50:59,765 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 15:50:59,765 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 15:50:59,766 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:50:59,767 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 15:50:59,768 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 15:50:59,768 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:50:59,769 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 15:50:59,770 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 15:50:59,771 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 15:50:59,771 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 15:50:59,771 - [INFO] - Successfully processed 2 dates
2025-01-27 15:50:59,771 - [INFO] - Starting client report loading process...
2025-01-27 15:50:59,772 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 15:50:59,774 - [INFO] - Read CSV with shape: (24, 3)
2025-01-27 15:50:59,776 - [ERROR] - Error preparing data: 'date'
2025-01-27 15:50:59,776 - [ERROR] - DataFrame columns: impression_count, click_count, datetime
2025-01-27 15:50:59,779 - [ERROR] - Sample data:
   impression_count  click_count             datetime
0                 0            0  2022-05-26 00:00:00
1                 0            0  2022-05-26 01:00:00
2                 0            0  2022-05-26 02:00:00
3                 0            0  2022-05-26 03:00:00
4                 0            0  2022-05-26 04:00:00
2025-01-27 15:50:59,779 - [ERROR] - Error loading data: 'date'
2025-01-27 15:50:59,779 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'date'
2025-01-27 15:50:59,779 - [ERROR] - Processing or loading failed
2025-01-27 15:51:00,037 - [INFO] - Spark Session stopped
2025-01-27 15:55:48,290 - [INFO] - Starting application...
2025-01-27 15:55:48,352 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 15:55:54,494 - [INFO] - Spark Session created successfully
2025-01-27 15:55:54,494 - [INFO] - Spark version: 3.5.4
2025-01-27 15:55:54,494 - [INFO] - Spark master: local[*]
2025-01-27 15:55:54,494 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 15:55:54,495 - [INFO] - Starting file processing...
2025-01-27 15:55:54,495 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 15:55:54,495 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 15:55:54,495 - [INFO] - User agent filter: some user agent
2025-01-27 15:55:54,496 - [INFO] - Found 11 total parquet files
2025-01-27 15:55:54,496 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 15:55:54,496 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 15:55:59,805 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:56:00,366 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 15:56:02,106 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 15:56:02,632 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:56:03,026 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 15:56:03,375 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 15:56:03,619 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 15:56:08,377 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 15:56:08,378 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 15:56:08,379 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 15:56:08,379 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 15:56:08,379 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 15:56:08,726 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 15:56:08,881 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 15:56:10,007 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:56:10,264 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:56:10,441 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 15:56:10,662 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 15:56:10,833 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 15:56:11,144 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 15:56:11,296 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 15:56:12,726 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:56:13,029 - [INFO] - Found 0 records with invalid hours
2025-01-27 15:56:13,245 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:56:13,527 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 15:56:13,690 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 15:56:17,583 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 15:56:18,336 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 15:56:18,336 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 15:56:18,337 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 15:56:18,337 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 15:56:18,338 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 15:56:18,338 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 15:56:18,339 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 15:56:18,339 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 15:56:18,340 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 15:56:18,340 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 15:56:18,340 - [INFO] - Successfully processed 2 dates
2025-01-27 15:56:18,340 - [INFO] - Starting client report loading process...
2025-01-27 15:56:18,341 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 15:56:18,342 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 15:56:18,350 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 15:56:18,354 - [INFO] - Archived 0 unique rows
2025-01-27 15:56:18,369 - [INFO] - Successfully loaded 48 rows
2025-01-27 15:56:18,376 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 15:56:18,376 - [INFO] - - Archived rows: 0
2025-01-27 15:56:18,376 - [INFO] - - Loaded rows: 48
2025-01-27 15:56:18,376 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 15:56:18,380 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 15:56:18,386 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 15:56:18,389 - [INFO] - Archived 0 unique rows
2025-01-27 15:56:18,398 - [INFO] - Successfully loaded 48 rows
2025-01-27 15:56:18,403 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 15:56:18,403 - [INFO] - - Archived rows: 0
2025-01-27 15:56:18,403 - [INFO] - - Loaded rows: 48
2025-01-27 15:56:18,403 - [INFO] - 
Verifying data load...
2025-01-27 15:56:18,409 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 15:56:18,410 - [INFO] - 
Load Summary:
2025-01-27 15:56:18,410 - [INFO] - Total files processed: 2
2025-01-27 15:56:18,410 - [INFO] - Total rows loaded: 96
2025-01-27 15:56:18,410 - [INFO] - 
Date Range:
2025-01-27 15:56:18,411 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 15:56:18,411 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 15:56:18,411 - [INFO] - 
Total Counts:
2025-01-27 15:56:18,411 - [INFO] -   Impressions: 44
2025-01-27 15:56:18,411 - [INFO] -   Clicks: 30
2025-01-27 15:56:18,411 - [INFO] - 
Client report loading completed successfully
2025-01-27 15:56:18,412 - [INFO] - Processing and loading completed successfully
2025-01-27 15:56:19,598 - [INFO] - Spark Session stopped
2025-01-27 16:00:52,147 - [INFO] - Starting application...
2025-01-27 16:00:52,221 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 16:01:07,427 - [INFO] - Spark Session created successfully
2025-01-27 16:01:07,428 - [INFO] - Spark version: 3.5.4
2025-01-27 16:01:07,428 - [INFO] - Spark master: local[*]
2025-01-27 16:01:07,428 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 16:01:07,429 - [INFO] - Starting file processing...
2025-01-27 16:01:07,429 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 16:01:07,429 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 16:01:07,429 - [INFO] - User agent filter: some user agent
2025-01-27 16:01:07,430 - [INFO] - Found 11 total parquet files
2025-01-27 16:01:07,430 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 16:01:07,431 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 16:01:12,392 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 16:01:12,864 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 16:01:14,643 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 16:01:15,182 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:01:15,581 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 16:01:15,930 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 16:01:16,164 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 16:01:20,871 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 16:01:20,872 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 16:01:20,873 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 16:01:20,873 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 16:01:20,874 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 16:01:21,156 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 16:01:21,296 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 16:01:22,450 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 16:01:22,730 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:01:22,930 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 16:01:23,132 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 16:01:23,307 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 16:01:23,668 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 16:01:23,825 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 16:01:25,260 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 16:01:25,488 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:01:25,699 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 16:01:25,886 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 16:01:26,104 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 16:01:30,077 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 16:01:30,793 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 16:01:30,794 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 16:01:30,795 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 16:01:30,795 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 16:01:30,796 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 16:01:30,797 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 16:01:30,798 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 16:01:30,798 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 16:01:30,799 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 16:01:30,799 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 16:01:30,799 - [INFO] - Successfully processed 2 dates
2025-01-27 16:01:30,800 - [INFO] - Starting client report loading process...
2025-01-27 16:01:30,800 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 16:01:30,802 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 16:01:30,810 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 16:01:30,816 - [INFO] - Archived 0 unique rows
2025-01-27 16:01:30,833 - [INFO] - Successfully loaded 48 rows
2025-01-27 16:01:30,839 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 16:01:30,839 - [INFO] - - Archived rows: 0
2025-01-27 16:01:30,840 - [INFO] - - Loaded rows: 48
2025-01-27 16:01:30,840 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 16:01:30,844 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 16:01:30,850 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 16:01:30,855 - [INFO] - Archived 0 unique rows
2025-01-27 16:01:30,865 - [INFO] - Successfully loaded 48 rows
2025-01-27 16:01:30,870 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 16:01:30,870 - [INFO] - - Archived rows: 0
2025-01-27 16:01:30,870 - [INFO] - - Loaded rows: 48
2025-01-27 16:01:30,871 - [INFO] - 
Verifying data load...
2025-01-27 16:01:30,877 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 16:01:30,879 - [INFO] - 
Load Summary:
2025-01-27 16:01:30,879 - [INFO] - Total files processed: 2
2025-01-27 16:01:30,880 - [INFO] - Total rows loaded: 96
2025-01-27 16:01:30,880 - [INFO] - 
Date Range:
2025-01-27 16:01:30,880 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 16:01:30,880 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 16:01:30,880 - [INFO] - 
Total Counts:
2025-01-27 16:01:30,881 - [INFO] -   Impressions: 44
2025-01-27 16:01:30,881 - [INFO] -   Clicks: 30
2025-01-27 16:01:30,882 - [INFO] - 
Client report loading completed successfully
2025-01-27 16:01:30,882 - [INFO] - Processing and loading completed successfully
2025-01-27 16:01:32,071 - [INFO] - Spark Session stopped
2025-01-27 16:07:21,157 - [INFO] - Starting application...
2025-01-27 16:07:21,263 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 16:07:39,188 - [INFO] - Spark Session created successfully
2025-01-27 16:07:39,188 - [INFO] - Spark version: 3.5.4
2025-01-27 16:07:39,189 - [INFO] - Spark master: local[*]
2025-01-27 16:07:39,189 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 16:07:39,189 - [INFO] - Starting file processing...
2025-01-27 16:07:39,189 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 16:07:39,189 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 16:07:39,190 - [INFO] - User agent filter: some user agent
2025-01-27 16:07:39,191 - [INFO] - Found 11 total parquet files
2025-01-27 16:07:39,191 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 16:07:39,191 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 16:07:44,407 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 16:07:44,903 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 16:07:46,692 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 16:07:47,156 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:07:47,580 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 16:07:47,965 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 16:07:48,222 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 16:07:53,195 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 16:07:53,196 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 16:07:53,197 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 16:07:53,198 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 16:07:53,198 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 16:07:53,541 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 16:07:53,687 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 16:07:54,895 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 16:07:55,158 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:07:55,346 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 16:07:55,520 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 16:07:55,741 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 16:07:55,987 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 16:07:56,153 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 16:07:57,499 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 16:07:57,722 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:07:57,922 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 16:07:58,138 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 16:07:58,327 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 16:08:02,311 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 16:08:02,788 - [ERROR] - Error in _combine_and_fill_hours: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `date` cannot be resolved. Did you mean one of the following? [`hour`, `click_count`, `impression_count`].;
'Project ['date, hour#2238L, impression_count#2239L, click_count#2240L]
+- Filter (click_count#2240L > impression_count#2239L)
   +- Project [coalesce(hour#2221L, cast(0.0 as bigint)) AS hour#2238L, coalesce(impression_count#2225L, cast(0.0 as bigint)) AS impression_count#2239L, coalesce(click_count#2231L, cast(0.0 as bigint)) AS click_count#2240L]
      +- Project [hour#2221L, impression_count#2225L, count#2175L AS click_count#2231L]
         +- Project [hour#2221L, impression_count#2225L, count#2175L]
            +- Join LeftOuter, (hour#2221L = cast(hour#1869 as bigint))
               :- Project [hour#2221L, count#1533L AS impression_count#2225L]
               :  +- Project [hour#2221L, count#1533L]
               :     +- Join LeftOuter, (hour#2221L = cast(hour#1185 as bigint))
               :        :- Project [id#2219L AS hour#2221L]
               :        :  +- Range (0, 24, step=1, splits=Some(2))
               :        +- Project [hour#1185, CASE WHEN (count#1476L = valid_count#1478L) THEN count#1476L ELSE valid_count#1478L END AS count#1533L]
               :           +- Aggregate [hour#1185], [hour#1185, count(1) AS count#1476L, count(CASE WHEN isnotnull(hour#1185) THEN true END) AS valid_count#1478L]
               :              +- Project [transaction_header#857, user_identity#858, fraud_detection#859, geo_location#860, device_settings#861, connection#862, banner#863, rotator#864, interaction_id#865L, page_url#866, publisher_domain#867, shown_in_non_friendly_iframe#868, output_type#869, shown_in_ad_container#870, video_properties#871, rtb_vars#872, deprecated_dmp_vars#873, brand_safety_vars#874, adx_vars#875, ext_vars#876, test_id#877, raw_request_url#878, serving_type#879, is_p2c_enabled#880, ... 23 more fields]
               :                 +- Project [transaction_header#857, user_identity#858, fraud_detection#859, geo_location#860, device_settings#861, connection#862, banner#863, rotator#864, interaction_id#865L, page_url#866, publisher_domain#867, shown_in_non_friendly_iframe#868, output_type#869, shown_in_ad_container#870, video_properties#871, rtb_vars#872, deprecated_dmp_vars#873, brand_safety_vars#874, adx_vars#875, ext_vars#876, test_id#877, raw_request_url#878, serving_type#879, is_p2c_enabled#880, ... 22 more fields]
               :                    +- Filter (device_settings#861.user_agent = some user agent)
               :                       +- Relation [transaction_header#857,user_identity#858,fraud_detection#859,geo_location#860,device_settings#861,connection#862,banner#863,rotator#864,interaction_id#865L,page_url#866,publisher_domain#867,shown_in_non_friendly_iframe#868,output_type#869,shown_in_ad_container#870,video_properties#871,rtb_vars#872,deprecated_dmp_vars#873,brand_safety_vars#874,adx_vars#875,ext_vars#876,test_id#877,raw_request_url#878,serving_type#879,is_p2c_enabled#880,... 21 more fields] parquet
               +- Project [hour#1869, CASE WHEN (count#2124L = valid_count#2126L) THEN count#2124L ELSE valid_count#2126L END AS count#2175L]
                  +- Aggregate [hour#1869], [hour#1869, count(1) AS count#2124L, count(CASE WHEN isnotnull(hour#1869) THEN true END) AS valid_count#2126L]
                     +- Project [transaction_header#1583, user_identity#1584, fraud_detection#1585, geo_location#1586, device_settings#1587, connection#1588, banner#1589, rotator#1590, interaction_id#1591L, page_url#1592, landing_url#1593, publisher_domain#1594, banner_click_url_id#1595, keywords#1596, rtb_vars#1597, publisher_data#1598, dco_vars#1599, banner_vars#1600, adx_vars#1601, ext_vars#1602, test_id#1603, raw_request_url#1604, server_impression_time_ms#1605L, is_p2c_enabled#1606, ... 17 more fields]
                        +- Project [transaction_header#1583, user_identity#1584, fraud_detection#1585, geo_location#1586, device_settings#1587, connection#1588, banner#1589, rotator#1590, interaction_id#1591L, page_url#1592, landing_url#1593, publisher_domain#1594, banner_click_url_id#1595, keywords#1596, rtb_vars#1597, publisher_data#1598, dco_vars#1599, banner_vars#1600, adx_vars#1601, ext_vars#1602, test_id#1603, raw_request_url#1604, server_impression_time_ms#1605L, is_p2c_enabled#1606, ... 16 more fields]
                           +- Filter (device_settings#1587.user_agent = some user agent)
                              +- Relation [transaction_header#1583,user_identity#1584,fraud_detection#1585,geo_location#1586,device_settings#1587,connection#1588,banner#1589,rotator#1590,interaction_id#1591L,page_url#1592,landing_url#1593,publisher_domain#1594,banner_click_url_id#1595,keywords#1596,rtb_vars#1597,publisher_data#1598,dco_vars#1599,banner_vars#1600,adx_vars#1601,ext_vars#1602,test_id#1603,raw_request_url#1604,server_impression_time_ms#1605L,is_p2c_enabled#1606,... 15 more fields] parquet

2025-01-27 16:08:02,794 - [ERROR] - Error processing files for date '2022-05-27': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `date` cannot be resolved. Did you mean one of the following? [`hour`, `click_count`, `impression_count`].;
'Project ['date, hour#2238L, impression_count#2239L, click_count#2240L]
+- Filter (click_count#2240L > impression_count#2239L)
   +- Project [coalesce(hour#2221L, cast(0.0 as bigint)) AS hour#2238L, coalesce(impression_count#2225L, cast(0.0 as bigint)) AS impression_count#2239L, coalesce(click_count#2231L, cast(0.0 as bigint)) AS click_count#2240L]
      +- Project [hour#2221L, impression_count#2225L, count#2175L AS click_count#2231L]
         +- Project [hour#2221L, impression_count#2225L, count#2175L]
            +- Join LeftOuter, (hour#2221L = cast(hour#1869 as bigint))
               :- Project [hour#2221L, count#1533L AS impression_count#2225L]
               :  +- Project [hour#2221L, count#1533L]
               :     +- Join LeftOuter, (hour#2221L = cast(hour#1185 as bigint))
               :        :- Project [id#2219L AS hour#2221L]
               :        :  +- Range (0, 24, step=1, splits=Some(2))
               :        +- Project [hour#1185, CASE WHEN (count#1476L = valid_count#1478L) THEN count#1476L ELSE valid_count#1478L END AS count#1533L]
               :           +- Aggregate [hour#1185], [hour#1185, count(1) AS count#1476L, count(CASE WHEN isnotnull(hour#1185) THEN true END) AS valid_count#1478L]
               :              +- Project [transaction_header#857, user_identity#858, fraud_detection#859, geo_location#860, device_settings#861, connection#862, banner#863, rotator#864, interaction_id#865L, page_url#866, publisher_domain#867, shown_in_non_friendly_iframe#868, output_type#869, shown_in_ad_container#870, video_properties#871, rtb_vars#872, deprecated_dmp_vars#873, brand_safety_vars#874, adx_vars#875, ext_vars#876, test_id#877, raw_request_url#878, serving_type#879, is_p2c_enabled#880, ... 23 more fields]
               :                 +- Project [transaction_header#857, user_identity#858, fraud_detection#859, geo_location#860, device_settings#861, connection#862, banner#863, rotator#864, interaction_id#865L, page_url#866, publisher_domain#867, shown_in_non_friendly_iframe#868, output_type#869, shown_in_ad_container#870, video_properties#871, rtb_vars#872, deprecated_dmp_vars#873, brand_safety_vars#874, adx_vars#875, ext_vars#876, test_id#877, raw_request_url#878, serving_type#879, is_p2c_enabled#880, ... 22 more fields]
               :                    +- Filter (device_settings#861.user_agent = some user agent)
               :                       +- Relation [transaction_header#857,user_identity#858,fraud_detection#859,geo_location#860,device_settings#861,connection#862,banner#863,rotator#864,interaction_id#865L,page_url#866,publisher_domain#867,shown_in_non_friendly_iframe#868,output_type#869,shown_in_ad_container#870,video_properties#871,rtb_vars#872,deprecated_dmp_vars#873,brand_safety_vars#874,adx_vars#875,ext_vars#876,test_id#877,raw_request_url#878,serving_type#879,is_p2c_enabled#880,... 21 more fields] parquet
               +- Project [hour#1869, CASE WHEN (count#2124L = valid_count#2126L) THEN count#2124L ELSE valid_count#2126L END AS count#2175L]
                  +- Aggregate [hour#1869], [hour#1869, count(1) AS count#2124L, count(CASE WHEN isnotnull(hour#1869) THEN true END) AS valid_count#2126L]
                     +- Project [transaction_header#1583, user_identity#1584, fraud_detection#1585, geo_location#1586, device_settings#1587, connection#1588, banner#1589, rotator#1590, interaction_id#1591L, page_url#1592, landing_url#1593, publisher_domain#1594, banner_click_url_id#1595, keywords#1596, rtb_vars#1597, publisher_data#1598, dco_vars#1599, banner_vars#1600, adx_vars#1601, ext_vars#1602, test_id#1603, raw_request_url#1604, server_impression_time_ms#1605L, is_p2c_enabled#1606, ... 17 more fields]
                        +- Project [transaction_header#1583, user_identity#1584, fraud_detection#1585, geo_location#1586, device_settings#1587, connection#1588, banner#1589, rotator#1590, interaction_id#1591L, page_url#1592, landing_url#1593, publisher_domain#1594, banner_click_url_id#1595, keywords#1596, rtb_vars#1597, publisher_data#1598, dco_vars#1599, banner_vars#1600, adx_vars#1601, ext_vars#1602, test_id#1603, raw_request_url#1604, server_impression_time_ms#1605L, is_p2c_enabled#1606, ... 16 more fields]
                           +- Filter (device_settings#1587.user_agent = some user agent)
                              +- Relation [transaction_header#1583,user_identity#1584,fraud_detection#1585,geo_location#1586,device_settings#1587,connection#1588,banner#1589,rotator#1590,interaction_id#1591L,page_url#1592,landing_url#1593,publisher_domain#1594,banner_click_url_id#1595,keywords#1596,rtb_vars#1597,publisher_data#1598,dco_vars#1599,banner_vars#1600,adx_vars#1601,ext_vars#1602,test_id#1603,raw_request_url#1604,server_impression_time_ms#1605L,is_p2c_enabled#1606,... 15 more fields] parquet

2025-01-27 16:08:02,802 - [WARNING] - Failed to process data for date: 2022-05-27 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `date` cannot be resolved. Did you mean one of the following? [`hour`, `click_count`, `impression_count`].;
'Project ['date, hour#2238L, impression_count#2239L, click_count#2240L]
+- Filter (click_count#2240L > impression_count#2239L)
   +- Project [coalesce(hour#2221L, cast(0.0 as bigint)) AS hour#2238L, coalesce(impression_count#2225L, cast(0.0 as bigint)) AS impression_count#2239L, coalesce(click_count#2231L, cast(0.0 as bigint)) AS click_count#2240L]
      +- Project [hour#2221L, impression_count#2225L, count#2175L AS click_count#2231L]
         +- Project [hour#2221L, impression_count#2225L, count#2175L]
            +- Join LeftOuter, (hour#2221L = cast(hour#1869 as bigint))
               :- Project [hour#2221L, count#1533L AS impression_count#2225L]
               :  +- Project [hour#2221L, count#1533L]
               :     +- Join LeftOuter, (hour#2221L = cast(hour#1185 as bigint))
               :        :- Project [id#2219L AS hour#2221L]
               :        :  +- Range (0, 24, step=1, splits=Some(2))
               :        +- Project [hour#1185, CASE WHEN (count#1476L = valid_count#1478L) THEN count#1476L ELSE valid_count#1478L END AS count#1533L]
               :           +- Aggregate [hour#1185], [hour#1185, count(1) AS count#1476L, count(CASE WHEN isnotnull(hour#1185) THEN true END) AS valid_count#1478L]
               :              +- Project [transaction_header#857, user_identity#858, fraud_detection#859, geo_location#860, device_settings#861, connection#862, banner#863, rotator#864, interaction_id#865L, page_url#866, publisher_domain#867, shown_in_non_friendly_iframe#868, output_type#869, shown_in_ad_container#870, video_properties#871, rtb_vars#872, deprecated_dmp_vars#873, brand_safety_vars#874, adx_vars#875, ext_vars#876, test_id#877, raw_request_url#878, serving_type#879, is_p2c_enabled#880, ... 23 more fields]
               :                 +- Project [transaction_header#857, user_identity#858, fraud_detection#859, geo_location#860, device_settings#861, connection#862, banner#863, rotator#864, interaction_id#865L, page_url#866, publisher_domain#867, shown_in_non_friendly_iframe#868, output_type#869, shown_in_ad_container#870, video_properties#871, rtb_vars#872, deprecated_dmp_vars#873, brand_safety_vars#874, adx_vars#875, ext_vars#876, test_id#877, raw_request_url#878, serving_type#879, is_p2c_enabled#880, ... 22 more fields]
               :                    +- Filter (device_settings#861.user_agent = some user agent)
               :                       +- Relation [transaction_header#857,user_identity#858,fraud_detection#859,geo_location#860,device_settings#861,connection#862,banner#863,rotator#864,interaction_id#865L,page_url#866,publisher_domain#867,shown_in_non_friendly_iframe#868,output_type#869,shown_in_ad_container#870,video_properties#871,rtb_vars#872,deprecated_dmp_vars#873,brand_safety_vars#874,adx_vars#875,ext_vars#876,test_id#877,raw_request_url#878,serving_type#879,is_p2c_enabled#880,... 21 more fields] parquet
               +- Project [hour#1869, CASE WHEN (count#2124L = valid_count#2126L) THEN count#2124L ELSE valid_count#2126L END AS count#2175L]
                  +- Aggregate [hour#1869], [hour#1869, count(1) AS count#2124L, count(CASE WHEN isnotnull(hour#1869) THEN true END) AS valid_count#2126L]
                     +- Project [transaction_header#1583, user_identity#1584, fraud_detection#1585, geo_location#1586, device_settings#1587, connection#1588, banner#1589, rotator#1590, interaction_id#1591L, page_url#1592, landing_url#1593, publisher_domain#1594, banner_click_url_id#1595, keywords#1596, rtb_vars#1597, publisher_data#1598, dco_vars#1599, banner_vars#1600, adx_vars#1601, ext_vars#1602, test_id#1603, raw_request_url#1604, server_impression_time_ms#1605L, is_p2c_enabled#1606, ... 17 more fields]
                        +- Project [transaction_header#1583, user_identity#1584, fraud_detection#1585, geo_location#1586, device_settings#1587, connection#1588, banner#1589, rotator#1590, interaction_id#1591L, page_url#1592, landing_url#1593, publisher_domain#1594, banner_click_url_id#1595, keywords#1596, rtb_vars#1597, publisher_data#1598, dco_vars#1599, banner_vars#1600, adx_vars#1601, ext_vars#1602, test_id#1603, raw_request_url#1604, server_impression_time_ms#1605L, is_p2c_enabled#1606, ... 16 more fields]
                           +- Filter (device_settings#1587.user_agent = some user agent)
                              +- Relation [transaction_header#1583,user_identity#1584,fraud_detection#1585,geo_location#1586,device_settings#1587,connection#1588,banner#1589,rotator#1590,interaction_id#1591L,page_url#1592,landing_url#1593,publisher_domain#1594,banner_click_url_id#1595,keywords#1596,rtb_vars#1597,publisher_data#1598,dco_vars#1599,banner_vars#1600,adx_vars#1601,ext_vars#1602,test_id#1603,raw_request_url#1604,server_impression_time_ms#1605L,is_p2c_enabled#1606,... 15 more fields] parquet

2025-01-27 16:08:02,803 - [INFO] - Successfully processed 1 dates
2025-01-27 16:08:02,804 - [INFO] - Starting client report loading process...
2025-01-27 16:08:02,804 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 16:08:02,807 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 16:08:02,820 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 16:08:02,827 - [INFO] - Archived 0 unique rows
2025-01-27 16:08:02,845 - [INFO] - Successfully loaded 48 rows
2025-01-27 16:08:02,851 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 16:08:02,851 - [INFO] - - Archived rows: 0
2025-01-27 16:08:02,851 - [INFO] - - Loaded rows: 48
2025-01-27 16:08:02,852 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 16:08:02,854 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 16:08:02,861 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 16:08:02,865 - [INFO] - Archived 0 unique rows
2025-01-27 16:08:02,875 - [INFO] - Successfully loaded 48 rows
2025-01-27 16:08:02,880 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 16:08:02,880 - [INFO] - - Archived rows: 0
2025-01-27 16:08:02,880 - [INFO] - - Loaded rows: 48
2025-01-27 16:08:02,880 - [INFO] - 
Verifying data load...
2025-01-27 16:08:02,887 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 16:08:02,888 - [INFO] - 
Load Summary:
2025-01-27 16:08:02,889 - [INFO] - Total files processed: 2
2025-01-27 16:08:02,889 - [INFO] - Total rows loaded: 96
2025-01-27 16:08:02,889 - [INFO] - 
Date Range:
2025-01-27 16:08:02,889 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 16:08:02,889 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 16:08:02,890 - [INFO] - 
Total Counts:
2025-01-27 16:08:02,890 - [INFO] -   Impressions: 44
2025-01-27 16:08:02,890 - [INFO] -   Clicks: 30
2025-01-27 16:08:02,890 - [INFO] - 
Client report loading completed successfully
2025-01-27 16:08:02,890 - [INFO] - Processing and loading completed successfully
2025-01-27 16:08:03,298 - [INFO] - Spark Session stopped
2025-01-27 16:13:48,652 - [INFO] - Starting application...
2025-01-27 16:13:48,728 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 16:14:16,051 - [INFO] - Spark Session created successfully
2025-01-27 16:14:16,052 - [INFO] - Spark version: 3.5.4
2025-01-27 16:14:16,052 - [INFO] - Spark master: local[*]
2025-01-27 16:14:16,052 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 16:14:16,053 - [INFO] - Starting file processing...
2025-01-27 16:14:16,053 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 16:14:16,053 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 16:14:16,053 - [INFO] - User agent filter: some user agent
2025-01-27 16:14:16,054 - [INFO] - Found 8 total parquet files
2025-01-27 16:14:16,054 - [INFO] - Impressions files by date: 2022-05-27
2025-01-27 16:14:16,054 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 16:14:21,410 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 16:14:21,835 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 16:14:23,607 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-27 16:14:23,609 - [WARNING] - Failed to process data for date: 2022-05-27 - An error occurred while calling z:org.apache.spark.api.python.PythonRDD.runJob.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 7.0 failed 1 times, most recent failure: Lost task 0.0 in stage 7.0 (TID 7) (host.docker.internal executor driver): java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2856)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2792)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2791)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2791)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1247)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1247)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3060)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2994)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2983)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:989)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2393)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2414)
	at org.apache.spark.SparkContext.runJob(SparkContext.scala:2433)
	at org.apache.spark.api.python.PythonRDD$.runJob(PythonRDD.scala:181)
	at org.apache.spark.api.python.PythonRDD.runJob(PythonRDD.scala)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:566)
	at py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)
	at py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:374)
	at py4j.Gateway.invoke(Gateway.java:282)
	at py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)
	at py4j.commands.CallCommand.execute(CallCommand.java:79)
	at py4j.ClientServerConnection.waitForCommands(ClientServerConnection.java:182)
	at py4j.ClientServerConnection.run(ClientServerConnection.java:106)
	at java.base/java.lang.Thread.run(Thread.java:834)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.base/java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.base/java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:110)
	at java.base/java.net.SocketOutputStream.write(SocketOutputStream.java:150)
	at java.base/java.io.BufferedOutputStream.flushBuffer(BufferedOutputStream.java:81)
	at java.base/java.io.BufferedOutputStream.write(BufferedOutputStream.java:122)
	at java.base/java.io.DataOutputStream.write(DataOutputStream.java:107)
	at java.base/java.io.FilterOutputStream.write(FilterOutputStream.java:108)
	at org.apache.spark.api.python.PythonRDD$.write$1(PythonRDD.scala:310)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRDD$.$anonfun$writeIteratorToStream$1$adapted(PythonRDD.scala:322)
	at scala.collection.Iterator.foreach(Iterator.scala:943)
	at scala.collection.Iterator.foreach$(Iterator.scala:943)
	at org.apache.spark.api.python.SerDeUtil$AutoBatchedPickler.foreach(SerDeUtil.scala:80)
	at org.apache.spark.api.python.PythonRDD$.writeIteratorToStream(PythonRDD.scala:322)
	at org.apache.spark.api.python.PythonRunner$$anon$2.writeIteratorToStream(PythonRunner.scala:751)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.$anonfun$run$1(PythonRunner.scala:451)
	at org.apache.spark.util.Utils$.logUncaughtExceptions(Utils.scala:1928)
	at org.apache.spark.api.python.BasePythonRunner$WriterThread.run(PythonRunner.scala:282)

2025-01-27 16:14:23,610 - [ERROR] - No dates were successfully processed
2025-01-27 16:14:23,610 - [ERROR] - Spark processing failed
2025-01-27 16:14:23,610 - [ERROR] - Processing or loading failed
2025-01-27 16:14:23,931 - [INFO] - Spark Session stopped
2025-01-27 16:16:21,782 - [INFO] - Starting application...
2025-01-27 16:16:21,857 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 16:16:49,137 - [INFO] - Spark Session created successfully
2025-01-27 16:16:49,138 - [INFO] - Spark version: 3.5.4
2025-01-27 16:16:49,138 - [INFO] - Spark master: local[*]
2025-01-27 16:16:49,139 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 16:16:49,139 - [INFO] - Starting file processing...
2025-01-27 16:16:49,139 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 16:16:49,139 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 16:16:49,139 - [INFO] - User agent filter: some user agent
2025-01-27 16:16:49,140 - [INFO] - Found 8 total parquet files
2025-01-27 16:16:49,141 - [INFO] - Impressions files by date: 2022-05-27
2025-01-27 16:16:49,141 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 16:16:54,517 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 16:16:55,021 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 16:16:56,812 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 16:16:57,290 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:16:57,694 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 16:16:58,107 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 16:16:58,373 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 16:16:58,733 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 16:16:58,939 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 16:17:00,254 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 16:17:00,633 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:17:00,929 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 16:17:01,177 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 16:17:01,491 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 16:17:06,898 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 16:17:08,108 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 16:17:08,109 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 16:17:08,110 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 16:17:08,110 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 16:17:08,111 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 16:17:08,111 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 16:17:08,112 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 16:17:08,112 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 16:17:08,113 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 16:17:08,113 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 16:17:08,113 - [INFO] - Successfully processed 1 dates
2025-01-27 16:17:08,114 - [INFO] - Starting client report loading process...
2025-01-27 16:17:08,114 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 16:17:08,116 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 16:17:08,124 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 16:17:08,129 - [INFO] - Archived 0 unique rows
2025-01-27 16:17:08,146 - [INFO] - Successfully loaded 48 rows
2025-01-27 16:17:08,152 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 16:17:08,152 - [INFO] - - Archived rows: 0
2025-01-27 16:17:08,152 - [INFO] - - Loaded rows: 48
2025-01-27 16:17:08,153 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 16:17:08,156 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 16:17:08,162 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 16:17:08,167 - [INFO] - Archived 0 unique rows
2025-01-27 16:17:08,176 - [INFO] - Successfully loaded 48 rows
2025-01-27 16:17:08,181 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 16:17:08,181 - [INFO] - - Archived rows: 0
2025-01-27 16:17:08,181 - [INFO] - - Loaded rows: 48
2025-01-27 16:17:08,182 - [INFO] - 
Verifying data load...
2025-01-27 16:17:08,188 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 16:17:08,190 - [INFO] - 
Load Summary:
2025-01-27 16:17:08,190 - [INFO] - Total files processed: 2
2025-01-27 16:17:08,190 - [INFO] - Total rows loaded: 96
2025-01-27 16:17:08,190 - [INFO] - 
Date Range:
2025-01-27 16:17:08,191 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 16:17:08,191 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 16:17:08,191 - [INFO] - 
Total Counts:
2025-01-27 16:17:08,191 - [INFO] -   Impressions: 44
2025-01-27 16:17:08,191 - [INFO] -   Clicks: 30
2025-01-27 16:17:08,192 - [INFO] - 
Client report loading completed successfully
2025-01-27 16:17:08,192 - [INFO] - Processing and loading completed successfully
2025-01-27 16:17:08,898 - [INFO] - Spark Session stopped
2025-01-27 16:31:31,523 - [INFO] - Starting application...
2025-01-27 16:31:31,584 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 16:31:48,545 - [INFO] - Spark Session created successfully
2025-01-27 16:31:48,545 - [INFO] - Spark version: 3.5.4
2025-01-27 16:31:48,545 - [INFO] - Spark master: local[*]
2025-01-27 16:31:48,545 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 16:31:48,545 - [INFO] - Starting file processing...
2025-01-27 16:31:48,546 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 16:31:48,546 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 16:31:48,546 - [INFO] - User agent filter: some user agent
2025-01-27 16:31:48,547 - [INFO] - Found 11 total parquet files
2025-01-27 16:31:48,547 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 16:31:48,547 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 16:31:53,715 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 16:31:54,190 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 16:31:55,957 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 16:31:56,438 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:31:56,847 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 16:31:57,224 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 16:31:57,487 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 16:32:02,397 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 16:32:02,398 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 16:32:02,399 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 16:32:02,399 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 16:32:02,399 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 16:32:02,661 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 16:32:02,841 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 16:32:04,063 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 16:32:04,394 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:32:04,576 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 16:32:04,764 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 16:32:04,998 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 16:32:05,310 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 16:32:05,478 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 16:32:06,827 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 16:32:07,063 - [INFO] - Found 0 records with invalid hours
2025-01-27 16:32:07,252 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 16:32:07,455 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 16:32:07,651 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 16:32:13,314 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 16:32:14,378 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 16:32:14,379 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 16:32:14,381 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 16:32:14,383 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 16:32:14,384 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 16:32:14,386 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 16:32:14,388 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 16:32:14,389 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 16:32:14,391 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 16:32:14,392 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 16:32:14,392 - [INFO] - Successfully processed 2 dates
2025-01-27 16:32:14,392 - [INFO] - Starting client report loading process...
2025-01-27 16:32:14,393 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 16:32:14,396 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 16:32:14,412 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 16:32:14,420 - [INFO] - Archived 0 unique rows
2025-01-27 16:32:14,443 - [INFO] - Successfully loaded 48 rows
2025-01-27 16:32:14,450 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 16:32:14,450 - [INFO] - - Archived rows: 0
2025-01-27 16:32:14,451 - [INFO] - - Loaded rows: 48
2025-01-27 16:32:14,451 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 16:32:14,455 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 16:32:14,467 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 16:32:14,475 - [INFO] - Archived 0 unique rows
2025-01-27 16:32:14,492 - [INFO] - Successfully loaded 48 rows
2025-01-27 16:32:14,498 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 16:32:14,498 - [INFO] - - Archived rows: 0
2025-01-27 16:32:14,499 - [INFO] - - Loaded rows: 48
2025-01-27 16:32:14,499 - [INFO] - 
Verifying data load...
2025-01-27 16:32:14,506 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 16:32:14,508 - [INFO] - 
Load Summary:
2025-01-27 16:32:14,508 - [INFO] - Total files processed: 2
2025-01-27 16:32:14,508 - [INFO] - Total rows loaded: 96
2025-01-27 16:32:14,509 - [INFO] - 
Date Range:
2025-01-27 16:32:14,509 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 16:32:14,509 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 16:32:14,509 - [INFO] - 
Total Counts:
2025-01-27 16:32:14,509 - [INFO] -   Impressions: 44
2025-01-27 16:32:14,510 - [INFO] -   Clicks: 30
2025-01-27 16:32:14,510 - [INFO] - 
Client report loading completed successfully
2025-01-27 16:32:14,510 - [INFO] - Processing and loading completed successfully
2025-01-27 16:32:15,333 - [INFO] - Spark Session stopped
2025-01-27 16:33:38,755 - [INFO] - Starting application...
2025-01-27 16:33:38,822 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 16:34:04,714 - [INFO] - Spark Session created successfully
2025-01-27 16:34:04,715 - [INFO] - Spark version: 3.5.4
2025-01-27 16:34:04,715 - [INFO] - Spark master: local[*]
2025-01-27 16:34:04,715 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 16:34:04,715 - [INFO] - Starting file processing...
2025-01-27 16:34:04,715 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 16:34:04,716 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 16:34:04,716 - [INFO] - User agent filter: some user agent
2025-01-27 16:34:04,716 - [WARNING] - No parquet files found in input directory
2025-01-27 16:34:04,716 - [ERROR] - Spark processing failed
2025-01-27 16:34:04,717 - [ERROR] - Processing or loading failed
2025-01-27 16:34:05,033 - [INFO] - Spark Session stopped
2025-01-27 17:32:47,501 - [INFO] - Starting application...
2025-01-27 17:32:47,566 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 17:33:00,787 - [INFO] - Spark Session created successfully
2025-01-27 17:33:00,788 - [INFO] - Spark version: 3.5.4
2025-01-27 17:33:00,788 - [INFO] - Spark master: local[*]
2025-01-27 17:33:00,788 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 17:33:00,788 - [INFO] - Starting file processing...
2025-01-27 17:33:00,789 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 17:33:00,789 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 17:33:00,789 - [INFO] - User agent filter: some user agent
2025-01-27 17:33:00,791 - [INFO] - Found 11 total parquet files
2025-01-27 17:33:00,791 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 17:33:00,791 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 17:33:06,151 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:33:06,605 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 17:33:08,368 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:33:08,914 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:33:09,331 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:33:09,734 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 17:33:09,969 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:33:14,643 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 17:33:14,644 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 17:33:14,644 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:33:14,645 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 17:33:14,645 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 17:33:14,917 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:33:15,064 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 17:33:16,259 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:33:16,554 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:33:16,760 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 17:33:16,961 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 17:33:17,138 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 17:33:17,502 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 17:33:17,661 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 17:33:19,074 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 17:33:19,315 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:33:19,510 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 17:33:19,729 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 17:33:19,963 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 17:33:23,827 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 17:33:24,557 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 17:33:24,557 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 17:33:24,558 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:33:24,559 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 17:33:24,559 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 17:33:24,560 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 17:33:24,560 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 17:33:24,561 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 17:33:24,562 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 17:33:24,562 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 17:33:24,562 - [INFO] - Successfully processed 2 dates
2025-01-27 17:33:24,562 - [INFO] - Starting client report loading process...
2025-01-27 17:33:24,563 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 17:33:24,565 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 17:33:24,573 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 17:33:24,578 - [INFO] - Archived 0 unique rows
2025-01-27 17:33:24,603 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 17:33:24,609 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 17:33:24,609 - [INFO] - - Archived rows: 0
2025-01-27 17:33:24,609 - [INFO] - - Loaded rows: 48
2025-01-27 17:33:24,609 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 17:33:24,622 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 17:33:24,628 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 17:33:24,633 - [INFO] - Archived 0 unique rows
2025-01-27 17:33:24,641 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 17:33:24,646 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 17:33:24,646 - [INFO] - - Archived rows: 0
2025-01-27 17:33:24,647 - [INFO] - - Loaded rows: 48
2025-01-27 17:33:24,647 - [INFO] - 
Verifying data load...
2025-01-27 17:33:24,652 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 17:33:24,653 - [INFO] - 
Load Summary:
2025-01-27 17:33:24,654 - [INFO] - Total files processed: 2
2025-01-27 17:33:24,654 - [INFO] - Total rows loaded: 96
2025-01-27 17:33:24,655 - [INFO] - 
Date Range:
2025-01-27 17:33:24,655 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 17:33:24,655 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 17:33:24,655 - [INFO] - 
Total Counts:
2025-01-27 17:33:24,655 - [INFO] -   Impressions: 44
2025-01-27 17:33:24,655 - [INFO] -   Clicks: 30
2025-01-27 17:33:24,656 - [INFO] - 
Client report loading completed successfully
2025-01-27 17:33:24,656 - [INFO] - Processing and loading completed successfully
2025-01-27 17:33:24,830 - [INFO] - Spark Session stopped
2025-01-27 17:49:27,974 - [INFO] - Starting application...
2025-01-27 17:49:28,070 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 17:49:44,546 - [INFO] - Spark Session created successfully
2025-01-27 17:49:44,546 - [INFO] - Spark version: 3.5.4
2025-01-27 17:49:44,546 - [INFO] - Spark master: local[*]
2025-01-27 17:49:44,546 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 17:49:44,547 - [INFO] - Starting file processing...
2025-01-27 17:49:44,547 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 17:49:44,547 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 17:49:44,547 - [INFO] - User agent filter: some user agent
2025-01-27 17:49:44,548 - [INFO] - Found 11 total parquet files
2025-01-27 17:49:44,548 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 17:49:44,548 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 17:49:50,246 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:49:50,821 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 17:49:52,964 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:49:53,432 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:49:53,819 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:49:54,256 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 17:49:54,521 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:49:59,480 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 17:49:59,480 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 17:49:59,481 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:49:59,482 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 17:49:59,482 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 17:49:59,770 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:49:59,933 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 17:50:01,152 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:50:01,455 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:50:01,678 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 17:50:01,893 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 17:50:02,056 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 17:50:02,409 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 17:50:02,585 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 17:50:03,986 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 17:50:04,261 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:50:04,458 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 17:50:04,675 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 17:50:04,827 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 17:50:08,902 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 17:50:09,671 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 17:50:09,672 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 17:50:09,673 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:50:09,673 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 17:50:09,674 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 17:50:09,675 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 17:50:09,676 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 17:50:09,677 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 17:50:09,678 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 17:50:09,678 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 17:50:09,678 - [INFO] - Successfully processed 2 dates
2025-01-27 17:50:09,678 - [INFO] - Starting client report loading process...
2025-01-27 17:50:09,679 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 17:50:09,682 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 17:50:09,694 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 17:50:09,694 - [ERROR] - Error loading data: 'ClientReportETL' object has no attribute '_handle_click_impression_mismatch'
2025-01-27 17:50:09,694 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'ClientReportETL' object has no attribute '_handle_click_impression_mismatch'
2025-01-27 17:50:09,695 - [ERROR] - Processing or loading failed
2025-01-27 17:50:10,908 - [INFO] - Spark Session stopped
2025-01-27 17:50:50,747 - [INFO] - Starting application...
2025-01-27 17:50:50,808 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 17:51:05,434 - [INFO] - Spark Session created successfully
2025-01-27 17:51:05,434 - [INFO] - Spark version: 3.5.4
2025-01-27 17:51:05,434 - [INFO] - Spark master: local[*]
2025-01-27 17:51:05,435 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 17:51:05,435 - [INFO] - Starting file processing...
2025-01-27 17:51:05,435 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 17:51:05,435 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 17:51:05,436 - [INFO] - User agent filter: some user agent
2025-01-27 17:51:05,436 - [INFO] - Found 11 total parquet files
2025-01-27 17:51:05,437 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 17:51:05,437 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 17:51:10,973 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:51:11,435 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 17:51:13,281 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:51:13,770 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:51:14,225 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:51:14,629 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 17:51:14,894 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:51:19,908 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 17:51:19,909 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 17:51:19,909 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:51:19,910 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 17:51:19,910 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 17:51:20,265 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:51:20,458 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 17:51:21,653 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:51:21,934 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:51:22,119 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 17:51:22,379 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 17:51:22,584 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 17:51:22,880 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 17:51:23,028 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 17:51:24,374 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 17:51:24,637 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:51:24,868 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 17:51:25,077 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 17:51:25,289 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 17:51:29,235 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 17:51:30,027 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 17:51:30,028 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 17:51:30,028 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:51:30,029 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 17:51:30,029 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 17:51:30,030 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 17:51:30,030 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 17:51:30,031 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 17:51:30,032 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 17:51:30,032 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 17:51:30,032 - [INFO] - Successfully processed 2 dates
2025-01-27 17:51:30,032 - [INFO] - Starting client report loading process...
2025-01-27 17:51:30,033 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 17:51:30,035 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 17:51:30,043 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 17:51:30,043 - [ERROR] - Error loading data: 'ClientReportETL' object has no attribute '_handle_click_impression_mismatch'
2025-01-27 17:51:30,043 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'ClientReportETL' object has no attribute '_handle_click_impression_mismatch'
2025-01-27 17:51:30,044 - [ERROR] - Processing or loading failed
2025-01-27 17:51:30,246 - [INFO] - Spark Session stopped
2025-01-27 17:53:47,368 - [INFO] - Starting application...
2025-01-27 17:53:47,430 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 17:54:05,931 - [INFO] - Spark Session created successfully
2025-01-27 17:54:05,931 - [INFO] - Spark version: 3.5.4
2025-01-27 17:54:05,931 - [INFO] - Spark master: local[*]
2025-01-27 17:54:05,932 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 17:54:05,932 - [INFO] - Starting file processing...
2025-01-27 17:54:05,932 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 17:54:05,932 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 17:54:05,932 - [INFO] - User agent filter: some user agent
2025-01-27 17:54:05,933 - [INFO] - Found 11 total parquet files
2025-01-27 17:54:05,934 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 17:54:05,934 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 17:54:11,291 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:54:11,792 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 17:54:13,564 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:54:14,040 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:54:14,490 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:54:14,877 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 17:54:15,137 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:54:19,942 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 17:54:19,942 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 17:54:19,943 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:54:19,944 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 17:54:19,944 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 17:54:20,263 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:54:20,411 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 17:54:21,604 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:54:21,887 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:54:22,083 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 17:54:22,288 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 17:54:22,478 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 17:54:22,736 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 17:54:22,894 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 17:54:24,249 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 17:54:24,522 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:54:24,702 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 17:54:24,934 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 17:54:25,104 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 17:54:29,075 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 17:54:29,838 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 17:54:29,839 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 17:54:29,840 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:54:29,841 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 17:54:29,842 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 17:54:29,842 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 17:54:29,843 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 17:54:29,844 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 17:54:29,845 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 17:54:29,845 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 17:54:29,845 - [INFO] - Successfully processed 2 dates
2025-01-27 17:54:29,846 - [INFO] - Starting client report loading process...
2025-01-27 17:54:29,847 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 17:54:29,850 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 17:54:29,862 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 17:54:29,867 - [INFO] - Archived 0 unique rows
2025-01-27 17:54:29,888 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 17:54:29,895 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 17:54:29,895 - [INFO] - - Archived rows: 0
2025-01-27 17:54:29,896 - [INFO] - - Loaded rows: 48
2025-01-27 17:54:29,896 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 17:54:29,899 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 17:54:29,907 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 17:54:29,911 - [INFO] - Archived 0 unique rows
2025-01-27 17:54:29,923 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 17:54:29,928 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 17:54:29,928 - [INFO] - - Archived rows: 0
2025-01-27 17:54:29,928 - [INFO] - - Loaded rows: 48
2025-01-27 17:54:29,928 - [INFO] - 
Verifying data load...
2025-01-27 17:54:29,935 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 17:54:29,936 - [INFO] - 
Load Summary:
2025-01-27 17:54:29,937 - [INFO] - Total files processed: 2
2025-01-27 17:54:29,937 - [INFO] - Total rows loaded: 96
2025-01-27 17:54:29,938 - [INFO] - 
Date Range:
2025-01-27 17:54:29,938 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 17:54:29,938 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 17:54:29,938 - [INFO] - 
Total Counts:
2025-01-27 17:54:29,938 - [INFO] -   Impressions: 44
2025-01-27 17:54:29,939 - [INFO] -   Clicks: 30
2025-01-27 17:54:29,939 - [INFO] - 
Client report loading completed successfully
2025-01-27 17:54:29,939 - [INFO] - Processing and loading completed successfully
2025-01-27 17:54:31,088 - [INFO] - Spark Session stopped
2025-01-27 17:59:25,376 - [INFO] - Starting application...
2025-01-27 17:59:25,450 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 17:59:44,593 - [INFO] - Spark Session created successfully
2025-01-27 17:59:44,593 - [INFO] - Spark version: 3.5.4
2025-01-27 17:59:44,593 - [INFO] - Spark master: local[*]
2025-01-27 17:59:44,594 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 17:59:44,594 - [INFO] - Starting file processing...
2025-01-27 17:59:44,594 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 17:59:44,594 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 17:59:44,594 - [INFO] - User agent filter: some user agent
2025-01-27 17:59:44,596 - [INFO] - Found 11 total parquet files
2025-01-27 17:59:44,596 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 17:59:44,596 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 17:59:49,673 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:59:50,148 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 17:59:51,833 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:59:52,329 - [INFO] - Found 0 records with invalid hours
2025-01-27 17:59:52,716 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:59:53,123 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 17:59:53,373 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 17:59:58,085 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 17:59:58,086 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 17:59:58,087 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 17:59:58,088 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 17:59:58,088 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 17:59:58,356 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 17:59:58,555 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 17:59:59,721 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 17:59:59,977 - [INFO] - Found 0 records with invalid hours
2025-01-27 18:00:00,190 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 18:00:00,423 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 18:00:00,674 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 18:00:01,001 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 18:00:01,193 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 18:00:02,576 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 18:00:02,820 - [INFO] - Found 0 records with invalid hours
2025-01-27 18:00:03,042 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 18:00:03,275 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 18:00:03,481 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 18:00:07,443 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 18:00:08,210 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 18:00:08,211 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 18:00:08,211 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 18:00:08,212 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 18:00:08,213 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 18:00:08,213 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 18:00:08,214 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 18:00:08,215 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 18:00:08,215 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 18:00:08,216 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 18:00:08,216 - [INFO] - Successfully processed 2 dates
2025-01-27 18:00:08,217 - [INFO] - Starting client report loading process...
2025-01-27 18:00:08,217 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 18:00:08,220 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 18:00:08,233 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 18:00:08,239 - [INFO] - Archived 0 unique rows
2025-01-27 18:00:08,255 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 18:00:08,261 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 18:00:08,262 - [INFO] - - Archived rows: 0
2025-01-27 18:00:08,262 - [INFO] - - Loaded rows: 48
2025-01-27 18:00:08,262 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 18:00:08,265 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 18:00:08,273 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 18:00:08,277 - [INFO] - Archived 0 unique rows
2025-01-27 18:00:08,290 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 18:00:08,294 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 18:00:08,295 - [INFO] - - Archived rows: 0
2025-01-27 18:00:08,295 - [INFO] - - Loaded rows: 48
2025-01-27 18:00:08,295 - [INFO] - 
Verifying data load...
2025-01-27 18:00:08,301 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 18:00:08,303 - [INFO] - 
Load Summary:
2025-01-27 18:00:08,304 - [INFO] - Total files processed: 2
2025-01-27 18:00:08,304 - [INFO] - Total rows loaded: 96
2025-01-27 18:00:08,304 - [INFO] - 
Date Range:
2025-01-27 18:00:08,304 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 18:00:08,304 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 18:00:08,305 - [INFO] - 
Total Counts:
2025-01-27 18:00:08,305 - [INFO] -   Impressions: 44
2025-01-27 18:00:08,305 - [INFO] -   Clicks: 30
2025-01-27 18:00:08,305 - [INFO] - 
Client report loading completed successfully
2025-01-27 18:00:08,305 - [INFO] - Processing and loading completed successfully
2025-01-27 18:00:09,445 - [INFO] - Spark Session stopped
2025-01-27 18:07:04,486 - [INFO] - Starting application...
2025-01-27 18:07:04,545 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 18:07:22,448 - [INFO] - Spark Session created successfully
2025-01-27 18:07:22,448 - [INFO] - Spark version: 3.5.4
2025-01-27 18:07:22,449 - [INFO] - Spark master: local[*]
2025-01-27 18:07:22,449 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 18:07:22,449 - [INFO] - Starting file processing...
2025-01-27 18:07:22,449 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 18:07:22,449 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 18:07:22,449 - [INFO] - User agent filter: some user agent
2025-01-27 18:07:22,450 - [INFO] - Found 11 total parquet files
2025-01-27 18:07:22,451 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 18:07:22,451 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 18:07:27,531 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 18:07:27,977 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 18:07:29,653 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 18:07:30,153 - [INFO] - Found 0 records with invalid hours
2025-01-27 18:07:30,587 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 18:07:30,950 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 18:07:31,211 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 18:07:35,918 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 18:07:35,919 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 18:07:35,919 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 18:07:35,920 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 18:07:35,920 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 18:07:36,192 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 18:07:36,331 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 18:07:37,466 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 18:07:37,728 - [INFO] - Found 0 records with invalid hours
2025-01-27 18:07:37,906 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 18:07:38,169 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 18:07:38,362 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 18:07:38,645 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 18:07:38,821 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 18:07:40,106 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 18:07:40,369 - [INFO] - Found 0 records with invalid hours
2025-01-27 18:07:40,597 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 18:07:40,806 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 18:07:40,959 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 18:07:44,838 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-27 18:07:45,593 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 18:07:45,594 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 18:07:45,594 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 18:07:45,595 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 18:07:45,595 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 18:07:45,596 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 18:07:45,596 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 18:07:45,597 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 18:07:45,597 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 18:07:45,598 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 18:07:45,598 - [INFO] - Successfully processed 2 dates
2025-01-27 18:07:45,598 - [INFO] - Starting client report loading process...
2025-01-27 18:07:45,599 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 18:07:45,600 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 18:07:45,608 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 18:07:45,611 - [INFO] - Archived 0 unique rows
2025-01-27 18:07:45,627 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 18:07:45,633 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 18:07:45,633 - [INFO] - - Archived rows: 0
2025-01-27 18:07:45,634 - [INFO] - - Loaded rows: 48
2025-01-27 18:07:45,634 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 18:07:45,637 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 18:07:45,642 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 18:07:45,646 - [INFO] - Archived 0 unique rows
2025-01-27 18:07:45,655 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 18:07:45,659 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 18:07:45,659 - [INFO] - - Archived rows: 0
2025-01-27 18:07:45,659 - [INFO] - - Loaded rows: 48
2025-01-27 18:07:45,659 - [INFO] - 
Verifying data load...
2025-01-27 18:07:45,665 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 18:07:45,666 - [INFO] - 
Load Summary:
2025-01-27 18:07:45,667 - [INFO] - Total files processed: 2
2025-01-27 18:07:45,667 - [INFO] - Total rows loaded: 96
2025-01-27 18:07:45,667 - [INFO] - 
Date Range:
2025-01-27 18:07:45,667 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 18:07:45,667 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 18:07:45,667 - [INFO] - 
Total Counts:
2025-01-27 18:07:45,668 - [INFO] -   Impressions: 44
2025-01-27 18:07:45,668 - [INFO] -   Clicks: 30
2025-01-27 18:07:45,668 - [INFO] - 
Client report loading completed successfully
2025-01-27 18:07:45,668 - [INFO] - Processing and loading completed successfully
2025-01-27 18:07:46,851 - [INFO] - Spark Session stopped
2025-01-27 18:44:44,500 - [INFO] - Starting application...
2025-01-27 18:44:44,581 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 18:45:02,091 - [INFO] - Spark Session created successfully
2025-01-27 18:45:02,091 - [INFO] - Spark version: 3.5.4
2025-01-27 18:45:02,092 - [INFO] - Spark master: local[*]
2025-01-27 18:45:02,092 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 18:45:02,092 - [INFO] - Starting file processing...
2025-01-27 18:45:02,092 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 18:45:02,092 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 18:45:02,093 - [INFO] - User agent filter: some user agent
2025-01-27 18:45:02,094 - [INFO] - Found 11 total parquet files
2025-01-27 18:45:02,094 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 18:45:02,094 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 18:45:07,721 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 18:45:08,182 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 18:45:09,999 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 18:45:10,479 - [INFO] - Found 0 records with invalid hours
2025-01-27 18:45:10,910 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 18:45:11,246 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 18:45:11,550 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 18:45:16,875 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 18:45:16,875 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 18:45:16,876 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 18:45:16,877 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 18:45:16,877 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 18:45:17,179 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 18:45:17,360 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 18:45:18,492 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 18:45:18,815 - [INFO] - Found 0 records with invalid hours
2025-01-27 18:45:19,052 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 18:45:19,252 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 18:45:19,441 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 18:45:19,708 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 18:45:19,863 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 18:45:21,281 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 18:45:21,609 - [INFO] - Found 0 records with invalid hours
2025-01-27 18:45:21,819 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 18:45:22,087 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 18:45:22,285 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 18:45:26,207 - [WARNING] - Found records where clicks exceed impressions:
2025-01-27 18:45:26,924 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 18:45:26,925 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 18:45:26,925 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 18:45:26,926 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 18:45:26,927 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 18:45:26,928 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 18:45:26,928 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 18:45:26,929 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 18:45:26,930 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 18:45:26,930 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 18:45:26,930 - [INFO] - Successfully processed 2 dates
2025-01-27 18:45:26,930 - [INFO] - Starting client report loading process...
2025-01-27 18:45:26,931 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 18:45:26,933 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 18:45:26,944 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 18:45:26,951 - [INFO] - Archived 0 unique rows
2025-01-27 18:45:26,977 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 18:45:26,987 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 18:45:26,987 - [INFO] - - Archived rows: 0
2025-01-27 18:45:26,987 - [INFO] - - Loaded rows: 48
2025-01-27 18:45:26,987 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 18:45:26,997 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 18:45:27,004 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 18:45:27,009 - [INFO] - Archived 0 unique rows
2025-01-27 18:45:27,017 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 18:45:27,022 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 18:45:27,022 - [INFO] - - Archived rows: 0
2025-01-27 18:45:27,022 - [INFO] - - Loaded rows: 48
2025-01-27 18:45:27,023 - [INFO] - 
Verifying data load...
2025-01-27 18:45:27,028 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-27 18:45:27,029 - [INFO] - 
Load Summary:
2025-01-27 18:45:27,030 - [INFO] - Total files processed: 2
2025-01-27 18:45:27,030 - [INFO] - Total rows loaded: 96
2025-01-27 18:45:27,030 - [INFO] - 
Date Range:
2025-01-27 18:45:27,030 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 18:45:27,030 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 18:45:27,031 - [INFO] - 
Total Counts:
2025-01-27 18:45:27,031 - [INFO] -   Impressions: 44
2025-01-27 18:45:27,031 - [INFO] -   Clicks: 30
2025-01-27 18:45:27,031 - [INFO] - 
Client report loading completed successfully
2025-01-27 18:45:27,031 - [INFO] - Processing and loading completed successfully
2025-01-27 18:45:27,223 - [INFO] - Spark Session stopped
2025-01-27 18:59:44,125 - [INFO] - Starting application...
2025-01-27 18:59:44,200 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 18:59:55,102 - [INFO] - Spark Session created successfully
2025-01-27 18:59:55,102 - [INFO] - Spark version: 3.5.4
2025-01-27 18:59:55,102 - [INFO] - Spark master: local[*]
2025-01-27 18:59:55,103 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 18:59:55,103 - [INFO] - Starting file processing...
2025-01-27 18:59:55,103 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 18:59:55,103 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 18:59:55,103 - [INFO] - User agent filter: some user agent
2025-01-27 18:59:55,104 - [INFO] - Found 9 total parquet files
2025-01-27 18:59:55,104 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 18:59:55,105 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 18:59:58,144 - [ERROR] - Error processing files for date '2022-05-26': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L] parquet

2025-01-27 18:59:58,148 - [WARNING] - Failed to process data for date: 2022-05-26 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L] parquet

2025-01-27 18:59:58,288 - [ERROR] - Error processing files for date '2022-05-27': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#45L,page_url#46,transaction_header_transaction_id_lo#47L,transaction_header_transaction_id_hi#48L,transaction_header_creation_time#49L,transaction_header_producer_time#50L,transaction_header_original_producer#51,transaction_header_recent_producer#52,user_identity_cookie_id#53,user_identity_is_opted_out#54,user_identity_cookie_id_origin_id#55L,user_identity_browser_cookie_id#56,user_identity_browser_cookie_status#57,user_identity_device_advertising_id#58,banner_banner_id#59L,banner_campaign_id#60L,banner_media_id#61L,banner_tag_id#62L,banner_banner_placement_id#63L,rtb_vars_winning_price_in_dkk_lo#64L,rtb_vars_winning_price_in_dkk_hi#65L,rtb_vars_winning_price_in_dkk_signScale#66L] parquet

2025-01-27 18:59:58,293 - [WARNING] - Failed to process data for date: 2022-05-27 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#45L,page_url#46,transaction_header_transaction_id_lo#47L,transaction_header_transaction_id_hi#48L,transaction_header_creation_time#49L,transaction_header_producer_time#50L,transaction_header_original_producer#51,transaction_header_recent_producer#52,user_identity_cookie_id#53,user_identity_is_opted_out#54,user_identity_cookie_id_origin_id#55L,user_identity_browser_cookie_id#56,user_identity_browser_cookie_status#57,user_identity_device_advertising_id#58,banner_banner_id#59L,banner_campaign_id#60L,banner_media_id#61L,banner_tag_id#62L,banner_banner_placement_id#63L,rtb_vars_winning_price_in_dkk_lo#64L,rtb_vars_winning_price_in_dkk_hi#65L,rtb_vars_winning_price_in_dkk_signScale#66L] parquet

2025-01-27 18:59:58,293 - [ERROR] - No dates were successfully processed
2025-01-27 18:59:58,294 - [ERROR] - Spark processing failed
2025-01-27 18:59:58,294 - [ERROR] - Processing or loading failed
2025-01-27 18:59:58,521 - [INFO] - Spark Session stopped
2025-01-27 19:04:53,253 - [INFO] - Starting application...
2025-01-27 19:04:53,317 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 19:05:19,171 - [INFO] - Spark Session created successfully
2025-01-27 19:05:19,171 - [INFO] - Spark version: 3.5.4
2025-01-27 19:05:19,172 - [INFO] - Spark master: local[*]
2025-01-27 19:05:19,172 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 19:05:19,172 - [INFO] - Starting file processing...
2025-01-27 19:05:19,172 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 19:05:19,172 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 19:05:19,173 - [INFO] - User agent filter: some user agent
2025-01-27 19:05:19,174 - [INFO] - Found 9 total parquet files
2025-01-27 19:05:19,174 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 19:05:19,174 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 19:05:22,277 - [ERROR] - Error processing files for date '2022-05-26': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L] parquet

2025-01-27 19:05:22,284 - [WARNING] - Failed to process data for date: 2022-05-26 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#0L,page_url#1,transaction_header_transaction_id_lo#2L,transaction_header_transaction_id_hi#3L,transaction_header_creation_time#4L,transaction_header_producer_time#5L,transaction_header_original_producer#6,transaction_header_recent_producer#7,user_identity_cookie_id#8,user_identity_is_opted_out#9,user_identity_cookie_id_origin_id#10L,user_identity_browser_cookie_id#11,user_identity_browser_cookie_status#12,user_identity_device_advertising_id#13,banner_banner_id#14L,banner_campaign_id#15L,banner_media_id#16L,banner_tag_id#17L,banner_banner_placement_id#18L,rtb_vars_winning_price_in_dkk_lo#19L,rtb_vars_winning_price_in_dkk_hi#20L,rtb_vars_winning_price_in_dkk_signScale#21L] parquet

2025-01-27 19:05:22,423 - [ERROR] - Error processing files for date '2022-05-27': [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#45L,page_url#46,transaction_header_transaction_id_lo#47L,transaction_header_transaction_id_hi#48L,transaction_header_creation_time#49L,transaction_header_producer_time#50L,transaction_header_original_producer#51,transaction_header_recent_producer#52,user_identity_cookie_id#53,user_identity_is_opted_out#54,user_identity_cookie_id_origin_id#55L,user_identity_browser_cookie_id#56,user_identity_browser_cookie_status#57,user_identity_device_advertising_id#58,banner_banner_id#59L,banner_campaign_id#60L,banner_media_id#61L,banner_tag_id#62L,banner_banner_placement_id#63L,rtb_vars_winning_price_in_dkk_lo#64L,rtb_vars_winning_price_in_dkk_hi#65L,rtb_vars_winning_price_in_dkk_signScale#66L] parquet

2025-01-27 19:05:22,428 - [WARNING] - Failed to process data for date: 2022-05-27 - [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `device_settings`.`user_agent` cannot be resolved. Did you mean one of the following? [`banner_banner_id`, `banner_media_id`, `banner_tag_id`, `interaction_id`, `page_url`].;
'Project ['device_settings.user_agent]
+- Relation [interaction_id#45L,page_url#46,transaction_header_transaction_id_lo#47L,transaction_header_transaction_id_hi#48L,transaction_header_creation_time#49L,transaction_header_producer_time#50L,transaction_header_original_producer#51,transaction_header_recent_producer#52,user_identity_cookie_id#53,user_identity_is_opted_out#54,user_identity_cookie_id_origin_id#55L,user_identity_browser_cookie_id#56,user_identity_browser_cookie_status#57,user_identity_device_advertising_id#58,banner_banner_id#59L,banner_campaign_id#60L,banner_media_id#61L,banner_tag_id#62L,banner_banner_placement_id#63L,rtb_vars_winning_price_in_dkk_lo#64L,rtb_vars_winning_price_in_dkk_hi#65L,rtb_vars_winning_price_in_dkk_signScale#66L] parquet

2025-01-27 19:05:22,428 - [ERROR] - No dates were successfully processed
2025-01-27 19:05:22,428 - [ERROR] - Spark processing failed
2025-01-27 19:05:22,428 - [ERROR] - Processing or loading failed
2025-01-27 19:05:22,571 - [INFO] - Spark Session stopped
2025-01-27 19:06:32,856 - [INFO] - Starting application...
2025-01-27 19:06:32,936 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 19:06:41,135 - [INFO] - Spark Session created successfully
2025-01-27 19:06:41,135 - [INFO] - Spark version: 3.5.4
2025-01-27 19:06:41,135 - [INFO] - Spark master: local[*]
2025-01-27 19:06:41,135 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 19:06:41,136 - [INFO] - Starting file processing...
2025-01-27 19:06:41,136 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 19:06:41,136 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 19:06:41,136 - [INFO] - User agent filter: some user agent
2025-01-27 19:06:41,137 - [INFO] - Found 11 total parquet files
2025-01-27 19:06:41,138 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 19:06:41,138 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 19:06:46,292 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 19:06:46,758 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 19:06:48,563 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 19:06:49,032 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:06:49,481 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 19:06:49,928 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 19:06:50,181 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 19:06:54,996 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 19:06:54,996 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 19:06:54,997 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 19:06:54,998 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 19:06:54,998 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 19:06:55,319 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 19:06:55,503 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 19:06:56,686 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 19:06:56,945 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:06:57,158 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 19:06:57,385 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 19:06:57,572 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 19:06:57,837 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 19:06:57,992 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 19:06:59,341 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 19:06:59,579 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:06:59,775 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 19:07:00,014 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 19:07:00,200 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 19:07:04,380 - [WARNING] - Found records where clicks exceed impressions:
2025-01-27 19:07:05,214 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 19:07:05,215 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 19:07:05,215 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 19:07:05,216 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 19:07:05,217 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 19:07:05,218 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 19:07:05,218 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 19:07:05,219 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 19:07:05,220 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 19:07:05,220 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 19:07:05,220 - [INFO] - Successfully processed 2 dates
2025-01-27 19:07:05,220 - [INFO] - Starting client report loading process...
2025-01-27 19:07:05,221 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 19:07:05,224 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 19:07:05,236 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 19:07:05,243 - [INFO] - Archived 0 unique rows
2025-01-27 19:07:05,262 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 19:07:05,270 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 19:07:05,270 - [INFO] - - Archived rows: 0
2025-01-27 19:07:05,270 - [INFO] - - Loaded rows: 48
2025-01-27 19:07:05,271 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 19:07:05,284 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 19:07:05,292 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 19:07:05,312 - [ERROR] - Error storing invalid records: (psycopg2.errors.UndefinedColumn) column "resolution" of relation "client_report_invalid" does not exist
LINE 1: ... impression_count, click_count, validation_error, resolution...
                                                             ^

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, resolution, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(resolution_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(resolution_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'resolution_m0': 'flagged', 'source_file_m0': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 27, 19, 7, 5, 298055), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'resolution_m1': 'flagged', 'source_file_m1': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 27, 19, 7, 5, 298055)}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-27 19:07:05,313 - [ERROR] - Error loading data: (psycopg2.errors.UndefinedColumn) column "resolution" of relation "client_report_invalid" does not exist
LINE 1: ... impression_count, click_count, validation_error, resolution...
                                                             ^

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, resolution, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(resolution_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(resolution_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'resolution_m0': 'flagged', 'source_file_m0': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 27, 19, 7, 5, 298055), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'resolution_m1': 'flagged', 'source_file_m1': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 27, 19, 7, 5, 298055)}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-27 19:07:05,313 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv: (psycopg2.errors.UndefinedColumn) column "resolution" of relation "client_report_invalid" does not exist
LINE 1: ... impression_count, click_count, validation_error, resolution...
                                                             ^

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, resolution, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(resolution_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(resolution_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'resolution_m0': 'flagged', 'source_file_m0': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 27, 19, 7, 5, 298055), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'resolution_m1': 'flagged', 'source_file_m1': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 27, 19, 7, 5, 298055)}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-27 19:07:05,314 - [ERROR] - Processing or loading failed
2025-01-27 19:07:06,377 - [INFO] - Spark Session stopped
2025-01-27 19:09:13,117 - [INFO] - Starting application...
2025-01-27 19:09:13,179 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 19:09:39,019 - [INFO] - Spark Session created successfully
2025-01-27 19:09:39,020 - [INFO] - Spark version: 3.5.4
2025-01-27 19:09:39,020 - [INFO] - Spark master: local[*]
2025-01-27 19:09:39,020 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 19:09:39,020 - [INFO] - Starting file processing...
2025-01-27 19:09:39,021 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 19:09:39,021 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 19:09:39,021 - [INFO] - User agent filter: some user agent
2025-01-27 19:09:39,023 - [INFO] - Found 11 total parquet files
2025-01-27 19:09:39,023 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 19:09:39,023 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 19:09:45,019 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 19:09:45,885 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 19:09:47,822 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 19:09:48,376 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:09:48,795 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 19:09:49,170 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 19:09:49,426 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 19:09:54,305 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 19:09:54,306 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 19:09:54,306 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 19:09:54,307 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 19:09:54,307 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 19:09:54,605 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 19:09:54,768 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 19:09:55,953 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 19:09:56,208 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:09:56,398 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 19:09:56,584 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 19:09:56,804 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 19:09:57,069 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 19:09:57,219 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 19:09:58,532 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 19:09:58,776 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:09:59,221 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 19:09:59,760 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 19:10:00,189 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 19:10:04,219 - [WARNING] - Found records where clicks exceed impressions:
2025-01-27 19:10:04,971 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 19:10:04,971 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 19:10:04,972 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 19:10:04,973 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 19:10:04,973 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 19:10:04,974 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 19:10:04,974 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 19:10:04,975 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 19:10:04,975 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 19:10:04,976 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 19:10:04,976 - [INFO] - Successfully processed 2 dates
2025-01-27 19:10:04,976 - [INFO] - Starting client report loading process...
2025-01-27 19:10:04,977 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 19:10:04,978 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 19:10:04,988 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 19:10:04,995 - [INFO] - Archived 0 unique rows
2025-01-27 19:10:05,105 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 19:10:05,112 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 19:10:05,112 - [INFO] - - Archived rows: 0
2025-01-27 19:10:05,112 - [INFO] - - Loaded rows: 48
2025-01-27 19:10:05,112 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 19:10:05,114 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 19:10:05,120 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 19:10:05,135 - [ERROR] - Error storing invalid records: (psycopg2.errors.UndefinedColumn) column "resolution" of relation "client_report_invalid" does not exist
LINE 1: ... impression_count, click_count, validation_error, resolution...
                                                             ^

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, resolution, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(resolution_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(resolution_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'resolution_m0': 'flagged', 'source_file_m0': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 27, 19, 10, 5, 124614), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'resolution_m1': None, 'source_file_m1': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 27, 19, 10, 5, 124614)}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-27 19:10:05,136 - [ERROR] - Error loading data: (psycopg2.errors.UndefinedColumn) column "resolution" of relation "client_report_invalid" does not exist
LINE 1: ... impression_count, click_count, validation_error, resolution...
                                                             ^

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, resolution, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(resolution_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(resolution_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'resolution_m0': 'flagged', 'source_file_m0': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 27, 19, 10, 5, 124614), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'resolution_m1': None, 'source_file_m1': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 27, 19, 10, 5, 124614)}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-27 19:10:05,136 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv: (psycopg2.errors.UndefinedColumn) column "resolution" of relation "client_report_invalid" does not exist
LINE 1: ... impression_count, click_count, validation_error, resolution...
                                                             ^

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, resolution, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(resolution_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(resolution_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'resolution_m0': 'flagged', 'source_file_m0': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 27, 19, 10, 5, 124614), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'resolution_m1': None, 'source_file_m1': 'C:\\Users\\Rokas\\Documents\\Airidas\\adform\\adform_spark_app\\output\\task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 27, 19, 10, 5, 124614)}]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-27 19:10:05,137 - [ERROR] - Processing or loading failed
2025-01-27 19:10:06,212 - [INFO] - Spark Session stopped
2025-01-27 19:11:21,475 - [INFO] - Starting application...
2025-01-27 19:11:21,561 - [INFO] - Database schema and tables verified/created successfully
2025-01-27 19:11:38,645 - [INFO] - Spark Session created successfully
2025-01-27 19:11:38,646 - [INFO] - Spark version: 3.5.4
2025-01-27 19:11:38,646 - [INFO] - Spark master: local[*]
2025-01-27 19:11:38,646 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-27 19:11:38,647 - [INFO] - Starting file processing...
2025-01-27 19:11:38,647 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-27 19:11:38,647 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-27 19:11:38,647 - [INFO] - User agent filter: some user agent
2025-01-27 19:11:38,648 - [INFO] - Found 11 total parquet files
2025-01-27 19:11:38,648 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-27 19:11:38,649 - [INFO] - Clicks files by date: 2022-05-27
2025-01-27 19:11:43,616 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 19:11:44,087 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-27 19:11:45,756 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 19:11:46,210 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:11:46,619 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 19:11:47,006 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-27 19:11:47,252 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-27 19:11:52,224 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-27 19:11:52,225 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-27 19:11:52,226 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-27 19:11:52,227 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-27 19:11:52,227 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-27 19:11:52,498 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-27 19:11:52,676 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-27 19:11:53,872 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 19:11:54,162 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:11:54,361 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-27 19:11:54,571 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-27 19:11:54,788 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-27 19:11:55,116 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-27 19:11:55,270 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-27 19:11:56,595 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 19:11:56,869 - [INFO] - Found 0 records with invalid hours
2025-01-27 19:11:57,044 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 19:11:57,265 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-27 19:11:57,437 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-27 19:12:01,364 - [WARNING] - Found records where clicks exceed impressions:
2025-01-27 19:12:02,134 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-27 19:12:02,135 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-27 19:12:02,135 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-27 19:12:02,136 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-27 19:12:02,137 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-27 19:12:02,137 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-27 19:12:02,138 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-27 19:12:02,139 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-27 19:12:02,139 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-27 19:12:02,140 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-27 19:12:02,140 - [INFO] - Successfully processed 2 dates
2025-01-27 19:12:02,140 - [INFO] - Starting client report loading process...
2025-01-27 19:12:02,141 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-27 19:12:02,143 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 19:12:02,155 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 19:12:02,162 - [INFO] - Archived 0 unique rows
2025-01-27 19:12:02,181 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 19:12:02,187 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-27 19:12:02,188 - [INFO] - - Archived rows: 0
2025-01-27 19:12:02,188 - [INFO] - - Loaded rows: 48
2025-01-27 19:12:02,188 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-27 19:12:02,192 - [INFO] - Read CSV with shape: (24, 4)
2025-01-27 19:12:02,199 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-27 19:12:02,218 - [INFO] - Stored 2 invalid records for later analysis
2025-01-27 19:12:02,222 - [INFO] - Archived 0 unique rows
2025-01-27 19:12:02,232 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-27 19:12:02,237 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-27 19:12:02,237 - [INFO] - - Archived rows: 0
2025-01-27 19:12:02,238 - [INFO] - - Loaded rows: 48
2025-01-27 19:12:02,238 - [INFO] - 
Verifying data load...
2025-01-27 19:12:02,244 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-27 19:12:02,245 - [INFO] - 
Load Summary:
2025-01-27 19:12:02,246 - [INFO] - Total files processed: 2
2025-01-27 19:12:02,246 - [INFO] - Total rows loaded: 96
2025-01-27 19:12:02,246 - [INFO] - 
Date Range:
2025-01-27 19:12:02,246 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-27 19:12:02,247 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-27 19:12:02,247 - [INFO] - 
Total Counts:
2025-01-27 19:12:02,247 - [INFO] -   Impressions: 24
2025-01-27 19:12:02,247 - [INFO] -   Clicks: 30
2025-01-27 19:12:02,247 - [INFO] - 
Client report loading completed successfully
2025-01-27 19:12:02,248 - [INFO] - Processing and loading completed successfully
2025-01-27 19:12:03,352 - [INFO] - Spark Session stopped
2025-01-28 06:30:22,264 - [INFO] - Starting application...
2025-01-28 06:30:22,351 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:30:26,421 - [INFO] - Spark Session created successfully
2025-01-28 06:30:26,423 - [INFO] - Spark version: 3.5.0
2025-01-28 06:30:26,423 - [INFO] - Spark master: local[*]
2025-01-28 06:30:26,424 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:30:26,424 - [INFO] - Starting file processing...
2025-01-28 06:30:26,425 - [INFO] - Input path: /app/raw_data
2025-01-28 06:30:26,426 - [INFO] - Output path: /app/output
2025-01-28 06:30:26,426 - [INFO] - User agent filter: some user agent
2025-01-28 06:30:26,541 - [INFO] - Found 11 total parquet files
2025-01-28 06:30:26,542 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 06:30:26,543 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 06:30:31,043 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 06:30:32,112 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 06:30:34,652 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 06:30:35,504 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:30:36,370 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 06:30:36,987 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 06:30:37,373 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 06:30:41,659 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 06:30:41,665 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 06:30:41,670 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 06:30:41,677 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 06:30:41,678 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 06:30:42,236 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 06:30:42,712 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 06:30:43,661 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 06:30:44,584 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:30:44,963 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 06:30:45,508 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 06:30:46,059 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 06:30:46,829 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 06:30:47,286 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 06:30:48,444 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 06:30:49,102 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:30:49,528 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 06:30:50,272 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 06:30:50,779 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 06:30:52,380 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-28 06:30:54,141 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 06:30:54,149 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 06:30:54,156 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 06:30:54,160 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 06:30:54,165 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 06:30:54,170 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 06:30:54,175 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 06:30:54,179 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 06:30:54,185 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 06:30:54,186 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 06:30:54,187 - [INFO] - Successfully processed 2 dates
2025-01-28 06:30:54,187 - [INFO] - Starting client report loading process...
2025-01-28 06:30:54,205 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 06:30:54,219 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 06:30:54,259 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 06:30:54,278 - [INFO] - Archived 0 unique rows
2025-01-28 06:30:54,316 - [INFO] - Successfully loaded 48 rows
2025-01-28 06:30:54,322 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 06:30:54,323 - [INFO] - - Archived rows: 0
2025-01-28 06:30:54,324 - [INFO] - - Loaded rows: 48
2025-01-28 06:30:54,325 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 06:30:54,334 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 06:30:54,348 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 06:30:54,351 - [INFO] - Archived 0 unique rows
2025-01-28 06:30:54,364 - [INFO] - Successfully loaded 48 rows
2025-01-28 06:30:54,370 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 06:30:54,371 - [INFO] - - Archived rows: 0
2025-01-28 06:30:54,372 - [INFO] - - Loaded rows: 48
2025-01-28 06:30:54,373 - [INFO] - 
Verifying data load...
2025-01-28 06:30:54,382 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-28 06:30:54,383 - [INFO] - 
Load Summary:
2025-01-28 06:30:54,385 - [INFO] - Total files processed: 2
2025-01-28 06:30:54,386 - [INFO] - Total rows loaded: 96
2025-01-28 06:30:54,390 - [INFO] - 
Date Range:
2025-01-28 06:30:54,395 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 06:30:54,396 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 06:30:54,397 - [INFO] - 
Total Counts:
2025-01-28 06:30:54,398 - [INFO] -   Impressions: 44
2025-01-28 06:30:54,399 - [INFO] -   Clicks: 30
2025-01-28 06:30:54,400 - [INFO] - 
Client report loading completed successfully
2025-01-28 06:30:54,401 - [INFO] - Processing and loading completed successfully
2025-01-28 06:30:55,429 - [INFO] - Spark Session stopped
2025-01-28 06:31:03,047 - [INFO] - Starting application...
2025-01-28 06:31:03,112 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:31:11,211 - [INFO] - Spark Session created successfully
2025-01-28 06:31:11,215 - [INFO] - Spark version: 3.5.0
2025-01-28 06:31:11,217 - [INFO] - Spark master: local[*]
2025-01-28 06:31:11,219 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:31:11,221 - [INFO] - Starting file processing...
2025-01-28 06:31:11,223 - [INFO] - Input path: /app/raw_data
2025-01-28 06:31:11,224 - [INFO] - Output path: /app/output
2025-01-28 06:31:11,226 - [INFO] - User agent filter: some user agent
2025-01-28 06:31:11,233 - [WARNING] - No parquet files found in input directory
2025-01-28 06:31:11,235 - [ERROR] - Spark processing failed
2025-01-28 06:31:11,237 - [ERROR] - Processing or loading failed
2025-01-28 06:31:11,746 - [INFO] - Spark Session stopped
2025-01-28 06:32:01,560 - [INFO] - Starting application...
2025-01-28 06:32:01,592 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:32:05,039 - [INFO] - Spark Session created successfully
2025-01-28 06:32:05,041 - [INFO] - Spark version: 3.5.0
2025-01-28 06:32:05,042 - [INFO] - Spark master: local[*]
2025-01-28 06:32:05,042 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:32:05,043 - [INFO] - Starting file processing...
2025-01-28 06:32:05,044 - [INFO] - Input path: /app/raw_data
2025-01-28 06:32:05,045 - [INFO] - Output path: /app/output
2025-01-28 06:32:05,046 - [INFO] - User agent filter: some user agent
2025-01-28 06:32:05,047 - [WARNING] - No parquet files found in input directory
2025-01-28 06:32:05,048 - [ERROR] - Spark processing failed
2025-01-28 06:32:05,049 - [ERROR] - Processing or loading failed
2025-01-28 06:32:05,238 - [INFO] - Spark Session stopped
2025-01-28 06:33:01,825 - [INFO] - Starting application...
2025-01-28 06:33:01,862 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:33:05,234 - [INFO] - Spark Session created successfully
2025-01-28 06:33:05,235 - [INFO] - Spark version: 3.5.0
2025-01-28 06:33:05,236 - [INFO] - Spark master: local[*]
2025-01-28 06:33:05,238 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:33:05,239 - [INFO] - Starting file processing...
2025-01-28 06:33:05,240 - [INFO] - Input path: /app/raw_data
2025-01-28 06:33:05,241 - [INFO] - Output path: /app/output
2025-01-28 06:33:05,242 - [INFO] - User agent filter: some user agent
2025-01-28 06:33:05,268 - [INFO] - Found 11 total parquet files
2025-01-28 06:33:05,270 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 06:33:05,271 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 06:33:09,743 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 06:33:10,313 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 06:33:12,005 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 06:33:12,704 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:33:13,263 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 06:33:13,885 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 06:33:14,262 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 06:33:17,051 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 06:33:17,055 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 06:33:17,060 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 06:33:17,065 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 06:33:17,066 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 06:33:17,381 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 06:33:17,578 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 06:33:17,951 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 06:33:18,321 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:33:18,501 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 06:33:18,772 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 06:33:19,012 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 06:33:19,286 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 06:33:19,473 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 06:33:19,913 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 06:33:20,291 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:33:20,516 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 06:33:20,824 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 06:33:21,113 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 06:33:22,026 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-28 06:33:22,869 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 06:33:22,874 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 06:33:22,878 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 06:33:22,881 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 06:33:22,885 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 06:33:22,888 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 06:33:22,892 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 06:33:22,896 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 06:33:22,899 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 06:33:22,900 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 06:33:22,901 - [INFO] - Successfully processed 2 dates
2025-01-28 06:33:22,902 - [INFO] - Starting client report loading process...
2025-01-28 06:33:22,924 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 06:33:22,939 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 06:33:23,001 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 06:33:23,012 - [INFO] - Archived 0 unique rows
2025-01-28 06:33:23,074 - [INFO] - Successfully loaded 48 rows
2025-01-28 06:33:23,080 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 06:33:23,081 - [INFO] - - Archived rows: 0
2025-01-28 06:33:23,082 - [INFO] - - Loaded rows: 48
2025-01-28 06:33:23,083 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 06:33:23,090 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 06:33:23,098 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 06:33:23,101 - [INFO] - Archived 0 unique rows
2025-01-28 06:33:23,108 - [INFO] - Successfully loaded 48 rows
2025-01-28 06:33:23,113 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 06:33:23,114 - [INFO] - - Archived rows: 0
2025-01-28 06:33:23,116 - [INFO] - - Loaded rows: 48
2025-01-28 06:33:23,117 - [INFO] - 
Verifying data load...
2025-01-28 06:33:23,121 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-28 06:33:23,122 - [INFO] - 
Load Summary:
2025-01-28 06:33:23,123 - [INFO] - Total files processed: 2
2025-01-28 06:33:23,124 - [INFO] - Total rows loaded: 96
2025-01-28 06:33:23,125 - [INFO] - 
Date Range:
2025-01-28 06:33:23,125 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 06:33:23,126 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 06:33:23,127 - [INFO] - 
Total Counts:
2025-01-28 06:33:23,128 - [INFO] -   Impressions: 44
2025-01-28 06:33:23,129 - [INFO] -   Clicks: 30
2025-01-28 06:33:23,130 - [INFO] - 
Client report loading completed successfully
2025-01-28 06:33:23,130 - [INFO] - Processing and loading completed successfully
2025-01-28 06:33:24,091 - [INFO] - Spark Session stopped
2025-01-28 06:34:02,380 - [INFO] - Starting application...
2025-01-28 06:34:02,422 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:34:05,903 - [INFO] - Spark Session created successfully
2025-01-28 06:34:05,905 - [INFO] - Spark version: 3.5.0
2025-01-28 06:34:05,906 - [INFO] - Spark master: local[*]
2025-01-28 06:34:05,907 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:34:05,907 - [INFO] - Starting file processing...
2025-01-28 06:34:05,908 - [INFO] - Input path: /app/raw_data
2025-01-28 06:34:05,909 - [INFO] - Output path: /app/output
2025-01-28 06:34:05,910 - [INFO] - User agent filter: some user agent
2025-01-28 06:34:05,913 - [WARNING] - No parquet files found in input directory
2025-01-28 06:34:05,914 - [ERROR] - Spark processing failed
2025-01-28 06:34:05,914 - [ERROR] - Processing or loading failed
2025-01-28 06:34:06,103 - [INFO] - Spark Session stopped
2025-01-28 06:35:01,683 - [INFO] - Starting application...
2025-01-28 06:35:01,722 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:35:04,889 - [INFO] - Spark Session created successfully
2025-01-28 06:35:04,891 - [INFO] - Spark version: 3.5.0
2025-01-28 06:35:04,891 - [INFO] - Spark master: local[*]
2025-01-28 06:35:04,892 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:35:04,893 - [INFO] - Starting file processing...
2025-01-28 06:35:04,894 - [INFO] - Input path: /app/raw_data
2025-01-28 06:35:04,895 - [INFO] - Output path: /app/output
2025-01-28 06:35:04,896 - [INFO] - User agent filter: some user agent
2025-01-28 06:35:04,896 - [WARNING] - No parquet files found in input directory
2025-01-28 06:35:04,897 - [ERROR] - Spark processing failed
2025-01-28 06:35:04,898 - [ERROR] - Processing or loading failed
2025-01-28 06:35:05,093 - [INFO] - Spark Session stopped
2025-01-28 06:36:01,701 - [INFO] - Starting application...
2025-01-28 06:36:01,735 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:36:04,805 - [INFO] - Spark Session created successfully
2025-01-28 06:36:04,807 - [INFO] - Spark version: 3.5.0
2025-01-28 06:36:04,808 - [INFO] - Spark master: local[*]
2025-01-28 06:36:04,809 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:36:04,810 - [INFO] - Starting file processing...
2025-01-28 06:36:04,811 - [INFO] - Input path: /app/raw_data
2025-01-28 06:36:04,812 - [INFO] - Output path: /app/output
2025-01-28 06:36:04,813 - [INFO] - User agent filter: some user agent
2025-01-28 06:36:04,814 - [WARNING] - No parquet files found in input directory
2025-01-28 06:36:04,814 - [ERROR] - Spark processing failed
2025-01-28 06:36:04,815 - [ERROR] - Processing or loading failed
2025-01-28 06:36:05,028 - [INFO] - Spark Session stopped
2025-01-28 06:37:01,593 - [INFO] - Starting application...
2025-01-28 06:37:01,626 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:37:04,640 - [INFO] - Spark Session created successfully
2025-01-28 06:37:04,646 - [INFO] - Spark version: 3.5.0
2025-01-28 06:37:04,647 - [INFO] - Spark master: local[*]
2025-01-28 06:37:04,649 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:37:04,650 - [INFO] - Starting file processing...
2025-01-28 06:37:04,651 - [INFO] - Input path: /app/raw_data
2025-01-28 06:37:04,652 - [INFO] - Output path: /app/output
2025-01-28 06:37:04,653 - [INFO] - User agent filter: some user agent
2025-01-28 06:37:04,675 - [INFO] - Found 11 total parquet files
2025-01-28 06:37:04,676 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 06:37:04,678 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 06:37:08,572 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 06:37:09,101 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 06:37:10,658 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 06:37:11,377 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:37:11,986 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 06:37:12,601 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 06:37:12,914 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 06:37:15,605 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 06:37:15,609 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 06:37:15,613 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 06:37:15,618 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 06:37:15,619 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 06:37:15,892 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 06:37:16,079 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 06:37:16,438 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 06:37:16,794 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:37:16,988 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 06:37:17,244 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 06:37:17,473 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 06:37:17,802 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 06:37:17,982 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 06:37:18,376 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 06:37:18,769 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:37:18,989 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 06:37:19,307 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 06:37:19,544 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 06:37:20,477 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-28 06:37:21,427 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 06:37:21,432 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 06:37:21,436 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 06:37:21,441 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 06:37:21,445 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 06:37:21,449 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 06:37:21,453 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 06:37:21,457 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 06:37:21,461 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 06:37:21,463 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 06:37:21,463 - [INFO] - Successfully processed 2 dates
2025-01-28 06:37:21,464 - [INFO] - Starting client report loading process...
2025-01-28 06:37:21,473 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 06:37:21,483 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 06:37:21,507 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 06:37:21,516 - [INFO] - Archived 0 unique rows
2025-01-28 06:37:21,551 - [INFO] - Successfully loaded 48 rows
2025-01-28 06:37:21,556 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 06:37:21,557 - [INFO] - - Archived rows: 0
2025-01-28 06:37:21,558 - [INFO] - - Loaded rows: 48
2025-01-28 06:37:21,559 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 06:37:21,565 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 06:37:21,571 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 06:37:21,573 - [INFO] - Archived 0 unique rows
2025-01-28 06:37:21,579 - [INFO] - Successfully loaded 48 rows
2025-01-28 06:37:21,583 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 06:37:21,584 - [INFO] - - Archived rows: 0
2025-01-28 06:37:21,585 - [INFO] - - Loaded rows: 48
2025-01-28 06:37:21,586 - [INFO] - 
Verifying data load...
2025-01-28 06:37:21,589 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-28 06:37:21,590 - [INFO] - 
Load Summary:
2025-01-28 06:37:21,591 - [INFO] - Total files processed: 2
2025-01-28 06:37:21,592 - [INFO] - Total rows loaded: 96
2025-01-28 06:37:21,592 - [INFO] - 
Date Range:
2025-01-28 06:37:21,593 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 06:37:21,594 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 06:37:21,595 - [INFO] - 
Total Counts:
2025-01-28 06:37:21,596 - [INFO] -   Impressions: 44
2025-01-28 06:37:21,596 - [INFO] -   Clicks: 30
2025-01-28 06:37:21,597 - [INFO] - 
Client report loading completed successfully
2025-01-28 06:37:21,598 - [INFO] - Processing and loading completed successfully
2025-01-28 06:37:22,507 - [INFO] - Spark Session stopped
2025-01-28 06:38:02,383 - [INFO] - Starting application...
2025-01-28 06:38:02,433 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:38:05,556 - [INFO] - Spark Session created successfully
2025-01-28 06:38:05,558 - [INFO] - Spark version: 3.5.0
2025-01-28 06:38:05,559 - [INFO] - Spark master: local[*]
2025-01-28 06:38:05,560 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:38:05,561 - [INFO] - Starting file processing...
2025-01-28 06:38:05,562 - [INFO] - Input path: /app/raw_data
2025-01-28 06:38:05,563 - [INFO] - Output path: /app/output
2025-01-28 06:38:05,564 - [INFO] - User agent filter: some user agent
2025-01-28 06:38:05,568 - [WARNING] - No parquet files found in input directory
2025-01-28 06:38:05,569 - [ERROR] - Spark processing failed
2025-01-28 06:38:05,570 - [ERROR] - Processing or loading failed
2025-01-28 06:38:05,774 - [INFO] - Spark Session stopped
2025-01-28 06:39:02,325 - [INFO] - Starting application...
2025-01-28 06:39:02,358 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:39:05,446 - [INFO] - Spark Session created successfully
2025-01-28 06:39:05,448 - [INFO] - Spark version: 3.5.0
2025-01-28 06:39:05,449 - [INFO] - Spark master: local[*]
2025-01-28 06:39:05,450 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:39:05,451 - [INFO] - Starting file processing...
2025-01-28 06:39:05,452 - [INFO] - Input path: /app/raw_data
2025-01-28 06:39:05,453 - [INFO] - Output path: /app/output
2025-01-28 06:39:05,454 - [INFO] - User agent filter: some user agent
2025-01-28 06:39:05,455 - [WARNING] - No parquet files found in input directory
2025-01-28 06:39:05,456 - [ERROR] - Spark processing failed
2025-01-28 06:39:05,456 - [ERROR] - Processing or loading failed
2025-01-28 06:39:05,663 - [INFO] - Spark Session stopped
2025-01-28 06:40:02,218 - [INFO] - Starting application...
2025-01-28 06:40:02,257 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:40:05,329 - [INFO] - Spark Session created successfully
2025-01-28 06:40:05,331 - [INFO] - Spark version: 3.5.0
2025-01-28 06:40:05,332 - [INFO] - Spark master: local[*]
2025-01-28 06:40:05,333 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:40:05,334 - [INFO] - Starting file processing...
2025-01-28 06:40:05,335 - [INFO] - Input path: /app/raw_data
2025-01-28 06:40:05,336 - [INFO] - Output path: /app/output
2025-01-28 06:40:05,337 - [INFO] - User agent filter: some user agent
2025-01-28 06:40:05,358 - [INFO] - Found 11 total parquet files
2025-01-28 06:40:05,359 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 06:40:05,361 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 06:40:09,381 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 06:40:09,851 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 06:40:11,263 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 06:40:11,942 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:40:12,519 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 06:40:13,086 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 06:40:13,406 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 06:40:16,297 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 06:40:16,302 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 06:40:16,307 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 06:40:16,311 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 06:40:16,312 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 06:40:16,603 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 06:40:16,768 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 06:40:17,140 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 06:40:17,477 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:40:17,640 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 06:40:17,876 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 06:40:18,114 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 06:40:18,412 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 06:40:18,591 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 06:40:18,984 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 06:40:19,339 - [INFO] - Found 0 records with invalid hours
2025-01-28 06:40:19,531 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 06:40:19,778 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 06:40:20,008 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 06:40:20,813 - [WARNING] - Found records where clicks exceed impressions: 2022-05-27
2025-01-28 06:40:21,993 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 06:40:21,999 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 06:40:22,004 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 06:40:22,008 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 06:40:22,013 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 06:40:22,017 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 06:40:22,021 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 06:40:22,025 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 06:40:22,029 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 06:40:22,030 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 06:40:22,031 - [INFO] - Successfully processed 2 dates
2025-01-28 06:40:22,032 - [INFO] - Starting client report loading process...
2025-01-28 06:40:22,064 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 06:40:22,132 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 06:40:22,364 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 06:40:22,460 - [INFO] - Archived 0 unique rows
2025-01-28 06:40:22,693 - [INFO] - Successfully loaded 48 rows
2025-01-28 06:40:22,702 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 06:40:22,703 - [INFO] - - Archived rows: 0
2025-01-28 06:40:22,704 - [INFO] - - Loaded rows: 48
2025-01-28 06:40:22,705 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 06:40:22,710 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 06:40:22,718 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 06:40:22,721 - [INFO] - Archived 0 unique rows
2025-01-28 06:40:22,726 - [INFO] - Successfully loaded 48 rows
2025-01-28 06:40:22,731 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 06:40:22,732 - [INFO] - - Archived rows: 0
2025-01-28 06:40:22,733 - [INFO] - - Loaded rows: 48
2025-01-28 06:40:22,735 - [INFO] - 
Verifying data load...
2025-01-28 06:40:22,739 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('44'), 'clicks': Decimal('30')}}
2025-01-28 06:40:22,740 - [INFO] - 
Load Summary:
2025-01-28 06:40:22,741 - [INFO] - Total files processed: 2
2025-01-28 06:40:22,742 - [INFO] - Total rows loaded: 96
2025-01-28 06:40:22,743 - [INFO] - 
Date Range:
2025-01-28 06:40:22,744 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 06:40:22,744 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 06:40:22,745 - [INFO] - 
Total Counts:
2025-01-28 06:40:22,746 - [INFO] -   Impressions: 44
2025-01-28 06:40:22,746 - [INFO] -   Clicks: 30
2025-01-28 06:40:22,747 - [INFO] - 
Client report loading completed successfully
2025-01-28 06:40:22,748 - [INFO] - Processing and loading completed successfully
2025-01-28 06:40:23,855 - [INFO] - Spark Session stopped
2025-01-28 06:41:01,833 - [INFO] - Starting application...
2025-01-28 06:41:01,881 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:41:05,554 - [INFO] - Spark Session created successfully
2025-01-28 06:41:05,555 - [INFO] - Spark version: 3.5.0
2025-01-28 06:41:05,556 - [INFO] - Spark master: local[*]
2025-01-28 06:41:05,557 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:41:05,558 - [INFO] - Starting file processing...
2025-01-28 06:41:05,559 - [INFO] - Input path: /app/raw_data
2025-01-28 06:41:05,560 - [INFO] - Output path: /app/output
2025-01-28 06:41:05,561 - [INFO] - User agent filter: some user agent
2025-01-28 06:41:05,564 - [WARNING] - No parquet files found in input directory
2025-01-28 06:41:05,565 - [ERROR] - Spark processing failed
2025-01-28 06:41:05,565 - [ERROR] - Processing or loading failed
2025-01-28 06:41:05,741 - [INFO] - Spark Session stopped
2025-01-28 06:50:35,093 - [INFO] - Starting application...
2025-01-28 06:50:35,141 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:50:38,107 - [INFO] - Spark Session created successfully
2025-01-28 06:50:38,108 - [INFO] - Spark version: 3.5.0
2025-01-28 06:50:38,109 - [INFO] - Spark master: local[*]
2025-01-28 06:50:38,110 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:50:38,110 - [INFO] - Starting file processing...
2025-01-28 06:50:38,111 - [INFO] - Input path: /app/raw_data
2025-01-28 06:50:38,111 - [INFO] - Output path: /app/output
2025-01-28 06:50:38,112 - [INFO] - User agent filter: some user agent
2025-01-28 06:50:38,115 - [WARNING] - No parquet files found in input directory
2025-01-28 06:50:38,115 - [ERROR] - Spark processing failed
2025-01-28 06:50:38,116 - [ERROR] - Processing or loading failed
2025-01-28 06:50:38,331 - [INFO] - Spark Session stopped
2025-01-28 06:51:01,983 - [INFO] - Starting application...
2025-01-28 06:51:02,015 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:51:05,087 - [INFO] - Spark Session created successfully
2025-01-28 06:51:05,089 - [INFO] - Spark version: 3.5.0
2025-01-28 06:51:05,090 - [INFO] - Spark master: local[*]
2025-01-28 06:51:05,090 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 06:51:05,091 - [INFO] - Starting file processing...
2025-01-28 06:51:05,093 - [INFO] - Input path: /app/raw_data
2025-01-28 06:51:05,094 - [INFO] - Output path: /app/output
2025-01-28 06:51:05,095 - [INFO] - User agent filter: some user agent
2025-01-28 06:51:05,096 - [WARNING] - No parquet files found in input directory
2025-01-28 06:51:05,097 - [ERROR] - Spark processing failed
2025-01-28 06:51:05,097 - [ERROR] - Processing or loading failed
2025-01-28 06:51:05,289 - [INFO] - Spark Session stopped
2025-01-28 06:58:15,473 - [INFO] - Starting application...
2025-01-28 06:58:15,553 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 06:59:02,883 - [INFO] - Starting application...
2025-01-28 06:59:02,950 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:00:01,788 - [INFO] - Starting application...
2025-01-28 07:00:01,824 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:01:01,666 - [INFO] - Starting application...
2025-01-28 07:01:01,701 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:01:17,228 - [INFO] - Starting application...
2025-01-28 07:01:17,261 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:02:02,122 - [INFO] - Starting application...
2025-01-28 07:02:02,155 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:03:02,458 - [INFO] - Starting application...
2025-01-28 07:03:02,494 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:04:01,777 - [INFO] - Starting application...
2025-01-28 07:04:01,817 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:05:02,034 - [INFO] - Starting application...
2025-01-28 07:05:02,068 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:06:01,908 - [INFO] - Starting application...
2025-01-28 07:06:01,941 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:07:02,117 - [INFO] - Starting application...
2025-01-28 07:07:02,153 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:08:02,403 - [INFO] - Starting application...
2025-01-28 07:08:02,437 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:09:01,682 - [INFO] - Starting application...
2025-01-28 07:09:01,715 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:09:45,155 - [INFO] - Starting application...
2025-01-28 07:09:45,188 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:10:02,053 - [INFO] - Starting application...
2025-01-28 07:10:02,087 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:10:46,269 - [INFO] - Starting application...
2025-01-28 07:10:46,338 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:11:02,190 - [INFO] - Starting application...
2025-01-28 07:11:02,224 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:12:02,437 - [INFO] - Starting application...
2025-01-28 07:12:02,470 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:23:24,711 - [INFO] - Starting application...
2025-01-28 07:23:24,897 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:24:02,013 - [INFO] - Starting application...
2025-01-28 07:24:02,081 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:25:02,531 - [INFO] - Starting application...
2025-01-28 07:25:02,567 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:26:02,192 - [INFO] - Starting application...
2025-01-28 07:26:02,225 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:27:01,675 - [INFO] - Starting application...
2025-01-28 07:27:01,712 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:28:20,335 - [INFO] - Starting application...
2025-01-28 07:28:28,361 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:29:02,299 - [INFO] - Starting application...
2025-01-28 07:29:07,248 - [INFO] - Starting application...
2025-01-28 07:29:15,275 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:30:02,169 - [INFO] - Starting application...
2025-01-28 07:30:10,196 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:31:01,758 - [INFO] - Starting application...
2025-01-28 07:31:09,786 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:32:02,362 - [INFO] - Starting application...
2025-01-28 07:32:11,328 - [INFO] - Starting application...
2025-01-28 07:32:19,351 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:33:02,337 - [INFO] - Starting application...
2025-01-28 07:33:10,362 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:33:36,815 - [INFO] - Starting application...
2025-01-28 07:33:44,839 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:34:01,776 - [INFO] - Starting application...
2025-01-28 07:34:09,801 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:34:23,149 - [INFO] - Starting application...
2025-01-28 07:34:31,175 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:35:02,086 - [INFO] - Starting application...
2025-01-28 07:35:10,120 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:36:01,663 - [INFO] - Starting application...
2025-01-28 07:36:09,692 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:37:02,299 - [INFO] - Starting application...
2025-01-28 07:37:10,328 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Temporary failure in name resolution

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 07:38:59,221 - [INFO] - Starting application...
2025-01-28 07:38:59,271 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:39:02,227 - [INFO] - Starting application...
2025-01-28 07:39:02,274 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:40:01,595 - [INFO] - Starting application...
2025-01-28 07:40:01,629 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:41:02,122 - [INFO] - Starting application...
2025-01-28 07:41:02,155 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:42:02,413 - [INFO] - Starting application...
2025-01-28 07:42:02,449 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:43:01,987 - [INFO] - Starting application...
2025-01-28 07:43:02,024 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:43:21,977 - [INFO] - Starting application...
2025-01-28 07:43:22,014 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:44:01,866 - [INFO] - Starting application...
2025-01-28 07:44:01,904 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:45:01,583 - [INFO] - Starting application...
2025-01-28 07:45:01,629 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:46:02,388 - [INFO] - Starting application...
2025-01-28 07:46:02,426 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:46:44,509 - [INFO] - Starting application...
2025-01-28 07:46:44,548 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:47:02,198 - [INFO] - Starting application...
2025-01-28 07:47:02,235 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:48:02,279 - [INFO] - Starting application...
2025-01-28 07:48:02,327 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:49:02,287 - [INFO] - Starting application...
2025-01-28 07:49:02,321 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:50:02,091 - [INFO] - Starting application...
2025-01-28 07:50:02,124 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:57:37,797 - [INFO] - Starting application...
2025-01-28 07:57:37,883 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:58:03,636 - [INFO] - Starting application...
2025-01-28 07:58:03,705 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:59:02,054 - [INFO] - Starting application...
2025-01-28 07:59:02,306 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 07:59:03,192 - [INFO] - Starting application...
2025-01-28 07:59:03,278 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:00:02,576 - [INFO] - Starting application...
2025-01-28 08:00:02,630 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:01:02,432 - [INFO] - Starting application...
2025-01-28 08:01:02,472 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:02:01,641 - [INFO] - Starting application...
2025-01-28 08:02:01,676 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:03:02,233 - [INFO] - Starting application...
2025-01-28 08:03:02,280 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:03:40,952 - [INFO] - Starting application...
2025-01-28 08:03:41,011 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:04:01,758 - [INFO] - Starting application...
2025-01-28 08:04:01,791 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:04:25,081 - [INFO] - Starting application...
2025-01-28 08:04:25,115 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:05:01,964 - [INFO] - Starting application...
2025-01-28 08:05:02,008 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:06:02,502 - [INFO] - Starting application...
2025-01-28 08:06:02,538 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:15:32,732 - [INFO] - Starting application...
2025-01-28 08:15:32,802 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:16:02,914 - [INFO] - Starting application...
2025-01-28 08:16:03,066 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:16:34,925 - [INFO] - Starting application...
2025-01-28 08:16:34,991 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:17:02,014 - [INFO] - Starting application...
2025-01-28 08:17:02,053 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:18:01,967 - [INFO] - Starting application...
2025-01-28 08:18:02,001 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:19:02,016 - [INFO] - Starting application...
2025-01-28 08:19:02,053 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:20:01,597 - [INFO] - Starting application...
2025-01-28 08:20:01,631 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:21:01,888 - [INFO] - Starting application...
2025-01-28 08:21:01,924 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:22:01,556 - [INFO] - Starting application...
2025-01-28 08:22:01,591 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:22:59,602 - [INFO] - Starting application...
2025-01-28 08:22:59,656 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:23:01,665 - [INFO] - Starting application...
2025-01-28 08:23:01,706 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:23:59,984 - [INFO] - Starting application...
2025-01-28 08:24:00,019 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:24:02,010 - [INFO] - Starting application...
2025-01-28 08:24:02,047 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:25:01,627 - [INFO] - Starting application...
2025-01-28 08:25:01,662 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:26:02,001 - [INFO] - Starting application...
2025-01-28 08:26:02,036 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:27:02,282 - [INFO] - Starting application...
2025-01-28 08:27:02,316 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:27:32,095 - [INFO] - Starting application...
2025-01-28 08:27:32,130 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:28:01,947 - [INFO] - Starting application...
2025-01-28 08:28:01,981 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:28:29,999 - [INFO] - Starting application...
2025-01-28 08:28:30,034 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:29:01,950 - [INFO] - Starting application...
2025-01-28 08:29:01,984 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:30:02,423 - [INFO] - Starting application...
2025-01-28 08:30:02,457 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:31:02,060 - [INFO] - Starting application...
2025-01-28 08:31:02,100 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:32:02,249 - [INFO] - Starting application...
2025-01-28 08:32:02,286 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:33:02,395 - [INFO] - Starting application...
2025-01-28 08:33:02,502 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:34:02,318 - [INFO] - Starting application...
2025-01-28 08:34:02,352 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:38:17,643 - [INFO] - Starting application...
2025-01-28 08:38:17,745 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:38:22,911 - [INFO] - Spark Session created successfully
2025-01-28 08:38:22,913 - [INFO] - Spark version: 3.5.0
2025-01-28 08:38:22,914 - [INFO] - Spark master: local[*]
2025-01-28 08:38:22,914 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:38:22,915 - [INFO] - Starting file processing...
2025-01-28 08:38:22,916 - [INFO] - Input path: /app/raw_data
2025-01-28 08:38:22,916 - [INFO] - Output path: /app/output
2025-01-28 08:38:22,917 - [INFO] - User agent filter: some user agent
2025-01-28 08:38:22,964 - [INFO] - Found 11 total parquet files
2025-01-28 08:38:22,971 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:38:22,972 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:38:28,827 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:38:29,493 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:38:31,588 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:38:32,443 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:38:33,152 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:38:34,017 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:38:34,480 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:38:37,805 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:38:37,806 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:38:37,807 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:38:38,371 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:38:38,668 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:38:39,234 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:38:39,733 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:38:39,991 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:38:40,319 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:38:40,601 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:38:41,060 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:38:41,410 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:38:42,076 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:38:42,510 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:38:42,751 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:38:43,118 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:38:43,446 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:38:44,751 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:38:45,222 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:38:45,224 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:38:45,224 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:38:45,225 - [ERROR] - No dates were successfully processed
2025-01-28 08:38:45,226 - [ERROR] - Spark processing failed
2025-01-28 08:38:45,227 - [ERROR] - Processing or loading failed
2025-01-28 08:38:45,792 - [INFO] - Spark Session stopped
2025-01-28 08:39:04,377 - [INFO] - Starting application...
2025-01-28 08:39:04,483 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:39:11,600 - [INFO] - Spark Session created successfully
2025-01-28 08:39:11,602 - [INFO] - Spark version: 3.5.0
2025-01-28 08:39:11,603 - [INFO] - Spark master: local[*]
2025-01-28 08:39:11,605 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:39:11,606 - [INFO] - Starting file processing...
2025-01-28 08:39:11,607 - [INFO] - Input path: /app/raw_data
2025-01-28 08:39:11,609 - [INFO] - Output path: /app/output
2025-01-28 08:39:11,610 - [INFO] - User agent filter: some user agent
2025-01-28 08:39:11,651 - [INFO] - Found 11 total parquet files
2025-01-28 08:39:11,652 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:39:11,653 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:39:18,404 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:39:19,082 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:39:21,207 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:39:22,067 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:39:22,804 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:39:23,654 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:39:24,171 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:39:26,631 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:39:26,886 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:39:26,887 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:39:27,241 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:39:27,468 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:39:27,863 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:39:28,261 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:39:28,466 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:39:28,828 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:39:29,078 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:39:29,413 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:39:29,622 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:39:30,231 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:39:30,719 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:39:30,946 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:39:31,289 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:39:31,595 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:39:32,797 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:39:33,304 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:39:33,305 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:39:33,306 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:39:33,307 - [ERROR] - No dates were successfully processed
2025-01-28 08:39:33,308 - [ERROR] - Spark processing failed
2025-01-28 08:39:33,310 - [ERROR] - Processing or loading failed
2025-01-28 08:39:33,833 - [INFO] - Spark Session stopped
2025-01-28 08:40:02,771 - [INFO] - Starting application...
2025-01-28 08:40:02,853 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:40:08,810 - [INFO] - Spark Session created successfully
2025-01-28 08:40:08,812 - [INFO] - Spark version: 3.5.0
2025-01-28 08:40:08,814 - [INFO] - Spark master: local[*]
2025-01-28 08:40:08,815 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:40:08,817 - [INFO] - Starting file processing...
2025-01-28 08:40:08,818 - [INFO] - Input path: /app/raw_data
2025-01-28 08:40:08,819 - [INFO] - Output path: /app/output
2025-01-28 08:40:08,821 - [INFO] - User agent filter: some user agent
2025-01-28 08:40:08,852 - [INFO] - Found 11 total parquet files
2025-01-28 08:40:08,854 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:40:08,855 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:40:15,010 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:40:15,800 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:40:17,961 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:40:18,896 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:40:19,643 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:40:20,621 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:40:21,116 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:40:24,079 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:40:24,080 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:40:24,082 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:40:24,435 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:40:24,675 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:40:25,250 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:40:25,771 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:40:26,046 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:40:26,401 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:40:26,754 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:40:27,155 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:40:27,508 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:40:28,302 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:40:28,986 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:40:29,358 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:40:29,770 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:40:30,179 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:40:31,522 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:40:32,118 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:40:32,119 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:40:32,121 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:40:32,122 - [ERROR] - No dates were successfully processed
2025-01-28 08:40:32,124 - [ERROR] - Spark processing failed
2025-01-28 08:40:32,126 - [ERROR] - Processing or loading failed
2025-01-28 08:40:32,560 - [INFO] - Spark Session stopped
2025-01-28 08:41:02,752 - [INFO] - Starting application...
2025-01-28 08:41:02,805 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:41:06,647 - [INFO] - Spark Session created successfully
2025-01-28 08:41:06,649 - [INFO] - Spark version: 3.5.0
2025-01-28 08:41:06,651 - [INFO] - Spark master: local[*]
2025-01-28 08:41:06,652 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:41:06,653 - [INFO] - Starting file processing...
2025-01-28 08:41:06,653 - [INFO] - Input path: /app/raw_data
2025-01-28 08:41:06,654 - [INFO] - Output path: /app/output
2025-01-28 08:41:06,655 - [INFO] - User agent filter: some user agent
2025-01-28 08:41:06,678 - [INFO] - Found 11 total parquet files
2025-01-28 08:41:06,679 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:41:06,681 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:41:10,867 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:41:11,386 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:41:12,905 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:41:13,648 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:41:14,277 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:41:14,914 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:41:15,286 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:41:17,406 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:41:17,408 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:41:17,409 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:41:17,706 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:41:17,847 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:41:18,138 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:41:18,504 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:41:18,704 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:41:18,978 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:41:19,211 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:41:19,502 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:41:19,739 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:41:20,147 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:41:20,510 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:41:20,693 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:41:20,979 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:41:21,258 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:41:22,221 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:41:22,619 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:41:22,620 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:41:22,621 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:41:22,622 - [ERROR] - No dates were successfully processed
2025-01-28 08:41:22,623 - [ERROR] - Spark processing failed
2025-01-28 08:41:22,624 - [ERROR] - Processing or loading failed
2025-01-28 08:41:23,252 - [INFO] - Spark Session stopped
2025-01-28 08:42:02,012 - [INFO] - Starting application...
2025-01-28 08:42:02,047 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:42:05,241 - [INFO] - Spark Session created successfully
2025-01-28 08:42:05,243 - [INFO] - Spark version: 3.5.0
2025-01-28 08:42:05,244 - [INFO] - Spark master: local[*]
2025-01-28 08:42:05,245 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:42:05,245 - [INFO] - Starting file processing...
2025-01-28 08:42:05,246 - [INFO] - Input path: /app/raw_data
2025-01-28 08:42:05,247 - [INFO] - Output path: /app/output
2025-01-28 08:42:05,248 - [INFO] - User agent filter: some user agent
2025-01-28 08:42:05,249 - [INFO] - Found 11 total parquet files
2025-01-28 08:42:05,250 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:42:05,251 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:42:09,382 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:42:09,858 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:42:11,372 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:42:12,065 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:42:12,741 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:42:13,401 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:42:13,815 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:42:16,303 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:42:16,304 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:42:16,305 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:42:16,597 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:42:16,777 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:42:17,164 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:42:17,589 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:42:17,839 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:42:18,123 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:42:18,382 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:42:18,721 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:42:18,972 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:42:19,511 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:42:19,924 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:42:20,127 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:42:20,440 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:42:20,707 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:42:21,718 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:42:22,145 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:42:22,146 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:42:22,147 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:42:22,148 - [ERROR] - No dates were successfully processed
2025-01-28 08:42:22,149 - [ERROR] - Spark processing failed
2025-01-28 08:42:22,150 - [ERROR] - Processing or loading failed
2025-01-28 08:42:22,748 - [INFO] - Spark Session stopped
2025-01-28 08:43:02,509 - [INFO] - Starting application...
2025-01-28 08:43:02,568 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:43:07,162 - [INFO] - Spark Session created successfully
2025-01-28 08:43:07,163 - [INFO] - Spark version: 3.5.0
2025-01-28 08:43:07,164 - [INFO] - Spark master: local[*]
2025-01-28 08:43:07,165 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:43:07,166 - [INFO] - Starting file processing...
2025-01-28 08:43:07,167 - [INFO] - Input path: /app/raw_data
2025-01-28 08:43:07,167 - [INFO] - Output path: /app/output
2025-01-28 08:43:07,168 - [INFO] - User agent filter: some user agent
2025-01-28 08:43:07,190 - [INFO] - Found 11 total parquet files
2025-01-28 08:43:07,192 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:43:07,193 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:43:11,817 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:43:12,375 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:43:14,004 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:43:14,749 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:43:15,407 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:43:16,058 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:43:16,453 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:43:18,600 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:43:18,601 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:43:18,602 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:43:18,886 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:43:19,057 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:43:19,414 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:43:19,785 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:43:19,945 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:43:20,211 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:43:20,473 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:43:20,829 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:43:21,032 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:43:21,453 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:43:21,851 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:43:22,090 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:43:22,394 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:43:22,688 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:43:23,698 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:43:24,146 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:43:24,148 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:43:24,149 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:43:24,149 - [ERROR] - No dates were successfully processed
2025-01-28 08:43:24,151 - [ERROR] - Spark processing failed
2025-01-28 08:43:24,153 - [ERROR] - Processing or loading failed
2025-01-28 08:43:24,734 - [INFO] - Spark Session stopped
2025-01-28 08:44:02,350 - [INFO] - Starting application...
2025-01-28 08:44:02,439 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:44:06,097 - [INFO] - Spark Session created successfully
2025-01-28 08:44:06,099 - [INFO] - Spark version: 3.5.0
2025-01-28 08:44:06,100 - [INFO] - Spark master: local[*]
2025-01-28 08:44:06,101 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:44:06,101 - [INFO] - Starting file processing...
2025-01-28 08:44:06,102 - [INFO] - Input path: /app/raw_data
2025-01-28 08:44:06,103 - [INFO] - Output path: /app/output
2025-01-28 08:44:06,104 - [INFO] - User agent filter: some user agent
2025-01-28 08:44:06,106 - [INFO] - Found 11 total parquet files
2025-01-28 08:44:06,107 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:44:06,107 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:44:10,185 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:44:10,721 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:44:12,237 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:44:12,924 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:44:13,512 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:44:14,156 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:44:14,526 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:44:16,743 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:44:16,745 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:44:16,746 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:44:17,032 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:44:17,251 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:44:17,576 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:44:17,950 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:44:18,155 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:44:18,424 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:44:18,675 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:44:19,033 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:44:19,247 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:44:19,782 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:44:20,179 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:44:20,406 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:44:20,719 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:44:20,994 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:44:22,010 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:44:22,408 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:44:22,409 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:44:22,410 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:44:22,411 - [ERROR] - No dates were successfully processed
2025-01-28 08:44:22,412 - [ERROR] - Spark processing failed
2025-01-28 08:44:22,413 - [ERROR] - Processing or loading failed
2025-01-28 08:44:23,039 - [INFO] - Spark Session stopped
2025-01-28 08:45:01,160 - [INFO] - Starting application...
2025-01-28 08:45:01,232 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:45:04,507 - [INFO] - Spark Session created successfully
2025-01-28 08:45:04,508 - [INFO] - Spark version: 3.5.0
2025-01-28 08:45:04,509 - [INFO] - Spark master: local[*]
2025-01-28 08:45:04,510 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:45:04,510 - [INFO] - Starting file processing...
2025-01-28 08:45:04,511 - [INFO] - Input path: /app/raw_data
2025-01-28 08:45:04,512 - [INFO] - Output path: /app/output
2025-01-28 08:45:04,513 - [INFO] - User agent filter: some user agent
2025-01-28 08:45:04,536 - [INFO] - Found 11 total parquet files
2025-01-28 08:45:04,537 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:45:04,538 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:45:08,501 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:45:09,022 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:45:10,639 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:45:11,325 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:45:11,917 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:45:12,539 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:45:12,870 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:45:14,977 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:45:14,977 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:45:14,978 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:45:15,264 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:45:15,443 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:45:15,815 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:45:16,163 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:45:16,344 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:45:16,629 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:45:16,867 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:45:17,186 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:45:17,396 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:45:17,811 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:45:18,202 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:45:18,398 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:45:18,728 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:45:18,999 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:45:20,053 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:45:20,550 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:45:20,550 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:45:20,551 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:45:20,552 - [ERROR] - No dates were successfully processed
2025-01-28 08:45:20,554 - [ERROR] - Spark processing failed
2025-01-28 08:45:20,555 - [ERROR] - Processing or loading failed
2025-01-28 08:45:21,093 - [INFO] - Spark Session stopped
2025-01-28 08:46:02,714 - [INFO] - Starting application...
2025-01-28 08:46:02,797 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:46:11,901 - [INFO] - Spark Session created successfully
2025-01-28 08:46:11,903 - [INFO] - Spark version: 3.5.0
2025-01-28 08:46:11,904 - [INFO] - Spark master: local[*]
2025-01-28 08:46:11,905 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:46:11,906 - [INFO] - Starting file processing...
2025-01-28 08:46:11,906 - [INFO] - Input path: /app/raw_data
2025-01-28 08:46:11,907 - [INFO] - Output path: /app/output
2025-01-28 08:46:11,908 - [INFO] - User agent filter: some user agent
2025-01-28 08:46:11,936 - [INFO] - Found 11 total parquet files
2025-01-28 08:46:11,938 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:46:11,939 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:46:19,104 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:46:19,640 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:46:21,319 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:46:22,004 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:46:22,834 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:46:23,590 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:46:23,994 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:46:26,536 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:46:26,537 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:46:26,538 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:46:26,808 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:46:26,971 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:46:27,430 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:46:27,840 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:46:28,015 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:46:28,272 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:46:28,501 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:46:28,844 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:46:29,053 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:46:29,503 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:46:29,904 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:46:30,137 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:46:30,467 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:46:30,843 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:46:32,597 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:46:33,100 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:46:33,102 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:46:33,105 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:46:33,107 - [ERROR] - No dates were successfully processed
2025-01-28 08:46:33,110 - [ERROR] - Spark processing failed
2025-01-28 08:46:33,111 - [ERROR] - Processing or loading failed
2025-01-28 08:46:33,635 - [INFO] - Spark Session stopped
2025-01-28 08:47:02,131 - [INFO] - Starting application...
2025-01-28 08:47:02,220 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:47:06,493 - [INFO] - Spark Session created successfully
2025-01-28 08:47:06,494 - [INFO] - Spark version: 3.5.0
2025-01-28 08:47:06,495 - [INFO] - Spark master: local[*]
2025-01-28 08:47:06,496 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:47:06,497 - [INFO] - Starting file processing...
2025-01-28 08:47:06,498 - [INFO] - Input path: /app/raw_data
2025-01-28 08:47:06,499 - [INFO] - Output path: /app/output
2025-01-28 08:47:06,499 - [INFO] - User agent filter: some user agent
2025-01-28 08:47:06,522 - [INFO] - Found 11 total parquet files
2025-01-28 08:47:06,523 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:47:06,524 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:47:10,943 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:47:11,495 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:47:13,027 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:47:13,713 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:47:14,423 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:47:15,191 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:47:15,548 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:47:17,906 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:47:17,908 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:47:17,909 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:47:18,201 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:47:18,384 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:47:18,725 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:47:19,080 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:47:19,257 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:47:19,544 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:47:19,822 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:47:20,138 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:47:20,340 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:47:20,899 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:47:21,381 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:47:21,633 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:47:22,029 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:47:22,322 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:47:23,722 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:47:24,202 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:47:24,204 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:47:24,208 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:47:24,209 - [ERROR] - No dates were successfully processed
2025-01-28 08:47:24,211 - [ERROR] - Spark processing failed
2025-01-28 08:47:24,213 - [ERROR] - Processing or loading failed
2025-01-28 08:47:24,762 - [INFO] - Spark Session stopped
2025-01-28 08:47:49,666 - [INFO] - Starting application...
2025-01-28 08:47:49,786 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:47:53,918 - [INFO] - Spark Session created successfully
2025-01-28 08:47:53,919 - [INFO] - Spark version: 3.5.0
2025-01-28 08:47:53,919 - [INFO] - Spark master: local[*]
2025-01-28 08:47:53,920 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:47:53,920 - [INFO] - Starting file processing...
2025-01-28 08:47:53,922 - [INFO] - Input path: /app/raw_data
2025-01-28 08:47:53,922 - [INFO] - Output path: /app/output
2025-01-28 08:47:53,923 - [INFO] - User agent filter: some user agent
2025-01-28 08:47:53,945 - [INFO] - Found 11 total parquet files
2025-01-28 08:47:53,946 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:47:53,946 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:47:58,436 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:47:58,934 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:48:00,552 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:48:01,204 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:48:01,795 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:48:02,227 - [INFO] - Starting application...
2025-01-28 08:48:02,273 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:48:02,535 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:48:02,927 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:48:05,562 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:05,563 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:05,564 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:05,919 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:48:06,146 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:48:06,604 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:48:07,012 - [INFO] - Spark Session created successfully
2025-01-28 08:48:07,014 - [INFO] - Spark version: 3.5.0
2025-01-28 08:48:07,016 - [INFO] - Spark master: local[*]
2025-01-28 08:48:07,017 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:48:07,019 - [INFO] - Starting file processing...
2025-01-28 08:48:07,020 - [INFO] - Input path: /app/raw_data
2025-01-28 08:48:07,021 - [INFO] - Output path: /app/output
2025-01-28 08:48:07,023 - [INFO] - User agent filter: some user agent
2025-01-28 08:48:07,056 - [INFO] - Found 11 total parquet files
2025-01-28 08:48:07,058 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:48:07,060 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:48:07,132 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:48:07,380 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:48:07,723 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:48:08,035 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:48:08,405 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:48:08,663 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:48:09,232 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:48:09,879 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:48:10,188 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:48:10,639 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:48:10,972 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:48:12,497 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:48:13,668 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:13,670 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:13,670 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:13,671 - [ERROR] - No dates were successfully processed
2025-01-28 08:48:13,673 - [ERROR] - Spark processing failed
2025-01-28 08:48:13,674 - [ERROR] - Processing or loading failed
2025-01-28 08:48:13,821 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:48:14,515 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:48:14,547 - [INFO] - Spark Session stopped
2025-01-28 08:48:16,538 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:48:17,389 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:48:18,024 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:48:18,879 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:48:19,372 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:48:22,142 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:22,143 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:22,145 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:22,489 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:48:22,680 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:48:23,084 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:48:23,553 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:48:23,776 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:48:24,138 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:48:24,448 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:48:24,810 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:48:25,110 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:48:25,622 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:48:26,060 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:48:26,274 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:48:26,586 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:48:26,869 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:48:27,942 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:48:28,365 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:28,366 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:28,367 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:48:28,369 - [ERROR] - No dates were successfully processed
2025-01-28 08:48:28,370 - [ERROR] - Spark processing failed
2025-01-28 08:48:28,373 - [ERROR] - Processing or loading failed
2025-01-28 08:48:28,979 - [INFO] - Spark Session stopped
2025-01-28 08:49:02,483 - [INFO] - Starting application...
2025-01-28 08:49:02,605 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:49:07,500 - [INFO] - Spark Session created successfully
2025-01-28 08:49:07,502 - [INFO] - Spark version: 3.5.0
2025-01-28 08:49:07,503 - [INFO] - Spark master: local[*]
2025-01-28 08:49:07,504 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:49:07,506 - [INFO] - Starting file processing...
2025-01-28 08:49:07,507 - [INFO] - Input path: /app/raw_data
2025-01-28 08:49:07,507 - [INFO] - Output path: /app/output
2025-01-28 08:49:07,508 - [INFO] - User agent filter: some user agent
2025-01-28 08:49:07,535 - [INFO] - Found 11 total parquet files
2025-01-28 08:49:07,537 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:49:07,538 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:49:12,431 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:49:12,966 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:49:14,652 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:49:15,387 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:49:16,066 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:49:16,729 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:49:17,451 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:49:20,180 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:49:20,181 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:49:20,183 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:49:20,448 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:49:20,605 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:49:20,926 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:49:21,306 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:49:21,486 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:49:21,805 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:49:22,062 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:49:22,348 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:49:22,546 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:49:22,962 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:49:23,341 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:49:23,551 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:49:23,877 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:49:24,212 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:49:25,361 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:49:25,908 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:49:25,909 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:49:25,910 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:49:25,911 - [ERROR] - No dates were successfully processed
2025-01-28 08:49:25,912 - [ERROR] - Spark processing failed
2025-01-28 08:49:25,913 - [ERROR] - Processing or loading failed
2025-01-28 08:49:26,391 - [INFO] - Spark Session stopped
2025-01-28 08:50:02,304 - [INFO] - Starting application...
2025-01-28 08:50:02,364 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:50:06,987 - [INFO] - Spark Session created successfully
2025-01-28 08:50:06,989 - [INFO] - Spark version: 3.5.0
2025-01-28 08:50:06,991 - [INFO] - Spark master: local[*]
2025-01-28 08:50:06,992 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:50:06,994 - [INFO] - Starting file processing...
2025-01-28 08:50:06,996 - [INFO] - Input path: /app/raw_data
2025-01-28 08:50:06,997 - [INFO] - Output path: /app/output
2025-01-28 08:50:06,999 - [INFO] - User agent filter: some user agent
2025-01-28 08:50:07,050 - [INFO] - Found 11 total parquet files
2025-01-28 08:50:07,052 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:50:07,054 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:50:13,076 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:50:14,038 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:50:16,054 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:50:16,795 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:50:17,442 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:50:18,066 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:50:18,443 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:50:20,653 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:50:20,655 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:50:20,656 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:50:20,910 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:50:21,114 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:50:21,485 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:50:21,864 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:50:22,069 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:50:22,335 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:50:22,571 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:50:22,910 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:50:23,130 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:50:23,576 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:50:23,994 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:50:24,236 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:50:24,570 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:50:24,923 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:50:25,982 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:50:26,490 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:50:26,492 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:50:26,492 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:50:26,493 - [ERROR] - No dates were successfully processed
2025-01-28 08:50:26,494 - [ERROR] - Spark processing failed
2025-01-28 08:50:26,495 - [ERROR] - Processing or loading failed
2025-01-28 08:50:27,010 - [INFO] - Spark Session stopped
2025-01-28 08:51:01,987 - [INFO] - Starting application...
2025-01-28 08:51:02,027 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:51:05,305 - [INFO] - Spark Session created successfully
2025-01-28 08:51:05,306 - [INFO] - Spark version: 3.5.0
2025-01-28 08:51:05,307 - [INFO] - Spark master: local[*]
2025-01-28 08:51:05,307 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:51:05,308 - [INFO] - Starting file processing...
2025-01-28 08:51:05,309 - [INFO] - Input path: /app/raw_data
2025-01-28 08:51:05,309 - [INFO] - Output path: /app/output
2025-01-28 08:51:05,310 - [INFO] - User agent filter: some user agent
2025-01-28 08:51:05,332 - [INFO] - Found 11 total parquet files
2025-01-28 08:51:05,333 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:51:05,334 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:51:09,723 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:51:10,277 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:51:11,871 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:51:12,550 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:51:13,084 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:51:13,685 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:51:14,017 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:51:16,104 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:51:16,104 - [ERROR] - Error processing files for date '2022-05-26': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:51:16,105 - [WARNING] - Failed to process data for date: 2022-05-26 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:51:16,359 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:51:16,582 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:51:16,902 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:51:17,273 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:51:17,441 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:51:17,700 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:51:17,930 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:51:18,274 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:51:18,469 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:51:18,912 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:51:19,278 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:51:19,489 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:51:19,779 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:51:20,065 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:51:21,104 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:51:21,509 - [ERROR] - Error in _combine_and_fill_hours: type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:51:21,510 - [ERROR] - Error processing files for date '2022-05-27': type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:51:21,511 - [WARNING] - Failed to process data for date: 2022-05-27 - type object 'datetime.datetime' has no attribute '_get_object_id'
2025-01-28 08:51:21,512 - [ERROR] - No dates were successfully processed
2025-01-28 08:51:21,512 - [ERROR] - Spark processing failed
2025-01-28 08:51:21,514 - [ERROR] - Processing or loading failed
2025-01-28 08:51:22,134 - [INFO] - Spark Session stopped
2025-01-28 10:54:53,407 - [INFO] - Starting application...
2025-01-28 10:54:56,353 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Unknown host

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 08:58:24,296 - [INFO] - Starting application...
2025-01-28 08:58:24,376 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:58:29,315 - [INFO] - Spark Session created successfully
2025-01-28 08:58:29,318 - [INFO] - Spark version: 3.5.0
2025-01-28 08:58:29,319 - [INFO] - Spark master: local[*]
2025-01-28 08:58:29,320 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:58:29,321 - [INFO] - Starting file processing...
2025-01-28 08:58:29,321 - [INFO] - Input path: /app/raw_data
2025-01-28 08:58:29,322 - [INFO] - Output path: /app/output
2025-01-28 08:58:29,323 - [INFO] - User agent filter: some user agent
2025-01-28 08:58:29,365 - [INFO] - Found 11 total parquet files
2025-01-28 08:58:29,366 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 08:58:29,367 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 08:58:35,278 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:58:35,876 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 08:58:37,662 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:58:38,495 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:58:39,251 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:58:40,089 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 08:58:40,518 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 08:58:44,608 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 08:58:44,614 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 08:58:44,619 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 08:58:44,623 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 08:58:44,625 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 08:58:44,939 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 08:58:45,148 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 08:58:45,636 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:58:46,149 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:58:46,384 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 08:58:46,760 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 08:58:47,039 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 08:58:47,414 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 08:58:47,667 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 08:58:48,304 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:58:48,759 - [INFO] - Found 0 records with invalid hours
2025-01-28 08:58:49,053 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:58:49,454 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 08:58:49,796 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 08:58:50,826 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 08:58:51,959 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 08:58:51,964 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 08:58:51,968 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 08:58:51,974 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 08:58:51,978 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 08:58:51,983 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 08:58:51,988 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 08:58:51,993 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 08:58:51,997 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 08:58:51,998 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 08:58:51,998 - [INFO] - Successfully processed 2 dates
2025-01-28 08:58:51,999 - [INFO] - Starting client report loading process...
2025-01-28 08:58:52,014 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 08:58:52,053 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 08:58:52,224 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 08:58:52,485 - [INFO] - Archived 0 unique rows
2025-01-28 08:58:52,764 - [INFO] - Successfully loaded 24 rows into client_report.
2025-01-28 08:58:52,777 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 08:58:52,778 - [INFO] - - Archived rows: 0
2025-01-28 08:58:52,778 - [INFO] - - Loaded rows: 24
2025-01-28 08:58:52,779 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 08:58:52,784 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 08:58:52,794 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 08:58:52,832 - [INFO] - Stored 2 invalid records for later analysis
2025-01-28 08:58:52,834 - [INFO] - Archived 0 unique rows
2025-01-28 08:58:52,840 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 08:58:52,845 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 08:58:52,846 - [INFO] - - Archived rows: 0
2025-01-28 08:58:52,847 - [INFO] - - Loaded rows: 48
2025-01-28 08:58:52,847 - [INFO] - 
Verifying data load...
2025-01-28 08:58:52,854 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 08:58:52,855 - [INFO] - 
Load Summary:
2025-01-28 08:58:52,856 - [INFO] - Total files processed: 2
2025-01-28 08:58:52,857 - [INFO] - Total rows loaded: 72
2025-01-28 08:58:52,858 - [INFO] - 
Date Range:
2025-01-28 08:58:52,858 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 08:58:52,859 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 08:58:52,860 - [INFO] - 
Total Counts:
2025-01-28 08:58:52,861 - [INFO] -   Impressions: 24
2025-01-28 08:58:52,861 - [INFO] -   Clicks: 30
2025-01-28 08:58:52,862 - [INFO] - 
Client report loading completed successfully
2025-01-28 08:58:52,863 - [INFO] - Processing and loading completed successfully
2025-01-28 08:58:53,879 - [INFO] - Spark Session stopped
2025-01-28 08:59:02,779 - [INFO] - Starting application...
2025-01-28 08:59:02,902 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 08:59:10,164 - [INFO] - Spark Session created successfully
2025-01-28 08:59:10,166 - [INFO] - Spark version: 3.5.0
2025-01-28 08:59:10,167 - [INFO] - Spark master: local[*]
2025-01-28 08:59:10,168 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 08:59:10,170 - [INFO] - Starting file processing...
2025-01-28 08:59:10,171 - [INFO] - Input path: /app/raw_data
2025-01-28 08:59:10,172 - [INFO] - Output path: /app/output
2025-01-28 08:59:10,173 - [INFO] - User agent filter: some user agent
2025-01-28 08:59:10,179 - [WARNING] - No parquet files found in input directory
2025-01-28 08:59:10,180 - [ERROR] - Spark processing failed
2025-01-28 08:59:10,181 - [ERROR] - Processing or loading failed
2025-01-28 08:59:10,624 - [INFO] - Spark Session stopped
2025-01-28 09:00:02,639 - [INFO] - Starting application...
2025-01-28 09:00:02,693 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:00:07,068 - [INFO] - Spark Session created successfully
2025-01-28 09:00:07,070 - [INFO] - Spark version: 3.5.0
2025-01-28 09:00:07,071 - [INFO] - Spark master: local[*]
2025-01-28 09:00:07,073 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:00:07,074 - [INFO] - Starting file processing...
2025-01-28 09:00:07,076 - [INFO] - Input path: /app/raw_data
2025-01-28 09:00:07,077 - [INFO] - Output path: /app/output
2025-01-28 09:00:07,079 - [INFO] - User agent filter: some user agent
2025-01-28 09:00:07,080 - [WARNING] - No parquet files found in input directory
2025-01-28 09:00:07,081 - [ERROR] - Spark processing failed
2025-01-28 09:00:07,083 - [ERROR] - Processing or loading failed
2025-01-28 09:00:07,600 - [INFO] - Spark Session stopped
2025-01-28 09:01:02,314 - [INFO] - Starting application...
2025-01-28 09:01:02,356 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:01:05,841 - [INFO] - Spark Session created successfully
2025-01-28 09:01:05,843 - [INFO] - Spark version: 3.5.0
2025-01-28 09:01:05,844 - [INFO] - Spark master: local[*]
2025-01-28 09:01:05,846 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:01:05,847 - [INFO] - Starting file processing...
2025-01-28 09:01:05,848 - [INFO] - Input path: /app/raw_data
2025-01-28 09:01:05,849 - [INFO] - Output path: /app/output
2025-01-28 09:01:05,850 - [INFO] - User agent filter: some user agent
2025-01-28 09:01:05,875 - [INFO] - Found 11 total parquet files
2025-01-28 09:01:05,876 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 09:01:05,877 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 09:01:10,383 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:01:11,041 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 09:01:12,662 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:01:13,430 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:01:14,103 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:01:14,722 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 09:01:15,104 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:01:18,022 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 09:01:18,026 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 09:01:18,031 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:01:18,035 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 09:01:18,036 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 09:01:18,339 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:01:18,523 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 09:01:18,961 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:01:19,349 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:01:19,543 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 09:01:19,856 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 09:01:20,119 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 09:01:20,434 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 09:01:20,771 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 09:01:21,226 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:01:21,595 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:01:21,847 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:01:22,160 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 09:01:22,485 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:01:23,475 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 09:01:24,726 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 09:01:24,732 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 09:01:24,736 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:01:24,740 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 09:01:24,745 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 09:01:24,750 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:01:24,755 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 09:01:24,760 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 09:01:24,765 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 09:01:24,773 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 09:01:24,774 - [INFO] - Successfully processed 2 dates
2025-01-28 09:01:24,777 - [INFO] - Starting client report loading process...
2025-01-28 09:01:24,873 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 09:01:24,962 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:01:25,356 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:01:25,574 - [INFO] - Archived 24 unique rows
2025-01-28 09:01:25,954 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 09:01:25,961 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 09:01:25,962 - [INFO] - - Archived rows: 24
2025-01-28 09:01:25,963 - [INFO] - - Loaded rows: 48
2025-01-28 09:01:25,964 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 09:01:25,973 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:01:25,980 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:01:26,025 - [ERROR] - Error storing invalid records: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 1, 25, 998670), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 1, 25, 998670)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:01:26,027 - [ERROR] - Error loading data: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 1, 25, 998670), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 1, 25, 998670)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:01:26,029 - [ERROR] - Error processing /app/output/task1_output_2022-05-27.csv: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 1, 25, 998670), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 1, 25, 998670)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:01:26,031 - [ERROR] - Processing or loading failed
2025-01-28 09:01:26,527 - [INFO] - Spark Session stopped
2025-01-28 09:02:03,051 - [INFO] - Starting application...
2025-01-28 09:02:03,196 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:02:08,982 - [INFO] - Spark Session created successfully
2025-01-28 09:02:08,984 - [INFO] - Spark version: 3.5.0
2025-01-28 09:02:08,985 - [INFO] - Spark master: local[*]
2025-01-28 09:02:08,986 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:02:08,987 - [INFO] - Starting file processing...
2025-01-28 09:02:08,988 - [INFO] - Input path: /app/raw_data
2025-01-28 09:02:08,989 - [INFO] - Output path: /app/output
2025-01-28 09:02:08,990 - [INFO] - User agent filter: some user agent
2025-01-28 09:02:08,994 - [WARNING] - No parquet files found in input directory
2025-01-28 09:02:08,994 - [ERROR] - Spark processing failed
2025-01-28 09:02:08,995 - [ERROR] - Processing or loading failed
2025-01-28 09:02:09,087 - [INFO] - Spark Session stopped
2025-01-28 09:03:01,686 - [INFO] - Starting application...
2025-01-28 09:03:01,722 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:03:05,115 - [INFO] - Spark Session created successfully
2025-01-28 09:03:05,117 - [INFO] - Spark version: 3.5.0
2025-01-28 09:03:05,117 - [INFO] - Spark master: local[*]
2025-01-28 09:03:05,118 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:03:05,119 - [INFO] - Starting file processing...
2025-01-28 09:03:05,120 - [INFO] - Input path: /app/raw_data
2025-01-28 09:03:05,120 - [INFO] - Output path: /app/output
2025-01-28 09:03:05,121 - [INFO] - User agent filter: some user agent
2025-01-28 09:03:05,122 - [WARNING] - No parquet files found in input directory
2025-01-28 09:03:05,123 - [ERROR] - Spark processing failed
2025-01-28 09:03:05,124 - [ERROR] - Processing or loading failed
2025-01-28 09:03:05,317 - [INFO] - Spark Session stopped
2025-01-28 09:04:01,895 - [INFO] - Starting application...
2025-01-28 09:04:01,929 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:04:05,235 - [INFO] - Spark Session created successfully
2025-01-28 09:04:05,237 - [INFO] - Spark version: 3.5.0
2025-01-28 09:04:05,238 - [INFO] - Spark master: local[*]
2025-01-28 09:04:05,239 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:04:05,240 - [INFO] - Starting file processing...
2025-01-28 09:04:05,241 - [INFO] - Input path: /app/raw_data
2025-01-28 09:04:05,242 - [INFO] - Output path: /app/output
2025-01-28 09:04:05,243 - [INFO] - User agent filter: some user agent
2025-01-28 09:04:05,244 - [WARNING] - No parquet files found in input directory
2025-01-28 09:04:05,245 - [ERROR] - Spark processing failed
2025-01-28 09:04:05,245 - [ERROR] - Processing or loading failed
2025-01-28 09:04:05,437 - [INFO] - Spark Session stopped
2025-01-28 09:05:02,000 - [INFO] - Starting application...
2025-01-28 09:05:02,035 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:05:05,243 - [INFO] - Spark Session created successfully
2025-01-28 09:05:05,245 - [INFO] - Spark version: 3.5.0
2025-01-28 09:05:05,246 - [INFO] - Spark master: local[*]
2025-01-28 09:05:05,247 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:05:05,248 - [INFO] - Starting file processing...
2025-01-28 09:05:05,249 - [INFO] - Input path: /app/raw_data
2025-01-28 09:05:05,250 - [INFO] - Output path: /app/output
2025-01-28 09:05:05,250 - [INFO] - User agent filter: some user agent
2025-01-28 09:05:05,251 - [WARNING] - No parquet files found in input directory
2025-01-28 09:05:05,252 - [ERROR] - Spark processing failed
2025-01-28 09:05:05,253 - [ERROR] - Processing or loading failed
2025-01-28 09:05:05,430 - [INFO] - Spark Session stopped
2025-01-28 09:06:01,985 - [INFO] - Starting application...
2025-01-28 09:06:02,018 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:06:05,150 - [INFO] - Spark Session created successfully
2025-01-28 09:06:05,151 - [INFO] - Spark version: 3.5.0
2025-01-28 09:06:05,152 - [INFO] - Spark master: local[*]
2025-01-28 09:06:05,153 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:06:05,154 - [INFO] - Starting file processing...
2025-01-28 09:06:05,155 - [INFO] - Input path: /app/raw_data
2025-01-28 09:06:05,155 - [INFO] - Output path: /app/output
2025-01-28 09:06:05,156 - [INFO] - User agent filter: some user agent
2025-01-28 09:06:05,157 - [WARNING] - No parquet files found in input directory
2025-01-28 09:06:05,158 - [ERROR] - Spark processing failed
2025-01-28 09:06:05,158 - [ERROR] - Processing or loading failed
2025-01-28 09:06:05,364 - [INFO] - Spark Session stopped
2025-01-28 09:07:01,947 - [INFO] - Starting application...
2025-01-28 09:07:01,985 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:07:05,135 - [INFO] - Spark Session created successfully
2025-01-28 09:07:05,137 - [INFO] - Spark version: 3.5.0
2025-01-28 09:07:05,138 - [INFO] - Spark master: local[*]
2025-01-28 09:07:05,139 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:07:05,140 - [INFO] - Starting file processing...
2025-01-28 09:07:05,141 - [INFO] - Input path: /app/raw_data
2025-01-28 09:07:05,142 - [INFO] - Output path: /app/output
2025-01-28 09:07:05,144 - [INFO] - User agent filter: some user agent
2025-01-28 09:07:05,145 - [WARNING] - No parquet files found in input directory
2025-01-28 09:07:05,146 - [ERROR] - Spark processing failed
2025-01-28 09:07:05,147 - [ERROR] - Processing or loading failed
2025-01-28 09:07:05,346 - [INFO] - Spark Session stopped
2025-01-28 09:08:01,884 - [INFO] - Starting application...
2025-01-28 09:08:01,917 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:08:05,242 - [INFO] - Spark Session created successfully
2025-01-28 09:08:05,244 - [INFO] - Spark version: 3.5.0
2025-01-28 09:08:05,245 - [INFO] - Spark master: local[*]
2025-01-28 09:08:05,246 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:08:05,247 - [INFO] - Starting file processing...
2025-01-28 09:08:05,248 - [INFO] - Input path: /app/raw_data
2025-01-28 09:08:05,249 - [INFO] - Output path: /app/output
2025-01-28 09:08:05,250 - [INFO] - User agent filter: some user agent
2025-01-28 09:08:05,251 - [WARNING] - No parquet files found in input directory
2025-01-28 09:08:05,252 - [ERROR] - Spark processing failed
2025-01-28 09:08:05,252 - [ERROR] - Processing or loading failed
2025-01-28 09:08:05,364 - [INFO] - Spark Session stopped
2025-01-28 09:09:01,956 - [INFO] - Starting application...
2025-01-28 09:09:01,989 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:09:04,964 - [INFO] - Spark Session created successfully
2025-01-28 09:09:04,965 - [INFO] - Spark version: 3.5.0
2025-01-28 09:09:04,966 - [INFO] - Spark master: local[*]
2025-01-28 09:09:04,967 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:09:04,968 - [INFO] - Starting file processing...
2025-01-28 09:09:04,969 - [INFO] - Input path: /app/raw_data
2025-01-28 09:09:04,970 - [INFO] - Output path: /app/output
2025-01-28 09:09:04,970 - [INFO] - User agent filter: some user agent
2025-01-28 09:09:04,971 - [WARNING] - No parquet files found in input directory
2025-01-28 09:09:04,972 - [ERROR] - Spark processing failed
2025-01-28 09:09:04,973 - [ERROR] - Processing or loading failed
2025-01-28 09:09:05,174 - [INFO] - Spark Session stopped
2025-01-28 09:10:01,750 - [INFO] - Starting application...
2025-01-28 09:10:01,790 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:10:04,941 - [INFO] - Spark Session created successfully
2025-01-28 09:10:04,943 - [INFO] - Spark version: 3.5.0
2025-01-28 09:10:04,944 - [INFO] - Spark master: local[*]
2025-01-28 09:10:04,945 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:10:04,947 - [INFO] - Starting file processing...
2025-01-28 09:10:04,948 - [INFO] - Input path: /app/raw_data
2025-01-28 09:10:04,949 - [INFO] - Output path: /app/output
2025-01-28 09:10:04,949 - [INFO] - User agent filter: some user agent
2025-01-28 09:10:04,951 - [WARNING] - No parquet files found in input directory
2025-01-28 09:10:04,952 - [ERROR] - Spark processing failed
2025-01-28 09:10:04,952 - [ERROR] - Processing or loading failed
2025-01-28 09:10:05,159 - [INFO] - Spark Session stopped
2025-01-28 09:11:01,757 - [INFO] - Starting application...
2025-01-28 09:11:01,790 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:11:05,031 - [INFO] - Spark Session created successfully
2025-01-28 09:11:05,033 - [INFO] - Spark version: 3.5.0
2025-01-28 09:11:05,034 - [INFO] - Spark master: local[*]
2025-01-28 09:11:05,035 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:11:05,036 - [INFO] - Starting file processing...
2025-01-28 09:11:05,037 - [INFO] - Input path: /app/raw_data
2025-01-28 09:11:05,038 - [INFO] - Output path: /app/output
2025-01-28 09:11:05,039 - [INFO] - User agent filter: some user agent
2025-01-28 09:11:05,040 - [WARNING] - No parquet files found in input directory
2025-01-28 09:11:05,041 - [ERROR] - Spark processing failed
2025-01-28 09:11:05,041 - [ERROR] - Processing or loading failed
2025-01-28 09:11:05,208 - [INFO] - Spark Session stopped
2025-01-28 09:12:01,744 - [INFO] - Starting application...
2025-01-28 09:12:01,781 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:12:05,065 - [INFO] - Spark Session created successfully
2025-01-28 09:12:05,067 - [INFO] - Spark version: 3.5.0
2025-01-28 09:12:05,068 - [INFO] - Spark master: local[*]
2025-01-28 09:12:05,069 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:12:05,070 - [INFO] - Starting file processing...
2025-01-28 09:12:05,071 - [INFO] - Input path: /app/raw_data
2025-01-28 09:12:05,072 - [INFO] - Output path: /app/output
2025-01-28 09:12:05,072 - [INFO] - User agent filter: some user agent
2025-01-28 09:12:05,073 - [WARNING] - No parquet files found in input directory
2025-01-28 09:12:05,074 - [ERROR] - Spark processing failed
2025-01-28 09:12:05,075 - [ERROR] - Processing or loading failed
2025-01-28 09:12:05,245 - [INFO] - Spark Session stopped
2025-01-28 09:13:01,809 - [INFO] - Starting application...
2025-01-28 09:13:01,848 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:13:05,170 - [INFO] - Spark Session created successfully
2025-01-28 09:13:05,172 - [INFO] - Spark version: 3.5.0
2025-01-28 09:13:05,173 - [INFO] - Spark master: local[*]
2025-01-28 09:13:05,174 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:13:05,175 - [INFO] - Starting file processing...
2025-01-28 09:13:05,176 - [INFO] - Input path: /app/raw_data
2025-01-28 09:13:05,177 - [INFO] - Output path: /app/output
2025-01-28 09:13:05,178 - [INFO] - User agent filter: some user agent
2025-01-28 09:13:05,179 - [WARNING] - No parquet files found in input directory
2025-01-28 09:13:05,180 - [ERROR] - Spark processing failed
2025-01-28 09:13:05,181 - [ERROR] - Processing or loading failed
2025-01-28 09:13:05,380 - [INFO] - Spark Session stopped
2025-01-28 09:14:21,842 - [INFO] - Starting application...
2025-01-28 09:14:21,894 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:14:24,968 - [INFO] - Spark Session created successfully
2025-01-28 09:14:24,970 - [INFO] - Spark version: 3.5.0
2025-01-28 09:14:24,971 - [INFO] - Spark master: local[*]
2025-01-28 09:14:24,971 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:14:24,972 - [INFO] - Starting file processing...
2025-01-28 09:14:24,973 - [INFO] - Input path: /app/raw_data
2025-01-28 09:14:24,974 - [INFO] - Output path: /app/output
2025-01-28 09:14:24,974 - [INFO] - User agent filter: some user agent
2025-01-28 09:14:25,008 - [INFO] - Found 11 total parquet files
2025-01-28 09:14:25,009 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 09:14:25,010 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 09:14:29,198 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:14:29,706 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 09:14:31,227 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:14:31,862 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:14:32,389 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:14:32,911 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 09:14:33,234 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:14:35,851 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 09:14:35,856 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 09:14:35,860 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:14:35,864 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 09:14:35,865 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 09:14:36,122 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:14:36,285 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 09:14:36,589 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:14:36,957 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:14:37,136 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 09:14:37,424 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 09:14:37,698 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 09:14:38,020 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 09:14:38,215 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 09:14:38,627 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:14:39,010 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:14:39,219 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:14:39,527 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 09:14:39,803 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:14:40,687 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 09:14:42,485 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 09:14:42,489 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 09:14:42,494 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:14:42,498 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 09:14:42,502 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 09:14:42,507 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:14:42,512 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 09:14:42,517 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 09:14:42,523 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 09:14:42,524 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 09:14:42,525 - [INFO] - Successfully processed 2 dates
2025-01-28 09:14:42,526 - [INFO] - Starting client report loading process...
2025-01-28 09:14:42,547 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 09:14:42,599 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:14:42,769 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:14:42,906 - [INFO] - Archived 0 unique rows
2025-01-28 09:14:43,113 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 09:14:43,120 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 09:14:43,121 - [INFO] - - Archived rows: 0
2025-01-28 09:14:43,122 - [INFO] - - Loaded rows: 48
2025-01-28 09:14:43,123 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 09:14:43,131 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:14:43,142 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:14:43,185 - [ERROR] - Error storing invalid records: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 14, 43, 155641), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 14, 43, 155641)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:14:43,186 - [ERROR] - Error loading data: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 14, 43, 155641), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 14, 43, 155641)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:14:43,187 - [ERROR] - Error processing /app/output/task1_output_2022-05-27.csv: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 14, 43, 155641), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 14, 43, 155641)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:14:43,190 - [ERROR] - Processing or loading failed
2025-01-28 09:14:43,730 - [INFO] - Spark Session stopped
2025-01-28 09:15:02,191 - [INFO] - Starting application...
2025-01-28 09:15:02,242 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:15:06,047 - [INFO] - Spark Session created successfully
2025-01-28 09:15:06,049 - [INFO] - Spark version: 3.5.0
2025-01-28 09:15:06,050 - [INFO] - Spark master: local[*]
2025-01-28 09:15:06,051 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:15:06,052 - [INFO] - Starting file processing...
2025-01-28 09:15:06,053 - [INFO] - Input path: /app/raw_data
2025-01-28 09:15:06,054 - [INFO] - Output path: /app/output
2025-01-28 09:15:06,054 - [INFO] - User agent filter: some user agent
2025-01-28 09:15:06,057 - [WARNING] - No parquet files found in input directory
2025-01-28 09:15:06,058 - [ERROR] - Spark processing failed
2025-01-28 09:15:06,059 - [ERROR] - Processing or loading failed
2025-01-28 09:15:06,224 - [INFO] - Spark Session stopped
2025-01-28 09:16:01,811 - [INFO] - Starting application...
2025-01-28 09:16:01,846 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:16:05,003 - [INFO] - Spark Session created successfully
2025-01-28 09:16:05,006 - [INFO] - Spark version: 3.5.0
2025-01-28 09:16:05,007 - [INFO] - Spark master: local[*]
2025-01-28 09:16:05,008 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:16:05,009 - [INFO] - Starting file processing...
2025-01-28 09:16:05,010 - [INFO] - Input path: /app/raw_data
2025-01-28 09:16:05,011 - [INFO] - Output path: /app/output
2025-01-28 09:16:05,012 - [INFO] - User agent filter: some user agent
2025-01-28 09:16:05,013 - [WARNING] - No parquet files found in input directory
2025-01-28 09:16:05,014 - [ERROR] - Spark processing failed
2025-01-28 09:16:05,015 - [ERROR] - Processing or loading failed
2025-01-28 09:16:05,183 - [INFO] - Spark Session stopped
2025-01-28 09:17:01,761 - [INFO] - Starting application...
2025-01-28 09:17:01,797 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:17:04,878 - [INFO] - Spark Session created successfully
2025-01-28 09:17:04,879 - [INFO] - Spark version: 3.5.0
2025-01-28 09:17:04,880 - [INFO] - Spark master: local[*]
2025-01-28 09:17:04,881 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:17:04,882 - [INFO] - Starting file processing...
2025-01-28 09:17:04,883 - [INFO] - Input path: /app/raw_data
2025-01-28 09:17:04,884 - [INFO] - Output path: /app/output
2025-01-28 09:17:04,884 - [INFO] - User agent filter: some user agent
2025-01-28 09:17:04,885 - [WARNING] - No parquet files found in input directory
2025-01-28 09:17:04,886 - [ERROR] - Spark processing failed
2025-01-28 09:17:04,886 - [ERROR] - Processing or loading failed
2025-01-28 09:17:05,071 - [INFO] - Spark Session stopped
2025-01-28 09:18:01,592 - [INFO] - Starting application...
2025-01-28 09:18:01,633 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:18:04,724 - [INFO] - Spark Session created successfully
2025-01-28 09:18:04,725 - [INFO] - Spark version: 3.5.0
2025-01-28 09:18:04,727 - [INFO] - Spark master: local[*]
2025-01-28 09:18:04,728 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:18:04,728 - [INFO] - Starting file processing...
2025-01-28 09:18:04,729 - [INFO] - Input path: /app/raw_data
2025-01-28 09:18:04,730 - [INFO] - Output path: /app/output
2025-01-28 09:18:04,731 - [INFO] - User agent filter: some user agent
2025-01-28 09:18:04,732 - [WARNING] - No parquet files found in input directory
2025-01-28 09:18:04,733 - [ERROR] - Spark processing failed
2025-01-28 09:18:04,734 - [ERROR] - Processing or loading failed
2025-01-28 09:18:04,939 - [INFO] - Spark Session stopped
2025-01-28 09:19:01,492 - [INFO] - Starting application...
2025-01-28 09:19:01,525 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:19:05,036 - [INFO] - Spark Session created successfully
2025-01-28 09:19:05,038 - [INFO] - Spark version: 3.5.0
2025-01-28 09:19:05,039 - [INFO] - Spark master: local[*]
2025-01-28 09:19:05,040 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:19:05,041 - [INFO] - Starting file processing...
2025-01-28 09:19:05,043 - [INFO] - Input path: /app/raw_data
2025-01-28 09:19:05,043 - [INFO] - Output path: /app/output
2025-01-28 09:19:05,044 - [INFO] - User agent filter: some user agent
2025-01-28 09:19:05,046 - [WARNING] - No parquet files found in input directory
2025-01-28 09:19:05,047 - [ERROR] - Spark processing failed
2025-01-28 09:19:05,048 - [ERROR] - Processing or loading failed
2025-01-28 09:19:05,212 - [INFO] - Spark Session stopped
2025-01-28 09:20:01,785 - [INFO] - Starting application...
2025-01-28 09:20:01,818 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:20:05,138 - [INFO] - Spark Session created successfully
2025-01-28 09:20:05,139 - [INFO] - Spark version: 3.5.0
2025-01-28 09:20:05,140 - [INFO] - Spark master: local[*]
2025-01-28 09:20:05,141 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:20:05,141 - [INFO] - Starting file processing...
2025-01-28 09:20:05,142 - [INFO] - Input path: /app/raw_data
2025-01-28 09:20:05,143 - [INFO] - Output path: /app/output
2025-01-28 09:20:05,144 - [INFO] - User agent filter: some user agent
2025-01-28 09:20:05,145 - [WARNING] - No parquet files found in input directory
2025-01-28 09:20:05,153 - [ERROR] - Spark processing failed
2025-01-28 09:20:05,154 - [ERROR] - Processing or loading failed
2025-01-28 09:20:05,329 - [INFO] - Spark Session stopped
2025-01-28 09:21:01,976 - [INFO] - Starting application...
2025-01-28 09:21:02,012 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:21:05,501 - [INFO] - Spark Session created successfully
2025-01-28 09:21:05,503 - [INFO] - Spark version: 3.5.0
2025-01-28 09:21:05,504 - [INFO] - Spark master: local[*]
2025-01-28 09:21:05,505 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:21:05,506 - [INFO] - Starting file processing...
2025-01-28 09:21:05,506 - [INFO] - Input path: /app/raw_data
2025-01-28 09:21:05,507 - [INFO] - Output path: /app/output
2025-01-28 09:21:05,508 - [INFO] - User agent filter: some user agent
2025-01-28 09:21:05,509 - [WARNING] - No parquet files found in input directory
2025-01-28 09:21:05,510 - [ERROR] - Spark processing failed
2025-01-28 09:21:05,511 - [ERROR] - Processing or loading failed
2025-01-28 09:21:05,679 - [INFO] - Spark Session stopped
2025-01-28 09:22:02,249 - [INFO] - Starting application...
2025-01-28 09:22:02,283 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:22:05,465 - [INFO] - Spark Session created successfully
2025-01-28 09:22:05,466 - [INFO] - Spark version: 3.5.0
2025-01-28 09:22:05,467 - [INFO] - Spark master: local[*]
2025-01-28 09:22:05,468 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:22:05,470 - [INFO] - Starting file processing...
2025-01-28 09:22:05,471 - [INFO] - Input path: /app/raw_data
2025-01-28 09:22:05,472 - [INFO] - Output path: /app/output
2025-01-28 09:22:05,472 - [INFO] - User agent filter: some user agent
2025-01-28 09:22:05,473 - [WARNING] - No parquet files found in input directory
2025-01-28 09:22:05,475 - [ERROR] - Spark processing failed
2025-01-28 09:22:05,475 - [ERROR] - Processing or loading failed
2025-01-28 09:22:05,663 - [INFO] - Spark Session stopped
2025-01-28 09:23:28,503 - [INFO] - Starting application...
2025-01-28 09:23:28,553 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:23:31,691 - [INFO] - Spark Session created successfully
2025-01-28 09:23:31,692 - [INFO] - Spark version: 3.5.0
2025-01-28 09:23:31,693 - [INFO] - Spark master: local[*]
2025-01-28 09:23:31,693 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:23:31,695 - [INFO] - Starting file processing...
2025-01-28 09:23:31,695 - [INFO] - Input path: /app/raw_data
2025-01-28 09:23:31,695 - [INFO] - Output path: /app/output
2025-01-28 09:23:31,696 - [INFO] - User agent filter: some user agent
2025-01-28 09:23:31,719 - [INFO] - Found 11 total parquet files
2025-01-28 09:23:31,720 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 09:23:31,720 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 09:23:35,942 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:23:36,424 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 09:23:37,998 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:23:38,613 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:23:39,170 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:23:39,770 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 09:23:40,112 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:23:42,712 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 09:23:42,716 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 09:23:42,719 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:23:42,723 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 09:23:42,723 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 09:23:42,978 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:23:43,114 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 09:23:43,431 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:23:43,789 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:23:43,988 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 09:23:44,314 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 09:23:44,560 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 09:23:44,840 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 09:23:45,027 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 09:23:45,418 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:23:45,774 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:23:46,008 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:23:46,312 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 09:23:46,593 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:23:47,781 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 09:23:49,281 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 09:23:49,285 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 09:23:49,289 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:23:49,293 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 09:23:49,297 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 09:23:49,302 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:23:49,307 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 09:23:49,311 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 09:23:49,315 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 09:23:49,315 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 09:23:49,316 - [INFO] - Successfully processed 2 dates
2025-01-28 09:23:49,317 - [INFO] - Starting client report loading process...
2025-01-28 09:23:49,330 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 09:23:49,369 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:23:49,558 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:23:49,666 - [INFO] - Archived 0 unique rows
2025-01-28 09:23:49,871 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 09:23:49,878 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 09:23:49,879 - [INFO] - - Archived rows: 0
2025-01-28 09:23:49,880 - [INFO] - - Loaded rows: 48
2025-01-28 09:23:49,881 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 09:23:49,890 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:23:49,898 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:23:49,940 - [ERROR] - Error storing invalid records: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 23, 49, 911156), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 23, 49, 911156)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:23:49,941 - [ERROR] - Error loading data: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 23, 49, 911156), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 23, 49, 911156)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:23:49,943 - [ERROR] - Error processing /app/output/task1_output_2022-05-27.csv: (psycopg2.errors.UniqueViolation) duplicate key value violates unique constraint "client_report_invalid_pkey"
DETAIL:  Key (datetime, source_file)=(2022-05-27 11:00:00, /app/output/task1_output_2022-05-27.csv) already exists.

[SQL: INSERT INTO adform_dw.client_report_invalid (datetime, impression_count, click_count, validation_error, source_file, audit_loaded_datetime) VALUES (%(datetime_m0)s, %(impression_count_m0)s, %(click_count_m0)s, %(validation_error_m0)s, %(source_file_m0)s, %(audit_loaded_datetime_m0)s), (%(datetime_m1)s, %(impression_count_m1)s, %(click_count_m1)s, %(validation_error_m1)s, %(source_file_m1)s, %(audit_loaded_datetime_m1)s)]
[parameters: {'datetime_m0': datetime.datetime(2022, 5, 27, 11, 0), 'impression_count_m0': 0, 'click_count_m0': 10, 'validation_error_m0': 'clicks_without_impressions', 'source_file_m0': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m0': datetime.datetime(2025, 1, 28, 9, 23, 49, 911156), 'datetime_m1': datetime.datetime(2022, 5, 27, 12, 0), 'impression_count_m1': 10, 'click_count_m1': 20, 'validation_error_m1': 'clicks_exceed_impressions', 'source_file_m1': '/app/output/task1_output_2022-05-27.csv', 'audit_loaded_datetime_m1': datetime.datetime(2025, 1, 28, 9, 23, 49, 911156)}]
(Background on this error at: https://sqlalche.me/e/14/gkpj)
2025-01-28 09:23:49,943 - [ERROR] - Processing or loading failed
2025-01-28 09:23:50,800 - [INFO] - Spark Session stopped
2025-01-28 09:24:01,671 - [INFO] - Starting application...
2025-01-28 09:24:01,717 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:24:06,539 - [INFO] - Spark Session created successfully
2025-01-28 09:24:06,541 - [INFO] - Spark version: 3.5.0
2025-01-28 09:24:06,542 - [INFO] - Spark master: local[*]
2025-01-28 09:24:06,543 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:24:06,544 - [INFO] - Starting file processing...
2025-01-28 09:24:06,545 - [INFO] - Input path: /app/raw_data
2025-01-28 09:24:06,546 - [INFO] - Output path: /app/output
2025-01-28 09:24:06,546 - [INFO] - User agent filter: some user agent
2025-01-28 09:24:06,550 - [WARNING] - No parquet files found in input directory
2025-01-28 09:24:06,550 - [ERROR] - Spark processing failed
2025-01-28 09:24:06,551 - [ERROR] - Processing or loading failed
2025-01-28 09:24:06,703 - [INFO] - Spark Session stopped
2025-01-28 09:28:00,430 - [INFO] - Starting application...
2025-01-28 09:28:00,543 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:28:02,081 - [INFO] - Starting application...
2025-01-28 09:28:02,121 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:28:06,133 - [INFO] - Spark Session created successfully
2025-01-28 09:28:06,138 - [INFO] - Spark version: 3.5.0
2025-01-28 09:28:06,139 - [INFO] - Spark master: local[*]
2025-01-28 09:28:06,140 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:28:06,142 - [INFO] - Starting file processing...
2025-01-28 09:28:06,143 - [INFO] - Input path: /app/raw_data
2025-01-28 09:28:06,144 - [INFO] - Output path: /app/output
2025-01-28 09:28:06,145 - [INFO] - User agent filter: some user agent
2025-01-28 09:28:06,252 - [INFO] - Found 11 total parquet files
2025-01-28 09:28:06,253 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 09:28:06,253 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 09:28:06,308 - [INFO] - Spark Session created successfully
2025-01-28 09:28:06,311 - [INFO] - Spark version: 3.5.0
2025-01-28 09:28:06,312 - [INFO] - Spark master: local[*]
2025-01-28 09:28:06,313 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:28:06,315 - [INFO] - Starting file processing...
2025-01-28 09:28:06,317 - [INFO] - Input path: /app/raw_data
2025-01-28 09:28:06,318 - [INFO] - Output path: /app/output
2025-01-28 09:28:06,320 - [INFO] - User agent filter: some user agent
2025-01-28 09:28:06,327 - [INFO] - Found 11 total parquet files
2025-01-28 09:28:06,329 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 09:28:06,331 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 09:28:12,681 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:28:12,754 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:28:13,508 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 09:28:13,599 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 09:28:16,016 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:28:16,031 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:28:17,090 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:28:17,122 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:28:18,047 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:28:18,065 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:28:19,091 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 09:28:19,114 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 09:28:19,723 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:28:19,796 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:28:26,324 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 09:28:26,330 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 09:28:26,335 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:28:26,341 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 09:28:26,344 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 09:28:26,385 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 09:28:26,402 - [ERROR] - Error removing file impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet: [Errno 2] No such file or directory: '/app/raw_data/impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet'
2025-01-28 09:28:26,405 - [ERROR] - Error removing file impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet: [Errno 2] No such file or directory: '/app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet'
2025-01-28 09:28:26,413 - [ERROR] - Error removing file impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet: [Errno 2] No such file or directory: '/app/raw_data/impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet'
2025-01-28 09:28:26,414 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 09:28:27,125 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:28:27,252 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:28:27,403 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 09:28:27,678 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 09:28:28,172 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:28:28,858 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:28:29,834 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:28:31,019 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 09:28:32,167 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:28:34,523 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 09:28:35,050 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 09:28:37,490 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 09:28:38,041 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 09:28:43,236 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 09:28:43,502 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 09:28:44,288 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 09:28:46,876 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 09:29:04,088 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 09:29:33,491 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:29:34,349 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:29:43,163 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:29:43,279 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:30:01,005 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:30:04,945 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:40:14,110 - [INFO] - Starting application...
2025-01-28 09:40:14,199 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:40:18,280 - [INFO] - Spark Session created successfully
2025-01-28 09:40:18,281 - [INFO] - Spark version: 3.5.0
2025-01-28 09:40:18,282 - [INFO] - Spark master: local[*]
2025-01-28 09:40:18,282 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:40:18,283 - [INFO] - Starting file processing...
2025-01-28 09:40:18,283 - [INFO] - Input path: /app/raw_data
2025-01-28 09:40:18,284 - [INFO] - Output path: /app/output
2025-01-28 09:40:18,284 - [INFO] - User agent filter: some user agent
2025-01-28 09:40:18,373 - [INFO] - Found 8 total parquet files
2025-01-28 09:40:18,373 - [INFO] - Impressions files by date: 2022-05-27
2025-01-28 09:40:18,374 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 09:40:22,602 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:40:23,072 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 09:40:24,612 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:40:25,339 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:40:25,890 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 09:40:26,442 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 09:40:26,837 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 09:40:27,249 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 09:40:27,516 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 09:40:28,145 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:40:28,737 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:40:29,082 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:40:29,511 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 09:40:29,851 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:40:32,929 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 09:40:34,172 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 09:40:34,179 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 09:40:34,184 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:40:34,189 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 09:40:34,193 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 09:40:34,198 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:40:34,202 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 09:40:34,206 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 09:40:34,212 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 09:40:34,213 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 09:40:34,213 - [INFO] - Successfully processed 1 dates
2025-01-28 09:40:34,214 - [INFO] - Starting client report loading process...
2025-01-28 09:40:34,234 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 09:40:34,247 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:40:34,272 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:40:34,283 - [INFO] - Archived 0 unique rows
2025-01-28 09:40:34,306 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 09:40:34,309 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 09:40:34,310 - [INFO] - - Archived rows: 0
2025-01-28 09:40:34,310 - [INFO] - - Loaded rows: 48
2025-01-28 09:40:34,311 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 09:40:34,318 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:40:34,325 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:40:34,328 - [INFO] - Archived 24 unique rows
2025-01-28 09:40:34,334 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 09:40:34,337 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 09:40:34,337 - [INFO] - - Archived rows: 24
2025-01-28 09:40:34,338 - [INFO] - - Loaded rows: 48
2025-01-28 09:40:34,339 - [INFO] - 
Verifying data load...
2025-01-28 09:40:34,345 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 09:40:34,346 - [INFO] - 
Load Summary:
2025-01-28 09:40:34,347 - [INFO] - Total files processed: 2
2025-01-28 09:40:34,347 - [INFO] - Total rows loaded: 96
2025-01-28 09:40:34,348 - [INFO] - 
Date Range:
2025-01-28 09:40:34,349 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 09:40:34,349 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 09:40:34,350 - [INFO] - 
Total Counts:
2025-01-28 09:40:34,351 - [INFO] -   Impressions: 24
2025-01-28 09:40:34,351 - [INFO] -   Clicks: 30
2025-01-28 09:40:34,352 - [INFO] - 
Client report loading completed successfully
2025-01-28 09:40:34,353 - [INFO] - Processing and loading completed successfully
2025-01-28 09:40:34,959 - [INFO] - Spark Session stopped
2025-01-28 09:41:05,831 - [INFO] - Starting application...
2025-01-28 09:41:05,993 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:41:16,162 - [INFO] - Spark Session created successfully
2025-01-28 09:41:16,163 - [INFO] - Spark version: 3.5.0
2025-01-28 09:41:16,165 - [INFO] - Spark master: local[*]
2025-01-28 09:41:16,166 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:41:16,167 - [INFO] - Starting file processing...
2025-01-28 09:41:16,168 - [INFO] - Input path: /app/raw_data
2025-01-28 09:41:16,170 - [INFO] - Output path: /app/output
2025-01-28 09:41:16,171 - [INFO] - User agent filter: some user agent
2025-01-28 09:41:16,175 - [WARNING] - No parquet files found in input directory
2025-01-28 09:41:16,176 - [ERROR] - Spark processing failed
2025-01-28 09:41:16,177 - [ERROR] - Processing or loading failed
2025-01-28 09:41:16,285 - [INFO] - Spark Session stopped
2025-01-28 09:42:03,423 - [INFO] - Starting application...
2025-01-28 09:42:03,602 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:42:16,545 - [INFO] - Spark Session created successfully
2025-01-28 09:42:16,551 - [INFO] - Spark version: 3.5.0
2025-01-28 09:42:16,558 - [INFO] - Spark master: local[*]
2025-01-28 09:42:16,562 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:42:16,566 - [INFO] - Starting file processing...
2025-01-28 09:42:16,570 - [INFO] - Input path: /app/raw_data
2025-01-28 09:42:16,573 - [INFO] - Output path: /app/output
2025-01-28 09:42:16,576 - [INFO] - User agent filter: some user agent
2025-01-28 09:42:16,581 - [WARNING] - No parquet files found in input directory
2025-01-28 09:42:16,586 - [ERROR] - Spark processing failed
2025-01-28 09:42:16,591 - [ERROR] - Processing or loading failed
2025-01-28 09:42:17,088 - [INFO] - Spark Session stopped
2025-01-28 09:43:04,872 - [INFO] - Starting application...
2025-01-28 09:43:05,091 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:43:14,511 - [INFO] - Spark Session created successfully
2025-01-28 09:43:14,513 - [INFO] - Spark version: 3.5.0
2025-01-28 09:43:14,515 - [INFO] - Spark master: local[*]
2025-01-28 09:43:14,516 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:43:14,517 - [INFO] - Starting file processing...
2025-01-28 09:43:14,519 - [INFO] - Input path: /app/raw_data
2025-01-28 09:43:14,520 - [INFO] - Output path: /app/output
2025-01-28 09:43:14,521 - [INFO] - User agent filter: some user agent
2025-01-28 09:43:14,523 - [WARNING] - No parquet files found in input directory
2025-01-28 09:43:14,524 - [ERROR] - Spark processing failed
2025-01-28 09:43:14,525 - [ERROR] - Processing or loading failed
2025-01-28 09:43:15,041 - [INFO] - Spark Session stopped
2025-01-28 09:44:02,218 - [INFO] - Starting application...
2025-01-28 09:44:02,292 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:44:06,817 - [INFO] - Spark Session created successfully
2025-01-28 09:44:06,819 - [INFO] - Spark version: 3.5.0
2025-01-28 09:44:06,820 - [INFO] - Spark master: local[*]
2025-01-28 09:44:06,821 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:44:06,822 - [INFO] - Starting file processing...
2025-01-28 09:44:06,823 - [INFO] - Input path: /app/raw_data
2025-01-28 09:44:06,824 - [INFO] - Output path: /app/output
2025-01-28 09:44:06,825 - [INFO] - User agent filter: some user agent
2025-01-28 09:44:06,826 - [WARNING] - No parquet files found in input directory
2025-01-28 09:44:06,827 - [ERROR] - Spark processing failed
2025-01-28 09:44:06,828 - [ERROR] - Processing or loading failed
2025-01-28 09:44:06,977 - [INFO] - Spark Session stopped
2025-01-28 09:45:01,576 - [INFO] - Starting application...
2025-01-28 09:45:01,614 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:45:05,091 - [INFO] - Spark Session created successfully
2025-01-28 09:45:05,093 - [INFO] - Spark version: 3.5.0
2025-01-28 09:45:05,094 - [INFO] - Spark master: local[*]
2025-01-28 09:45:05,095 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:45:05,096 - [INFO] - Starting file processing...
2025-01-28 09:45:05,097 - [INFO] - Input path: /app/raw_data
2025-01-28 09:45:05,098 - [INFO] - Output path: /app/output
2025-01-28 09:45:05,099 - [INFO] - User agent filter: some user agent
2025-01-28 09:45:05,100 - [WARNING] - No parquet files found in input directory
2025-01-28 09:45:05,101 - [ERROR] - Spark processing failed
2025-01-28 09:45:05,101 - [ERROR] - Processing or loading failed
2025-01-28 09:45:05,243 - [INFO] - Spark Session stopped
2025-01-28 09:46:01,830 - [INFO] - Starting application...
2025-01-28 09:46:01,866 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:46:05,111 - [INFO] - Spark Session created successfully
2025-01-28 09:46:05,113 - [INFO] - Spark version: 3.5.0
2025-01-28 09:46:05,114 - [INFO] - Spark master: local[*]
2025-01-28 09:46:05,115 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:46:05,116 - [INFO] - Starting file processing...
2025-01-28 09:46:05,117 - [INFO] - Input path: /app/raw_data
2025-01-28 09:46:05,117 - [INFO] - Output path: /app/output
2025-01-28 09:46:05,118 - [INFO] - User agent filter: some user agent
2025-01-28 09:46:05,119 - [WARNING] - No parquet files found in input directory
2025-01-28 09:46:05,120 - [ERROR] - Spark processing failed
2025-01-28 09:46:05,120 - [ERROR] - Processing or loading failed
2025-01-28 09:46:05,290 - [INFO] - Spark Session stopped
2025-01-28 09:47:01,839 - [INFO] - Starting application...
2025-01-28 09:47:01,873 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:47:04,866 - [INFO] - Spark Session created successfully
2025-01-28 09:47:04,868 - [INFO] - Spark version: 3.5.0
2025-01-28 09:47:04,869 - [INFO] - Spark master: local[*]
2025-01-28 09:47:04,870 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:47:04,871 - [INFO] - Starting file processing...
2025-01-28 09:47:04,872 - [INFO] - Input path: /app/raw_data
2025-01-28 09:47:04,873 - [INFO] - Output path: /app/output
2025-01-28 09:47:04,874 - [INFO] - User agent filter: some user agent
2025-01-28 09:47:04,895 - [INFO] - Found 11 total parquet files
2025-01-28 09:47:04,896 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 09:47:04,898 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 09:47:09,060 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:47:09,580 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 09:47:11,187 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:47:11,868 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:47:12,450 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:47:13,080 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 09:47:13,418 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 09:47:16,192 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 09:47:16,196 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 09:47:16,201 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 09:47:16,206 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 09:47:16,207 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 09:47:16,477 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 09:47:16,616 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 09:47:16,965 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:47:17,291 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:47:17,442 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 09:47:17,699 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 09:47:17,955 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 09:47:18,249 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 09:47:18,441 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 09:47:18,839 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:47:19,228 - [INFO] - Found 0 records with invalid hours
2025-01-28 09:47:19,418 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:47:19,697 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 09:47:19,978 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 09:47:20,830 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 09:47:21,710 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 09:47:21,714 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 09:47:21,719 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 09:47:21,723 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 09:47:21,728 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 09:47:21,732 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 09:47:21,737 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 09:47:21,741 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 09:47:21,746 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 09:47:21,747 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 09:47:21,749 - [INFO] - Successfully processed 2 dates
2025-01-28 09:47:21,750 - [INFO] - Starting client report loading process...
2025-01-28 09:47:21,766 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 09:47:21,803 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:47:21,942 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:47:22,025 - [INFO] - Archived 0 unique rows
2025-01-28 09:47:22,175 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 09:47:22,181 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 09:47:22,183 - [INFO] - - Archived rows: 0
2025-01-28 09:47:22,184 - [INFO] - - Loaded rows: 48
2025-01-28 09:47:22,185 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 09:47:22,191 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 09:47:22,197 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 09:47:22,200 - [INFO] - Archived 0 unique rows
2025-01-28 09:47:22,206 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 09:47:22,211 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 09:47:22,212 - [INFO] - - Archived rows: 0
2025-01-28 09:47:22,213 - [INFO] - - Loaded rows: 48
2025-01-28 09:47:22,214 - [INFO] - 
Verifying data load...
2025-01-28 09:47:22,218 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 09:47:22,219 - [INFO] - 
Load Summary:
2025-01-28 09:47:22,220 - [INFO] - Total files processed: 2
2025-01-28 09:47:22,221 - [INFO] - Total rows loaded: 96
2025-01-28 09:47:22,221 - [INFO] - 
Date Range:
2025-01-28 09:47:22,222 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 09:47:22,223 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 09:47:22,224 - [INFO] - 
Total Counts:
2025-01-28 09:47:22,224 - [INFO] -   Impressions: 24
2025-01-28 09:47:22,225 - [INFO] -   Clicks: 30
2025-01-28 09:47:22,226 - [INFO] - 
Client report loading completed successfully
2025-01-28 09:47:22,226 - [INFO] - Processing and loading completed successfully
2025-01-28 09:47:22,876 - [INFO] - Spark Session stopped
2025-01-28 09:48:01,946 - [INFO] - Starting application...
2025-01-28 09:48:01,999 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:48:06,883 - [INFO] - Spark Session created successfully
2025-01-28 09:48:06,885 - [INFO] - Spark version: 3.5.0
2025-01-28 09:48:06,886 - [INFO] - Spark master: local[*]
2025-01-28 09:48:06,888 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:48:06,889 - [INFO] - Starting file processing...
2025-01-28 09:48:06,890 - [INFO] - Input path: /app/raw_data
2025-01-28 09:48:06,891 - [INFO] - Output path: /app/output
2025-01-28 09:48:06,891 - [INFO] - User agent filter: some user agent
2025-01-28 09:48:06,896 - [WARNING] - No parquet files found in input directory
2025-01-28 09:48:06,897 - [ERROR] - Spark processing failed
2025-01-28 09:48:06,898 - [ERROR] - Processing or loading failed
2025-01-28 09:48:07,158 - [INFO] - Spark Session stopped
2025-01-28 09:49:01,806 - [INFO] - Starting application...
2025-01-28 09:49:01,841 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:49:05,188 - [INFO] - Spark Session created successfully
2025-01-28 09:49:05,189 - [INFO] - Spark version: 3.5.0
2025-01-28 09:49:05,190 - [INFO] - Spark master: local[*]
2025-01-28 09:49:05,191 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:49:05,192 - [INFO] - Starting file processing...
2025-01-28 09:49:05,193 - [INFO] - Input path: /app/raw_data
2025-01-28 09:49:05,194 - [INFO] - Output path: /app/output
2025-01-28 09:49:05,194 - [INFO] - User agent filter: some user agent
2025-01-28 09:49:05,195 - [WARNING] - No parquet files found in input directory
2025-01-28 09:49:05,196 - [ERROR] - Spark processing failed
2025-01-28 09:49:05,197 - [ERROR] - Processing or loading failed
2025-01-28 09:49:05,361 - [INFO] - Spark Session stopped
2025-01-28 09:50:01,872 - [INFO] - Starting application...
2025-01-28 09:50:01,910 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 09:50:05,765 - [INFO] - Spark Session created successfully
2025-01-28 09:50:05,767 - [INFO] - Spark version: 3.5.0
2025-01-28 09:50:05,768 - [INFO] - Spark master: local[*]
2025-01-28 09:50:05,769 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 09:50:05,771 - [INFO] - Starting file processing...
2025-01-28 09:50:05,772 - [INFO] - Input path: /app/raw_data
2025-01-28 09:50:05,773 - [INFO] - Output path: /app/output
2025-01-28 09:50:05,774 - [INFO] - User agent filter: some user agent
2025-01-28 09:50:05,775 - [WARNING] - No parquet files found in input directory
2025-01-28 09:50:05,776 - [ERROR] - Spark processing failed
2025-01-28 09:50:05,777 - [ERROR] - Processing or loading failed
2025-01-28 09:50:05,923 - [INFO] - Spark Session stopped
2025-01-28 12:18:36,606 - [INFO] - Starting application...
2025-01-28 12:18:39,468 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Unknown host

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 12:19:17,934 - [INFO] - Starting application...
2025-01-28 12:19:17,998 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:19:53,398 - [INFO] - Spark Session created successfully
2025-01-28 12:19:53,398 - [INFO] - Starting file processing...
2025-01-28 12:19:53,398 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 12:19:53,398 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 12:19:53,398 - [INFO] - User agent filter: some user agent
2025-01-28 12:19:53,399 - [INFO] - Found 11 total parquet files
2025-01-28 12:19:53,400 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:19:53,400 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:19:59,499 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:19:59,981 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:20:01,867 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:20:02,364 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:20:02,837 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:20:03,251 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:20:03,567 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:20:03,568 - [ERROR] - Error in _combine_and_fill_hours: 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:20:03,569 - [ERROR] - Error processing files for date '2022-05-26': 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:20:03,569 - [WARNING] - Failed to process data for date: 2022-05-26 - 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:20:03,964 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:20:04,165 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:20:05,349 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:20:05,651 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:20:05,975 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:20:06,187 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:20:06,366 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:20:06,714 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:20:06,899 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:20:08,412 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:20:08,708 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:20:08,927 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:20:09,220 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:20:09,413 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:20:09,413 - [ERROR] - Error in _combine_and_fill_hours: 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:20:09,414 - [ERROR] - Error processing files for date '2022-05-27': 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:20:09,414 - [WARNING] - Failed to process data for date: 2022-05-27 - 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:20:09,414 - [ERROR] - No dates were successfully processed
2025-01-28 12:20:09,414 - [ERROR] - Spark processing failed
2025-01-28 12:20:09,415 - [ERROR] - Processing or loading failed
2025-01-28 12:20:10,313 - [INFO] - Spark Session stopped
2025-01-28 12:22:31,122 - [INFO] - Starting application...
2025-01-28 12:22:31,187 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:22:57,538 - [INFO] - Spark Session created successfully
2025-01-28 12:22:57,538 - [INFO] - Starting file processing...
2025-01-28 12:22:57,538 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 12:22:57,538 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 12:22:57,539 - [INFO] - User agent filter: some user agent
2025-01-28 12:22:57,540 - [INFO] - Found 11 total parquet files
2025-01-28 12:22:57,540 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:22:57,540 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:23:03,624 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:23:04,153 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:23:06,105 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:23:06,637 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:23:07,049 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:23:07,511 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:23:07,777 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:23:07,777 - [ERROR] - Error in _combine_and_fill_hours: 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:23:07,777 - [ERROR] - Error processing files for date '2022-05-26': 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:23:07,777 - [WARNING] - Failed to process data for date: 2022-05-26 - 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:23:08,127 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:23:08,305 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:23:09,561 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:23:09,923 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:23:10,204 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:23:10,461 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:23:10,671 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:23:10,965 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:23:11,146 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:23:12,657 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:23:12,942 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:23:13,228 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:23:13,461 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:23:13,655 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:23:13,655 - [ERROR] - Error in _combine_and_fill_hours: 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:23:13,656 - [ERROR] - Error processing files for date '2022-05-27': 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:23:13,656 - [WARNING] - Failed to process data for date: 2022-05-27 - 'DataProcessor' object has no attribute 'spark'
2025-01-28 12:23:13,656 - [ERROR] - No dates were successfully processed
2025-01-28 12:23:13,656 - [ERROR] - Spark processing failed
2025-01-28 12:23:13,657 - [ERROR] - Processing or loading failed
2025-01-28 12:23:14,581 - [INFO] - Spark Session stopped
2025-01-28 12:28:04,587 - [INFO] - Starting application...
2025-01-28 12:28:04,653 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:28:30,668 - [INFO] - Spark Session created successfully
2025-01-28 12:28:30,668 - [INFO] - Starting file processing...
2025-01-28 12:28:30,669 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 12:28:30,669 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 12:28:30,669 - [INFO] - User agent filter: some user agent
2025-01-28 12:28:30,670 - [INFO] - Found 11 total parquet files
2025-01-28 12:28:30,670 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:28:30,670 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:28:36,262 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:28:36,725 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:28:38,519 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:28:39,004 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:28:39,509 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:28:39,915 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:28:40,179 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:28:45,406 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 12:28:45,407 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:28:45,407 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:28:45,408 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:28:45,408 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:28:45,732 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:28:45,880 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:28:47,076 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:28:47,337 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:28:47,537 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:28:47,751 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:28:47,912 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:28:48,203 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:28:48,365 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:28:49,846 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:28:50,114 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:28:50,312 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:28:50,550 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:28:50,720 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:28:54,792 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 12:28:55,491 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 12:28:55,492 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:28:55,492 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:28:55,493 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:28:55,494 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:28:55,495 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:28:55,495 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:28:55,496 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:28:55,497 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:28:55,497 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:28:55,498 - [INFO] - Successfully processed 2 dates
2025-01-28 12:28:55,498 - [INFO] - Starting client report loading process...
2025-01-28 12:28:55,499 - [ERROR] - Error in load_data: 'ClientReportETL' object has no attribute 'logger'
2025-01-28 12:28:55,499 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv: 'ClientReportETL' object has no attribute 'logger'
2025-01-28 12:28:55,499 - [ERROR] - Processing or loading failed
2025-01-28 12:28:55,782 - [INFO] - Spark Session stopped
2025-01-28 12:31:51,274 - [INFO] - Starting application...
2025-01-28 12:31:51,337 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:32:17,336 - [INFO] - Spark Session created successfully
2025-01-28 12:32:17,336 - [INFO] - Starting file processing...
2025-01-28 12:32:17,337 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 12:32:17,337 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 12:32:17,337 - [INFO] - User agent filter: some user agent
2025-01-28 12:32:17,338 - [INFO] - Found 11 total parquet files
2025-01-28 12:32:17,338 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:32:17,339 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:32:22,654 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:32:23,157 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:32:24,981 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:32:25,561 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:32:25,997 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:32:26,379 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:32:26,628 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:32:31,636 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 12:32:31,637 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:32:31,638 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:32:31,638 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:32:31,639 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:32:31,938 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:32:32,080 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:32:33,252 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:32:33,532 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:32:33,719 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:32:33,933 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:32:34,141 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:32:34,383 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:32:34,561 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:32:36,000 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:32:36,254 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:32:36,430 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:32:36,653 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:32:36,821 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:32:40,913 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 12:32:41,699 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 12:32:41,699 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:32:41,700 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:32:41,700 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:32:41,701 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:32:41,702 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:32:41,702 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:32:41,702 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:32:41,704 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:32:41,704 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:32:41,704 - [INFO] - Successfully processed 2 dates
2025-01-28 12:32:41,705 - [INFO] - Starting client report loading process...
2025-01-28 12:32:41,705 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 12:32:41,708 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:32:41,723 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:32:41,729 - [INFO] - Archived 0 unique rows
2025-01-28 12:32:41,746 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:32:41,751 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 12:32:41,752 - [INFO] - - Archived rows: 0
2025-01-28 12:32:41,752 - [INFO] - - Loaded rows: 48
2025-01-28 12:32:41,752 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 12:32:41,755 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:32:41,763 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:32:41,767 - [INFO] - Archived 0 unique rows
2025-01-28 12:32:41,777 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:32:41,782 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 12:32:41,782 - [INFO] - - Archived rows: 0
2025-01-28 12:32:41,783 - [INFO] - - Loaded rows: 48
2025-01-28 12:32:41,783 - [INFO] - 
Verifying data load...
2025-01-28 12:32:41,789 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:32:41,791 - [INFO] - 
Load Summary:
2025-01-28 12:32:41,791 - [INFO] - Total files processed: 2
2025-01-28 12:32:41,791 - [INFO] - Total rows loaded: 96
2025-01-28 12:32:41,791 - [INFO] - 
Date Range:
2025-01-28 12:32:41,791 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:32:41,792 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:32:41,792 - [INFO] - 
Total Counts:
2025-01-28 12:32:41,793 - [INFO] -   Impressions: 24
2025-01-28 12:32:41,793 - [INFO] -   Clicks: 30
2025-01-28 12:32:41,793 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:32:41,793 - [INFO] - Processing and loading completed successfully
2025-01-28 12:32:42,916 - [INFO] - Spark Session stopped
2025-01-28 12:54:33,006 - [INFO] - Starting application...
2025-01-28 12:54:33,069 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:54:41,229 - [INFO] - Spark Session created successfully
2025-01-28 12:54:41,229 - [INFO] - Spark version: 3.5.4
2025-01-28 12:54:41,229 - [INFO] - Spark master: local[*]
2025-01-28 12:54:41,229 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:54:41,229 - [INFO] - Starting file processing...
2025-01-28 12:54:41,229 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 12:54:41,230 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 12:54:41,230 - [INFO] - User agent filter: some user agent
2025-01-28 12:54:41,231 - [INFO] - Found 11 total parquet files
2025-01-28 12:54:41,231 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:54:41,231 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:54:46,734 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:54:47,270 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:54:49,091 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:54:49,643 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:54:50,052 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:54:50,464 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:54:50,725 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:54:55,818 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 12:54:55,819 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:54:55,819 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:54:55,820 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:54:55,820 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:54:56,113 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:54:56,262 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:54:57,480 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:54:57,759 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:54:57,967 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:54:58,187 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:54:58,401 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:54:58,731 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:54:58,924 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:55:00,502 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:55:00,800 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:55:01,009 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:55:01,275 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:55:01,448 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:55:05,521 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 12:55:06,267 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 12:55:06,267 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:55:06,269 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:55:06,269 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:55:06,270 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:55:06,271 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:55:06,272 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:55:06,272 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:55:06,273 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:55:06,273 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:55:06,274 - [INFO] - Successfully processed 2 dates
2025-01-28 12:55:06,274 - [INFO] - Starting client report loading process...
2025-01-28 12:55:06,275 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 12:55:06,277 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:55:06,288 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:55:06,292 - [INFO] - Archived 0 unique rows
2025-01-28 12:55:06,312 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:55:06,318 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 12:55:06,318 - [INFO] - - Archived rows: 0
2025-01-28 12:55:06,318 - [INFO] - - Loaded rows: 48
2025-01-28 12:55:06,319 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 12:55:06,322 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:55:06,331 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:55:06,335 - [INFO] - Archived 0 unique rows
2025-01-28 12:55:06,345 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:55:06,350 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 12:55:06,351 - [INFO] - - Archived rows: 0
2025-01-28 12:55:06,351 - [INFO] - - Loaded rows: 48
2025-01-28 12:55:06,351 - [INFO] - 
Verifying data load...
2025-01-28 12:55:06,357 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:55:06,359 - [INFO] - 
Load Summary:
2025-01-28 12:55:06,359 - [INFO] - Total files processed: 2
2025-01-28 12:55:06,359 - [INFO] - Total rows loaded: 96
2025-01-28 12:55:06,360 - [INFO] - 
Date Range:
2025-01-28 12:55:06,360 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:55:06,360 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:55:06,360 - [INFO] - 
Total Counts:
2025-01-28 12:55:06,361 - [INFO] -   Impressions: 24
2025-01-28 12:55:06,361 - [INFO] -   Clicks: 30
2025-01-28 12:55:06,362 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:55:06,362 - [INFO] - Processing and loading completed successfully
2025-01-28 12:55:07,513 - [INFO] - Spark Session stopped
2025-01-28 13:28:42,720 - [INFO] - Starting application...
2025-01-28 13:28:45,579 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Unknown host

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 13:29:15,029 - [INFO] - Starting application...
2025-01-28 13:29:15,088 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:29:19,910 - [INFO] - Spark Session created successfully
2025-01-28 13:29:19,910 - [INFO] - Spark version: 3.5.4
2025-01-28 13:29:19,911 - [INFO] - Spark master: local[*]
2025-01-28 13:29:19,911 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:29:19,911 - [INFO] - Starting file processing...
2025-01-28 13:29:19,911 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:29:19,912 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:29:19,912 - [INFO] - User agent filter: some user agent
2025-01-28 13:29:19,913 - [INFO] - Found 11 total parquet files
2025-01-28 13:29:19,913 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:29:19,913 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:29:25,185 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:29:25,637 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:29:27,378 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:29:27,837 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:29:28,218 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:29:28,579 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:29:28,866 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:29:33,721 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:29:33,722 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:29:33,723 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:29:33,723 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:29:33,724 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:29:33,971 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:29:34,137 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:29:35,342 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:29:35,612 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:29:35,784 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:29:35,995 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:29:36,194 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:29:36,496 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:29:36,655 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:29:38,007 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:29:38,253 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:29:38,448 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:29:38,650 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:29:38,804 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:29:42,692 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:29:43,355 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:29:43,356 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:29:43,356 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:29:43,357 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:29:43,357 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:29:43,358 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:29:43,359 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:29:43,359 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:29:43,360 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:29:43,360 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:29:43,360 - [INFO] - Successfully processed 2 dates
2025-01-28 13:29:43,360 - [INFO] - Starting client report loading process...
2025-01-28 13:29:43,361 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:29:43,363 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:29:43,371 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:29:43,375 - [INFO] - Archived 0 unique rows
2025-01-28 13:29:43,390 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:29:43,396 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:29:43,397 - [INFO] - - Archived rows: 0
2025-01-28 13:29:43,397 - [INFO] - - Loaded rows: 48
2025-01-28 13:29:43,397 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:29:43,407 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:29:43,412 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:29:43,415 - [INFO] - Archived 0 unique rows
2025-01-28 13:29:43,423 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:29:43,427 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:29:43,428 - [INFO] - - Archived rows: 0
2025-01-28 13:29:43,428 - [INFO] - - Loaded rows: 48
2025-01-28 13:29:43,428 - [INFO] - 
Verifying data load...
2025-01-28 13:29:43,432 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:29:43,434 - [INFO] - 
Load Summary:
2025-01-28 13:29:43,434 - [INFO] - Total files processed: 2
2025-01-28 13:29:43,434 - [INFO] - Total rows loaded: 96
2025-01-28 13:29:43,434 - [INFO] - 
Date Range:
2025-01-28 13:29:43,435 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:29:43,435 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:29:43,435 - [INFO] - 
Total Counts:
2025-01-28 13:29:43,435 - [INFO] -   Impressions: 24
2025-01-28 13:29:43,435 - [INFO] -   Clicks: 30
2025-01-28 13:29:43,436 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:29:43,436 - [INFO] - Processing and loading completed successfully
2025-01-28 13:29:43,691 - [INFO] - Spark Session stopped
2025-01-28 13:31:27,110 - [INFO] - Starting application...
2025-01-28 13:31:27,177 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:31:31,896 - [INFO] - Spark Session created successfully
2025-01-28 13:31:31,896 - [INFO] - Spark version: 3.5.4
2025-01-28 13:31:31,897 - [INFO] - Spark master: local[*]
2025-01-28 13:31:31,897 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:31:31,897 - [INFO] - Starting file processing...
2025-01-28 13:31:31,897 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:31:31,897 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:31:31,897 - [INFO] - User agent filter: some user agent
2025-01-28 13:31:31,899 - [INFO] - Found 11 total parquet files
2025-01-28 13:31:31,899 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:31:31,899 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:31:37,068 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:31:37,507 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:31:39,278 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:31:39,733 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:31:40,117 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:31:40,492 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:31:40,744 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:31:45,447 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:31:45,448 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:31:45,449 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:31:45,449 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:31:45,450 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:31:45,717 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:31:45,890 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:31:47,086 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:31:47,341 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:31:47,515 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:31:47,731 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:31:47,925 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:31:48,280 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:31:48,434 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:31:49,775 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:31:50,045 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:31:50,258 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:31:50,471 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:31:50,645 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:31:54,565 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:31:55,329 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:31:55,329 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:31:55,331 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:31:55,332 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:31:55,332 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:31:55,333 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:31:55,334 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:31:55,334 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:31:55,335 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:31:55,336 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:31:55,336 - [INFO] - Successfully processed 2 dates
2025-01-28 13:31:55,336 - [INFO] - Starting client report loading process...
2025-01-28 13:31:55,337 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:31:55,338 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:31:55,347 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:31:55,351 - [INFO] - Archived 0 unique rows
2025-01-28 13:31:55,366 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:31:55,371 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:31:55,371 - [INFO] - - Archived rows: 0
2025-01-28 13:31:55,371 - [INFO] - - Loaded rows: 48
2025-01-28 13:31:55,372 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:31:55,375 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:31:55,380 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:31:55,384 - [INFO] - Archived 0 unique rows
2025-01-28 13:31:55,392 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:31:55,397 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:31:55,397 - [INFO] - - Archived rows: 0
2025-01-28 13:31:55,397 - [INFO] - - Loaded rows: 48
2025-01-28 13:31:55,397 - [INFO] - 
Verifying data load...
2025-01-28 13:31:55,403 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:31:55,404 - [INFO] - 
Load Summary:
2025-01-28 13:31:55,404 - [INFO] - Total files processed: 2
2025-01-28 13:31:55,404 - [INFO] - Total rows loaded: 96
2025-01-28 13:31:55,405 - [INFO] - 
Date Range:
2025-01-28 13:31:55,405 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:31:55,405 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:31:55,406 - [INFO] - 
Total Counts:
2025-01-28 13:31:55,406 - [INFO] -   Impressions: 24
2025-01-28 13:31:55,406 - [INFO] -   Clicks: 30
2025-01-28 13:31:55,406 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:31:55,406 - [INFO] - Processing and loading completed successfully
2025-01-28 13:31:56,558 - [INFO] - Spark Session stopped
2025-01-28 13:32:57,756 - [INFO] - Starting application...
2025-01-28 13:32:57,827 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:33:16,132 - [INFO] - Spark Session created successfully
2025-01-28 13:33:16,132 - [INFO] - Spark version: 3.5.4
2025-01-28 13:33:16,132 - [INFO] - Spark master: local[*]
2025-01-28 13:33:16,132 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:33:16,133 - [INFO] - Starting file processing...
2025-01-28 13:33:16,133 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:33:16,133 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:33:16,133 - [INFO] - User agent filter: some user agent
2025-01-28 13:33:16,134 - [INFO] - Found 11 total parquet files
2025-01-28 13:33:16,135 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:33:16,135 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:33:21,529 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:33:22,047 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:33:23,908 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:33:24,421 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:33:24,826 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:33:25,209 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:33:25,470 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:33:30,199 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:33:30,200 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:33:30,201 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:33:30,201 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:33:30,202 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:33:30,463 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:33:30,680 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:33:32,053 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:33:32,329 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:33:32,491 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:33:32,670 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:33:32,841 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:33:33,125 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:33:33,292 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:33:34,678 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:33:34,934 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:33:35,107 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:33:35,302 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:33:35,500 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:33:39,476 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:33:40,136 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:33:40,136 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:33:40,137 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:33:40,138 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:33:40,139 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:33:40,139 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:33:40,140 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:33:40,141 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:33:40,142 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:33:40,142 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:33:40,142 - [INFO] - Successfully processed 2 dates
2025-01-28 13:33:40,142 - [INFO] - Starting client report loading process...
2025-01-28 13:33:40,143 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:33:40,145 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:33:40,153 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:33:40,158 - [INFO] - Archived 0 unique rows
2025-01-28 13:33:40,173 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:33:40,178 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:33:40,178 - [INFO] - - Archived rows: 0
2025-01-28 13:33:40,178 - [INFO] - - Loaded rows: 48
2025-01-28 13:33:40,178 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:33:40,181 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:33:40,189 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:33:40,192 - [INFO] - Archived 0 unique rows
2025-01-28 13:33:40,200 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:33:40,204 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:33:40,205 - [INFO] - - Archived rows: 0
2025-01-28 13:33:40,205 - [INFO] - - Loaded rows: 48
2025-01-28 13:33:40,205 - [INFO] - 
Verifying data load...
2025-01-28 13:33:40,210 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:33:40,212 - [INFO] - 
Load Summary:
2025-01-28 13:33:40,212 - [INFO] - Total files processed: 2
2025-01-28 13:33:40,212 - [INFO] - Total rows loaded: 96
2025-01-28 13:33:40,212 - [INFO] - 
Date Range:
2025-01-28 13:33:40,212 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:33:40,213 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:33:40,213 - [INFO] - 
Total Counts:
2025-01-28 13:33:40,214 - [INFO] -   Impressions: 24
2025-01-28 13:33:40,214 - [INFO] -   Clicks: 30
2025-01-28 13:33:40,214 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:33:40,214 - [INFO] - Processing and loading completed successfully
2025-01-28 13:33:40,479 - [INFO] - Spark Session stopped
2025-01-28 13:35:58,771 - [INFO] - Starting application...
2025-01-28 13:35:58,831 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:36:17,878 - [INFO] - Spark Session created successfully
2025-01-28 13:36:17,879 - [INFO] - Spark version: 3.5.4
2025-01-28 13:36:17,879 - [INFO] - Spark master: local[*]
2025-01-28 13:36:17,879 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:36:17,879 - [INFO] - Starting file processing...
2025-01-28 13:36:17,879 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:36:17,880 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:36:17,880 - [INFO] - User agent filter: some user agent
2025-01-28 13:36:17,881 - [INFO] - Found 11 total parquet files
2025-01-28 13:36:17,881 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:36:17,881 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:36:23,278 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:36:23,797 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:36:25,725 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:36:26,280 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:36:26,721 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:36:27,101 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:36:27,348 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:36:32,345 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:36:32,345 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:36:32,346 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:36:32,347 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:36:32,348 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:36:32,665 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:36:32,830 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:36:34,018 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:36:34,294 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:36:34,501 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:36:34,715 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:36:34,971 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:36:35,265 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:36:35,461 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:36:36,914 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:36:37,174 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:36:37,355 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:36:37,572 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:36:37,760 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:36:41,739 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:36:42,489 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:36:42,490 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:36:42,490 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:36:42,491 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:36:42,492 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:36:42,492 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:36:42,494 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:36:42,494 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:36:42,495 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:36:42,495 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:36:42,496 - [INFO] - Successfully processed 2 dates
2025-01-28 13:36:42,496 - [INFO] - Starting client report loading process...
2025-01-28 13:36:42,497 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:36:42,500 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:36:42,510 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:36:42,517 - [INFO] - Archived 0 unique rows
2025-01-28 13:36:42,535 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:36:42,541 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:36:42,541 - [INFO] - - Archived rows: 0
2025-01-28 13:36:42,541 - [INFO] - - Loaded rows: 48
2025-01-28 13:36:42,541 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:36:42,544 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:36:42,552 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:36:42,555 - [INFO] - Archived 0 unique rows
2025-01-28 13:36:42,566 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:36:42,571 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:36:42,572 - [INFO] - - Archived rows: 0
2025-01-28 13:36:42,572 - [INFO] - - Loaded rows: 48
2025-01-28 13:36:42,572 - [INFO] - 
Verifying data load...
2025-01-28 13:36:42,577 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:36:42,578 - [INFO] - 
Load Summary:
2025-01-28 13:36:42,579 - [INFO] - Total files processed: 2
2025-01-28 13:36:42,579 - [INFO] - Total rows loaded: 96
2025-01-28 13:36:42,579 - [INFO] - 
Date Range:
2025-01-28 13:36:42,579 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:36:42,579 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:36:42,580 - [INFO] - 
Total Counts:
2025-01-28 13:36:42,580 - [INFO] -   Impressions: 24
2025-01-28 13:36:42,581 - [INFO] -   Clicks: 30
2025-01-28 13:36:42,581 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:36:42,581 - [INFO] - Processing and loading completed successfully
2025-01-28 13:36:43,731 - [INFO] - Spark Session stopped
2025-01-28 13:38:47,558 - [INFO] - Starting application...
2025-01-28 13:38:47,627 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:39:05,602 - [INFO] - Spark Session created successfully
2025-01-28 13:39:05,602 - [INFO] - Spark version: 3.5.4
2025-01-28 13:39:05,603 - [INFO] - Spark master: local[*]
2025-01-28 13:39:05,603 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:39:05,603 - [INFO] - Starting file processing...
2025-01-28 13:39:05,603 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:39:05,603 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:39:05,604 - [INFO] - User agent filter: some user agent
2025-01-28 13:39:05,605 - [INFO] - Found 11 total parquet files
2025-01-28 13:39:05,605 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:39:05,605 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:39:11,898 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:39:12,427 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:39:14,389 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:39:14,961 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:39:15,439 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:39:15,947 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:39:16,297 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:39:21,841 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:39:21,842 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:39:21,842 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:39:21,843 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:39:21,843 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:39:22,193 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:39:22,363 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:39:23,583 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:39:23,878 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:39:24,190 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:39:24,492 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:39:24,682 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:39:25,125 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:39:25,341 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:39:26,874 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:39:27,193 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:39:27,439 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:39:27,683 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:39:27,946 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:39:32,603 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:39:33,548 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:39:33,549 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:39:33,550 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:39:33,551 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:39:33,552 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:39:33,552 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:39:33,553 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:39:33,554 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:39:33,555 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:39:33,556 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:39:33,556 - [INFO] - Successfully processed 2 dates
2025-01-28 13:39:33,556 - [INFO] - Starting client report loading process...
2025-01-28 13:39:33,558 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:39:33,560 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:39:33,572 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:39:33,578 - [INFO] - Archived 0 unique rows
2025-01-28 13:39:33,599 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:39:33,604 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:39:33,605 - [INFO] - - Archived rows: 0
2025-01-28 13:39:33,605 - [INFO] - - Loaded rows: 48
2025-01-28 13:39:33,605 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:39:33,608 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:39:33,615 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:39:33,619 - [INFO] - Archived 0 unique rows
2025-01-28 13:39:33,630 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:39:33,635 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:39:33,635 - [INFO] - - Archived rows: 0
2025-01-28 13:39:33,635 - [INFO] - - Loaded rows: 48
2025-01-28 13:39:33,635 - [INFO] - 
Verifying data load...
2025-01-28 13:39:33,642 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:39:33,649 - [INFO] - 
Load Summary:
2025-01-28 13:39:33,649 - [INFO] - Total files processed: 2
2025-01-28 13:39:33,650 - [INFO] - Total rows loaded: 96
2025-01-28 13:39:33,650 - [INFO] - 
Date Range:
2025-01-28 13:39:33,650 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:39:33,650 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:39:33,651 - [INFO] - 
Total Counts:
2025-01-28 13:39:33,651 - [INFO] -   Impressions: 24
2025-01-28 13:39:33,651 - [INFO] -   Clicks: 30
2025-01-28 13:39:33,651 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:39:33,652 - [INFO] - Processing and loading completed successfully
2025-01-28 13:39:34,594 - [INFO] - Spark Session stopped
2025-01-28 13:45:15,163 - [INFO] - Starting application...
2025-01-28 13:45:15,260 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:45:31,607 - [INFO] - Spark Session created successfully
2025-01-28 13:45:31,607 - [INFO] - Spark version: 3.5.4
2025-01-28 13:45:31,607 - [INFO] - Spark master: local[*]
2025-01-28 13:45:31,608 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:45:31,608 - [INFO] - Starting file processing...
2025-01-28 13:45:31,608 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:45:31,608 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:45:31,608 - [INFO] - User agent filter: some user agent
2025-01-28 13:45:31,609 - [INFO] - Found 11 total parquet files
2025-01-28 13:45:31,609 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:45:31,610 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:45:37,598 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:45:38,160 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:45:40,146 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:45:40,660 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:45:41,134 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:45:41,562 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:45:41,856 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:45:47,436 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:45:47,437 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:45:47,438 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:45:47,439 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:45:47,439 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:45:47,738 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:45:47,976 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:45:49,221 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:45:49,476 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:45:49,704 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:45:49,937 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:45:50,165 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:45:50,547 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:45:50,741 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:45:52,266 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:45:52,547 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:45:52,762 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:45:53,065 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:45:53,238 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:45:57,777 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:45:58,600 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:45:58,601 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:45:58,602 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:45:58,603 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:45:58,604 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:45:58,605 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:45:58,606 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:45:58,607 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:45:58,608 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:45:58,608 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:45:58,608 - [INFO] - Successfully processed 2 dates
2025-01-28 13:45:58,608 - [INFO] - Starting client report loading process...
2025-01-28 13:45:58,609 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:45:58,612 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:45:58,626 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:45:58,633 - [INFO] - Archived 0 unique rows
2025-01-28 13:45:58,655 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:45:58,663 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:45:58,663 - [INFO] - - Archived rows: 0
2025-01-28 13:45:58,664 - [INFO] - - Loaded rows: 48
2025-01-28 13:45:58,664 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:45:58,677 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:45:58,688 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:45:58,691 - [INFO] - Archived 0 unique rows
2025-01-28 13:45:58,703 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:45:58,708 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:45:58,708 - [INFO] - - Archived rows: 0
2025-01-28 13:45:58,709 - [INFO] - - Loaded rows: 48
2025-01-28 13:45:58,709 - [INFO] - 
Verifying data load...
2025-01-28 13:45:58,716 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:45:58,718 - [INFO] - 
Load Summary:
2025-01-28 13:45:58,718 - [INFO] - Total files processed: 2
2025-01-28 13:45:58,718 - [INFO] - Total rows loaded: 96
2025-01-28 13:45:58,719 - [INFO] - 
Date Range:
2025-01-28 13:45:58,719 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:45:58,720 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:45:58,720 - [INFO] - 
Total Counts:
2025-01-28 13:45:58,720 - [INFO] -   Impressions: 24
2025-01-28 13:45:58,720 - [INFO] -   Clicks: 30
2025-01-28 13:45:58,721 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:45:58,721 - [INFO] - Processing and loading completed successfully
2025-01-28 13:45:59,772 - [INFO] - Spark Session stopped
2025-01-28 13:50:26,627 - [INFO] - Starting application...
2025-01-28 13:50:26,728 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:50:41,187 - [INFO] - Spark Session created successfully
2025-01-28 13:50:41,188 - [INFO] - Spark version: 3.5.4
2025-01-28 13:50:41,188 - [INFO] - Spark master: local[*]
2025-01-28 13:50:41,188 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:50:41,188 - [INFO] - Starting file processing...
2025-01-28 13:50:41,189 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:50:41,189 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:50:41,189 - [INFO] - User agent filter: some user agent
2025-01-28 13:50:41,190 - [INFO] - Found 11 total parquet files
2025-01-28 13:50:41,190 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:50:41,190 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:50:46,806 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:50:47,501 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:50:49,619 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:50:50,121 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:50:50,613 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:50:51,086 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:50:51,364 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:50:56,590 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:50:56,591 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:50:56,592 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:50:56,592 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:50:56,593 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:50:56,901 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:50:57,057 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:50:58,255 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:50:58,522 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:50:58,719 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:50:58,907 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:50:59,157 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:50:59,433 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:50:59,624 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:51:01,044 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:51:01,307 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:51:01,494 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:51:01,746 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:51:01,920 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:51:06,165 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:51:07,042 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:51:07,043 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:51:07,044 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:51:07,045 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:51:07,046 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:51:07,047 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:51:07,048 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:51:07,050 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:51:07,050 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:51:07,051 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:51:07,051 - [INFO] - Successfully processed 2 dates
2025-01-28 13:51:07,051 - [INFO] - Starting client report loading process...
2025-01-28 13:51:07,052 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:51:07,055 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:51:07,065 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:51:07,070 - [INFO] - Archived 0 unique rows
2025-01-28 13:51:07,092 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:51:07,097 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:51:07,098 - [INFO] - - Archived rows: 0
2025-01-28 13:51:07,098 - [INFO] - - Loaded rows: 48
2025-01-28 13:51:07,098 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:51:07,102 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:51:07,109 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:51:07,113 - [INFO] - Archived 0 unique rows
2025-01-28 13:51:07,122 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:51:07,127 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:51:07,127 - [INFO] - - Archived rows: 0
2025-01-28 13:51:07,127 - [INFO] - - Loaded rows: 48
2025-01-28 13:51:07,128 - [INFO] - 
Verifying data load...
2025-01-28 13:51:07,134 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:51:07,135 - [INFO] - 
Load Summary:
2025-01-28 13:51:07,135 - [INFO] - Total files processed: 2
2025-01-28 13:51:07,135 - [INFO] - Total rows loaded: 96
2025-01-28 13:51:07,136 - [INFO] - 
Date Range:
2025-01-28 13:51:07,136 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:51:07,136 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:51:07,136 - [INFO] - 
Total Counts:
2025-01-28 13:51:07,137 - [INFO] -   Impressions: 24
2025-01-28 13:51:07,137 - [INFO] -   Clicks: 30
2025-01-28 13:51:07,137 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:51:07,137 - [INFO] - Processing and loading completed successfully
2025-01-28 13:51:08,157 - [INFO] - Spark Session stopped
2025-01-28 13:53:03,595 - [INFO] - Starting application...
2025-01-28 13:53:03,657 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:53:21,342 - [INFO] - Spark Session created successfully
2025-01-28 13:53:21,342 - [INFO] - Spark version: 3.5.4
2025-01-28 13:53:21,342 - [INFO] - Spark master: local[*]
2025-01-28 13:53:21,343 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:53:21,343 - [INFO] - Starting file processing...
2025-01-28 13:53:21,343 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:53:21,343 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:53:21,343 - [INFO] - User agent filter: some user agent
2025-01-28 13:53:21,344 - [INFO] - Found 11 total parquet files
2025-01-28 13:53:21,345 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:53:21,345 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:53:26,852 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:53:27,308 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:53:29,121 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:53:29,608 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:53:30,032 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:53:30,494 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:53:30,778 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:53:35,863 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:53:35,864 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:53:35,864 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:53:35,865 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:53:35,865 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:53:36,170 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:53:36,328 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:53:37,535 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:53:37,781 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:53:37,961 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:53:38,191 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:53:38,377 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:53:38,688 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:53:38,854 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:53:40,361 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:53:40,641 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:53:40,859 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:53:41,107 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:53:41,295 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:53:45,459 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:53:46,276 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:53:46,277 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:53:46,278 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:53:46,278 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:53:46,278 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:53:46,279 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:53:46,280 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:53:46,281 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:53:46,281 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:53:46,281 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:53:46,282 - [INFO] - Successfully processed 2 dates
2025-01-28 13:53:46,282 - [INFO] - Starting client report loading process...
2025-01-28 13:53:46,282 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:53:46,284 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:53:46,293 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:53:46,298 - [INFO] - Archived 0 unique rows
2025-01-28 13:53:46,316 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:53:46,323 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:53:46,323 - [INFO] - - Archived rows: 0
2025-01-28 13:53:46,323 - [INFO] - - Loaded rows: 48
2025-01-28 13:53:46,323 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:53:46,327 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:53:46,333 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:53:46,337 - [INFO] - Archived 0 unique rows
2025-01-28 13:53:46,347 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:53:46,352 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:53:46,352 - [INFO] - - Archived rows: 0
2025-01-28 13:53:46,352 - [INFO] - - Loaded rows: 48
2025-01-28 13:53:46,353 - [INFO] - 
Verifying data load...
2025-01-28 13:53:46,359 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:53:46,361 - [INFO] - 
Load Summary:
2025-01-28 13:53:46,361 - [INFO] - Total files processed: 2
2025-01-28 13:53:46,361 - [INFO] - Total rows loaded: 96
2025-01-28 13:53:46,361 - [INFO] - 
Date Range:
2025-01-28 13:53:46,361 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:53:46,361 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:53:46,362 - [INFO] - 
Total Counts:
2025-01-28 13:53:46,362 - [INFO] -   Impressions: 24
2025-01-28 13:53:46,363 - [INFO] -   Clicks: 30
2025-01-28 13:53:46,363 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:53:46,363 - [INFO] - Processing and loading completed successfully
2025-01-28 13:53:47,450 - [INFO] - Spark Session stopped
2025-01-28 11:54:39,745 - [INFO] - Starting application...
2025-01-28 11:54:39,780 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 11:54:43,133 - [INFO] - Spark Session created successfully
2025-01-28 11:54:43,134 - [INFO] - Spark version: 3.5.0
2025-01-28 11:54:43,135 - [INFO] - Spark master: local[*]
2025-01-28 11:54:43,135 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 11:54:43,136 - [INFO] - Starting file processing...
2025-01-28 11:54:43,136 - [INFO] - Input path: /app/raw_data
2025-01-28 11:54:43,137 - [INFO] - Output path: /app/output
2025-01-28 11:54:43,137 - [INFO] - User agent filter: some user agent
2025-01-28 11:54:43,160 - [INFO] - Found 11 total parquet files
2025-01-28 11:54:43,161 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 11:54:43,162 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 11:54:47,678 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 11:54:48,272 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 11:54:49,869 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 11:54:50,533 - [INFO] - Found 0 records with invalid hours
2025-01-28 11:54:51,082 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 11:54:51,658 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 11:54:51,992 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 11:54:55,010 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 11:54:55,014 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 11:54:55,018 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 11:54:55,023 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 11:54:55,024 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 11:54:55,337 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 11:54:55,537 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 11:54:55,951 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 11:54:56,413 - [INFO] - Found 0 records with invalid hours
2025-01-28 11:54:56,635 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 11:54:56,986 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 11:54:57,324 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 11:54:57,901 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 11:54:58,141 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 11:54:58,695 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 11:54:59,142 - [INFO] - Found 0 records with invalid hours
2025-01-28 11:54:59,356 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 11:54:59,766 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 11:55:00,048 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 11:55:00,957 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 11:55:02,058 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 11:55:02,065 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 11:55:02,074 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 11:55:02,080 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 11:55:02,086 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 11:55:02,092 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 11:55:02,097 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 11:55:02,103 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 11:55:02,110 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 11:55:02,113 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 11:55:02,114 - [INFO] - Successfully processed 2 dates
2025-01-28 11:55:02,115 - [INFO] - Starting client report loading process...
2025-01-28 11:55:02,142 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 11:55:02,205 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 11:55:02,424 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 11:55:02,548 - [INFO] - Archived 0 unique rows
2025-01-28 11:55:02,623 - [INFO] - Starting application...
2025-01-28 11:55:02,749 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 11:55:02,755 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 11:55:02,756 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 11:55:02,756 - [INFO] - - Archived rows: 0
2025-01-28 11:55:02,757 - [INFO] - - Loaded rows: 48
2025-01-28 11:55:02,758 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 11:55:02,764 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 11:55:02,774 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 11:55:02,776 - [INFO] - Archived 0 unique rows
2025-01-28 11:55:02,782 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 11:55:02,786 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 11:55:02,787 - [INFO] - - Archived rows: 0
2025-01-28 11:55:02,788 - [INFO] - - Loaded rows: 48
2025-01-28 11:55:02,789 - [INFO] - 
Verifying data load...
2025-01-28 11:55:02,795 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 11:55:02,796 - [INFO] - 
Load Summary:
2025-01-28 11:55:02,797 - [INFO] - Total files processed: 2
2025-01-28 11:55:02,798 - [INFO] - Total rows loaded: 96
2025-01-28 11:55:02,799 - [INFO] - 
Date Range:
2025-01-28 11:55:02,799 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 11:55:02,800 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 11:55:02,801 - [INFO] - 
Total Counts:
2025-01-28 11:55:02,803 - [INFO] -   Impressions: 24
2025-01-28 11:55:02,804 - [INFO] -   Clicks: 30
2025-01-28 11:55:02,804 - [INFO] - 
Client report loading completed successfully
2025-01-28 11:55:02,805 - [INFO] - Processing and loading completed successfully
2025-01-28 11:55:04,026 - [INFO] - Spark Session stopped
2025-01-28 11:55:08,092 - [INFO] - Spark Session created successfully
2025-01-28 11:55:08,094 - [INFO] - Spark version: 3.5.0
2025-01-28 11:55:08,094 - [INFO] - Spark master: local[*]
2025-01-28 11:55:08,095 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 11:55:08,096 - [INFO] - Starting file processing...
2025-01-28 11:55:08,097 - [INFO] - Input path: /app/raw_data
2025-01-28 11:55:08,097 - [INFO] - Output path: /app/output
2025-01-28 11:55:08,098 - [INFO] - User agent filter: some user agent
2025-01-28 11:55:08,102 - [WARNING] - No parquet files found in input directory
2025-01-28 11:55:08,103 - [ERROR] - Spark processing failed
2025-01-28 11:55:08,104 - [ERROR] - Processing or loading failed
2025-01-28 11:55:08,254 - [INFO] - Spark Session stopped
2025-01-28 11:56:02,224 - [INFO] - Starting application...
2025-01-28 11:56:02,282 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 11:56:06,037 - [INFO] - Spark Session created successfully
2025-01-28 11:56:06,038 - [INFO] - Spark version: 3.5.0
2025-01-28 11:56:06,040 - [INFO] - Spark master: local[*]
2025-01-28 11:56:06,041 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 11:56:06,041 - [INFO] - Starting file processing...
2025-01-28 11:56:06,043 - [INFO] - Input path: /app/raw_data
2025-01-28 11:56:06,044 - [INFO] - Output path: /app/output
2025-01-28 11:56:06,045 - [INFO] - User agent filter: some user agent
2025-01-28 11:56:06,046 - [WARNING] - No parquet files found in input directory
2025-01-28 11:56:06,047 - [ERROR] - Spark processing failed
2025-01-28 11:56:06,048 - [ERROR] - Processing or loading failed
2025-01-28 11:56:06,200 - [INFO] - Spark Session stopped
2025-01-28 13:58:09,329 - [INFO] - Starting application...
2025-01-28 13:58:12,152 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Unknown host

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 13:58:36,396 - [INFO] - Starting application...
2025-01-28 13:58:36,487 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:58:41,691 - [INFO] - Spark Session created successfully
2025-01-28 13:58:41,692 - [INFO] - Spark version: 3.5.4
2025-01-28 13:58:41,692 - [INFO] - Spark master: local[*]
2025-01-28 13:58:41,692 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:58:41,692 - [INFO] - Starting file processing...
2025-01-28 13:58:41,692 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 13:58:41,693 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 13:58:41,693 - [INFO] - User agent filter: some user agent
2025-01-28 13:58:41,694 - [INFO] - Found 11 total parquet files
2025-01-28 13:58:41,694 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:58:41,694 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:58:47,324 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:58:47,860 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:58:49,775 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:58:50,384 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:58:50,815 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:58:51,254 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:58:51,542 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:58:57,440 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 13:58:57,441 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:58:57,442 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:58:57,443 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:58:57,443 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:58:57,803 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:58:57,982 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:58:59,363 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:58:59,673 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:58:59,893 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:59:00,119 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:59:00,328 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:59:00,589 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:59:00,828 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:59:02,358 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:59:02,768 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:59:03,152 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:59:03,410 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:59:03,611 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:59:07,960 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 13:59:08,777 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 13:59:08,779 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:59:08,780 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:59:08,780 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:59:08,781 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:59:08,782 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:59:08,782 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:59:08,783 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:59:08,783 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:59:08,784 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:59:08,784 - [INFO] - Successfully processed 2 dates
2025-01-28 13:59:08,784 - [INFO] - Starting client report loading process...
2025-01-28 13:59:08,785 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 13:59:08,787 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:59:08,799 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:59:08,805 - [INFO] - Archived 0 unique rows
2025-01-28 13:59:08,825 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:59:08,830 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 13:59:08,830 - [INFO] - - Archived rows: 0
2025-01-28 13:59:08,831 - [INFO] - - Loaded rows: 48
2025-01-28 13:59:08,831 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 13:59:08,835 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:59:08,842 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:59:08,846 - [INFO] - Archived 0 unique rows
2025-01-28 13:59:08,856 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:59:08,861 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 13:59:08,862 - [INFO] - - Archived rows: 0
2025-01-28 13:59:08,862 - [INFO] - - Loaded rows: 48
2025-01-28 13:59:08,862 - [INFO] - 
Verifying data load...
2025-01-28 13:59:08,871 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:59:08,873 - [INFO] - 
Load Summary:
2025-01-28 13:59:08,874 - [INFO] - Total files processed: 2
2025-01-28 13:59:08,874 - [INFO] - Total rows loaded: 96
2025-01-28 13:59:08,874 - [INFO] - 
Date Range:
2025-01-28 13:59:08,874 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:59:08,874 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:59:08,875 - [INFO] - 
Total Counts:
2025-01-28 13:59:08,875 - [INFO] -   Impressions: 24
2025-01-28 13:59:08,875 - [INFO] -   Clicks: 30
2025-01-28 13:59:08,876 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:59:08,876 - [INFO] - Processing and loading completed successfully
2025-01-28 13:59:09,955 - [INFO] - Spark Session stopped
2025-01-28 14:00:55,877 - [INFO] - Starting application...
2025-01-28 14:00:55,946 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:01:00,877 - [INFO] - Spark Session created successfully
2025-01-28 14:01:00,877 - [INFO] - Spark version: 3.5.4
2025-01-28 14:01:00,877 - [INFO] - Spark master: local[*]
2025-01-28 14:01:00,877 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:01:00,877 - [INFO] - Starting file processing...
2025-01-28 14:01:00,877 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 14:01:00,879 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 14:01:00,879 - [INFO] - User agent filter: some user agent
2025-01-28 14:01:00,880 - [INFO] - Found 11 total parquet files
2025-01-28 14:01:00,880 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:01:00,880 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:01:06,520 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:01:07,007 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:01:08,934 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:01:09,498 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:01:09,991 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:01:10,450 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:01:10,717 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:01:15,912 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 14:01:15,912 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:01:15,913 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:01:15,914 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:01:15,914 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:01:16,159 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:01:16,329 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:01:17,467 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:01:17,715 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:01:17,915 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:01:18,105 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:01:18,313 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:01:18,678 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:01:19,035 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:01:20,636 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:01:20,926 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:01:21,159 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:01:21,393 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:01:21,597 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:01:25,719 - [WARNING] - Found records where clicks exceed impressions: {date}
2025-01-28 14:01:26,487 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 14:01:26,488 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:01:26,490 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:01:26,491 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:01:26,491 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:01:26,492 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:01:26,493 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:01:26,494 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:01:26,495 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:01:26,495 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:01:26,496 - [INFO] - Successfully processed 2 dates
2025-01-28 14:01:26,496 - [INFO] - Starting client report loading process...
2025-01-28 14:01:26,497 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 14:01:26,499 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:01:26,512 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:01:26,518 - [INFO] - Archived 0 unique rows
2025-01-28 14:01:26,533 - [INFO] - Successfully loaded 48 rows
2025-01-28 14:01:26,541 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 14:01:26,541 - [INFO] - - Archived rows: 0
2025-01-28 14:01:26,541 - [INFO] - - Loaded rows: 48
2025-01-28 14:01:26,541 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 14:01:26,544 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:01:26,550 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:01:26,553 - [INFO] - Archived 0 unique rows
2025-01-28 14:01:26,562 - [INFO] - Successfully loaded 48 rows
2025-01-28 14:01:26,566 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 14:01:26,567 - [INFO] - - Archived rows: 0
2025-01-28 14:01:26,567 - [INFO] - - Loaded rows: 48
2025-01-28 14:01:26,567 - [INFO] - 
Verifying data load...
2025-01-28 14:01:26,573 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 14:01:26,574 - [INFO] - 
Load Summary:
2025-01-28 14:01:26,574 - [INFO] - Total files processed: 2
2025-01-28 14:01:26,574 - [INFO] - Total rows loaded: 96
2025-01-28 14:01:26,574 - [INFO] - 
Date Range:
2025-01-28 14:01:26,575 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 14:01:26,575 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 14:01:26,575 - [INFO] - 
Total Counts:
2025-01-28 14:01:26,576 - [INFO] -   Impressions: 24
2025-01-28 14:01:26,576 - [INFO] -   Clicks: 30
2025-01-28 14:01:26,576 - [INFO] - 
Client report loading completed successfully
2025-01-28 14:01:26,576 - [INFO] - Processing and loading completed successfully
2025-01-28 14:01:27,711 - [INFO] - Spark Session stopped
2025-01-28 14:05:20,946 - [INFO] - Starting application...
2025-01-28 14:05:21,024 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:05:39,383 - [INFO] - Spark Session created successfully
2025-01-28 14:05:39,384 - [INFO] - Spark version: 3.5.4
2025-01-28 14:05:39,384 - [INFO] - Spark master: local[*]
2025-01-28 14:05:39,384 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:05:39,384 - [INFO] - Starting file processing...
2025-01-28 14:05:39,385 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 14:05:39,385 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 14:05:39,385 - [INFO] - User agent filter: some user agent
2025-01-28 14:05:39,386 - [INFO] - Found 11 total parquet files
2025-01-28 14:05:39,386 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:05:39,386 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:05:45,093 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:05:45,586 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:05:47,452 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:05:47,979 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:05:48,423 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:05:48,823 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:05:49,076 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:05:54,305 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 14:05:54,306 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:05:54,306 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:05:54,307 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:05:54,307 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:05:54,615 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:05:54,788 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:05:55,978 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:05:56,229 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:05:56,425 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:05:56,662 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:05:56,893 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:05:57,193 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:05:57,366 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:05:58,813 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:05:59,145 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:05:59,363 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:05:59,616 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:05:59,773 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:06:04,028 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:06:04,947 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 14:06:04,948 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:06:04,949 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:06:04,950 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:06:04,951 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:06:04,953 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:06:04,954 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:06:04,957 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:06:04,960 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:06:04,961 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:06:04,962 - [INFO] - Successfully processed 2 dates
2025-01-28 14:06:04,962 - [INFO] - Starting client report loading process...
2025-01-28 14:06:04,963 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 14:06:04,965 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:06:04,980 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:06:04,985 - [INFO] - Archived 0 unique rows
2025-01-28 14:06:05,006 - [INFO] - Successfully loaded 48 rows
2025-01-28 14:06:05,012 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 14:06:05,012 - [INFO] - - Archived rows: 0
2025-01-28 14:06:05,012 - [INFO] - - Loaded rows: 48
2025-01-28 14:06:05,012 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 14:06:05,016 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:06:05,026 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:06:05,029 - [INFO] - Archived 0 unique rows
2025-01-28 14:06:05,041 - [INFO] - Successfully loaded 48 rows
2025-01-28 14:06:05,045 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 14:06:05,046 - [INFO] - - Archived rows: 0
2025-01-28 14:06:05,046 - [INFO] - - Loaded rows: 48
2025-01-28 14:06:05,046 - [INFO] - 
Verifying data load...
2025-01-28 14:06:05,053 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 14:06:05,054 - [INFO] - 
Load Summary:
2025-01-28 14:06:05,055 - [INFO] - Total files processed: 2
2025-01-28 14:06:05,055 - [INFO] - Total rows loaded: 96
2025-01-28 14:06:05,055 - [INFO] - 
Date Range:
2025-01-28 14:06:05,055 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 14:06:05,055 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 14:06:05,056 - [INFO] - 
Total Counts:
2025-01-28 14:06:05,056 - [INFO] -   Impressions: 24
2025-01-28 14:06:05,057 - [INFO] -   Clicks: 30
2025-01-28 14:06:05,057 - [INFO] - 
Client report loading completed successfully
2025-01-28 14:06:05,057 - [INFO] - Processing and loading completed successfully
2025-01-28 14:06:06,028 - [INFO] - Spark Session stopped
2025-01-28 12:11:59,959 - [INFO] - Starting application...
2025-01-28 12:12:00,000 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:12:02,717 - [INFO] - Starting application...
2025-01-28 12:12:02,761 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:12:04,697 - [INFO] - Spark Session created successfully
2025-01-28 12:12:04,698 - [INFO] - Spark version: 3.5.0
2025-01-28 12:12:04,699 - [INFO] - Spark master: local[*]
2025-01-28 12:12:04,700 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:12:04,701 - [INFO] - Starting file processing...
2025-01-28 12:12:04,702 - [INFO] - Input path: /app/raw_data
2025-01-28 12:12:04,702 - [INFO] - Output path: /app/output
2025-01-28 12:12:04,703 - [INFO] - User agent filter: some user agent
2025-01-28 12:12:04,728 - [INFO] - Found 11 total parquet files
2025-01-28 12:12:04,728 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:12:04,729 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:12:07,941 - [INFO] - Spark Session created successfully
2025-01-28 12:12:07,943 - [INFO] - Spark version: 3.5.0
2025-01-28 12:12:07,944 - [INFO] - Spark master: local[*]
2025-01-28 12:12:07,945 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:12:07,946 - [INFO] - Starting file processing...
2025-01-28 12:12:07,947 - [INFO] - Input path: /app/raw_data
2025-01-28 12:12:07,949 - [INFO] - Output path: /app/output
2025-01-28 12:12:07,950 - [INFO] - User agent filter: some user agent
2025-01-28 12:12:07,955 - [INFO] - Found 11 total parquet files
2025-01-28 12:12:07,956 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:12:07,957 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:12:11,135 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:12:11,838 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:12:13,769 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:12:14,092 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:12:14,493 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:12:15,262 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:12:15,949 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:12:16,839 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:12:16,849 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:12:17,466 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:12:17,907 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:12:18,651 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:12:19,418 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:12:20,030 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:12:22,414 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 12:12:22,426 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:12:22,433 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:12:22,438 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:12:22,440 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:12:23,137 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:12:23,491 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:12:24,066 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:12:24,476 - [ERROR] - Error in _combine_and_fill_hours: An error occurred while calling o181.javaToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 26.0 failed 1 times, most recent failure: Lost task 0.0 in stage 26.0 (TID 25) (239b4a5d4f38 executor driver): org.apache.spark.SparkFileNotFoundException: File file:/app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
Caused by: org.apache.spark.SparkFileNotFoundException: File file:/app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

2025-01-28 12:12:24,482 - [ERROR] - Error processing files for date '2022-05-26': An error occurred while calling o181.javaToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 26.0 failed 1 times, most recent failure: Lost task 0.0 in stage 26.0 (TID 25) (239b4a5d4f38 executor driver): org.apache.spark.SparkFileNotFoundException: File file:/app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
Caused by: org.apache.spark.SparkFileNotFoundException: File file:/app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

2025-01-28 12:12:24,487 - [WARNING] - Failed to process data for date: 2022-05-26 - An error occurred while calling o181.javaToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 26.0 failed 1 times, most recent failure: Lost task 0.0 in stage 26.0 (TID 25) (239b4a5d4f38 executor driver): org.apache.spark.SparkFileNotFoundException: File file:/app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
Caused by: org.apache.spark.SparkFileNotFoundException: File file:/app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet does not exist
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage2.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

2025-01-28 12:12:24,694 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:12:25,004 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:12:25,031 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:12:25,340 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:12:25,567 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:12:25,857 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:12:26,109 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:12:26,255 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:12:26,598 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:12:26,713 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:12:26,949 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:12:27,322 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:12:27,556 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:12:27,658 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:12:28,038 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:12:28,057 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:12:28,328 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:12:28,375 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:12:28,918 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:12:29,613 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:12:29,955 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:12:30,794 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:12:31,370 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:12:31,838 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:12:32,337 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 12:12:32,405 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:12:34,406 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 12:12:34,413 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:12:34,423 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:12:34,432 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:12:34,442 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:12:34,448 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:12:34,454 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:12:34,462 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:12:34,469 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:12:34,471 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:12:34,472 - [INFO] - Successfully processed 2 dates
2025-01-28 12:12:34,473 - [INFO] - Starting client report loading process...
2025-01-28 12:12:34,502 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 12:12:34,563 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:12:34,809 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:12:35,008 - [INFO] - Archived 0 unique rows
2025-01-28 12:12:35,246 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:12:35,253 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 12:12:35,253 - [INFO] - - Archived rows: 0
2025-01-28 12:12:35,254 - [INFO] - - Loaded rows: 48
2025-01-28 12:12:35,255 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 12:12:35,265 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:12:35,274 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:12:35,277 - [INFO] - Archived 0 unique rows
2025-01-28 12:12:35,285 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:12:35,289 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 12:12:35,290 - [INFO] - - Archived rows: 0
2025-01-28 12:12:35,291 - [INFO] - - Loaded rows: 48
2025-01-28 12:12:35,292 - [INFO] - 
Verifying data load...
2025-01-28 12:12:35,301 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:12:35,303 - [INFO] - 
Load Summary:
2025-01-28 12:12:35,303 - [INFO] - Total files processed: 2
2025-01-28 12:12:35,304 - [INFO] - Total rows loaded: 96
2025-01-28 12:12:35,305 - [INFO] - 
Date Range:
2025-01-28 12:12:35,306 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:12:35,306 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:12:35,307 - [INFO] - 
Total Counts:
2025-01-28 12:12:35,308 - [INFO] -   Impressions: 24
2025-01-28 12:12:35,309 - [INFO] -   Clicks: 30
2025-01-28 12:12:35,311 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:12:35,312 - [INFO] - Processing and loading completed successfully
2025-01-28 12:12:35,477 - [ERROR] - Error in _combine_and_fill_hours: An error occurred while calling o413.javaToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 75.0 failed 1 times, most recent failure: Lost task 1.0 in stage 75.0 (TID 73) (239b4a5d4f38 executor driver): org.apache.spark.SparkFileNotFoundException: /app/raw_data/impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet (No such file or directory)
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
Caused by: org.apache.spark.SparkFileNotFoundException: /app/raw_data/impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet (No such file or directory)
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

2025-01-28 12:12:35,482 - [ERROR] - Error processing files for date '2022-05-27': An error occurred while calling o413.javaToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 75.0 failed 1 times, most recent failure: Lost task 1.0 in stage 75.0 (TID 73) (239b4a5d4f38 executor driver): org.apache.spark.SparkFileNotFoundException: /app/raw_data/impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet (No such file or directory)
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
Caused by: org.apache.spark.SparkFileNotFoundException: /app/raw_data/impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet (No such file or directory)
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

2025-01-28 12:12:35,492 - [WARNING] - Failed to process data for date: 2022-05-27 - An error occurred while calling o413.javaToPython.
: org.apache.spark.SparkException: Job aborted due to stage failure: Task 1 in stage 75.0 failed 1 times, most recent failure: Lost task 1.0 in stage 75.0 (TID 73) (239b4a5d4f38 executor driver): org.apache.spark.SparkFileNotFoundException: /app/raw_data/impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet (No such file or directory)
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

Driver stacktrace:
	at org.apache.spark.scheduler.DAGScheduler.failJobAndIndependentStages(DAGScheduler.scala:2844)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2(DAGScheduler.scala:2780)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$abortStage$2$adapted(DAGScheduler.scala:2779)
	at scala.collection.mutable.ResizableArray.foreach(ResizableArray.scala:62)
	at scala.collection.mutable.ResizableArray.foreach$(ResizableArray.scala:55)
	at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:49)
	at org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:2779)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGScheduler.$anonfun$handleTaskSetFailed$1$adapted(DAGScheduler.scala:1242)
	at scala.Option.foreach(Option.scala:407)
	at org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:1242)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:3048)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2982)
	at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:2971)
	at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:49)
Caused by: org.apache.spark.SparkFileNotFoundException: /app/raw_data/impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet (No such file or directory)
It is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.
	at org.apache.spark.sql.errors.QueryExecutionErrors$.readCurrentFileNotFoundError(QueryExecutionErrors.scala:780)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:220)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:279)
	at org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:129)
	at org.apache.spark.sql.execution.FileSourceScanExec$$anon$1.hasNext(DataSourceScanExec.scala:593)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.columnartorow_nextBatch_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.hashAgg_doAggregateWithKeys_0$(Unknown Source)
	at org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)
	at org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)
	at org.apache.spark.sql.execution.WholeStageCodegenEvaluatorFactory$WholeStageCodegenPartitionEvaluator$$anon$1.hasNext(WholeStageCodegenEvaluatorFactory.scala:43)
	at scala.collection.Iterator$$anon$10.hasNext(Iterator.scala:460)
	at org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:140)
	at org.apache.spark.shuffle.ShuffleWriteProcessor.write(ShuffleWriteProcessor.scala:59)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:104)
	at org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:54)
	at org.apache.spark.TaskContext.runTaskWithListeners(TaskContext.scala:161)
	at org.apache.spark.scheduler.Task.run(Task.scala:141)
	at org.apache.spark.executor.Executor$TaskRunner.$anonfun$run$4(Executor.scala:620)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally(SparkErrorUtils.scala:64)
	at org.apache.spark.util.SparkErrorUtils.tryWithSafeFinally$(SparkErrorUtils.scala:61)
	at org.apache.spark.util.Utils$.tryWithSafeFinally(Utils.scala:94)
	at org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:623)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)

2025-01-28 12:12:35,496 - [ERROR] - No dates were successfully processed
2025-01-28 12:12:35,499 - [ERROR] - Spark processing failed
2025-01-28 12:12:35,502 - [ERROR] - Processing or loading failed
2025-01-28 12:12:36,385 - [INFO] - Spark Session stopped
2025-01-28 12:12:36,595 - [INFO] - Spark Session stopped
2025-01-28 12:13:02,398 - [INFO] - Starting application...
2025-01-28 12:13:02,480 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:13:06,864 - [INFO] - Spark Session created successfully
2025-01-28 12:13:06,865 - [INFO] - Spark version: 3.5.0
2025-01-28 12:13:06,866 - [INFO] - Spark master: local[*]
2025-01-28 12:13:06,867 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:13:06,868 - [INFO] - Starting file processing...
2025-01-28 12:13:06,869 - [INFO] - Input path: /app/raw_data
2025-01-28 12:13:06,870 - [INFO] - Output path: /app/output
2025-01-28 12:13:06,871 - [INFO] - User agent filter: some user agent
2025-01-28 12:13:06,875 - [WARNING] - No parquet files found in input directory
2025-01-28 12:13:06,876 - [ERROR] - Spark processing failed
2025-01-28 12:13:06,877 - [ERROR] - Processing or loading failed
2025-01-28 12:13:06,989 - [INFO] - Spark Session stopped
2025-01-28 12:14:01,581 - [INFO] - Starting application...
2025-01-28 12:14:01,615 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:14:05,002 - [INFO] - Spark Session created successfully
2025-01-28 12:14:05,003 - [INFO] - Spark version: 3.5.0
2025-01-28 12:14:05,004 - [INFO] - Spark master: local[*]
2025-01-28 12:14:05,005 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:14:05,006 - [INFO] - Starting file processing...
2025-01-28 12:14:05,006 - [INFO] - Input path: /app/raw_data
2025-01-28 12:14:05,007 - [INFO] - Output path: /app/output
2025-01-28 12:14:05,008 - [INFO] - User agent filter: some user agent
2025-01-28 12:14:05,009 - [WARNING] - No parquet files found in input directory
2025-01-28 12:14:05,009 - [ERROR] - Spark processing failed
2025-01-28 12:14:05,010 - [ERROR] - Processing or loading failed
2025-01-28 12:14:05,152 - [INFO] - Spark Session stopped
2025-01-28 12:14:40,482 - [INFO] - Starting application...
2025-01-28 12:14:40,535 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:14:44,185 - [INFO] - Spark Session created successfully
2025-01-28 12:14:44,187 - [INFO] - Spark version: 3.5.0
2025-01-28 12:14:44,187 - [INFO] - Spark master: local[*]
2025-01-28 12:14:44,188 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:14:44,189 - [INFO] - Starting file processing...
2025-01-28 12:14:44,189 - [INFO] - Input path: /app/raw_data
2025-01-28 12:14:44,190 - [INFO] - Output path: /app/output
2025-01-28 12:14:44,191 - [INFO] - User agent filter: some user agent
2025-01-28 12:14:44,195 - [WARNING] - No parquet files found in input directory
2025-01-28 12:14:44,195 - [ERROR] - Spark processing failed
2025-01-28 12:14:44,197 - [ERROR] - Processing or loading failed
2025-01-28 12:14:44,387 - [INFO] - Spark Session stopped
2025-01-28 12:15:02,310 - [INFO] - Starting application...
2025-01-28 12:15:02,348 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:15:05,730 - [INFO] - Spark Session created successfully
2025-01-28 12:15:05,732 - [INFO] - Spark version: 3.5.0
2025-01-28 12:15:05,733 - [INFO] - Spark master: local[*]
2025-01-28 12:15:05,735 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:15:05,736 - [INFO] - Starting file processing...
2025-01-28 12:15:05,738 - [INFO] - Input path: /app/raw_data
2025-01-28 12:15:05,740 - [INFO] - Output path: /app/output
2025-01-28 12:15:05,741 - [INFO] - User agent filter: some user agent
2025-01-28 12:15:05,742 - [WARNING] - No parquet files found in input directory
2025-01-28 12:15:05,743 - [ERROR] - Spark processing failed
2025-01-28 12:15:05,744 - [ERROR] - Processing or loading failed
2025-01-28 12:15:05,913 - [INFO] - Spark Session stopped
2025-01-28 12:16:02,549 - [INFO] - Starting application...
2025-01-28 12:16:02,585 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:16:06,179 - [INFO] - Spark Session created successfully
2025-01-28 12:16:06,181 - [INFO] - Spark version: 3.5.0
2025-01-28 12:16:06,182 - [INFO] - Spark master: local[*]
2025-01-28 12:16:06,183 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:16:06,184 - [INFO] - Starting file processing...
2025-01-28 12:16:06,185 - [INFO] - Input path: /app/raw_data
2025-01-28 12:16:06,186 - [INFO] - Output path: /app/output
2025-01-28 12:16:06,187 - [INFO] - User agent filter: some user agent
2025-01-28 12:16:06,188 - [WARNING] - No parquet files found in input directory
2025-01-28 12:16:06,188 - [ERROR] - Spark processing failed
2025-01-28 12:16:06,189 - [ERROR] - Processing or loading failed
2025-01-28 12:16:06,377 - [INFO] - Spark Session stopped
2025-01-28 12:17:01,978 - [INFO] - Starting application...
2025-01-28 12:17:02,016 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:17:05,469 - [INFO] - Spark Session created successfully
2025-01-28 12:17:05,470 - [INFO] - Spark version: 3.5.0
2025-01-28 12:17:05,471 - [INFO] - Spark master: local[*]
2025-01-28 12:17:05,472 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:17:05,473 - [INFO] - Starting file processing...
2025-01-28 12:17:05,474 - [INFO] - Input path: /app/raw_data
2025-01-28 12:17:05,475 - [INFO] - Output path: /app/output
2025-01-28 12:17:05,476 - [INFO] - User agent filter: some user agent
2025-01-28 12:17:05,499 - [INFO] - Found 11 total parquet files
2025-01-28 12:17:05,500 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:17:05,501 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:17:13,105 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:17:13,816 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:17:16,211 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:17:16,970 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:17:17,670 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:17:18,433 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:17:18,895 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:17:21,904 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 12:17:21,908 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:17:21,912 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:17:21,916 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:17:21,917 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:17:22,177 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:17:22,333 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:17:22,686 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:17:23,032 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:17:23,218 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:17:23,501 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:17:23,764 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:17:24,088 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:17:24,323 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:17:24,929 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:17:25,391 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:17:25,653 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:17:26,064 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:17:26,589 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:17:27,798 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 12:17:28,987 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 12:17:28,992 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:17:28,997 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:17:29,002 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:17:29,008 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:17:29,012 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:17:29,017 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:17:29,022 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:17:29,027 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:17:29,029 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:17:29,031 - [INFO] - Successfully processed 2 dates
2025-01-28 12:17:29,032 - [INFO] - Starting client report loading process...
2025-01-28 12:17:29,048 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 12:17:29,101 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:17:29,338 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:17:29,458 - [INFO] - Archived 0 unique rows
2025-01-28 12:17:29,690 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:17:29,696 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 12:17:29,697 - [INFO] - - Archived rows: 0
2025-01-28 12:17:29,698 - [INFO] - - Loaded rows: 48
2025-01-28 12:17:29,699 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 12:17:29,705 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:17:29,713 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:17:29,721 - [INFO] - Archived 0 unique rows
2025-01-28 12:17:29,728 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:17:29,739 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 12:17:29,740 - [INFO] - - Archived rows: 0
2025-01-28 12:17:29,741 - [INFO] - - Loaded rows: 48
2025-01-28 12:17:29,742 - [INFO] - 
Verifying data load...
2025-01-28 12:17:29,748 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:17:29,749 - [INFO] - 
Load Summary:
2025-01-28 12:17:29,750 - [INFO] - Total files processed: 2
2025-01-28 12:17:29,751 - [INFO] - Total rows loaded: 96
2025-01-28 12:17:29,752 - [INFO] - 
Date Range:
2025-01-28 12:17:29,753 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:17:29,754 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:17:29,755 - [INFO] - 
Total Counts:
2025-01-28 12:17:29,756 - [INFO] -   Impressions: 24
2025-01-28 12:17:29,757 - [INFO] -   Clicks: 30
2025-01-28 12:17:29,757 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:17:29,758 - [INFO] - Processing and loading completed successfully
2025-01-28 12:17:30,848 - [INFO] - Spark Session stopped
2025-01-28 12:18:02,591 - [INFO] - Starting application...
2025-01-28 12:18:02,655 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:18:06,883 - [INFO] - Spark Session created successfully
2025-01-28 12:18:06,884 - [INFO] - Spark version: 3.5.0
2025-01-28 12:18:06,885 - [INFO] - Spark master: local[*]
2025-01-28 12:18:06,886 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:18:06,887 - [INFO] - Starting file processing...
2025-01-28 12:18:06,888 - [INFO] - Input path: /app/raw_data
2025-01-28 12:18:06,889 - [INFO] - Output path: /app/output
2025-01-28 12:18:06,890 - [INFO] - User agent filter: some user agent
2025-01-28 12:18:06,893 - [WARNING] - No parquet files found in input directory
2025-01-28 12:18:06,894 - [ERROR] - Spark processing failed
2025-01-28 12:18:06,895 - [ERROR] - Processing or loading failed
2025-01-28 12:18:07,051 - [INFO] - Spark Session stopped
2025-01-28 12:19:01,661 - [INFO] - Starting application...
2025-01-28 12:19:01,695 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:19:06,067 - [INFO] - Spark Session created successfully
2025-01-28 12:19:06,068 - [INFO] - Spark version: 3.5.0
2025-01-28 12:19:06,070 - [INFO] - Spark master: local[*]
2025-01-28 12:19:06,071 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:19:06,071 - [INFO] - Starting file processing...
2025-01-28 12:19:06,072 - [INFO] - Input path: /app/raw_data
2025-01-28 12:19:06,080 - [INFO] - Output path: /app/output
2025-01-28 12:19:06,082 - [INFO] - User agent filter: some user agent
2025-01-28 12:19:06,083 - [WARNING] - No parquet files found in input directory
2025-01-28 12:19:06,084 - [ERROR] - Spark processing failed
2025-01-28 12:19:06,085 - [ERROR] - Processing or loading failed
2025-01-28 12:19:06,232 - [INFO] - Spark Session stopped
2025-01-28 12:20:01,965 - [INFO] - Starting application...
2025-01-28 12:20:02,001 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:20:06,020 - [INFO] - Spark Session created successfully
2025-01-28 12:20:06,022 - [INFO] - Spark version: 3.5.0
2025-01-28 12:20:06,023 - [INFO] - Spark master: local[*]
2025-01-28 12:20:06,024 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:20:06,025 - [INFO] - Starting file processing...
2025-01-28 12:20:06,026 - [INFO] - Input path: /app/raw_data
2025-01-28 12:20:06,027 - [INFO] - Output path: /app/output
2025-01-28 12:20:06,028 - [INFO] - User agent filter: some user agent
2025-01-28 12:20:06,029 - [WARNING] - No parquet files found in input directory
2025-01-28 12:20:06,030 - [ERROR] - Spark processing failed
2025-01-28 12:20:06,031 - [ERROR] - Processing or loading failed
2025-01-28 12:20:06,153 - [INFO] - Spark Session stopped
2025-01-28 12:21:01,866 - [INFO] - Starting application...
2025-01-28 12:21:01,908 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:21:05,690 - [INFO] - Spark Session created successfully
2025-01-28 12:21:05,691 - [INFO] - Spark version: 3.5.0
2025-01-28 12:21:05,692 - [INFO] - Spark master: local[*]
2025-01-28 12:21:05,694 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:21:05,695 - [INFO] - Starting file processing...
2025-01-28 12:21:05,696 - [INFO] - Input path: /app/raw_data
2025-01-28 12:21:05,697 - [INFO] - Output path: /app/output
2025-01-28 12:21:05,697 - [INFO] - User agent filter: some user agent
2025-01-28 12:21:05,699 - [WARNING] - No parquet files found in input directory
2025-01-28 12:21:05,700 - [ERROR] - Spark processing failed
2025-01-28 12:21:05,700 - [ERROR] - Processing or loading failed
2025-01-28 12:21:05,872 - [INFO] - Spark Session stopped
2025-01-28 12:22:02,562 - [INFO] - Starting application...
2025-01-28 12:22:02,609 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:22:06,067 - [INFO] - Spark Session created successfully
2025-01-28 12:22:06,069 - [INFO] - Spark version: 3.5.0
2025-01-28 12:22:06,070 - [INFO] - Spark master: local[*]
2025-01-28 12:22:06,071 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:22:06,072 - [INFO] - Starting file processing...
2025-01-28 12:22:06,072 - [INFO] - Input path: /app/raw_data
2025-01-28 12:22:06,073 - [INFO] - Output path: /app/output
2025-01-28 12:22:06,074 - [INFO] - User agent filter: some user agent
2025-01-28 12:22:06,075 - [WARNING] - No parquet files found in input directory
2025-01-28 12:22:06,076 - [ERROR] - Spark processing failed
2025-01-28 12:22:06,076 - [ERROR] - Processing or loading failed
2025-01-28 12:22:06,259 - [INFO] - Spark Session stopped
2025-01-28 12:23:01,876 - [INFO] - Starting application...
2025-01-28 12:23:01,911 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:23:05,565 - [INFO] - Spark Session created successfully
2025-01-28 12:23:05,567 - [INFO] - Spark version: 3.5.0
2025-01-28 12:23:05,569 - [INFO] - Spark master: local[*]
2025-01-28 12:23:05,570 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:23:05,572 - [INFO] - Starting file processing...
2025-01-28 12:23:05,573 - [INFO] - Input path: /app/raw_data
2025-01-28 12:23:05,575 - [INFO] - Output path: /app/output
2025-01-28 12:23:05,576 - [INFO] - User agent filter: some user agent
2025-01-28 12:23:05,577 - [WARNING] - No parquet files found in input directory
2025-01-28 12:23:05,578 - [ERROR] - Spark processing failed
2025-01-28 12:23:05,580 - [ERROR] - Processing or loading failed
2025-01-28 12:23:05,737 - [INFO] - Spark Session stopped
2025-01-28 12:24:02,352 - [INFO] - Starting application...
2025-01-28 12:24:02,390 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:24:06,023 - [INFO] - Spark Session created successfully
2025-01-28 12:24:06,026 - [INFO] - Spark version: 3.5.0
2025-01-28 12:24:06,027 - [INFO] - Spark master: local[*]
2025-01-28 12:24:06,027 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:24:06,028 - [INFO] - Starting file processing...
2025-01-28 12:24:06,029 - [INFO] - Input path: /app/raw_data
2025-01-28 12:24:06,030 - [INFO] - Output path: /app/output
2025-01-28 12:24:06,031 - [INFO] - User agent filter: some user agent
2025-01-28 12:24:06,032 - [WARNING] - No parquet files found in input directory
2025-01-28 12:24:06,033 - [ERROR] - Spark processing failed
2025-01-28 12:24:06,033 - [ERROR] - Processing or loading failed
2025-01-28 12:24:06,231 - [INFO] - Spark Session stopped
2025-01-28 12:25:01,830 - [INFO] - Starting application...
2025-01-28 12:25:01,866 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:25:06,512 - [INFO] - Spark Session created successfully
2025-01-28 12:25:06,513 - [INFO] - Spark version: 3.5.0
2025-01-28 12:25:06,515 - [INFO] - Spark master: local[*]
2025-01-28 12:25:06,516 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:25:06,517 - [INFO] - Starting file processing...
2025-01-28 12:25:06,517 - [INFO] - Input path: /app/raw_data
2025-01-28 12:25:06,518 - [INFO] - Output path: /app/output
2025-01-28 12:25:06,519 - [INFO] - User agent filter: some user agent
2025-01-28 12:25:06,546 - [INFO] - Found 11 total parquet files
2025-01-28 12:25:06,547 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:25:06,548 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:25:11,277 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:25:11,819 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:25:13,614 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:25:14,273 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:25:14,827 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:25:15,474 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:25:15,808 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:25:18,673 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 12:25:18,678 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:25:18,683 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:25:18,687 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:25:18,689 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:25:18,957 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:25:19,109 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:25:19,464 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:25:19,854 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:25:20,022 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:25:20,295 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:25:20,533 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:25:20,858 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:25:21,063 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:25:21,497 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:25:21,939 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:25:22,166 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:25:22,449 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:25:22,753 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:25:23,611 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 12:25:24,492 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 12:25:24,496 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:25:24,500 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:25:24,505 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:25:24,509 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:25:24,514 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:25:24,518 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:25:24,522 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:25:24,526 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:25:24,527 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:25:24,528 - [INFO] - Successfully processed 2 dates
2025-01-28 12:25:24,529 - [INFO] - Starting client report loading process...
2025-01-28 12:25:24,536 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 12:25:24,544 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:25:24,555 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:25:24,560 - [INFO] - Archived 0 unique rows
2025-01-28 12:25:24,576 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:25:24,581 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 12:25:24,583 - [INFO] - - Archived rows: 0
2025-01-28 12:25:24,584 - [INFO] - - Loaded rows: 48
2025-01-28 12:25:24,585 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 12:25:24,592 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:25:24,599 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:25:24,602 - [INFO] - Archived 0 unique rows
2025-01-28 12:25:24,608 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:25:24,613 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 12:25:24,614 - [INFO] - - Archived rows: 0
2025-01-28 12:25:24,615 - [INFO] - - Loaded rows: 48
2025-01-28 12:25:24,617 - [INFO] - 
Verifying data load...
2025-01-28 12:25:24,619 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:25:24,621 - [INFO] - 
Load Summary:
2025-01-28 12:25:24,622 - [INFO] - Total files processed: 2
2025-01-28 12:25:24,623 - [INFO] - Total rows loaded: 96
2025-01-28 12:25:24,624 - [INFO] - 
Date Range:
2025-01-28 12:25:24,625 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:25:24,626 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:25:24,627 - [INFO] - 
Total Counts:
2025-01-28 12:25:24,628 - [INFO] -   Impressions: 24
2025-01-28 12:25:24,629 - [INFO] -   Clicks: 30
2025-01-28 12:25:24,630 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:25:24,631 - [INFO] - Processing and loading completed successfully
2025-01-28 12:25:25,642 - [INFO] - Spark Session stopped
2025-01-28 12:26:02,302 - [INFO] - Starting application...
2025-01-28 12:26:02,338 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:26:05,880 - [INFO] - Spark Session created successfully
2025-01-28 12:26:05,882 - [INFO] - Spark version: 3.5.0
2025-01-28 12:26:05,883 - [INFO] - Spark master: local[*]
2025-01-28 12:26:05,885 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:26:05,886 - [INFO] - Starting file processing...
2025-01-28 12:26:05,887 - [INFO] - Input path: /app/raw_data
2025-01-28 12:26:05,888 - [INFO] - Output path: /app/output
2025-01-28 12:26:05,888 - [INFO] - User agent filter: some user agent
2025-01-28 12:26:05,892 - [WARNING] - No parquet files found in input directory
2025-01-28 12:26:05,893 - [ERROR] - Spark processing failed
2025-01-28 12:26:05,894 - [ERROR] - Processing or loading failed
2025-01-28 12:26:06,073 - [INFO] - Spark Session stopped
2025-01-28 12:27:01,695 - [INFO] - Starting application...
2025-01-28 12:27:01,734 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:27:05,094 - [INFO] - Spark Session created successfully
2025-01-28 12:27:05,096 - [INFO] - Spark version: 3.5.0
2025-01-28 12:27:05,097 - [INFO] - Spark master: local[*]
2025-01-28 12:27:05,098 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:27:05,099 - [INFO] - Starting file processing...
2025-01-28 12:27:05,099 - [INFO] - Input path: /app/raw_data
2025-01-28 12:27:05,100 - [INFO] - Output path: /app/output
2025-01-28 12:27:05,101 - [INFO] - User agent filter: some user agent
2025-01-28 12:27:05,102 - [WARNING] - No parquet files found in input directory
2025-01-28 12:27:05,102 - [ERROR] - Spark processing failed
2025-01-28 12:27:05,103 - [ERROR] - Processing or loading failed
2025-01-28 12:27:05,301 - [INFO] - Spark Session stopped
2025-01-28 12:28:10,968 - [INFO] - Starting application...
2025-01-28 12:28:11,025 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:28:16,465 - [INFO] - Spark Session created successfully
2025-01-28 12:28:16,466 - [INFO] - Spark version: 3.5.0
2025-01-28 12:28:16,467 - [INFO] - Spark master: local[*]
2025-01-28 12:28:16,468 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:28:16,469 - [INFO] - Starting file processing...
2025-01-28 12:28:16,469 - [INFO] - Input path: /app/raw_data
2025-01-28 12:28:16,470 - [INFO] - Output path: /app/output
2025-01-28 12:28:16,470 - [INFO] - User agent filter: some user agent
2025-01-28 12:28:16,492 - [INFO] - Found 11 total parquet files
2025-01-28 12:28:16,492 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:28:16,493 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:28:21,299 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:28:21,981 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:28:23,730 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:28:24,463 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:28:25,090 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:28:25,722 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:28:26,091 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:28:28,986 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 12:28:28,990 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:28:28,995 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:28:28,999 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:28:29,000 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:28:29,250 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:28:29,409 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:28:29,787 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:28:30,159 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:28:30,330 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:28:30,601 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:28:30,851 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:28:31,172 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:28:31,370 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:28:31,914 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:28:32,370 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:28:32,577 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:28:32,861 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:28:33,159 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:28:34,055 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 12:28:34,914 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 12:28:34,917 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:28:34,921 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:28:34,925 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:28:34,929 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:28:34,933 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:28:34,936 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:28:34,941 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:28:34,945 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:28:34,945 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:28:34,946 - [INFO] - Successfully processed 2 dates
2025-01-28 12:28:34,946 - [INFO] - Starting client report loading process...
2025-01-28 12:28:34,953 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 12:28:34,961 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:28:34,975 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:28:34,984 - [INFO] - Archived 0 unique rows
2025-01-28 12:28:35,001 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:28:35,006 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 12:28:35,007 - [INFO] - - Archived rows: 0
2025-01-28 12:28:35,007 - [INFO] - - Loaded rows: 48
2025-01-28 12:28:35,008 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 12:28:35,013 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:28:35,019 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:28:35,021 - [INFO] - Archived 0 unique rows
2025-01-28 12:28:35,027 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:28:35,031 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 12:28:35,032 - [INFO] - - Archived rows: 0
2025-01-28 12:28:35,033 - [INFO] - - Loaded rows: 48
2025-01-28 12:28:35,033 - [INFO] - 
Verifying data load...
2025-01-28 12:28:35,037 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:28:35,038 - [INFO] - 
Load Summary:
2025-01-28 12:28:35,039 - [INFO] - Total files processed: 2
2025-01-28 12:28:35,040 - [INFO] - Total rows loaded: 96
2025-01-28 12:28:35,040 - [INFO] - 
Date Range:
2025-01-28 12:28:35,041 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:28:35,041 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:28:35,042 - [INFO] - 
Total Counts:
2025-01-28 12:28:35,042 - [INFO] -   Impressions: 24
2025-01-28 12:28:35,043 - [INFO] -   Clicks: 30
2025-01-28 12:28:35,044 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:28:35,044 - [INFO] - Processing and loading completed successfully
2025-01-28 12:28:36,097 - [INFO] - Spark Session stopped
2025-01-28 12:29:01,978 - [INFO] - Starting application...
2025-01-28 12:29:02,020 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:29:05,875 - [INFO] - Spark Session created successfully
2025-01-28 12:29:05,877 - [INFO] - Spark version: 3.5.0
2025-01-28 12:29:05,878 - [INFO] - Spark master: local[*]
2025-01-28 12:29:05,879 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:29:05,881 - [INFO] - Starting file processing...
2025-01-28 12:29:05,882 - [INFO] - Input path: /app/raw_data
2025-01-28 12:29:05,883 - [INFO] - Output path: /app/output
2025-01-28 12:29:05,884 - [INFO] - User agent filter: some user agent
2025-01-28 12:29:05,889 - [WARNING] - No parquet files found in input directory
2025-01-28 12:29:05,890 - [ERROR] - Spark processing failed
2025-01-28 12:29:05,891 - [ERROR] - Processing or loading failed
2025-01-28 12:29:06,049 - [INFO] - Spark Session stopped
2025-01-28 12:30:01,683 - [INFO] - Starting application...
2025-01-28 12:30:01,717 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:30:05,302 - [INFO] - Spark Session created successfully
2025-01-28 12:30:05,305 - [INFO] - Spark version: 3.5.0
2025-01-28 12:30:05,306 - [INFO] - Spark master: local[*]
2025-01-28 12:30:05,306 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:30:05,307 - [INFO] - Starting file processing...
2025-01-28 12:30:05,308 - [INFO] - Input path: /app/raw_data
2025-01-28 12:30:05,308 - [INFO] - Output path: /app/output
2025-01-28 12:30:05,309 - [INFO] - User agent filter: some user agent
2025-01-28 12:30:05,310 - [WARNING] - No parquet files found in input directory
2025-01-28 12:30:05,311 - [ERROR] - Spark processing failed
2025-01-28 12:30:05,312 - [ERROR] - Processing or loading failed
2025-01-28 12:30:05,510 - [INFO] - Spark Session stopped
2025-01-28 12:30:37,759 - [INFO] - Starting application...
2025-01-28 12:30:37,795 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:30:41,222 - [INFO] - Spark Session created successfully
2025-01-28 12:30:41,223 - [INFO] - Spark version: 3.5.0
2025-01-28 12:30:41,224 - [INFO] - Spark master: local[*]
2025-01-28 12:30:41,225 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:30:41,226 - [INFO] - Starting file processing...
2025-01-28 12:30:41,227 - [INFO] - Input path: /app/raw_data
2025-01-28 12:30:41,227 - [INFO] - Output path: /app/output
2025-01-28 12:30:41,228 - [INFO] - User agent filter: some user agent
2025-01-28 12:30:41,253 - [INFO] - Found 11 total parquet files
2025-01-28 12:30:41,254 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:30:41,255 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:30:46,026 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:30:46,653 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:30:48,304 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:30:49,149 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:30:49,766 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:30:50,442 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:30:50,791 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:30:53,798 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 12:30:53,801 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:30:53,805 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:30:53,809 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:30:53,809 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:30:54,100 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:30:54,251 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:30:54,592 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:30:54,955 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:30:55,175 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:30:55,450 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:30:55,709 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:30:56,067 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:30:56,262 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:30:56,696 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:30:57,082 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:30:57,307 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:30:57,632 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:30:57,921 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:30:58,816 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 12:30:59,671 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 12:30:59,676 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:30:59,680 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:30:59,684 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:30:59,689 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:30:59,694 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:30:59,698 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:30:59,702 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:30:59,707 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:30:59,708 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:30:59,708 - [INFO] - Successfully processed 2 dates
2025-01-28 12:30:59,709 - [INFO] - Starting client report loading process...
2025-01-28 12:30:59,717 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 12:30:59,724 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:30:59,738 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:30:59,744 - [INFO] - Archived 0 unique rows
2025-01-28 12:30:59,758 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:30:59,763 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 12:30:59,763 - [INFO] - - Archived rows: 0
2025-01-28 12:30:59,764 - [INFO] - - Loaded rows: 48
2025-01-28 12:30:59,765 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 12:30:59,771 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:30:59,778 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:30:59,780 - [INFO] - Archived 0 unique rows
2025-01-28 12:30:59,785 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:30:59,790 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 12:30:59,790 - [INFO] - - Archived rows: 0
2025-01-28 12:30:59,791 - [INFO] - - Loaded rows: 48
2025-01-28 12:30:59,792 - [INFO] - 
Verifying data load...
2025-01-28 12:30:59,794 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:30:59,795 - [INFO] - 
Load Summary:
2025-01-28 12:30:59,796 - [INFO] - Total files processed: 2
2025-01-28 12:30:59,796 - [INFO] - Total rows loaded: 96
2025-01-28 12:30:59,797 - [INFO] - 
Date Range:
2025-01-28 12:30:59,797 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:30:59,798 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:30:59,799 - [INFO] - 
Total Counts:
2025-01-28 12:30:59,799 - [INFO] -   Impressions: 24
2025-01-28 12:30:59,800 - [INFO] -   Clicks: 30
2025-01-28 12:30:59,800 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:30:59,801 - [INFO] - Processing and loading completed successfully
2025-01-28 12:31:00,846 - [INFO] - Spark Session stopped
2025-01-28 12:31:01,645 - [INFO] - Starting application...
2025-01-28 12:31:01,688 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:31:05,367 - [INFO] - Spark Session created successfully
2025-01-28 12:31:05,369 - [INFO] - Spark version: 3.5.0
2025-01-28 12:31:05,370 - [INFO] - Spark master: local[*]
2025-01-28 12:31:05,371 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:31:05,372 - [INFO] - Starting file processing...
2025-01-28 12:31:05,373 - [INFO] - Input path: /app/raw_data
2025-01-28 12:31:05,374 - [INFO] - Output path: /app/output
2025-01-28 12:31:05,375 - [INFO] - User agent filter: some user agent
2025-01-28 12:31:05,378 - [WARNING] - No parquet files found in input directory
2025-01-28 12:31:05,378 - [ERROR] - Spark processing failed
2025-01-28 12:31:05,379 - [ERROR] - Processing or loading failed
2025-01-28 12:31:05,518 - [INFO] - Spark Session stopped
2025-01-28 14:32:23,555 - [INFO] - Starting application...
2025-01-28 14:32:26,435 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Unknown host

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:32:55,738 - [INFO] - Starting application...
2025-01-28 14:32:55,806 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:33:21,972 - [INFO] - Spark Session created successfully
2025-01-28 14:33:21,972 - [INFO] - Spark version: 3.5.4
2025-01-28 14:33:21,972 - [INFO] - Spark master: local[*]
2025-01-28 14:33:21,973 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:33:21,973 - [INFO] - Starting file processing...
2025-01-28 14:33:21,973 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 14:33:21,973 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 14:33:21,973 - [INFO] - User agent filter: some user agent
2025-01-28 14:33:21,974 - [INFO] - Found 11 total parquet files
2025-01-28 14:33:21,975 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:33:21,975 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:33:27,786 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:33:28,272 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:33:30,069 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:33:30,539 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:33:30,985 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:33:31,446 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:33:31,733 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:33:36,995 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 14:33:36,995 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:33:36,996 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:33:36,997 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:33:36,997 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:33:37,279 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:33:37,457 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:33:38,642 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:33:38,894 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:33:39,130 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:33:39,303 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:33:39,490 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:33:39,772 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:33:39,963 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:33:41,365 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:33:41,676 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:33:41,882 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:33:42,121 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:33:42,408 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:33:46,540 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:33:47,369 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 14:33:47,370 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:33:47,371 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:33:47,372 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:33:47,372 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:33:47,373 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:33:47,374 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:33:47,375 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:33:47,376 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:33:47,376 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:33:47,376 - [INFO] - Successfully processed 2 dates
2025-01-28 14:33:47,376 - [INFO] - Starting client report loading process...
2025-01-28 14:33:47,377 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 14:33:47,380 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:33:47,389 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:33:47,395 - [INFO] - Archived 0 unique rows
2025-01-28 14:33:47,412 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:33:47,420 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 14:33:47,420 - [INFO] - - Archived rows: 0
2025-01-28 14:33:47,420 - [INFO] - - Loaded rows: 48
2025-01-28 14:33:47,420 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 14:33:47,424 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:33:47,431 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:33:47,472 - [ERROR] - Error storing invalid records: (psycopg2.errors.DatatypeMismatch) column "datetime" is of type timestamp without time zone but expression is of type text
LINE 10:                     SELECT s.datetime,
                                    ^
HINT:  You will need to rewrite or cast the expression.

[SQL: 
                    INSERT INTO adform_dw.client_report_invalid (
                        datetime,
                        impression_count,
                        click_count,
                        audit_loaded_datetime,
                        validation_error,
                        source_file
                    )
                    SELECT s.datetime,
                           s.impression_count,
                           s.click_count,
                           s.audit_loaded_datetime,
                           s.validation_error,
                           s.source_file
                    FROM adform_dw.client_report_invalid_staging s
                    ON CONFLICT (datetime, source_file)
                    DO UPDATE 
                       SET impression_count     = EXCLUDED.impression_count,
                           click_count         = EXCLUDED.click_count,
                           audit_loaded_datetime = EXCLUDED.audit_loaded_datetime,
                           validation_error    = EXCLUDED.validation_error;
                ]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-28 14:33:47,474 - [ERROR] - Error loading data: (psycopg2.errors.DatatypeMismatch) column "datetime" is of type timestamp without time zone but expression is of type text
LINE 10:                     SELECT s.datetime,
                                    ^
HINT:  You will need to rewrite or cast the expression.

[SQL: 
                    INSERT INTO adform_dw.client_report_invalid (
                        datetime,
                        impression_count,
                        click_count,
                        audit_loaded_datetime,
                        validation_error,
                        source_file
                    )
                    SELECT s.datetime,
                           s.impression_count,
                           s.click_count,
                           s.audit_loaded_datetime,
                           s.validation_error,
                           s.source_file
                    FROM adform_dw.client_report_invalid_staging s
                    ON CONFLICT (datetime, source_file)
                    DO UPDATE 
                       SET impression_count     = EXCLUDED.impression_count,
                           click_count         = EXCLUDED.click_count,
                           audit_loaded_datetime = EXCLUDED.audit_loaded_datetime,
                           validation_error    = EXCLUDED.validation_error;
                ]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-28 14:33:47,475 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv: (psycopg2.errors.DatatypeMismatch) column "datetime" is of type timestamp without time zone but expression is of type text
LINE 10:                     SELECT s.datetime,
                                    ^
HINT:  You will need to rewrite or cast the expression.

[SQL: 
                    INSERT INTO adform_dw.client_report_invalid (
                        datetime,
                        impression_count,
                        click_count,
                        audit_loaded_datetime,
                        validation_error,
                        source_file
                    )
                    SELECT s.datetime,
                           s.impression_count,
                           s.click_count,
                           s.audit_loaded_datetime,
                           s.validation_error,
                           s.source_file
                    FROM adform_dw.client_report_invalid_staging s
                    ON CONFLICT (datetime, source_file)
                    DO UPDATE 
                       SET impression_count     = EXCLUDED.impression_count,
                           click_count         = EXCLUDED.click_count,
                           audit_loaded_datetime = EXCLUDED.audit_loaded_datetime,
                           validation_error    = EXCLUDED.validation_error;
                ]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-28 14:33:47,475 - [ERROR] - Processing or loading failed
2025-01-28 14:33:48,543 - [INFO] - Spark Session stopped
2025-01-28 14:43:20,841 - [INFO] - Starting application...
2025-01-28 14:43:20,904 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:43:26,329 - [INFO] - Spark Session created successfully
2025-01-28 14:43:26,330 - [INFO] - Spark version: 3.5.4
2025-01-28 14:43:26,330 - [INFO] - Spark master: local[*]
2025-01-28 14:43:26,330 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:43:26,330 - [INFO] - Starting file processing...
2025-01-28 14:43:26,330 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 14:43:26,331 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 14:43:26,331 - [INFO] - User agent filter: some user agent
2025-01-28 14:43:26,332 - [INFO] - Found 11 total parquet files
2025-01-28 14:43:26,332 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:43:26,332 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:43:32,017 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:43:32,510 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:43:34,412 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:43:34,940 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:43:35,379 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:43:35,814 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:43:36,083 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:43:41,443 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 14:43:41,444 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:43:41,444 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:43:41,446 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:43:41,446 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:43:41,810 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:43:41,992 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:43:43,131 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:43:43,408 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:43:43,610 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:43:43,801 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:43:44,019 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:43:44,302 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:43:44,482 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:43:45,952 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:43:46,228 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:43:46,417 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:43:46,637 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:43:46,806 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:43:50,931 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:43:51,701 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 14:43:51,702 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:43:51,703 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:43:51,704 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:43:51,705 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:43:51,705 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:43:51,706 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:43:51,707 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:43:51,708 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:43:51,708 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:43:51,709 - [INFO] - Successfully processed 2 dates
2025-01-28 14:43:51,709 - [INFO] - Starting client report loading process...
2025-01-28 14:43:51,710 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 14:43:51,714 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:43:51,732 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:43:51,738 - [INFO] - Archived 0 unique rows
2025-01-28 14:43:51,758 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:43:51,766 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 14:43:51,766 - [INFO] - - Archived rows: 0
2025-01-28 14:43:51,766 - [INFO] - - Loaded rows: 48
2025-01-28 14:43:51,766 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 14:43:51,771 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:43:51,782 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:43:51,811 - [ERROR] - Error storing invalid records: (psycopg2.errors.DatatypeMismatch) column "datetime" is of type timestamp without time zone but expression is of type text
LINE 10:                     SELECT s.datetime,
                                    ^
HINT:  You will need to rewrite or cast the expression.

[SQL: 
                    INSERT INTO adform_dw.client_report_invalid (
                        datetime,
                        impression_count,
                        click_count,
                        audit_loaded_datetime,
                        validation_error,
                        source_file
                    )
                    SELECT s.datetime,
                           s.impression_count,
                           s.click_count,
                           s.audit_loaded_datetime,
                           s.validation_error,
                           s.source_file
                    FROM adform_dw.client_report_invalid_staging s
                    ON CONFLICT (datetime, source_file)
                    DO UPDATE 
                       SET impression_count     = EXCLUDED.impression_count,
                           click_count         = EXCLUDED.click_count,
                           audit_loaded_datetime = EXCLUDED.audit_loaded_datetime,
                           validation_error    = EXCLUDED.validation_error;
                ]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-28 14:43:51,812 - [ERROR] - Error loading data: (psycopg2.errors.DatatypeMismatch) column "datetime" is of type timestamp without time zone but expression is of type text
LINE 10:                     SELECT s.datetime,
                                    ^
HINT:  You will need to rewrite or cast the expression.

[SQL: 
                    INSERT INTO adform_dw.client_report_invalid (
                        datetime,
                        impression_count,
                        click_count,
                        audit_loaded_datetime,
                        validation_error,
                        source_file
                    )
                    SELECT s.datetime,
                           s.impression_count,
                           s.click_count,
                           s.audit_loaded_datetime,
                           s.validation_error,
                           s.source_file
                    FROM adform_dw.client_report_invalid_staging s
                    ON CONFLICT (datetime, source_file)
                    DO UPDATE 
                       SET impression_count     = EXCLUDED.impression_count,
                           click_count         = EXCLUDED.click_count,
                           audit_loaded_datetime = EXCLUDED.audit_loaded_datetime,
                           validation_error    = EXCLUDED.validation_error;
                ]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-28 14:43:51,813 - [ERROR] - Error processing C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv: (psycopg2.errors.DatatypeMismatch) column "datetime" is of type timestamp without time zone but expression is of type text
LINE 10:                     SELECT s.datetime,
                                    ^
HINT:  You will need to rewrite or cast the expression.

[SQL: 
                    INSERT INTO adform_dw.client_report_invalid (
                        datetime,
                        impression_count,
                        click_count,
                        audit_loaded_datetime,
                        validation_error,
                        source_file
                    )
                    SELECT s.datetime,
                           s.impression_count,
                           s.click_count,
                           s.audit_loaded_datetime,
                           s.validation_error,
                           s.source_file
                    FROM adform_dw.client_report_invalid_staging s
                    ON CONFLICT (datetime, source_file)
                    DO UPDATE 
                       SET impression_count     = EXCLUDED.impression_count,
                           click_count         = EXCLUDED.click_count,
                           audit_loaded_datetime = EXCLUDED.audit_loaded_datetime,
                           validation_error    = EXCLUDED.validation_error;
                ]
(Background on this error at: https://sqlalche.me/e/14/f405)
2025-01-28 14:43:51,814 - [ERROR] - Processing or loading failed
2025-01-28 14:43:52,924 - [INFO] - Spark Session stopped
2025-01-28 14:45:54,918 - [INFO] - Starting application...
2025-01-28 14:45:55,009 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:46:12,379 - [INFO] - Spark Session created successfully
2025-01-28 14:46:12,379 - [INFO] - Spark version: 3.5.4
2025-01-28 14:46:12,379 - [INFO] - Spark master: local[*]
2025-01-28 14:46:12,380 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:46:12,380 - [INFO] - Starting file processing...
2025-01-28 14:46:12,380 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 14:46:12,380 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 14:46:12,380 - [INFO] - User agent filter: some user agent
2025-01-28 14:46:12,382 - [INFO] - Found 11 total parquet files
2025-01-28 14:46:12,382 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:46:12,382 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:46:18,095 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:46:18,616 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:46:20,607 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:46:21,131 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:46:21,676 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:46:22,064 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:46:22,327 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:46:28,320 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 14:46:28,321 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:46:28,323 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:46:28,324 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:46:28,324 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:46:28,656 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:46:28,883 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:46:30,253 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:46:30,553 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:46:30,737 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:46:30,941 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:46:31,133 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:46:31,569 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:46:31,779 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:46:33,353 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:46:33,614 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:46:33,801 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:46:34,063 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:46:34,241 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:46:38,554 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:46:39,383 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 14:46:39,384 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:46:39,384 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:46:39,386 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:46:39,387 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:46:39,388 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:46:39,389 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:46:39,389 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:46:39,390 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:46:39,390 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:46:39,390 - [INFO] - Successfully processed 2 dates
2025-01-28 14:46:39,391 - [INFO] - Starting client report loading process...
2025-01-28 14:46:39,391 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 14:46:39,393 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:46:39,401 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:46:39,407 - [INFO] - Archived 0 unique rows
2025-01-28 14:46:39,423 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:46:39,427 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 14:46:39,428 - [INFO] - - Archived rows: 0
2025-01-28 14:46:39,428 - [INFO] - - Loaded rows: 48
2025-01-28 14:46:39,428 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 14:46:39,431 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:46:39,438 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:46:39,466 - [INFO] - Upsert completed: stored/updated 2 invalid records in client_report_invalid.
2025-01-28 14:46:39,469 - [INFO] - Archived 0 unique rows
2025-01-28 14:46:39,479 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:46:39,483 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 14:46:39,483 - [INFO] - - Archived rows: 0
2025-01-28 14:46:39,484 - [INFO] - - Loaded rows: 48
2025-01-28 14:46:39,484 - [INFO] - 
Verifying data load...
2025-01-28 14:46:39,490 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 14:46:39,492 - [INFO] - 
Load Summary:
2025-01-28 14:46:39,492 - [INFO] - Total files processed: 2
2025-01-28 14:46:39,492 - [INFO] - Total rows loaded: 96
2025-01-28 14:46:39,492 - [INFO] - 
Date Range:
2025-01-28 14:46:39,492 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 14:46:39,492 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 14:46:39,493 - [INFO] - 
Total Counts:
2025-01-28 14:46:39,493 - [INFO] -   Impressions: 24
2025-01-28 14:46:39,493 - [INFO] -   Clicks: 30
2025-01-28 14:46:39,493 - [INFO] - 
Client report loading completed successfully
2025-01-28 14:46:39,493 - [INFO] - Processing and loading completed successfully
2025-01-28 14:46:40,548 - [INFO] - Spark Session stopped
2025-01-28 14:47:52,454 - [INFO] - Starting application...
2025-01-28 14:47:52,513 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:48:06,774 - [INFO] - Spark Session created successfully
2025-01-28 14:48:06,774 - [INFO] - Spark version: 3.5.4
2025-01-28 14:48:06,775 - [INFO] - Spark master: local[*]
2025-01-28 14:48:06,775 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:48:06,775 - [INFO] - Starting file processing...
2025-01-28 14:48:06,775 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 14:48:06,775 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 14:48:06,776 - [INFO] - User agent filter: some user agent
2025-01-28 14:48:06,777 - [INFO] - Found 11 total parquet files
2025-01-28 14:48:06,777 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:48:06,777 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:48:11,827 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:48:12,280 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:48:14,112 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:48:14,575 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:48:14,972 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:48:15,393 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:48:15,674 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:48:20,626 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 14:48:20,627 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:48:20,627 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:48:20,628 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:48:20,628 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:48:20,868 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:48:21,032 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:48:22,111 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:48:22,361 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:48:22,569 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:48:22,757 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:48:22,937 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:48:23,258 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:48:23,410 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:48:24,781 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:48:25,032 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:48:25,247 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:48:25,436 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:48:25,655 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:48:29,571 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:48:30,302 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 14:48:30,303 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:48:30,304 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:48:30,304 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:48:30,305 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:48:30,306 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:48:30,306 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:48:30,307 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:48:30,308 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:48:30,308 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:48:30,308 - [INFO] - Successfully processed 2 dates
2025-01-28 14:48:30,309 - [INFO] - Starting client report loading process...
2025-01-28 14:48:30,309 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 14:48:30,311 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:48:30,320 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:48:30,327 - [INFO] - Archived 0 unique rows
2025-01-28 14:48:30,345 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:48:30,352 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 14:48:30,352 - [INFO] - - Archived rows: 0
2025-01-28 14:48:30,352 - [INFO] - - Loaded rows: 48
2025-01-28 14:48:30,352 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 14:48:30,356 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:48:30,364 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:48:30,395 - [INFO] - Upsert completed: stored/updated 2 invalid records in client_report_invalid.
2025-01-28 14:48:30,398 - [INFO] - Archived 0 unique rows
2025-01-28 14:48:30,408 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:48:30,413 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 14:48:30,413 - [INFO] - - Archived rows: 0
2025-01-28 14:48:30,414 - [INFO] - - Loaded rows: 48
2025-01-28 14:48:30,414 - [INFO] - 
Verifying data load...
2025-01-28 14:48:30,421 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 14:48:30,422 - [INFO] - 
Load Summary:
2025-01-28 14:48:30,422 - [INFO] - Total files processed: 2
2025-01-28 14:48:30,423 - [INFO] - Total rows loaded: 96
2025-01-28 14:48:30,423 - [INFO] - 
Date Range:
2025-01-28 14:48:30,423 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 14:48:30,423 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 14:48:30,424 - [INFO] - 
Total Counts:
2025-01-28 14:48:30,424 - [INFO] -   Impressions: 24
2025-01-28 14:48:30,424 - [INFO] -   Clicks: 30
2025-01-28 14:48:30,425 - [INFO] - 
Client report loading completed successfully
2025-01-28 14:48:30,425 - [INFO] - Processing and loading completed successfully
2025-01-28 14:48:31,582 - [INFO] - Spark Session stopped
2025-01-28 12:49:44,013 - [INFO] - Starting application...
2025-01-28 12:49:44,061 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:49:47,591 - [INFO] - Spark Session created successfully
2025-01-28 12:49:47,592 - [INFO] - Spark version: 3.5.0
2025-01-28 12:49:47,593 - [INFO] - Spark master: local[*]
2025-01-28 12:49:47,594 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:49:47,594 - [INFO] - Starting file processing...
2025-01-28 12:49:47,595 - [INFO] - Input path: /app/raw_data
2025-01-28 12:49:47,596 - [INFO] - Output path: /app/output
2025-01-28 12:49:47,597 - [INFO] - User agent filter: some user agent
2025-01-28 12:49:47,618 - [INFO] - Found 11 total parquet files
2025-01-28 12:49:47,619 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:49:47,620 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:49:51,754 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:49:52,269 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:49:53,833 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:49:54,480 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:49:55,029 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:49:55,646 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:49:55,971 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:49:58,567 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 12:49:58,571 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:49:58,575 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:49:58,579 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:49:58,580 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:49:58,811 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:49:58,977 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:49:59,251 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:49:59,596 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:49:59,788 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:50:00,105 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:50:00,310 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:50:00,599 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:50:00,843 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:50:01,242 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:50:01,710 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:50:01,906 - [INFO] - Starting application...
2025-01-28 12:50:01,907 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:50:01,947 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:50:02,245 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:50:02,609 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:50:03,563 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 12:50:04,527 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 12:50:04,532 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:50:04,536 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:50:04,540 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:50:04,544 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:50:04,549 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:50:04,553 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:50:04,558 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:50:04,563 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:50:04,564 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:50:04,565 - [INFO] - Successfully processed 2 dates
2025-01-28 12:50:04,566 - [INFO] - Starting client report loading process...
2025-01-28 12:50:04,579 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 12:50:04,590 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:50:04,617 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:50:04,626 - [INFO] - Archived 0 unique rows
2025-01-28 12:50:04,652 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:50:04,659 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 12:50:04,660 - [INFO] - - Archived rows: 0
2025-01-28 12:50:04,661 - [INFO] - - Loaded rows: 48
2025-01-28 12:50:04,662 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 12:50:04,670 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:50:04,681 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:50:04,684 - [INFO] - Archived 0 unique rows
2025-01-28 12:50:04,693 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:50:04,698 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 12:50:04,700 - [INFO] - - Archived rows: 0
2025-01-28 12:50:04,701 - [INFO] - - Loaded rows: 48
2025-01-28 12:50:04,703 - [INFO] - 
Verifying data load...
2025-01-28 12:50:04,708 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:50:04,709 - [INFO] - 
Load Summary:
2025-01-28 12:50:04,710 - [INFO] - Total files processed: 2
2025-01-28 12:50:04,711 - [INFO] - Total rows loaded: 96
2025-01-28 12:50:04,711 - [INFO] - 
Date Range:
2025-01-28 12:50:04,712 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:50:04,713 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:50:04,715 - [INFO] - 
Total Counts:
2025-01-28 12:50:04,716 - [INFO] -   Impressions: 24
2025-01-28 12:50:04,717 - [INFO] -   Clicks: 30
2025-01-28 12:50:04,717 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:50:04,718 - [INFO] - Processing and loading completed successfully
2025-01-28 12:50:05,599 - [INFO] - Spark Session stopped
2025-01-28 12:50:06,023 - [INFO] - Spark Session created successfully
2025-01-28 12:50:06,025 - [INFO] - Spark version: 3.5.0
2025-01-28 12:50:06,026 - [INFO] - Spark master: local[*]
2025-01-28 12:50:06,027 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:50:06,028 - [INFO] - Starting file processing...
2025-01-28 12:50:06,029 - [INFO] - Input path: /app/raw_data
2025-01-28 12:50:06,030 - [INFO] - Output path: /app/output
2025-01-28 12:50:06,031 - [INFO] - User agent filter: some user agent
2025-01-28 12:50:06,038 - [WARNING] - No parquet files found in input directory
2025-01-28 12:50:06,040 - [ERROR] - Spark processing failed
2025-01-28 12:50:06,041 - [ERROR] - Processing or loading failed
2025-01-28 12:50:06,156 - [INFO] - Spark Session stopped
2025-01-28 12:51:02,266 - [INFO] - Starting application...
2025-01-28 12:51:02,319 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:51:05,640 - [INFO] - Spark Session created successfully
2025-01-28 12:51:05,642 - [INFO] - Spark version: 3.5.0
2025-01-28 12:51:05,643 - [INFO] - Spark master: local[*]
2025-01-28 12:51:05,644 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:51:05,645 - [INFO] - Starting file processing...
2025-01-28 12:51:05,646 - [INFO] - Input path: /app/raw_data
2025-01-28 12:51:05,647 - [INFO] - Output path: /app/output
2025-01-28 12:51:05,648 - [INFO] - User agent filter: some user agent
2025-01-28 12:51:05,670 - [INFO] - Found 11 total parquet files
2025-01-28 12:51:05,671 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 12:51:05,672 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 12:51:09,878 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:51:10,504 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 12:51:12,092 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:51:12,808 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:51:13,376 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:51:13,995 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 12:51:14,338 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 12:51:16,991 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 12:51:16,995 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 12:51:17,000 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 12:51:17,004 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 12:51:17,005 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 12:51:17,249 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 12:51:17,392 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 12:51:17,663 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:51:18,012 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:51:18,179 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 12:51:18,430 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 12:51:18,638 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 12:51:18,925 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 12:51:19,149 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 12:51:19,514 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:51:19,881 - [INFO] - Found 0 records with invalid hours
2025-01-28 12:51:20,069 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:51:20,335 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 12:51:20,603 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 12:51:21,450 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 12:51:22,280 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 12:51:22,284 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 12:51:22,289 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 12:51:22,293 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 12:51:22,297 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 12:51:22,301 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 12:51:22,304 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 12:51:22,308 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 12:51:22,312 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 12:51:22,313 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 12:51:22,314 - [INFO] - Successfully processed 2 dates
2025-01-28 12:51:22,314 - [INFO] - Starting client report loading process...
2025-01-28 12:51:22,322 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 12:51:22,331 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:51:22,349 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:51:22,359 - [INFO] - Archived 0 unique rows
2025-01-28 12:51:22,383 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:51:22,390 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 12:51:22,392 - [INFO] - - Archived rows: 0
2025-01-28 12:51:22,393 - [INFO] - - Loaded rows: 48
2025-01-28 12:51:22,394 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 12:51:22,401 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 12:51:22,407 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 12:51:22,409 - [INFO] - Archived 0 unique rows
2025-01-28 12:51:22,414 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 12:51:22,419 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 12:51:22,420 - [INFO] - - Archived rows: 0
2025-01-28 12:51:22,422 - [INFO] - - Loaded rows: 48
2025-01-28 12:51:22,423 - [INFO] - 
Verifying data load...
2025-01-28 12:51:22,426 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 12:51:22,428 - [INFO] - 
Load Summary:
2025-01-28 12:51:22,428 - [INFO] - Total files processed: 2
2025-01-28 12:51:22,429 - [INFO] - Total rows loaded: 96
2025-01-28 12:51:22,431 - [INFO] - 
Date Range:
2025-01-28 12:51:22,432 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 12:51:22,432 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 12:51:22,434 - [INFO] - 
Total Counts:
2025-01-28 12:51:22,435 - [INFO] -   Impressions: 24
2025-01-28 12:51:22,435 - [INFO] -   Clicks: 30
2025-01-28 12:51:22,436 - [INFO] - 
Client report loading completed successfully
2025-01-28 12:51:22,437 - [INFO] - Processing and loading completed successfully
2025-01-28 12:51:23,483 - [INFO] - Spark Session stopped
2025-01-28 12:52:02,294 - [INFO] - Starting application...
2025-01-28 12:52:02,333 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 12:52:05,842 - [INFO] - Spark Session created successfully
2025-01-28 12:52:05,844 - [INFO] - Spark version: 3.5.0
2025-01-28 12:52:05,845 - [INFO] - Spark master: local[*]
2025-01-28 12:52:05,846 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 12:52:05,847 - [INFO] - Starting file processing...
2025-01-28 12:52:05,848 - [INFO] - Input path: /app/raw_data
2025-01-28 12:52:05,849 - [INFO] - Output path: /app/output
2025-01-28 12:52:05,850 - [INFO] - User agent filter: some user agent
2025-01-28 12:52:05,853 - [WARNING] - No parquet files found in input directory
2025-01-28 12:52:05,854 - [ERROR] - Spark processing failed
2025-01-28 12:52:05,856 - [ERROR] - Processing or loading failed
2025-01-28 12:52:06,036 - [INFO] - Spark Session stopped
2025-01-28 14:53:13,006 - [INFO] - Starting application...
2025-01-28 14:53:15,907 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) could not translate host name "postgres" to address: Unknown host

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:53:45,194 - [INFO] - Starting application...
2025-01-28 14:53:45,257 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:54:10,954 - [INFO] - Spark Session created successfully
2025-01-28 14:54:10,954 - [INFO] - Spark version: 3.5.4
2025-01-28 14:54:10,955 - [INFO] - Spark master: local[*]
2025-01-28 14:54:10,955 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:54:10,955 - [INFO] - Starting file processing...
2025-01-28 14:54:10,955 - [INFO] - Input path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data
2025-01-28 14:54:10,955 - [INFO] - Output path: C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output
2025-01-28 14:54:10,955 - [INFO] - User agent filter: some user agent
2025-01-28 14:54:10,956 - [INFO] - Found 11 total parquet files
2025-01-28 14:54:10,957 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:54:10,957 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:54:15,942 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:54:16,390 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:54:18,052 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:54:18,522 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:54:18,909 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:54:19,251 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:54:19,484 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:54:24,164 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-26.csv
2025-01-28 14:54:24,165 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:54:24,166 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:54:24,166 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:54:24,166 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:54:24,467 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:54:24,613 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:54:25,685 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:54:25,916 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:54:26,094 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:54:26,265 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:54:26,481 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:54:26,712 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:54:26,861 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:54:28,175 - [INFO] - Processing file: file:///C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:54:28,417 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:54:28,616 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:54:28,867 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:54:29,054 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:54:32,937 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:54:33,628 - [INFO] - Successfully wrote output to C:/Users/Rokas/Documents/Airidas/adform/adform_spark_app/output\task1_output_2022-05-27.csv
2025-01-28 14:54:33,629 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:54:33,630 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:54:33,631 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:54:33,632 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:54:33,632 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:54:33,633 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:54:33,634 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:54:33,634 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:54:33,634 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:54:33,635 - [INFO] - Successfully processed 2 dates
2025-01-28 14:54:33,635 - [INFO] - Starting client report loading process...
2025-01-28 14:54:33,635 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv
2025-01-28 14:54:33,637 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:54:33,645 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:54:33,650 - [INFO] - Archived 0 unique rows
2025-01-28 14:54:33,666 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:54:33,672 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-26.csv:
2025-01-28 14:54:33,672 - [INFO] - - Archived rows: 0
2025-01-28 14:54:33,672 - [INFO] - - Loaded rows: 48
2025-01-28 14:54:33,673 - [INFO] - Reading file: C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv
2025-01-28 14:54:33,676 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:54:33,682 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:54:33,715 - [INFO] - Upsert completed: stored/updated 2 invalid records in client_report_invalid.
2025-01-28 14:54:33,718 - [INFO] - Archived 0 unique rows
2025-01-28 14:54:33,729 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:54:33,733 - [INFO] - Processed C:\Users\Rokas\Documents\Airidas\adform\adform_spark_app\output\task1_output_2022-05-27.csv:
2025-01-28 14:54:33,733 - [INFO] - - Archived rows: 0
2025-01-28 14:54:33,733 - [INFO] - - Loaded rows: 48
2025-01-28 14:54:33,734 - [INFO] - 
Verifying data load...
2025-01-28 14:54:33,738 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 14:54:33,740 - [INFO] - 
Load Summary:
2025-01-28 14:54:33,740 - [INFO] - Total files processed: 2
2025-01-28 14:54:33,740 - [INFO] - Total rows loaded: 96
2025-01-28 14:54:33,741 - [INFO] - 
Date Range:
2025-01-28 14:54:33,741 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 14:54:33,741 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 14:54:33,741 - [INFO] - 
Total Counts:
2025-01-28 14:54:33,741 - [INFO] -   Impressions: 24
2025-01-28 14:54:33,742 - [INFO] -   Clicks: 30
2025-01-28 14:54:33,742 - [INFO] - 
Client report loading completed successfully
2025-01-28 14:54:33,742 - [INFO] - Processing and loading completed successfully
2025-01-28 14:54:33,922 - [INFO] - Spark Session stopped
2025-01-28 13:00:08,894 - [INFO] - Starting application...
2025-01-28 13:00:08,956 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 13:01:03,425 - [INFO] - Starting application...
2025-01-28 13:01:03,460 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 13:02:03,328 - [INFO] - Starting application...
2025-01-28 13:02:03,447 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 13:02:21,171 - [INFO] - Starting application...
2025-01-28 13:02:21,193 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 13:03:02,445 - [INFO] - Starting application...
2025-01-28 13:03:02,492 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 13:03:06,426 - [INFO] - Spark Session created successfully
2025-01-28 13:03:06,427 - [INFO] - Spark version: 3.5.0
2025-01-28 13:03:06,427 - [INFO] - Spark master: local[*]
2025-01-28 13:03:06,428 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 13:03:06,428 - [INFO] - Starting file processing...
2025-01-28 13:03:06,429 - [INFO] - Input path: /app/raw_data
2025-01-28 13:03:06,430 - [INFO] - Output path: /app/output
2025-01-28 13:03:06,430 - [INFO] - User agent filter: some user agent
2025-01-28 13:03:06,451 - [INFO] - Found 11 total parquet files
2025-01-28 13:03:06,452 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 13:03:06,453 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 13:03:10,894 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:03:11,433 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 13:03:12,915 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:03:13,560 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:03:14,118 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:03:14,774 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 13:03:15,104 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 13:03:17,815 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 13:03:17,819 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 13:03:17,822 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 13:03:17,826 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 13:03:17,826 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 13:03:18,100 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 13:03:18,240 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 13:03:18,544 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:03:18,882 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:03:19,064 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 13:03:19,322 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 13:03:19,542 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 13:03:19,868 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 13:03:20,041 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 13:03:20,481 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:03:20,825 - [INFO] - Found 0 records with invalid hours
2025-01-28 13:03:21,016 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:03:21,382 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 13:03:21,639 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 13:03:22,534 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 13:03:23,484 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 13:03:23,488 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 13:03:23,493 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 13:03:23,498 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 13:03:23,501 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 13:03:23,505 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 13:03:23,510 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 13:03:23,514 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 13:03:23,518 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 13:03:23,519 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 13:03:23,520 - [INFO] - Successfully processed 2 dates
2025-01-28 13:03:23,521 - [INFO] - Starting client report loading process...
2025-01-28 13:03:23,539 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 13:03:23,584 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:03:23,767 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:03:23,901 - [INFO] - Archived 0 unique rows
2025-01-28 13:03:24,151 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:03:24,158 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 13:03:24,159 - [INFO] - - Archived rows: 0
2025-01-28 13:03:24,160 - [INFO] - - Loaded rows: 48
2025-01-28 13:03:24,161 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 13:03:24,167 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 13:03:24,174 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 13:03:24,243 - [INFO] - Upsert completed: stored/updated 2 invalid records in client_report_invalid.
2025-01-28 13:03:24,245 - [INFO] - Archived 0 unique rows
2025-01-28 13:03:24,251 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 13:03:24,254 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 13:03:24,255 - [INFO] - - Archived rows: 0
2025-01-28 13:03:24,256 - [INFO] - - Loaded rows: 48
2025-01-28 13:03:24,256 - [INFO] - 
Verifying data load...
2025-01-28 13:03:24,262 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 13:03:24,263 - [INFO] - 
Load Summary:
2025-01-28 13:03:24,264 - [INFO] - Total files processed: 2
2025-01-28 13:03:24,264 - [INFO] - Total rows loaded: 96
2025-01-28 13:03:24,265 - [INFO] - 
Date Range:
2025-01-28 13:03:24,265 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 13:03:24,266 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 13:03:24,267 - [INFO] - 
Total Counts:
2025-01-28 13:03:24,268 - [INFO] -   Impressions: 24
2025-01-28 13:03:24,268 - [INFO] -   Clicks: 30
2025-01-28 13:03:24,269 - [INFO] - 
Client report loading completed successfully
2025-01-28 13:03:24,269 - [INFO] - Processing and loading completed successfully
2025-01-28 13:03:24,570 - [INFO] - Spark Session stopped
2025-01-28 14:12:26,149 - [INFO] - Starting application...
2025-01-28 14:12:26,207 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:12:29,894 - [INFO] - Spark Session created successfully
2025-01-28 14:12:29,895 - [INFO] - Spark version: 3.5.0
2025-01-28 14:12:29,896 - [INFO] - Spark master: local[*]
2025-01-28 14:12:29,896 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:12:29,897 - [INFO] - Starting file processing...
2025-01-28 14:12:29,898 - [INFO] - Input path: /app/raw_data
2025-01-28 14:12:29,899 - [INFO] - Output path: /app/output
2025-01-28 14:12:29,899 - [INFO] - User agent filter: some user agent
2025-01-28 14:12:29,903 - [WARNING] - No parquet files found in input directory
2025-01-28 14:12:29,904 - [ERROR] - Spark processing failed
2025-01-28 14:12:29,905 - [ERROR] - Processing or loading failed
2025-01-28 14:12:30,066 - [INFO] - Spark Session stopped
2025-01-28 14:13:01,839 - [INFO] - Starting application...
2025-01-28 14:13:01,865 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:13:08,841 - [INFO] - Starting application...
2025-01-28 14:13:08,888 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:13:11,960 - [INFO] - Spark Session created successfully
2025-01-28 14:13:11,961 - [INFO] - Spark version: 3.5.0
2025-01-28 14:13:11,962 - [INFO] - Spark master: local[*]
2025-01-28 14:13:11,963 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:13:11,964 - [INFO] - Starting file processing...
2025-01-28 14:13:11,964 - [INFO] - Input path: /app/raw_data
2025-01-28 14:13:11,965 - [INFO] - Output path: /app/output
2025-01-28 14:13:11,966 - [INFO] - User agent filter: some user agent
2025-01-28 14:13:11,969 - [WARNING] - No parquet files found in input directory
2025-01-28 14:13:11,970 - [ERROR] - Spark processing failed
2025-01-28 14:13:11,971 - [ERROR] - Processing or loading failed
2025-01-28 14:13:12,181 - [INFO] - Spark Session stopped
2025-01-28 14:14:01,682 - [INFO] - Starting application...
2025-01-28 14:14:01,704 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:15:02,232 - [INFO] - Starting application...
2025-01-28 14:15:02,255 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:16:01,807 - [INFO] - Starting application...
2025-01-28 14:16:01,830 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:17:02,352 - [INFO] - Starting application...
2025-01-28 14:17:02,374 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:18:01,921 - [INFO] - Starting application...
2025-01-28 14:18:01,943 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:19:01,454 - [INFO] - Starting application...
2025-01-28 14:19:01,475 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:20:02,014 - [INFO] - Starting application...
2025-01-28 14:20:02,035 - [ERROR] - Error ensuring schema: (psycopg2.OperationalError) connection to server at "localhost" (127.0.0.1), port 5432 failed: Connection refused
	Is the server running on that host and accepting TCP/IP connections?
connection to server at "localhost" (::1), port 5432 failed: Cannot assign requested address
	Is the server running on that host and accepting TCP/IP connections?

(Background on this error at: https://sqlalche.me/e/14/e3q8)
2025-01-28 14:27:26,397 - [INFO] - Starting application...
2025-01-28 14:27:26,948 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:27:31,930 - [INFO] - Spark Session created successfully
2025-01-28 14:27:31,935 - [INFO] - Spark version: 3.5.0
2025-01-28 14:27:31,936 - [INFO] - Spark master: local[*]
2025-01-28 14:27:31,936 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:27:31,937 - [INFO] - Starting file processing...
2025-01-28 14:27:31,938 - [INFO] - Input path: /app/raw_data
2025-01-28 14:27:31,938 - [INFO] - Output path: /app/output
2025-01-28 14:27:31,939 - [INFO] - User agent filter: some user agent
2025-01-28 14:27:31,967 - [INFO] - Found 11 total parquet files
2025-01-28 14:27:31,968 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:27:31,968 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:27:37,693 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:27:38,352 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:27:40,400 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:27:41,222 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:27:41,874 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:27:42,626 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:27:43,069 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:27:46,998 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 14:27:47,004 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:27:47,008 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:27:47,013 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:27:47,014 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:27:47,379 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:27:47,569 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:27:47,931 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:27:48,347 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:27:48,537 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:27:48,871 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:27:49,116 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:27:49,517 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:27:49,786 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:27:50,537 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:27:50,945 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:27:51,173 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:27:51,523 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:27:51,889 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:27:52,949 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:27:54,440 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 14:27:54,448 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:27:54,454 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:27:54,460 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:27:54,466 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:27:54,470 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:27:54,476 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:27:54,481 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:27:54,486 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:27:54,487 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:27:54,487 - [INFO] - Successfully processed 2 dates
2025-01-28 14:27:54,488 - [INFO] - Starting client report loading process...
2025-01-28 14:27:54,506 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 14:27:54,553 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:27:54,791 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:27:54,943 - [INFO] - Archived 0 unique rows
2025-01-28 14:27:55,237 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:27:55,244 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 14:27:55,245 - [INFO] - - Archived rows: 0
2025-01-28 14:27:55,246 - [INFO] - - Loaded rows: 48
2025-01-28 14:27:55,247 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 14:27:55,259 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:27:55,277 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:27:55,396 - [INFO] - Upsert completed: stored/updated 2 invalid records in client_report_invalid.
2025-01-28 14:27:55,399 - [INFO] - Archived 0 unique rows
2025-01-28 14:27:55,409 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:27:55,414 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 14:27:55,415 - [INFO] - - Archived rows: 0
2025-01-28 14:27:55,416 - [INFO] - - Loaded rows: 48
2025-01-28 14:27:55,416 - [INFO] - 
Verifying data load...
2025-01-28 14:27:55,424 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 14:27:55,425 - [INFO] - 
Load Summary:
2025-01-28 14:27:55,425 - [INFO] - Total files processed: 2
2025-01-28 14:27:55,426 - [INFO] - Total rows loaded: 96
2025-01-28 14:27:55,427 - [INFO] - 
Date Range:
2025-01-28 14:27:55,427 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 14:27:55,428 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 14:27:55,429 - [INFO] - 
Total Counts:
2025-01-28 14:27:55,430 - [INFO] -   Impressions: 24
2025-01-28 14:27:55,431 - [INFO] -   Clicks: 30
2025-01-28 14:27:55,431 - [INFO] - 
Client report loading completed successfully
2025-01-28 14:27:55,432 - [INFO] - Processing and loading completed successfully
2025-01-28 14:27:56,018 - [INFO] - Spark Session stopped
2025-01-28 14:28:03,057 - [INFO] - Starting application...
2025-01-28 14:28:03,696 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:28:10,984 - [INFO] - Spark Session created successfully
2025-01-28 14:28:10,986 - [INFO] - Spark version: 3.5.0
2025-01-28 14:28:10,987 - [INFO] - Spark master: local[*]
2025-01-28 14:28:10,991 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:28:10,992 - [INFO] - Starting file processing...
2025-01-28 14:28:10,993 - [INFO] - Input path: /app/raw_data
2025-01-28 14:28:10,994 - [INFO] - Output path: /app/output
2025-01-28 14:28:10,996 - [INFO] - User agent filter: some user agent
2025-01-28 14:28:11,003 - [WARNING] - No parquet files found in input directory
2025-01-28 14:28:11,004 - [ERROR] - Spark processing failed
2025-01-28 14:28:11,006 - [ERROR] - Processing or loading failed
2025-01-28 14:28:11,434 - [INFO] - Spark Session stopped
2025-01-28 14:29:02,706 - [INFO] - Starting application...
2025-01-28 14:29:03,190 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:29:07,414 - [INFO] - Spark Session created successfully
2025-01-28 14:29:07,416 - [INFO] - Spark version: 3.5.0
2025-01-28 14:29:07,417 - [INFO] - Spark master: local[*]
2025-01-28 14:29:07,418 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:29:07,419 - [INFO] - Starting file processing...
2025-01-28 14:29:07,420 - [INFO] - Input path: /app/raw_data
2025-01-28 14:29:07,421 - [INFO] - Output path: /app/output
2025-01-28 14:29:07,422 - [INFO] - User agent filter: some user agent
2025-01-28 14:29:07,425 - [WARNING] - No parquet files found in input directory
2025-01-28 14:29:07,426 - [ERROR] - Spark processing failed
2025-01-28 14:29:07,427 - [ERROR] - Processing or loading failed
2025-01-28 14:29:07,562 - [INFO] - Spark Session stopped
2025-01-28 14:30:02,222 - [INFO] - Starting application...
2025-01-28 14:30:02,594 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:30:05,829 - [INFO] - Spark Session created successfully
2025-01-28 14:30:05,831 - [INFO] - Spark version: 3.5.0
2025-01-28 14:30:05,832 - [INFO] - Spark master: local[*]
2025-01-28 14:30:05,833 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:30:05,834 - [INFO] - Starting file processing...
2025-01-28 14:30:05,835 - [INFO] - Input path: /app/raw_data
2025-01-28 14:30:05,836 - [INFO] - Output path: /app/output
2025-01-28 14:30:05,837 - [INFO] - User agent filter: some user agent
2025-01-28 14:30:05,864 - [INFO] - Found 11 total parquet files
2025-01-28 14:30:05,865 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:30:05,866 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:30:10,096 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:30:10,594 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:30:12,222 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:30:12,899 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:30:13,475 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:30:14,197 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:30:14,519 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:30:17,387 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 14:30:17,391 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:30:17,396 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:30:17,400 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:30:17,401 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:30:17,704 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:30:17,895 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:30:18,295 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:30:18,674 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:30:18,852 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:30:19,101 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:30:19,320 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:30:19,644 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:30:19,876 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:30:20,357 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:30:20,762 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:30:20,993 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:30:21,280 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:30:21,566 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:30:22,486 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:30:23,495 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 14:30:23,501 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:30:23,505 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:30:23,509 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:30:23,514 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:30:23,518 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:30:23,523 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:30:23,528 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:30:23,532 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:30:23,534 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:30:23,535 - [INFO] - Successfully processed 2 dates
2025-01-28 14:30:23,536 - [INFO] - Starting client report loading process...
2025-01-28 14:30:23,543 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 14:30:23,553 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:30:23,584 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:30:23,631 - [INFO] - Archived 0 unique rows
2025-01-28 14:30:23,773 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:30:23,843 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 14:30:23,855 - [INFO] - - Archived rows: 0
2025-01-28 14:30:23,857 - [INFO] - - Loaded rows: 48
2025-01-28 14:30:23,858 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 14:30:23,865 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:30:23,872 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:30:23,934 - [INFO] - Upsert completed: stored/updated 2 invalid records in client_report_invalid.
2025-01-28 14:30:23,936 - [INFO] - Archived 0 unique rows
2025-01-28 14:30:23,941 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:30:23,946 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 14:30:23,951 - [INFO] - - Archived rows: 0
2025-01-28 14:30:23,952 - [INFO] - - Loaded rows: 48
2025-01-28 14:30:23,953 - [INFO] - 
Verifying data load...
2025-01-28 14:30:23,957 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 14:30:23,959 - [INFO] - 
Load Summary:
2025-01-28 14:30:23,960 - [INFO] - Total files processed: 2
2025-01-28 14:30:23,961 - [INFO] - Total rows loaded: 96
2025-01-28 14:30:23,962 - [INFO] - 
Date Range:
2025-01-28 14:30:23,963 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 14:30:23,964 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 14:30:23,965 - [INFO] - 
Total Counts:
2025-01-28 14:30:23,966 - [INFO] -   Impressions: 24
2025-01-28 14:30:23,966 - [INFO] -   Clicks: 30
2025-01-28 14:30:23,967 - [INFO] - 
Client report loading completed successfully
2025-01-28 14:30:23,967 - [INFO] - Processing and loading completed successfully
2025-01-28 14:30:24,524 - [INFO] - Spark Session stopped
2025-01-28 14:31:02,673 - [INFO] - Starting application...
2025-01-28 14:31:03,067 - [INFO] - Database schema and tables verified/created successfully
2025-01-28 14:31:07,747 - [INFO] - Spark Session created successfully
2025-01-28 14:31:07,748 - [INFO] - Spark version: 3.5.0
2025-01-28 14:31:07,750 - [INFO] - Spark master: local[*]
2025-01-28 14:31:07,751 - [INFO] - Spark app name: ImpressionClickCounterApp
2025-01-28 14:31:07,753 - [INFO] - Starting file processing...
2025-01-28 14:31:07,755 - [INFO] - Input path: /app/raw_data
2025-01-28 14:31:07,756 - [INFO] - Output path: /app/output
2025-01-28 14:31:07,757 - [INFO] - User agent filter: some user agent
2025-01-28 14:31:07,787 - [INFO] - Found 11 total parquet files
2025-01-28 14:31:07,788 - [INFO] - Impressions files by date: 2022-05-26, 2022-05-27
2025-01-28 14:31:07,789 - [INFO] - Clicks files by date: 2022-05-27
2025-01-28 14:31:12,394 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:31:12,921 - [INFO] - Found 14 impressions for user agent: some user agent
2025-01-28 14:31:14,530 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:31:15,180 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:31:15,721 - [INFO] - Hour distribution before aggregation: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:31:16,313 - [INFO] - Aggregated hour distribution: [Row(hour=19, count=10, valid_count=10), Row(hour=11, count=4, valid_count=4)]
2025-01-28 14:31:16,668 - [INFO] - Final hour distribution: [Row(hour=19, count=10), Row(hour=11, count=4)]
2025-01-28 14:31:19,339 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-26.csv
2025-01-28 14:31:19,343 - [INFO] - Removed processed file: impressions_processed_dk_20220526113212045_172845633-172845636_1.parquet
2025-01-28 14:31:19,348 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204695_172756391-172756397_0.parquet
2025-01-28 14:31:19,352 - [INFO] - Removed processed file: impressions_processed_dk_20220526193204903_172845709-172845711_1.parquet
2025-01-28 14:31:19,353 - [INFO] - Successfully processed data for date: 2022-05-26
2025-01-28 14:31:19,581 - [INFO] - Distinct user agents in impressions: [Row(user_agent='some user agent')]
2025-01-28 14:31:19,736 - [INFO] - Found 10 impressions for user agent: some user agent
2025-01-28 14:31:20,009 - [INFO] - Processing file: file:///app/raw_data/impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:31:20,338 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:31:20,506 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=10)]
2025-01-28 14:31:20,756 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=10, valid_count=10)]
2025-01-28 14:31:20,961 - [INFO] - Final hour distribution: [Row(hour=12, count=10)]
2025-01-28 14:31:21,274 - [INFO] - Distinct user agents in clicks: [Row(user_agent='some user agent')]
2025-01-28 14:31:21,502 - [INFO] - Found 30 clicks for user agent: some user agent
2025-01-28 14:31:21,918 - [INFO] - Processing file: file:///app/raw_data/clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:31:22,265 - [INFO] - Found 0 records with invalid hours
2025-01-28 14:31:22,491 - [INFO] - Hour distribution before aggregation: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:31:22,756 - [INFO] - Aggregated hour distribution: [Row(hour=12, count=20, valid_count=20), Row(hour=11, count=10, valid_count=10)]
2025-01-28 14:31:23,036 - [INFO] - Final hour distribution: [Row(hour=12, count=20), Row(hour=11, count=10)]
2025-01-28 14:31:24,059 - [WARNING] - Found records where clicks exceed impressions:
2025-01-28 14:31:24,883 - [INFO] - Successfully wrote output to /app/output/task1_output_2022-05-27.csv
2025-01-28 14:31:24,887 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154212_172756551-172756554_0.parquet
2025-01-28 14:31:24,891 - [INFO] - Removed processed file: impressions_processed_dk_20220527123154402_172845889-172845894_1.parquet
2025-01-28 14:31:24,895 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145108_163644805-163644809_1.parquet
2025-01-28 14:31:24,899 - [INFO] - Removed processed file: clicks_processed_dk_20220527113145201_163587236-163587240_0.parquet
2025-01-28 14:31:24,903 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143730_163587241-163587247_0.parquet
2025-01-28 14:31:24,908 - [INFO] - Removed processed file: clicks_processed_dk_20220527120143900_163644810-163644812_1.parquet
2025-01-28 14:31:24,912 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154754_163644813-163644819_1.parquet
2025-01-28 14:31:24,916 - [INFO] - Removed processed file: clicks_processed_dk_20220527123154813_163587248-163587250_0.parquet
2025-01-28 14:31:24,917 - [INFO] - Successfully processed data for date: 2022-05-27
2025-01-28 14:31:24,918 - [INFO] - Successfully processed 2 dates
2025-01-28 14:31:24,919 - [INFO] - Starting client report loading process...
2025-01-28 14:31:24,927 - [INFO] - Reading file: /app/output/task1_output_2022-05-26.csv
2025-01-28 14:31:24,938 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:31:24,962 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:31:24,976 - [INFO] - Archived 0 unique rows
2025-01-28 14:31:25,007 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:31:25,013 - [INFO] - Processed /app/output/task1_output_2022-05-26.csv:
2025-01-28 14:31:25,014 - [INFO] - - Archived rows: 0
2025-01-28 14:31:25,015 - [INFO] - - Loaded rows: 48
2025-01-28 14:31:25,016 - [INFO] - Reading file: /app/output/task1_output_2022-05-27.csv
2025-01-28 14:31:25,021 - [INFO] - Read CSV with shape: (24, 4)
2025-01-28 14:31:25,029 - [INFO] - Data prepared successfully. Shape: (24, 4)
2025-01-28 14:31:25,053 - [INFO] - Upsert completed: stored/updated 2 invalid records in client_report_invalid.
2025-01-28 14:31:25,056 - [INFO] - Archived 0 unique rows
2025-01-28 14:31:25,063 - [INFO] - Successfully loaded 48 rows into client_report.
2025-01-28 14:31:25,075 - [INFO] - Processed /app/output/task1_output_2022-05-27.csv:
2025-01-28 14:31:25,076 - [INFO] - - Archived rows: 0
2025-01-28 14:31:25,077 - [INFO] - - Loaded rows: 48
2025-01-28 14:31:25,078 - [INFO] - 
Verifying data load...
2025-01-28 14:31:25,082 - [INFO] - Verification results: {'total_rows': 48, 'date_range': {'start': datetime.datetime(2022, 5, 26, 0, 0), 'end': datetime.datetime(2022, 5, 27, 23, 0)}, 'totals': {'impressions': Decimal('24'), 'clicks': Decimal('30')}}
2025-01-28 14:31:25,084 - [INFO] - 
Load Summary:
2025-01-28 14:31:25,085 - [INFO] - Total files processed: 2
2025-01-28 14:31:25,085 - [INFO] - Total rows loaded: 96
2025-01-28 14:31:25,086 - [INFO] - 
Date Range:
2025-01-28 14:31:25,087 - [INFO] -   Start: 2022-05-26 00:00:00
2025-01-28 14:31:25,087 - [INFO] -   End: 2022-05-27 23:00:00
2025-01-28 14:31:25,088 - [INFO] - 
Total Counts:
2025-01-28 14:31:25,089 - [INFO] -   Impressions: 24
2025-01-28 14:31:25,090 - [INFO] -   Clicks: 30
2025-01-28 14:31:25,090 - [INFO] - 
Client report loading completed successfully
2025-01-28 14:31:25,091 - [INFO] - Processing and loading completed successfully
2025-01-28 14:31:26,087 - [INFO] - Spark Session stopped
